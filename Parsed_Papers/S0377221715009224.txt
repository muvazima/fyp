@&#MAIN-TITLE@&#Better than pre-commitment mean-variance portfolio allocation strategies: A semi-self-financing Hamilton–Jacobi–Bellman equation approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We expand the admissible set for pre-commitment MV portfolio allocation.


                        
                        
                           
                           It can be proved it is optimal to withdraw cash in certain cases.


                        
                        
                           
                           We determine the optimal strategy by numerically solving an HJB equation.


                        
                        
                           
                           Numerical examples illustrate the optimality of cash withdrawals.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finance

Investment analysis

Constrained pre-commitment mean-variance

HJB equation

@&#ABSTRACT@&#


               
               
                  We generalize the idea of semi-self-financing strategies, originally discussed in Ehrbar (1990), and later formalized in Cui et al (2012), for the pre-commitment mean-variance (MV) optimal portfolio allocation problem. The proposed semi-self-financing strategies are built upon a numerical solution framework for Hamilton–Jacobi–Bellman equations, and can be readily employed in a very general setting, namely continuous or discrete re-balancing, jump-diffusions with finite activity, and realistic portfolio constraints. We show that if the portfolio wealth exceeds a threshold, an MV optimal strategy is to withdraw cash. These semi-self-financing strategies are generally non-unique. Numerical results confirming the superiority of the efficient frontiers produced by the strategies with positive cash withdrawals are presented. Tests based on estimation of parameters from historical time series show that the semi-self-financing strategy is robust to estimation ambiguities.
               
            

@&#INTRODUCTION@&#

@&#MOTIVATION@&#

The mean-variance (MV) optimization criteria are popular for portfolio allocation problems, due to their intuitive nature (Basak & Chabakauri, 2010; Bielecki, Pliska, & Zhou, 2005; Leippold, Trojani, & Vanini, 2004; Li & Ng, 2000; Vigna, 2014; Wang & Forsyth, 2010; Zhou & Li, 2000). Under these criteria, risk is quantified by variance, so that investors aim to maximize the expected terminal wealth of their portfolios, given a risk level. Hence, the results can be easily interpreted in terms of the trade-off between the risk and the expected terminal portfolio wealth.

Mean-variance optimization typically yields pre-commitment strategies, which are time inconsistent (Basak & Chabakauri, 2010; Björk & Murgoci, 2010; Cui & Li, 2010; Cui, Li, Wang, & Zhu, 2012; Wang & Forsyth, 2011; 2012). However, it has been shown by Vigna (2014) that pre-commitment strategies can also be viewed as a target-based optimization which involves minimizing a quadratic loss function. Hence, these strategies are appropriate in the context of pension plan investment and insurance applications (Bauerle, 2005; Delong & Gerrard, 2007; Delong, Gerrard, & Haberman, 2008; Jose-Fombellida & Rincon-Zapatero, 2008). In fact, this phenomenon has been also discussed in the literature of MV hedging (see, for example Schweizer, 2010). In addition, it has also been pointed out that, in the context of optimal trade execution, the pre-commitment strategy optimizes trading efficiency as measured in practice (Almgren, 2012).

Previous work on pre-commitment MV optimal portfolio allocation has been dominated by the analytic (closed-form) approach. (See, for example, Bielecki et al., 2005; Li and Ng, 2000; Øksendal and Sulem, 2009; Zhou and Li, 2000, among many others.) However, this approach is not feasible when realistic constraints, such as no trading if insolvent and limited leverage, are imposed. In addition, from a risk management point of view, it is useful to model jumps in asset prices. In this case, it is necessary to impose a liquidation condition if the portfolio wealth jumps into the insolvent region. As a result, in these general situations, a fully numerical approach must be employed. It is important to highlight that realistic portfolio constraints and jumps are found to have pronounced effects on the efficient frontiers (Dang & Forsyth, 2014; Wang & Forsyth, 2010).

It is standard that MV strategies for the optimal portfolio allocation problem are self-financing, i.e. no exogenous infusion or withdrawal of cash are allowed under any circumstances. Central to our discussion is the concept of semi-self-financing. The term semi-self-financing strategy is usually employed to refer to a strategy that exploits either exogenous infusion or withdrawal of cash, but not both. In our context, we strictly define a semi-self-financing strategy as a strategy that uses only non-negative cash withdrawals.


                        Ehrbar (1990) is possibly the first published work that touches upon the idea of semi-self-financing in the context of MV optimal portfolio allocation. As illustrated in Ehrbar (1990), even for a single-period model, it is possible to achieve a superior portfolio, i.e. a portfolio having the same standard derivation, but higher expected portfolio wealth, by not investing all of the initial wealth. It is further argued in Ehrbar (1990) that the self-financing strategy is unrealistic in the sense that it requires the investors “to invest all their money, even if the additional investments do not add to their utility”. By withdrawing part of the initial portfolio, the investors can achieve superior results. It is also emphasized in Ehrbar (1990) that semi-self-financing strategies are “not only more straightforward”, but also allow “investors to find better uses for the money they cannot invest”.

Recently, the idea of semi-self-financing in the context of unconstrained pre-commitment MV optimal portfolio allocation is formalized in Cui and Li (2010) and Cui et al. (2012). In these papers, it is shown that, if the portfolio wealth exceeds a threshold at a re-balancing time, by removing a certain amount of cash from the portfolio, one can obtain a portfolio having the same expected wealth and standard deviation as the portfolio obtained by a self-financing MV optimal strategy. In addition, the investor receives a bonus in terms of a free cash flow.

It is well-known that the MV optimal portfolio allocation problem is a multi-criteria optimization problem. Following a standard scalarization method for multi-criteria optimization, a single criterion can be formed by a positively weighted sum of the criteria (Yu, 1974). The resulting single-objective problem is referred to as the MV scalarization problem.

However, for MV optimization in general, and MV optimal portfolio allocation in particular, dynamic programming is not directly applicable to the MV scalarization problem, due to the presence of the variance term. To overcome this difficulty, an embedding technique is proposed in Li and Ng (2000) and Zhou and Li (2000) to embed the objective of the MV scalarization problem in a new single-objective optimization problem, namely the embedded MV optimization problem. Intuitively, this idea can be viewed as a quadratic target investment strategy (Vigna, 2014). Note that the embedding approach can be applied to general non-convex problems, in contrast to a Lagrange multiplier formulation (Li, Xhou, & Lim, 2002). Non-convex problems can arise if we consider non-linear effects, such as price impact (Tse, Forsyth, & Li, 2014).

Optimal solutions with respect to the embedded MV optimization problem can be obtained by solving an associated Hamilton–Jacobi–Bellman (HJB) equation. It has been established in Li and Ng (2000) and Zhou and Li (2000) that the MV scalarization optimal set is a subset of the embedded MV objective set. However, there may be points in the embedded MV objective set which are not in the MV scalarization optimal set. Methods for eliminating such spurious points are discussed in Dang, Forsyth, and Li (2015) and Tse et al. (2014). In the rest of the paper, to indicate the optimality of a strategy with respect to the MV scalarization problem and to the embedded MV optimization problem, we respectively use the terms scalarization MV optimal/optimality and embedded MV optimal/optimality.

The main contributions of the paper can be summarized as follows.

                           
                              •
                              In this paper, we generalize the idea of semi-self-financing strategies developed in Cui and Li (2010), Cui et al. (2012) and Ehrbar (1990) for the pre-commitment MV optimal portfolio allocation problem. Using the results in Dang and Forsyth (2014), Dang et al. (2015) and Tse et al. (2014), we formulate the embedded MV optimization problem in terms of the numerical solution of an HJB partial integro-differential equation (PIDE). Utilizing a fully numerical approach, it is straightforward to consider continuous or discrete re-balancing, jump-diffusions with finite activity, and realistic portfolio constraints. We determine an embedded MV optimal strategy over all possible semi-self-financing strategies which satisfy the constraints.

We find certain cases where it can be proved that an embedded MV optimal semi-self-financing strategy involves withdrawing cash from the portfolio. These cases occur when the portfolio wealth exceeds the discounted optimal terminal wealth of the embedded problem. An embedded MV optimal strategy in this case is to (i) withdraw a specified amount of cash, and (ii) invest the remaining amount in the risk-free asset. However, embedded MV optimal semi-self-financing strategies are generally not unique.

Using the numerical schemes discussed in Dang and Forsyth (2014) for the solution of the HJB equation, and using the results in Dang et al. (2015) and Tse et al. (2014), we can guarantee that scalarization MV optimal points, i.e. those that are on efficient frontiers, can be generated from embedded MV optimal points.

We include several numerical examples to illustrate the superiority of strategies with positive cash withdrawals in a general setting where continuous and discrete re-balancing, realistic constraints, and jump-diffusions (with finite activity) are allowed.

We estimate the jump diffusion parameters based on an 89 year time series of market return data. The jump parameter estimates are sensitive to the estimation method. However, the simulated investment results using the semi-self-financing mean-variance strategies are robust to estimated model parameter ambiguities.

Since the portfolio can be either continuously or discretely re-balanced, we denote the set of discrete re-balancing times by

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                                M
                                             
                                             =
                                             
                                                {
                                                
                                                   t
                                                   0
                                                
                                                =
                                                0
                                                <
                                                
                                                   t
                                                   1
                                                
                                                <
                                                ⋯
                                                <
                                                
                                                   t
                                                   M
                                                
                                                =
                                                T
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let

                           
                              
                                 
                                    
                                       
                                          
                                             T
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            0
                                                            ,
                                                            T
                                                            ]
                                                         
                                                      
                                                      
                                                         
                                                            continuous
                                                            
                                                            re-balancing
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            T
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            discrete
                                                            
                                                            re-balancing
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Define 
                           
                              
                                 t
                                 −
                              
                              =
                              t
                              −
                              ϵ
                              ,
                              where
                              
                              ϵ
                              →
                              
                                 0
                                 +
                              
                              ,
                           
                         i.e. 
                           
                              t
                              −
                           
                         is instant of time just before the (forward) time t, t ∈ [0, T].

For simplicity, we assume that there are only two assets available in the financial market, namely a risky asset and a risk-free asset. We denote by S(t) and B(t) the amounts invested in risky and risk-free assets, respectively, at time t, t ∈ [0, T]. We denote by ξ the random number representing the jump multiplier. When a jump occurs, we have 
                           
                              S
                              
                                 (
                                 t
                                 )
                              
                              =
                              ξ
                              S
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                        . As a specific example, in this paper, we consider ξ following a log-normal distribution p(ξ) given by Merton (1976)
                        
                           
                              (2.1)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                ξ
                                                )
                                             
                                             =
                                             
                                                1
                                                
                                                   
                                                      
                                                         2
                                                         π
                                                      
                                                   
                                                   ζ
                                                   ξ
                                                
                                             
                                             exp
                                             
                                                (
                                                −
                                                
                                                   
                                                      
                                                         (
                                                         log
                                                         
                                                            (
                                                            ξ
                                                            )
                                                         
                                                         −
                                                         ν
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                      2
                                                      
                                                         ζ
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        with mean ν and standard deviation ζ, with 
                           
                              E
                              
                                 [
                                 ξ
                                 ]
                              
                              =
                              exp
                              
                                 (
                                 ν
                                 +
                                 
                                    ζ
                                    2
                                 
                                 /
                                 2
                                 )
                              
                              ,
                           
                         where E[·] denotes the expectation operator, and 
                           
                              κ
                              =
                              E
                              [
                              ξ
                              ]
                              −
                              1
                           
                        . In the absence of control, S follows the process:

                           
                              (2.2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   S
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   S
                                                   (
                                                   
                                                      t
                                                      −
                                                   
                                                   )
                                                
                                             
                                             =
                                             
                                                (
                                                μ
                                                −
                                                λ
                                                κ
                                                )
                                             
                                             d
                                             t
                                             +
                                             σ
                                             d
                                             Z
                                             +
                                             d
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      π
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ξ
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Here, dZ is the increment of a Wiener process, μ is the real world drift rate, and σ is the volatility, πt
                         is a Poisson process with positive intensity parameter λ, and ξi
                         are i.i.d. positive random variables having distribution (2.1). Also, it is assumed that the dynamics of the risk-free asset B, in the absence of control, follows:

                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             B
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             r
                                             B
                                             (
                                             t
                                             )
                                             d
                                             t
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where r is the (constant) risk-free rate. We make the standard assumption that the real world drift rate of S is strictly greater than r. Since there is only one risky asset, it is never optimal (in a MV setting) to short stock, i.e. S(t) ≥ 0, t ∈ [0, T]. However, we allow short positions in the risk-free asset, i.e. it is possible that B(t) < 0, t ∈ [0, T].

We denote by 
                           
                              X
                              (
                              t
                              )
                              =
                              (
                              S
                              (
                              t
                              )
                              ,
                              B
                              (
                              t
                              )
                              )
                              ,
                           
                         
                        t ∈ [0, T], the multi-dimensional (controlled) underlying process. Let c(·) ≡ (d(·), B(·)) denote the control as a function of the current state at 
                           
                              t
                              ∈
                              T
                              ,
                           
                         i.e.

                           
                              (2.3)
                              
                                 
                                    
                                       
                                          
                                             c
                                             
                                                (
                                                ·
                                                )
                                             
                                             :
                                             (
                                             X
                                             
                                                (
                                                
                                                   t
                                                   −
                                                
                                                )
                                             
                                             ,
                                             
                                                t
                                                −
                                             
                                             )
                                             ↦
                                             c
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             c
                                             (
                                             X
                                             
                                                (
                                                
                                                   t
                                                   −
                                                
                                                )
                                             
                                             ,
                                             
                                                t
                                                −
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          ≡
                                       
                                       
                                          
                                             (
                                             d
                                             
                                                (
                                                X
                                                
                                                   (
                                                   
                                                      t
                                                      −
                                                   
                                                   )
                                                
                                                ,
                                                
                                                   t
                                                   −
                                                
                                                )
                                             
                                             ,
                                             B
                                             
                                                (
                                                X
                                                
                                                   (
                                                   
                                                      t
                                                      −
                                                   
                                                   )
                                                
                                                ,
                                                
                                                   t
                                                   −
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          ≡
                                       
                                       
                                          
                                             (
                                             d
                                             (
                                             t
                                             )
                                             ,
                                             B
                                             (
                                             t
                                             )
                                             )
                                             ,
                                             
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here, d(·) denotes the non-negative
cash amount withdrawn from the portfolio before the re-balancing occurs at time t, and B(·) is the amount of portfolio wealth invested in the risk-free asset at the re-balancing time 
                           
                              t
                              ∈
                              T
                           
                        . Note that 
                           
                              T
                              ∈
                              T
                              ,
                           
                         i.e. cash withdrawals are allowed at T.

For 
                           
                              t
                              ∈
                              T
                              ,
                           
                         we denote by 
                           
                              x
                              =
                              
                                 (
                                 s
                                 ,
                                 b
                                 )
                              
                              =
                              (
                              S
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ,
                              B
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              )
                           
                         the state of the system at time 
                           
                              
                                 t
                                 −
                              
                              ,
                           
                         and by (S(x, c), B(x, c)) the state of the system after the control c ≡ (d, B) is applied. We then have that

                           
                              (2.4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                      (
                                                      s
                                                      ,
                                                      b
                                                      ,
                                                      c
                                                      ≡
                                                      (
                                                      d
                                                      ,
                                                      B
                                                      )
                                                      )
                                                   
                                                
                                                
                                                   
                                                      =
                                                      (
                                                      s
                                                      +
                                                      b
                                                      )
                                                      −
                                                      d
                                                      −
                                                      B
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Let the controlled wealth of the portfolio at time t ∈ [0, T] be denoted by

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ≡
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                S
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ,
                                                B
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                             =
                                             S
                                             
                                                (
                                                t
                                                )
                                             
                                             +
                                             B
                                             
                                                (
                                                t
                                                )
                                             
                                             ,
                                             
                                             t
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We strictly enforce the solvency condition, i.e. the investor can continue trading at 
                           
                              t
                              ∈
                              T
                           
                         only if

                           
                              (2.5)
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                s
                                                ,
                                                b
                                                )
                                             
                                             =
                                             s
                                             +
                                             b
                                             >
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the event that insolvency (bankruptcy) occurs, we require that the investor immediately liquidate all investments in the risky asset, and cease trading. That is,

                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             =
                                             0
                                             ;
                                             B
                                             =
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                s
                                                ,
                                                b
                                                )
                                             
                                             ;
                                             
                                             
                                                
                                                if
                                                
                                             
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                s
                                                ,
                                                b
                                                )
                                             
                                             ≤
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We also constrain the leverage ratio, i.e. the investor must select an allocation satisfying

                           
                              (2.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   S
                                                   +
                                                   B
                                                
                                             
                                             ≤
                                             
                                                q
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where qmax
                         is a known positive constant with typical value in [1.5, 2.0].

Denote by 
                           
                              Z
                              
                                 s
                                 e
                                 l
                                 f
                              
                           
                         the usual self-financing admissible set (d ≡ 0)

                           
                              
                                 
                                    
                                       
                                          
                                             Z
                                             
                                                s
                                                e
                                                l
                                                f
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             c
                                             ≡
                                             (
                                             d
                                             ,
                                             B
                                             )
                                             ∈
                                             {
                                             0
                                             }
                                             ×
                                             (
                                             −
                                             ∞
                                             ,
                                             +
                                             ∞
                                             )
                                             :
                                             S
                                             =
                                             (
                                             s
                                             +
                                             b
                                             )
                                             −
                                             B
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             where
                                             
                                             S
                                             ≥
                                             0
                                             ,
                                             
                                             
                                             and
                                             
                                             0
                                             ≤
                                             
                                                S
                                                
                                                   S
                                                   +
                                                   B
                                                
                                             
                                             ≤
                                             
                                                q
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We denote by 
                           
                              Z
                              
                                 s
                                 e
                                 m
                                 i
                              
                           
                         the admissible set under a semi-self-financing strategy.

                           
                              
                                 
                                    
                                       
                                          
                                             Z
                                             
                                                s
                                                e
                                                m
                                                i
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             c
                                             ≡
                                             (
                                             d
                                             ,
                                             B
                                             )
                                             ∈
                                             [
                                             0
                                             ,
                                             +
                                             ∞
                                             )
                                             ×
                                             (
                                             −
                                             ∞
                                             ,
                                             +
                                             ∞
                                             )
                                             :
                                             S
                                             =
                                             (
                                             s
                                             +
                                             b
                                             )
                                             −
                                             d
                                             −
                                             B
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             where
                                             
                                             S
                                             ≥
                                             0
                                             ,
                                             
                                             
                                             and
                                             
                                             
                                             0
                                             ≤
                                             
                                                S
                                                
                                                   S
                                                   +
                                                   B
                                                
                                             
                                             ≤
                                             
                                                q
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Clearly

                           
                              (2.7)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                
                                                   s
                                                   e
                                                   l
                                                   f
                                                
                                             
                                             ⊆
                                             
                                                Z
                                                
                                                   s
                                                   e
                                                   m
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In our subsequent discussions, when describing quantities relevant to the semi-self-financing and self-financing cases, the subscripts semi and self are used, respectively. However, to avoid repetitions, unless otherwise stated, we occasionally omit these subscripts, with the understanding that the discussion applies to both cases. For example, the admissible sets for both semi-self-financing and self-financing cases are collectively denoted as 
                           Z
                        .

We respectively denote by 
                           
                              
                                 E
                                 
                                    c
                                    (
                                    ·
                                    )
                                 
                                 
                                    x
                                    ,
                                    t
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                           
                         and 
                           
                              V
                              a
                              
                                 r
                                 
                                    c
                                    (
                                    ·
                                    )
                                 
                                 
                                    x
                                    ,
                                    t
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                           
                         the expectation and the variance of the terminal portfolio wealth conditional on (x, t) and the control c(·), 
                           
                              t
                              ∈
                              T
                           
                        . We desire to find controls c(·) which generate Pareto optimal points. We use a standard scalarization method to combine the two conflicting criteria, namely maximizing 
                           
                              
                                 E
                                 
                                    c
                                    (
                                    ·
                                    )
                                 
                                 
                                    x
                                    ,
                                    t
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                           
                         and simultaneously minimizing 
                           
                              V
                              a
                              
                                 r
                                 
                                    c
                                    (
                                    ·
                                    )
                                 
                                 
                                    x
                                    ,
                                    t
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                              ,
                           
                         into a single objective, by means of a positive weighting parameter ρ. Specifically, we desire to find the controls which solve

                           
                              (2.8)
                              
                                 
                                    
                                       
                                          
                                             P
                                             
                                                (
                                                x
                                                ,
                                                t
                                                ;
                                                ρ
                                                )
                                             
                                             =
                                             
                                                inf
                                                
                                                   c
                                                   (
                                                   ·
                                                   )
                                                   ∈
                                                   Z
                                                
                                             
                                             
                                                {
                                                ρ
                                                V
                                                a
                                                
                                                   r
                                                   
                                                      c
                                                      (
                                                      ·
                                                      )
                                                   
                                                   
                                                      x
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   [
                                                   
                                                      W
                                                      c
                                                   
                                                   
                                                      (
                                                      T
                                                      )
                                                   
                                                   ]
                                                
                                                −
                                                
                                                   E
                                                   
                                                      c
                                                      (
                                                      ·
                                                      )
                                                   
                                                   
                                                      x
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   [
                                                   
                                                      W
                                                      c
                                                   
                                                   
                                                      (
                                                      T
                                                      )
                                                   
                                                   ]
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

More formally, we have the following definitions.

                           Definition 2.1
                           Achievable MV objective set


                           Let 
                                 
                                    
                                       (
                                       
                                          x
                                          0
                                       
                                       ,
                                       
                                          t
                                          0
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       X
                                       
                                          (
                                          t
                                          =
                                          0
                                          )
                                       
                                       ,
                                       t
                                       =
                                       0
                                       )
                                    
                                 
                               denote the initial state. We denote by

                                 
                                    (2.9)
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                   =
                                                   {
                                                   
                                                      (
                                                      V
                                                      a
                                                      
                                                         r
                                                         
                                                            c
                                                            (
                                                            ·
                                                            )
                                                         
                                                         
                                                            
                                                               x
                                                               0
                                                            
                                                            ,
                                                            
                                                               t
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            W
                                                            c
                                                         
                                                         
                                                            (
                                                            T
                                                            )
                                                         
                                                         ]
                                                      
                                                      ,
                                                      
                                                         E
                                                         
                                                            c
                                                            (
                                                            ·
                                                            )
                                                         
                                                         
                                                            
                                                               x
                                                               0
                                                            
                                                            ,
                                                            
                                                               t
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            W
                                                            c
                                                         
                                                         
                                                            (
                                                            T
                                                            )
                                                         
                                                         ]
                                                      
                                                      )
                                                   
                                                   :
                                                   c
                                                   ∈
                                                   Z
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              the achievable MV objective set, and by 
                                 
                                    Y
                                    ¯
                                 
                               its closure.

For ρ > 0, let

                                 
                                    (2.10)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                      
                                                         P
                                                         (
                                                         ρ
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      {
                                                      
                                                         (
                                                         
                                                            V
                                                            *
                                                         
                                                         ,
                                                         
                                                            E
                                                            *
                                                         
                                                         )
                                                      
                                                      ∈
                                                      
                                                         Y
                                                         ¯
                                                      
                                                      :
                                                      ρ
                                                      
                                                         V
                                                         *
                                                      
                                                      −
                                                      
                                                         E
                                                         *
                                                      
                                                      =
                                                      
                                                         inf
                                                         
                                                            (
                                                            V
                                                            ,
                                                            E
                                                            )
                                                            ∈
                                                            Y
                                                         
                                                      
                                                      ρ
                                                      V
                                                      −
                                                      E
                                                      }
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              We denote the scalarization MV optimal set w.r.t. 
                                 Y
                               as

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                      P
                                                   
                                                   =
                                                   
                                                      ⋃
                                                      
                                                         ρ
                                                         >
                                                         0
                                                      
                                                   
                                                   
                                                      Y
                                                      
                                                         P
                                                         (
                                                         ρ
                                                         )
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The scalarization MV optimal set 
                                 
                                    Y
                                    P
                                 
                               is commonly known as the efficient frontier.

The set 
                                 
                                    Y
                                    ′
                                 
                               dominates the set 
                                 
                                    Y
                                    
                                       ′
                                       ′
                                    
                                 
                               if

                                 
                                    (2.11)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         
                                                            (
                                                            V
                                                            ,
                                                            E
                                                            )
                                                         
                                                         ∈
                                                         
                                                            Y
                                                            ′
                                                         
                                                      
                                                   
                                                   ρ
                                                   V
                                                   −
                                                   E
                                                   ≤
                                                   
                                                      inf
                                                      
                                                         
                                                            (
                                                            V
                                                            ,
                                                            E
                                                            )
                                                         
                                                         ∈
                                                         
                                                            Y
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ρ
                                                   V
                                                   −
                                                   E
                                                   ;
                                                   
                                                   ∀
                                                   ρ
                                                   >
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              and if ∃ρ > 0 s.t. (2.11) is a strict inequality.

Let 
                           
                              
                                 Y
                                 
                                    s
                                    e
                                    l
                                    f
                                 
                              
                              =
                              
                                 {
                                 
                                    (
                                    V
                                    a
                                    
                                       r
                                       
                                          c
                                          (
                                          ·
                                          )
                                       
                                       
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             t
                                             0
                                          
                                       
                                    
                                    
                                       [
                                       
                                          W
                                          c
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       ]
                                    
                                    ,
                                    
                                       E
                                       
                                          c
                                          (
                                          ·
                                          )
                                       
                                       
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             t
                                             0
                                          
                                       
                                    
                                    
                                       [
                                       
                                          W
                                          c
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       ]
                                    
                                    )
                                 
                                 :
                                 c
                                 ∈
                                 
                                    Z
                                    
                                       s
                                       e
                                       l
                                       f
                                    
                                 
                                 }
                              
                              ,
                           
                         with the obvious similar definition of 
                           
                              Y
                              
                                 s
                                 e
                                 m
                                 i
                              
                           
                        . Let 
                           
                              Y
                              
                                 P
                              
                              
                                 s
                                 e
                                 l
                                 f
                              
                           
                         (resp. 
                           
                              Y
                              
                                 P
                              
                              
                                 s
                                 e
                                 m
                                 i
                              
                           
                        ) be the scalarization MV optimal set w.r.t. 
                           
                              Y
                              
                                 s
                                 e
                                 l
                                 f
                              
                           
                         (resp. 
                           
                              Y
                              
                                 s
                                 e
                                 m
                                 i
                              
                           
                        ). It follows from (2.7) that 
                           
                              
                                 Y
                                 
                                    s
                                    e
                                    l
                                    f
                                 
                              
                              ⊆
                              
                                 Y
                                 
                                    s
                                    e
                                    m
                                    i
                                 
                              
                           
                        . Hence, we have the following obvious result.

                           Proposition 2.1
                           
                              
                                 
                                    Y
                                    
                                       P
                                    
                                    
                                       s
                                       e
                                       l
                                       f
                                    
                                 
                               
                              cannot dominate
                              
                                 
                                    Y
                                    
                                       P
                                    
                                    
                                       s
                                       e
                                       m
                                       i
                                    
                                 
                              
                              .
                           

In the context of MV optimal portfolio allocation, our objective is to determine the efficient frontier 
                           
                              Y
                              P
                           
                        . We make use of the result in Zhou and Li (2000) and Li and Ng (2000) on the embedding technique.

                           Definition 2.4
                           Embedded MV objective set


                           Let 
                                 Y
                               be the achievable MV objective set defined in Definition 2.1. The embedded MV objective set, denoted by 
                                 
                                    
                                       Y
                                       Q
                                    
                                    ,
                                 
                               is defined by

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                      Q
                                                   
                                                   =
                                                   
                                                      ⋃
                                                      
                                                         −
                                                         ∞
                                                         <
                                                         γ
                                                         <
                                                         +
                                                         ∞
                                                      
                                                   
                                                   
                                                      Y
                                                      
                                                         Q
                                                         (
                                                         γ
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where

                                 
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                   
                                                      Q
                                                      (
                                                      γ
                                                      )
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   {
                                                   
                                                      (
                                                      
                                                         V
                                                         *
                                                      
                                                      ,
                                                      
                                                         E
                                                         *
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      ¯
                                                   
                                                   :
                                                   
                                                      V
                                                      *
                                                   
                                                   +
                                                   
                                                      E
                                                      *
                                                      2
                                                   
                                                   −
                                                   γ
                                                   
                                                      E
                                                      *
                                                   
                                                   =
                                                   
                                                      inf
                                                      
                                                         (
                                                         V
                                                         ,
                                                         E
                                                         )
                                                         ∈
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      V
                                                      +
                                                      
                                                         E
                                                         2
                                                      
                                                      −
                                                      γ
                                                      E
                                                      )
                                                   
                                                   }
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The embedding result of Li and Ng (2000) and Zhou and Li (2000) is summarized in Theorem 2.1.

                           Theorem 2.1
                           Embedding result


                           
                              Let
                              
                                 Y
                               
                              be the achievable MV objective set defined in 
                              
                                 Definition 2.1
                              
                              . Assume
                              
                                 
                                    
                                       (
                                       
                                          V
                                          0
                                       
                                       ,
                                       
                                          E
                                          0
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       
                                          P
                                          (
                                          ρ
                                          )
                                       
                                    
                                    ,
                                 
                               
                              ρ > 0, i.e.
                              
                                 
                                    (2.12)
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                   
                                                      V
                                                      0
                                                   
                                                   −
                                                   
                                                      E
                                                      0
                                                   
                                                   =
                                                   
                                                      inf
                                                      
                                                         (
                                                         V
                                                         ,
                                                         E
                                                         )
                                                         ∈
                                                         Y
                                                      
                                                   
                                                   ρ
                                                   V
                                                   −
                                                   E
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Then
                              
                                 
                                    (2.13)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                      0
                                                   
                                                   +
                                                   
                                                      E
                                                      0
                                                      2
                                                   
                                                   −
                                                   γ
                                                   
                                                      E
                                                      0
                                                   
                                                   =
                                                   
                                                      inf
                                                      
                                                         (
                                                         V
                                                         ,
                                                         E
                                                         )
                                                         ∈
                                                         Y
                                                      
                                                   
                                                   V
                                                   +
                                                   
                                                      E
                                                      2
                                                   
                                                   −
                                                   γ
                                                   E
                                                   ,
                                                   
                                                   i
                                                   .
                                                   e
                                                   .
                                                   
                                                   
                                                      (
                                                      
                                                         V
                                                         0
                                                      
                                                      ,
                                                      
                                                         E
                                                         0
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      
                                                         Q
                                                         (
                                                         γ
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    (2.14)
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                   =
                                                   
                                                      1
                                                      ρ
                                                   
                                                   +
                                                   2
                                                   
                                                      E
                                                      0
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              That is
                              
                                 
                                    
                                       Y
                                       P
                                    
                                    ⊆
                                    
                                       Y
                                       Q
                                    
                                 
                              
                              .
                           

In Appendix A we give a short proof of this, which shows that the embedding result is essentially a geometric property of 
                           
                              Y
                              ,
                           
                         and hence is valid for any admissible control set, including that for a semi-self-financing strategy.

The optimization problem arising from Theorem 2.1 is of the form

                           
                              (2.15)
                              
                                 
                                    
                                       
                                          
                                             V
                                             
                                                (
                                                x
                                                ,
                                                t
                                                )
                                             
                                             =
                                             
                                                inf
                                                
                                                   c
                                                   (
                                                   ·
                                                   )
                                                   ∈
                                                   Z
                                                
                                             
                                             
                                                {
                                                
                                                   E
                                                   
                                                      c
                                                      (
                                                      ·
                                                      )
                                                   
                                                   
                                                      x
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         
                                                            W
                                                            c
                                                         
                                                         
                                                            (
                                                            T
                                                            )
                                                         
                                                         −
                                                         γ
                                                         /
                                                         2
                                                         )
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where V(x, t) denotes the value function, and the parameter 
                           
                              γ
                              ∈
                              (
                              −
                              ∞
                              ,
                              +
                              ∞
                              )
                           
                        . Theorem 2.1 implies that there exists a γ ≡ γ(x, t, ρ), such that, for a given positive ρ, a control c
                        * ≡ (d
                        *, B
                        *) which minimizes the objective function of (2.8) also minimizes that of (2.15).

                           Remark 2.1
                           Scalarization and embedded MV optimal


                           A scalarization (resp. embedded) MV optimal control is a control in 
                                 Z
                               which minimizes the objective function of (2.8) (resp. of (2.15)). A strategy which generates such a control is a scalarization (resp. embedded) MV optimal strategy.


                              γ
                              ) Suppose 
                                 
                                    
                                       (
                                       
                                          V
                                          0
                                       
                                       ,
                                       
                                          E
                                          0
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       
                                          P
                                          (
                                          ρ
                                          )
                                       
                                    
                                 
                               and ∃γ ≤ 0, s.t. 
                                 
                                    
                                       (
                                       
                                          V
                                          0
                                       
                                       ,
                                       
                                          E
                                          0
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       
                                          Q
                                          (
                                          γ
                                          )
                                       
                                    
                                 
                              . From Eq. (2.14) this implies that 
                                 
                                    
                                       E
                                       0
                                    
                                    <
                                    0
                                    ,
                                 
                               and by definition 
                                 
                                    
                                       V
                                       0
                                    
                                    ≥
                                    0
                                 
                              . But the strategy of investing all assets in the risk free bond has positive expectation and zero variance. Hence an embedded MV optimal point 
                                 
                                    (
                                    
                                       V
                                       0
                                    
                                    ,
                                    
                                       E
                                       0
                                    
                                    )
                                 
                               with γ ≤ 0 cannot be scalarization MV optimal. In view of this, we will assume that γ > 0 in the remainder of this paper.

From (2.15), the value γ/2 can essentially be viewed as the optimal value of the terminal portfolio wealth for the embedded problem. Note that γ/2 is not the expected terminal wealth (see (2.14)).

                           Definition 2.5
                           Discounted optimal embedded terminal wealth


                           We define the discounted optimal embedded terminal wealth at time t, t ∈ [0, T], denoted by Wopt
                              (t), as (with γ > 0 from Remark 2.2)

                                 
                                    (2.16)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   =
                                                   
                                                      γ
                                                      2
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         r
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                   
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                     
                        Theorem 3.1
                        A scalarization MV optimal semi-self-financing strategy


                        
                           For any γ > 0, if
                           
                              
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    
                                       t
                                       −
                                    
                                    )
                                 
                                 >
                                 
                                    W
                                    
                                       o
                                       p
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       t
                                       −
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 t
                                 ∈
                                 T
                                 ,
                              
                            
                           then a scalarization MV optimal semi-self-financing strategy (i.e.
                           
                              
                                 Z
                                 =
                                 
                                    Z
                                    
                                       s
                                       e
                                       m
                                       i
                                    
                                 
                              
                           
                           ) is to
                           
                              
                                 •
                                 
                                    Step 1: withdraw
                                    
                                       
                                          d
                                          =
                                          
                                             W
                                             c
                                          
                                          
                                             (
                                             
                                                t
                                                −
                                             
                                             )
                                          
                                          −
                                          
                                             W
                                             
                                                o
                                                p
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                −
                                             
                                             )
                                          
                                       
                                     
                                    from the portfolio, and
                                 


                                    Step 2: invest the remaining amount, i.e.
                                    
                                       
                                          
                                             W
                                             
                                                o
                                                p
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                −
                                             
                                             )
                                          
                                          ,
                                       
                                     
                                    in the risk-free asset for the remainder of the investment horizon.
                                 

Since the proof of this result requires a fair amount of machinery, we postpone it until Section 5, where we also discuss the non-uniqueness of this strategy.

We first describe the computational process associated with the value function (2.15). For each fixed value of γ, 
                        
                           0
                           <
                           γ
                           <
                           +
                           ∞
                           ,
                        
                      we determine the value function V(s, b, t) by solving the associated HJB equation backward in time (Dang & Forsyth, 2014; Wang & Forsyth, 2010; 2012). The HJB equations are given in Appendix B. The terminal condition at time T is

                        
                           (4.1)
                           
                              
                                 
                                    
                                       
                                          V
                                          
                                             (
                                             s
                                             ,
                                             b
                                             ,
                                             T
                                             )
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   W
                                                   c
                                                
                                                
                                                   (
                                                   T
                                                   )
                                                
                                                −
                                                γ
                                                /
                                                2
                                                )
                                             
                                             2
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           (4.2)
                           
                              
                                 
                                    
                                       
                                          
                                             W
                                             c
                                          
                                          
                                             (
                                             T
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         s
                                                         +
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         Z
                                                         =
                                                         
                                                            Z
                                                            
                                                               s
                                                               e
                                                               l
                                                               f
                                                            
                                                         
                                                         ,
                                                         
                                                         
                                                            (
                                                            a
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         min
                                                         (
                                                         γ
                                                         /
                                                         2
                                                         ,
                                                         s
                                                         +
                                                         b
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         Z
                                                         =
                                                         
                                                            Z
                                                            
                                                               s
                                                               e
                                                               m
                                                               i
                                                            
                                                         
                                                         .
                                                         
                                                         
                                                            (
                                                            b
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

(Note that Eq. (4.2b) assumes that the optimal withdrawal 
                        
                           d
                           (
                           T
                           )
                           =
                           max
                           (
                           s
                           +
                           b
                           −
                           γ
                           /
                           2
                           ,
                           0
                           )
                        
                      occurs at T.) During this solution process, the optimal control c
                     *(·) can be determined. We then use this control to find the quantity 
                        
                           U
                           
                              (
                              s
                              ,
                              b
                              ,
                              t
                              )
                           
                           =
                           
                              E
                              
                                 
                                    c
                                    *
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                              
                              
                                 x
                                 ,
                                 t
                              
                           
                           
                              [
                              
                                 W
                                 c
                              
                              
                                 (
                                 T
                                 )
                              
                              ]
                           
                           ,
                        
                      since this information is needed in order to determine the corresponding embedded MV point 
                        
                           
                              (
                              V
                              a
                              
                                 r
                                 
                                    
                                       c
                                       *
                                    
                                    
                                       (
                                       ·
                                       )
                                    
                                 
                                 
                                    
                                       x
                                       0
                                    
                                    ,
                                    t
                                    =
                                    0
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                              ,
                              
                                 E
                                 
                                    
                                       c
                                       *
                                    
                                    
                                       (
                                       ·
                                       )
                                    
                                 
                                 
                                    
                                       x
                                       0
                                    
                                    ,
                                    t
                                    =
                                    0
                                 
                              
                              
                                 [
                                 
                                    W
                                    c
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ]
                              
                              )
                           
                           ∈
                           
                              Y
                              
                                 Q
                                 (
                                 γ
                                 )
                              
                           
                        
                     . This last step primarily involves solving an associated linear PDE/PIDE. For details, see Dang and Forsyth (2014).

The above computation is repeated for different values of γ, each of which give us an embedded MV point in the corresponding 
                        
                           Y
                           
                              Q
                              (
                              γ
                              )
                           
                        
                     . However, since our objective is to determine the efficient frontier 
                        
                           
                              Y
                              P
                           
                           ,
                        
                      the result that 
                        
                           
                              Y
                              P
                           
                           ⊆
                           
                              Y
                              Q
                           
                           ,
                        
                      as given in Theorem 2.1, is insufficient by itself. This is due to the fact that, in a general non-convex setting, there exist spurious points, i.e. points in 
                        
                           Y
                           Q
                        
                      which are not in 
                        
                           Y
                           P
                        
                     . The identification and elimination of spurious points from the set 
                        
                           Y
                           Q
                        
                      is primarily based on the concept of scalarization optimal points (SOPs) with respect to a set.

                        Definition 4.1
                        Let 
                              X
                            be a non-empty subset of 
                              
                                 Y
                                 ¯
                              
                           . We define

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                   ρ
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      (
                                                      
                                                         V
                                                         *
                                                      
                                                      ,
                                                      
                                                         E
                                                         *
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      X
                                                      ¯
                                                   
                                                   :
                                                   ρ
                                                   
                                                      V
                                                      *
                                                   
                                                   −
                                                   
                                                      E
                                                      *
                                                   
                                                   =
                                                   
                                                      inf
                                                      
                                                         (
                                                         V
                                                         ,
                                                         E
                                                         )
                                                         ∈
                                                         X
                                                      
                                                   
                                                   ρ
                                                   V
                                                   −
                                                   E
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 X
                                 ¯
                              
                            is the closure of 
                              X
                           . We call a point in 
                              
                                 
                                    A
                                    ρ
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            a scalarization optimal point (SOP) w.r.t. 
                              
                                 (
                                 X
                                 ,
                                 ρ
                                 )
                              
                           . We also define

                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                =
                                                {
                                                
                                                   (
                                                   
                                                      V
                                                      *
                                                   
                                                   ,
                                                   
                                                      E
                                                      *
                                                   
                                                   )
                                                
                                                :
                                                
                                                   (
                                                   
                                                      V
                                                      *
                                                   
                                                   ,
                                                   
                                                      E
                                                      *
                                                   
                                                   )
                                                
                                                
                                                is
                                                
                                                an
                                                
                                                SOP
                                                
                                                w.r.t.
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   ρ
                                                   )
                                                
                                                
                                                for
                                                
                                                some
                                                
                                                ρ
                                                >
                                                0
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We refer to 
                              
                                 
                                    (
                                    
                                       V
                                       0
                                    
                                    ,
                                    
                                       E
                                       0
                                    
                                    )
                                 
                                 ∈
                                 A
                                 
                                    (
                                    X
                                    )
                                 
                              
                            as SOP w.r.t.
                           
                              X
                           .

We have the following result in Tse et al. (2014), which leads to a computational procedure that guarantees generation of points on the efficient frontier.

                        Theorem 4.1
                        Theorem 4.7 in Tse et al. (2014)
                        


                        
                           The SOPs w.r.t.
                           
                              
                                 Y
                                 Q
                              
                            
                           are the same as the SOPs w.r.t.
                           
                              
                                 Y
                                 ,
                              
                            
                           i.e.
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                
                                                   (
                                                   
                                                      Y
                                                      Q
                                                   
                                                   )
                                                
                                                =
                                                
                                                   Y
                                                   P
                                                
                                                =
                                                A
                                                
                                                   (
                                                   Y
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We also have the following useful result on uniqueness of points in 
                        
                           Y
                           Q
                        
                      for fixed γ from Tse et al. (2014).

                        Theorem 4.2
                        Theorem 4.8 in Tse et al. (2014)
                        


                        
                           If
                           
                              
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                                 ∈
                                 A
                                 
                                    (
                                    
                                       Y
                                       Q
                                    
                                    )
                                 
                                 ,
                              
                            
                           then there exists a γ such that
                           
                              
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                                 ∈
                                 
                                    Y
                                    
                                       Q
                                       (
                                       γ
                                       )
                                    
                                 
                                 ,
                              
                            
                           and
                           
                              
                                 Y
                                 
                                    Q
                                    (
                                    γ
                                    )
                                 
                              
                            
                           is a singleton.
                        

An issue associated with numerical construction of the set 
                        
                           Y
                           Q
                        
                      is that, for each embedding parameter γ, 
                        
                           0
                           <
                           γ
                           <
                           +
                           ∞
                           ,
                        
                      a numerical algorithm applied to the embedded problem can generate only a single embedded MV point 
                        
                           
                              (
                              V
                              ,
                              E
                              )
                           
                           ∈
                           
                              Y
                              Q
                           
                           
                              (
                              γ
                              )
                           
                           ,
                        
                      while the set 
                        
                           Y
                           
                              Q
                              (
                              γ
                              )
                           
                        
                      may contain multiple embedded MV points. Thus, in the context of computation, what available to us is the computed MV embedded objective set, denoted by 
                        
                           Y
                           
                              Q
                           
                           †
                        
                     . This set is defined as follows.

                        Definition 4.2
                        Computed MV embedded objective set


                        Let 
                              
                                 Y
                                 
                                    Q
                                    (
                                    γ
                                    )
                                 
                                 †
                              
                            be a singleton subset of 
                              
                                 Y
                                 
                                    Q
                                    (
                                    γ
                                    )
                                 
                              
                           . Specifically, 
                              
                                 Y
                                 
                                    Q
                                    (
                                    γ
                                    )
                                 
                                 †
                              
                            contains either

                              
                                 •
                                 the unique single point which is SOP w.r.t. 
                                       
                                          Y
                                          Q
                                       
                                     if 
                                       
                                          Y
                                          
                                             Q
                                             (
                                             γ
                                             )
                                          
                                       
                                     is the singleton set containing a point SOP w.r.t. 
                                       
                                          
                                             Y
                                             Q
                                          
                                          ,
                                       
                                     or

an arbitrarily selected single point of 
                                       
                                          Y
                                          
                                             Q
                                             (
                                             γ
                                             )
                                          
                                       
                                     otherwise.

The computed MV objective set is then defined as 
                              
                                 
                                    Y
                                    
                                       Q
                                    
                                    †
                                 
                                 =
                                 
                                    ⋃
                                    
                                       0
                                       <
                                       γ
                                       <
                                       +
                                       ∞
                                    
                                 
                                 
                                    Y
                                    
                                       Q
                                       (
                                       γ
                                       )
                                    
                                    †
                                 
                                 .
                              
                           
                        

Under some technical conditions, which are satisfied in the present case, it can be shown that 
                        
                           Y
                           P
                        
                      can be generated from 
                        
                           Y
                           Q
                           †
                        
                     .

                        Theorem 4.3
                        Theorem 5.4 in Tse et al. (2014)
                        


                        
                           
                              
                                 A
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 =
                                 
                                    Y
                                    P
                                 
                                 =
                                 A
                                 
                                    (
                                    Y
                                    )
                                 
                                 .
                              
                           
                        

Another issue is that Theorem 4.3, in principle, requires the entire set 
                        
                           Y
                           Q
                           †
                        
                      to be available, but, in practice, we can only solve the embedded problem for a finite number of 
                        
                           γ
                           ∈
                           (
                           0
                           ,
                           +
                           ∞
                           )
                        
                      values. More specifically, a sampling discretization for γ needs to be implemented. We denote by Γk
                      the finite discrete set of sampled γ values at the sampling discretization level k. Examples of how Γk
                      can be refined are given by Dang et al. (2015). Denote by 
                        
                           
                              
                                 (
                                 
                                    Y
                                    Q
                                    †
                                 
                                 )
                              
                              k
                           
                           =
                           
                              ⋃
                              
                                 γ
                                 ∈
                                 
                                    Γ
                                    k
                                 
                              
                           
                           
                              Y
                              
                                 Q
                                 (
                                 γ
                                 )
                              
                              †
                           
                        
                      the set of all computed MV embedded points using the sampling set Γk
                     .

For a fixed sampling discretization level k, we need to compute the set 
                        
                           
                              (
                              
                                 Y
                                 Q
                                 †
                              
                              )
                           
                           k
                        
                      by repeating the computational process associated with the embedded problem outlined earlier for each γ ∈ Γk
                     . Once the set 
                        
                           
                              (
                              
                                 Y
                                 Q
                                 †
                              
                              )
                           
                           k
                        
                      has been computed, we need to construct its SOPs, i.e. 
                        
                           A
                           (
                           
                              
                                 (
                                 
                                    Y
                                    Q
                                    †
                                 
                                 )
                              
                              k
                           
                           )
                        
                     . This is easily done by determining the vertices of the upper left convex hull of 
                        
                           
                              (
                              
                                 Y
                                 Q
                                 †
                              
                              )
                           
                           k
                        
                      (Tse et al., 2014). The following theorem captures the asymptotic convergence properties of the set 
                        
                           A
                           (
                           
                              
                                 (
                                 
                                    Y
                                    Q
                                    †
                                 
                                 )
                              
                              k
                           
                           )
                        
                      with respect to the discretization of the embedding parameter γ.

                        Theorem 4.4
                        Theorem 3.1 of Dang et al. (2015)
                        


                        
                           Every limit point in
                           
                              
                                 A
                                 (
                                 
                                    
                                       (
                                       
                                          Y
                                          Q
                                          †
                                       
                                       )
                                    
                                    k
                                 
                                 )
                                 ,
                              
                           
                           
                              
                                 k
                                 →
                                 +
                                 ∞
                                 ,
                              
                            
                           is a point in
                           
                              
                                 A
                                 (
                                 
                                    Y
                                    Q
                                    †
                                 
                                 )
                              
                           
                           .
                        


                           Theorem 4.4 implies that a computational procedure which involves (i) discretizing the embedding parameter γ, (ii) constructing the upper left convex hull of the resulting set 
                              
                                 
                                    
                                       (
                                       
                                          Y
                                          Q
                                          †
                                       
                                       )
                                    
                                    k
                                 
                                 ,
                              
                            and (iii) repeating for finer discretizations of the γ set, results in a set of limit points which are points on the efficient frontier.

Since the value function V(s, b, t) (2.15) is defined as an expectation of a non-negative quantity, it immediately follows that V(s, b, t) ≥ 0. For use later in the paper, we define 
                           
                              
                                 T
                                 
                                    ≥
                                    α
                                 
                              
                              =
                              
                                 {
                                 t
                                 ∈
                                 T
                                 :
                                 t
                                 ≥
                                 α
                                 }
                              
                           
                        .

                           Proposition 5.1
                           
                              For both
                              
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          l
                                          f
                                       
                                    
                                    ,
                                 
                               
                              for all t ∈ [0, T], the state
                              
                                 
                                    
                                       (
                                       s
                                       ,
                                       b
                                       )
                                    
                                    =
                                    (
                                    0
                                    ,
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                    ,
                                 
                               
                              where Wopt
                              (t) is defined in 
                              
                                 (2.16)
                              
                              , is a (globally) minimum state of the value function V(s, b, t), i.e.
                              
                                 
                                    V
                                    (
                                    0
                                    ,
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    t
                                    )
                                    =
                                    0
                                    ,
                                 
                               ∀t ∈ [0, T].
                           

Consider the state 
                                 
                                    x
                                    =
                                    
                                       (
                                       s
                                       ,
                                       b
                                       )
                                    
                                    =
                                    (
                                    0
                                    ,
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                    ,
                                 
                               
                              t ∈ [0, T], and the strategy c
                              *(·) defined by neither withdrawing nor re-balancing in 
                                 
                                    T
                                    
                                       ≥
                                       t
                                    
                                 
                              . Of course, this strategy is in 
                                 Z
                              . Under c
                              *(·), 
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    γ
                                    /
                                    2
                                 
                               with certainty, i.e. the optimal embedded terminal wealth γ/2 is achievable under c
                              *(·). By definition (2.15), we have, also with certainty, that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   (
                                                   0
                                                   ,
                                                   
                                                      W
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                ≡
                                             
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         c
                                                         (
                                                         ·
                                                         )
                                                         ∈
                                                         Z
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         E
                                                         
                                                            c
                                                            (
                                                            ·
                                                            )
                                                         
                                                         
                                                            x
                                                            ,
                                                            t
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               (
                                                               
                                                                  W
                                                                  c
                                                               
                                                               
                                                                  (
                                                                  T
                                                                  )
                                                               
                                                               −
                                                               γ
                                                               /
                                                               2
                                                               )
                                                            
                                                            2
                                                         
                                                         ]
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      E
                                                      
                                                         
                                                            c
                                                            *
                                                         
                                                         
                                                            (
                                                            ·
                                                            )
                                                         
                                                      
                                                      
                                                         x
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            
                                                               W
                                                               c
                                                            
                                                            
                                                               (
                                                               T
                                                               )
                                                            
                                                            −
                                                            γ
                                                            /
                                                            2
                                                            )
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              This result holds for both the discrete and continuous re-balancing case.□

We are particularly interested in the case 
                           
                              Z
                              =
                              
                                 Z
                                 
                                    s
                                    e
                                    m
                                    i
                                 
                              
                              ,
                           
                         and we summarize the important properties of the state 
                           
                              
                                 (
                                 s
                                 ,
                                 b
                                 )
                              
                              =
                              (
                              0
                              ,
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         in Property 5.1 for 
                           
                              Z
                              =
                              
                                 Z
                                 
                                    s
                                    e
                                    m
                                    i
                                 
                              
                           
                        .

                           Property 5.1
                           The following properties for the state 
                                 
                                    
                                       (
                                       s
                                       ,
                                       b
                                       )
                                    
                                    =
                                    (
                                    0
                                    ,
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                    ,
                                 
                               
                              t ∈ [0, T], where Wopt
                              (t) is defined in (2.16), hold for both jump-diffusions and pure diffusions, for both discrete and continuous re-balancing, and for 
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    (a)
                                    The state 
                                          
                                             
                                                (
                                                s
                                                ,
                                                b
                                                )
                                             
                                             =
                                             (
                                             0
                                             ,
                                             
                                                W
                                                
                                                   o
                                                   p
                                                   t
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             )
                                          
                                        always satisfies the solvency condition (2.5) (see Remark 2.2) and the leverage constraint (2.6).

By Proposition 5.1 and (a), 
                                          
                                             
                                                (
                                                s
                                                ,
                                                b
                                                )
                                             
                                             =
                                             (
                                             0
                                             ,
                                             
                                                W
                                                
                                                   o
                                                   p
                                                   t
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             )
                                          
                                        is a (globally) minimum state of the value function V(s, b, t), 
                                          
                                             ∀
                                             t
                                             ∈
                                             [
                                             0
                                             ,
                                             T
                                             ]
                                             ⊇
                                             T
                                          
                                       . Hence, a re-balancing at time 
                                          
                                             t
                                             ∈
                                             T
                                          
                                        to this state is embedded MV optimal, and remains embedded MV optimal.

We are now in a position to prove our main result, Theorem 3.1.

                           Proof
                           For any γ > 0, when 
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    >
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    ,
                                 
                               applying the strategy in Theorem 3.1 results in a re-balancing to the state 
                                 
                                    
                                       (
                                       s
                                       ,
                                       b
                                       )
                                    
                                    =
                                    (
                                    0
                                    ,
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                              . This state, by Proposition 5.1, is a (globally) minimum state of the value function, and remains a (globally) minimum for times in 
                                 
                                    
                                       [
                                       t
                                       ,
                                       T
                                       ]
                                    
                                    ⊇
                                    
                                       T
                                       
                                          ≥
                                          t
                                       
                                    
                                 
                              . As a result, there exist no other strategies in 
                                 
                                    Z
                                    
                                       s
                                       e
                                       m
                                       i
                                    
                                 
                               which can produce a smaller value function (2.15). Hence, the strategy in Theorem 3.1 is embedded MV optimal.

Suppose 
                                 
                                    
                                       (
                                       
                                          V
                                          *
                                       
                                       ,
                                       
                                          E
                                          *
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       P
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                              . From Theorem 2.1, ∃γ
                              * s.t. 
                                 
                                    
                                       (
                                       
                                          V
                                          *
                                       
                                       ,
                                       
                                          E
                                          *
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       
                                          Q
                                          (
                                          
                                             γ
                                             *
                                          
                                          )
                                       
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                    ⊆
                                    
                                       Y
                                       
                                          Q
                                       
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                              . But, as shown above, the strategy in Theorem 3.1 is embedded MV optimal for all γ > 0, which includes γ
                              * corresponding to 
                                 
                                    
                                       (
                                       
                                          V
                                          *
                                       
                                       ,
                                       
                                          E
                                          *
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       P
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                              . Thus, this strategy is also scalarization MV optimal.□

We refer to the strategy described in Theorem 3.1 as the semi-self-financing MV strategy. If 
                           
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              >
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ,
                           
                         then the allocation 
                           
                              
                                 (
                                 S
                                 
                                    (
                                    
                                       t
                                       −
                                    
                                    )
                                 
                                 ,
                                 B
                                 
                                    (
                                    
                                       t
                                       −
                                    
                                    )
                                 
                                 )
                              
                              →
                              
                                 (
                                 S
                                 ,
                                 B
                                 )
                              
                              ≡
                              
                                 (
                                 0
                                 ,
                                 
                                    W
                                    
                                       o
                                       p
                                       t
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                           
                         is illustrated in Fig. 5.1
                        .

In this section, we show that, in general, embedded MV optimal semi-self-financing strategies are non-unique. Recall that 
                           
                              T
                              ∈
                              T
                              ,
                           
                         i.e. withdrawals are permitted at 
                           
                              t
                              =
                              T
                           
                        .

                           Proposition 5.2
                           
                              For both continuous and discrete re-balancing cases, when
                              
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                    ,
                                 
                               
                              we have
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      (
                                                      s
                                                      ,
                                                      b
                                                      ,
                                                      t
                                                      )
                                                   
                                                   =
                                                   0
                                                   ;
                                                   
                                                   ∀
                                                   s
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   b
                                                   ≥
                                                   
                                                      W
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   t
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Consider the state 
                                 
                                    x
                                    =
                                    (
                                    s
                                    ,
                                    b
                                    )
                                    ,
                                 
                               
                              s ≥ 0, and b ≥ Wopt
                              (t), t ∈ [0, T]. Also consider the control c
                              *(·) defined by (i) neither withdrawing nor re-balancing in 
                                 
                                    
                                       T
                                       
                                          ≥
                                          t
                                       
                                    
                                    ∖
                                    
                                       {
                                       T
                                       }
                                    
                                    ,
                                 
                               and (ii) applying steps of the strategy in Theorem 3.1 at T. Then, under c
                              *(·), 
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    γ
                                    /
                                    2
                                 
                               with certainty, i.e. the optimal embedded terminal wealth γ/2 is achievable under c
                              *(·). Thus, we have, also with certainty, that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   (
                                                   s
                                                   ,
                                                   b
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                ≡
                                             
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         c
                                                         (
                                                         ·
                                                         )
                                                         ∈
                                                         Z
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         E
                                                         
                                                            c
                                                            (
                                                            ·
                                                            )
                                                         
                                                         
                                                            x
                                                            ,
                                                            t
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               (
                                                               
                                                                  W
                                                                  c
                                                               
                                                               
                                                                  (
                                                                  T
                                                                  )
                                                               
                                                               −
                                                               γ
                                                               /
                                                               2
                                                               )
                                                            
                                                            2
                                                         
                                                         ]
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      E
                                                      
                                                         
                                                            c
                                                            *
                                                         
                                                         
                                                            (
                                                            ·
                                                            )
                                                         
                                                      
                                                      
                                                         x
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            
                                                               W
                                                               c
                                                            
                                                            
                                                               (
                                                               T
                                                               )
                                                            
                                                            −
                                                            γ
                                                            /
                                                            2
                                                            )
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                   =
                                                   0
                                                   ,
                                                   
                                                   
                                                   ∀
                                                   s
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   
                                                   b
                                                   ≥
                                                   
                                                      W
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                   
                                                   
                                                   ∀
                                                   t
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              □

If 
                           
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              =
                              S
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              +
                              B
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              >
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              t
                              ∈
                              T
                              ∖
                              {
                              T
                              }
                              ,
                           
                         from Proposition 5.2, an embedded MV optimal strategy is

                           
                              •
                              Step 1: if 
                                    
                                       B
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       <
                                       
                                          W
                                          
                                             o
                                             p
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       ,
                                    
                                  re-balance the portfolio to a point (S, B) in the triangular region on the (s, b) plane defined by the three points (0, Wopt
                                 (t)), 
                                    
                                       (
                                       
                                          W
                                          c
                                       
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       −
                                       
                                          W
                                          
                                             o
                                             p
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       ,
                                       
                                          W
                                          
                                             o
                                             p
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       )
                                       ,
                                    
                                  and 
                                    
                                       (
                                       0
                                       ,
                                       
                                          W
                                          c
                                       
                                       
                                          (
                                          
                                             t
                                             −
                                          
                                          )
                                       
                                       )
                                    
                                 . This step may involve a positive cash withdrawal.

Step 2: withdraw from the portfolio, at time 
                                    
                                       t
                                       =
                                       T
                                       ,
                                    
                                  the amount exceeding γ/2.

Possible allocations in Step 1 are illustrated in Fig. 5.2
                         (shaded region, including the boundaries). After Step 2, the optimal terminal wealth for the embedded problem γ/2 is hit exactly. Note that, if 
                           
                              B
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ≥
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ,
                           
                         then Step 1 can be omitted.

An interesting strategy is the one which corresponds to re-balancing to the point 
                           
                              (
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              −
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ,
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              )
                              ,
                           
                         i.e. investing 
                           
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                         in the bond, and allocating the remaining wealth to the risky asset. Another strategy is to re-balance to 
                           
                              (
                              0
                              ,
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              )
                              ,
                           
                         i.e. investing all the wealth in bond. No cash withdrawals are needed in these cases at t, 
                           
                              t
                              ∈
                              T
                              ∖
                              {
                              T
                              }
                           
                        . The strategy in Theorem 3.1 corresponds to re-balancing to the point (0, Wopt
                        (t)). This strategy involves immediately removing 
                           
                              d
                              =
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              −
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                         in cash from the portfolio. This corresponds to the concept of free cash flow as described in Bauerle and Grether (2015) and Cui et al. (2012). All of the above strategies involve cash withdrawals of the amount exceeding γ/2 at 
                           
                              t
                              =
                              T
                              ,
                           
                         and hence, produce the same points in 
                           
                              Y
                              Q
                              
                                 s
                                 e
                                 m
                                 i
                              
                           
                        .

Different choices of strategies simply amount to different ways of handling portfolio wealth in excess of 
                           
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                        . Since the strategy in Theorem 3.1 corresponds to the idea of a pure free cash flow of Bauerle and Grether (2015) and Cui et al. (2012), we restrict our attention to this strategy for the remainder of this paper.

                           Remark 5.1
                           Non-uniqueness of optimal strategies: numerical issues


                           We do not compute 
                                 
                                    Y
                                    Q
                                    
                                       s
                                       e
                                       m
                                       i
                                    
                                 
                               but only 
                                 
                                    Y
                                    
                                       Q
                                    
                                    
                                       †
                                       ,
                                       s
                                       e
                                       m
                                       i
                                    
                                 
                               (see Definition 4.2). However, if 
                                 
                                    
                                       (
                                       V
                                       ,
                                       E
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       
                                          Q
                                          (
                                          γ
                                          )
                                       
                                       
                                          †
                                          ,
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                    ⊆
                                    A
                                    
                                       (
                                       
                                          Y
                                          
                                             Q
                                          
                                          
                                             †
                                             ,
                                             s
                                             e
                                             m
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                 
                               then from Theorem 4.3, 
                                 
                                    
                                       (
                                       V
                                       ,
                                       E
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       P
                                    
                                 
                              . In other words, even though the embedded MV optimal strategy may be non-unique, the computed point 
                                 
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               is a unique point on the efficient frontier, if 
                                 
                                    
                                       (
                                       V
                                       ,
                                       E
                                       )
                                    
                                    ∈
                                    A
                                    
                                       (
                                       
                                          Y
                                          
                                             Q
                                          
                                          
                                             †
                                             ,
                                             s
                                             e
                                             m
                                             i
                                          
                                       
                                       )
                                    
                                 
                              .

(Theorem 3.1 strategy: optimality of withdrawing if 
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    >
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                 
                              ) Consider an alternative strategy: invest all wealth in the risk-free bond if 
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    >
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    ,
                                 
                               with no withdrawal at 
                                 
                                    t
                                    =
                                    T
                                 
                              . In this case, since the total wealth at 
                                 
                                    t
                                    =
                                    T
                                 
                               (with certainty) will be larger than γ/2, this will not be embedded MV optimal, hence cannot be scalerization MV optimal. Intuitively, in terms of mean variance, if the terminal wealth exceeds γ/2, then this increases the variance, which is unfavorable from the point of view of mean-variance optimality. Removing the cash from the investable wealth removes this upside penalty.

We have the following result which is proved in Dang and Forsyth (2015)
                        
                           Theorem 5.1
                           Theorem C.2 and Remark C.3 in Dang and Forsyth (2015)
                           


                           
                              Provided that the volatility σ, the jump intensity λ and the jump probability density p(ξ) are independent of the amount invested in the risky asset s, then if
                              
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    ≤
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    t
                                    ∈
                                    T
                                    ,
                                 
                               
                              an optimal embedded MV optimal policy is not to withdraw in the following cases:
                              
                                 
                                    •
                                    
                                       continuous re-balancing and jump-diffusions of the form (
                                       
                                          2.1
                                       
                                       ) and (
                                       
                                          2.2
                                       
                                       ), qmax
                                        ≥ 1,


                                       discrete re-balancing and jump-diffusions of the form (
                                       
                                          2.1
                                       
                                       ) and (
                                       
                                          2.2
                                       
                                       ), and no leverage possible (i.e.
                                       
                                          
                                             
                                                q
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       ).
                                    


                                       continuous or discrete re-balancing and pure diffusions (no jumps), qmax
                                        ≥ 1.
                                    

Since 
                           
                              
                                 Y
                                 P
                                 
                                    s
                                    e
                                    m
                                    i
                                 
                              
                              ⊆
                              
                                 Y
                                 Q
                                 
                                    s
                                    e
                                    m
                                    i
                                 
                              
                              ,
                           
                         we have the following result.

                           Corollary 5.1
                           
                              When
                              
                                 
                                    Z
                                    =
                                    
                                       Z
                                       
                                          s
                                          e
                                          m
                                          i
                                       
                                    
                                    ,
                                 
                               
                              for the cases of Theorem 
                              
                                 5.1
                              
                              , an optimal scalarization MV policy is to not withdraw when
                              
                                 
                                    
                                       W
                                       c
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                    ≤
                                    
                                       W
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          −
                                       
                                       )
                                    
                                 
                              
                              .
                           

Note that we have not been able to prove that Theorem 5.1 holds for the case of jump-diffusions, discrete rebalancing, and leverage permitted (i.e. qmax
                         > 1). In fact, it is not clear that the optimality of no withdrawal for 
                           
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              <
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                         holds for this case in general. Nevertheless, in all our numerical tests, we have always observed that, for all cases, it is never embedded MV optimal to withdraw if 
                           
                              
                                 W
                                 c
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                              ≤
                              
                                 W
                                 
                                    o
                                    p
                                    t
                                 
                              
                              
                                 (
                                 
                                    t
                                    −
                                 
                                 )
                              
                           
                        . However, it remains an open question as to whether this is true in general for any jump processes.

It is interesting to note that in some cases, the portfolio wealth Wc
                        (t) never exceeds Wopt
                        (t) ∀t. In Vigna (2014), it is proven that, for the case of pure diffusions, continuous re-balancing, no leverage permitted and no solvency constraints, then Wc
                        (t) ≤ Wopt
                        (t), i.e. the optimal terminal wealth for the embedded problem is always approached from below. The continuous re-balancing case was also discussed in Cui et al. (2012).

From Bauerle and Grether (2015), we learn that in a complete market, it is never optimal to withdraw cash from the investment portfolio. However, this is a sufficient but not necessary condition. Consider an incomplete market with downward jumps and continuous rebalancing. In this case, an optimal control will always produce Wc
                        (t) ≤ Wopt
                        (t), hence it is never optimal to withdraw cash in this case.

The positive cash withdrawal d certainly falls outside the scope of MV framework. However, this positive cash amount is an extra bonus for the investor that should be taken into account. To handle this free cash amount, we follow the concept of free cash flow in Cui and Li (2010), Cui et al. (2012) and Bauerle and Grether (2015). Let

                           
                              (5.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                                
                                                   
                                                      c
                                                      *
                                                   
                                                   
                                                      (
                                                      ·
                                                      )
                                                   
                                                
                                                
                                                   
                                                      x
                                                      0
                                                   
                                                   ,
                                                   0
                                                
                                             
                                             
                                                [
                                                
                                                   d
                                                   
                                                      t
                                                      o
                                                      t
                                                   
                                                
                                                ]
                                             
                                             =
                                             E
                                             
                                                [
                                                
                                                   ∫
                                                   0
                                                   T
                                                
                                                d
                                                
                                                   (
                                                   s
                                                   )
                                                
                                                
                                                   e
                                                   
                                                      r
                                                      (
                                                      T
                                                      −
                                                      s
                                                      )
                                                   
                                                
                                                d
                                                s
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        be the expected value of the cash withdrawals, under the control c
                        *(·), including interest. This expectation can added to the expected wealth of the portfolio. We refer to this strategy as the semi-self-financing MV plus free cash strategy. Note that if we allow only a finite number of rebalancing times tα
                        , then

                           
                              (5.2)
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             
                                                ∑
                                                α
                                             
                                             δ
                                             
                                                (
                                                s
                                                −
                                                
                                                   t
                                                   α
                                                
                                                )
                                             
                                             d
                                             
                                                (
                                                
                                                   t
                                                   α
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              δ
                              (
                              s
                              −
                              
                                 t
                                 α
                              
                              )
                           
                         is a Dirac function. In the continuous withdrawal case, we expect that it will be optimal to withdraw cash only once (see Section 5.4). In this case, we denote by 
                           
                              t
                              ^
                           
                         the random variable representing the first time the cash withdrawal d(·) is positive. This random variable is defined as

                           
                              (5.3)
                              
                                 
                                    
                                       
                                          
                                             
                                                t
                                                ^
                                             
                                             =
                                             inf
                                             
                                                {
                                                t
                                                ∈
                                                T
                                                :
                                                d
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                >
                                                0
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this case, Eq. (5.2) becomes

                           
                              (5.4)
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             δ
                                             
                                                (
                                                s
                                                −
                                                
                                                   t
                                                   ^
                                                
                                                )
                                             
                                             d
                                             
                                                (
                                                
                                                   t
                                                   ^
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To be clear in subsequent discussions, in Table 5.1
                        , we summarize how the expectations and the variances of the terminal wealth are computed for different strategies. These expectations and variances are used to plot efficient frontiers in numerical examples presented in Section 6.

                           Remark 5.3
                           Plus free cash frontier


                           Note that in the plus free cash case in Table 5.1, we add in the free cash to the expected value, but we do not include the free cash in the variance. In this case, the plus free cash frontier is simply the semi-self-financing MV efficient frontier shifted upward by the free cash. Adding the free cash into the variance calculation would penalize the strategy (i.e. increase the variance). Hence, we should not regard the plus free cash curve as a true efficient frontier, but as graphical way to represent the extra value obtained by the investor due to the free cash. Similar curves were shown in Cui et al. (2012).

In this section, we present selected numerical results of our proposed strategies applied to the MV portfolio allocation problem. In the experiments, we assume process (2.2) in the jump diffusion case, and 
                        
                           
                              
                                 d
                                 
                                    S
                                    t
                                 
                              
                              S
                           
                           =
                           μ
                           d
                           t
                           +
                           σ
                           d
                           Z
                           ,
                        
                      for the Geometric Brownian Motion (GBM) case.

We solve the HJB equations in Appendix B using the finite difference method described in Dang and Forsyth (2014). For computational purposes, we localize the original domain to 
                        
                           
                              [
                              0
                              ,
                              
                                 s
                                 
                                    m
                                    a
                                    x
                                 
                              
                              )
                           
                           ×
                           
                              [
                              −
                              
                                 b
                                 
                                    m
                                    a
                                    x
                                 
                              
                              ,
                              
                                 b
                                 
                                    m
                                    a
                                    x
                                 
                              
                              ]
                           
                           ×
                           
                              [
                              0
                              ,
                              T
                              ]
                           
                           ,
                        
                      where smax
                      and bmax
                      are positive and sufficiently large. Unless otherwise noted, the details of grid and timestep refinement levels used are given in Table 6.1
                     . For the construction of the efficient frontier, we also need to discretize γ. In our numerical experiments, when constructing efficient frontiers using refinement levels 1 and 2, we respectively use a total of 30 and 60 values of γ. Theorem 4.4 guarantees that successive refinements of the γ discretization, and constructing the upper left convex hull of the these points, generates limit points which are on the efficient frontier.

To illustrate the effect of our proposed strategies on the efficient frontiers, we carry out experiments where, in the case of jump diffusions, the mean jump size is upward (i.e. ν > 0, see Eq. (2.1)) and mean jump size downward (i.e. ν < 0 ), as well as with pure diffusions. Input parameters and data for these test cases are given in Table 6.2
                     . (The parameters for the mean downward jump-diffusion and pure diffusion cases are used in Dang and Forsyth (2014).) Note that, compared to the mean downward jump case, for the mean upward jump case, we increase the mean (ν) of the jump multiplier (ξ) from 
                        −
                     0.78832 to 0.1, and the drift μ from 0.07955 to 0.12168, while keeping other parameters the same. Hence, both jump cases have the same compensated drift. As a result, the changes in the efficient frontiers observed in these two cases entirely come from the effect of the jump term, and not from the drift term. In this section, we will show the superiority of the efficient frontiers produced by the strategies with positive cash withdrawals.

Although errors are introduced in truncating an infinite domain for the localized problem, we can make these errors small by choosing bmax
                         and smax
                         sufficiently large. As an illustrative example of this point, we carry out experiments with the semi-self-financing control with discrete re-balancing and upward jumps. Table 6.3 shows the expectation values (Exp. val.) and the standard deviations (Std. dev.) of the portfolio wealth obtained with various large boundary values for smax
                         and bmax
                        . It is observed that, as long as smax
                         and bmax
                         are sufficiently large, the values of the expectation and the variance are insensitive to the location of the truncated boundaries.

Next, we numerically show that the differences between the efficient frontiers obtained by a semi-self-financing strategy and those obtained by its self-financing counterpart are much larger than the discretization errors of the numerical methods. As an illustrative example, we consider a self-financing MV strategy and the semi-self-financing MV strategy for the case of discrete re-balancing and upward jumps.

In Fig. 6.1
                         we present the computed MV embedded objective sets 
                           
                              
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 k
                              
                              ,
                           
                        
                        
                           
                              k
                              =
                              1
                              ,
                              2
                              ,
                           
                         with spurious points removed, i.e. 
                           
                              A
                              (
                              
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 k
                              
                              )
                              ,
                           
                        
                        
                           
                              k
                              =
                              1
                              ,
                              2
                           
                        . Note that the expected value is plotted versus standard deviation, which is a more practically meaningful display of the results. For each strategy, the set 
                           
                              A
                              (
                              
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 k
                              
                              )
                           
                         for 
                           
                              k
                              =
                              2
                           
                         visually coincides with that for 
                           
                              k
                              =
                              1
                           
                        . Further refinement steps show negligible changes. This suggests convergence of the numerical solution, as well as convergence of 
                           
                              A
                              (
                              
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 k
                              
                              )
                           
                         to the efficient frontiers. Results from Fig. 6.1 indicate that the discretization errors of the numerical methods are negligibly small compared to the differences between the efficient frontiers obtained by different MV strategies. In the following, unless otherwise stated, refinement level 2 is used, and 
                           
                              A
                              (
                              
                                 
                                    (
                                    
                                       Y
                                       Q
                                       †
                                    
                                    )
                                 
                                 2
                              
                              )
                           
                         is considered to be the efficient frontier.

In this section, we compare the efficient frontiers obtained using semi-self-financing MV strategies with those obtained using a self-financing MV strategy. We only discuss the continuous and discrete re-balancing with jump-diffusions. Findings in the discrete case under pure diffusions are similar, and hence, omitted.

In Fig. 6.2
                        , we present plots of efficient frontiers for continuous and discrete re-balancing cases. Both mean downward and mean upward jumps are considered. In Figs. 6.3
                         and 6.4
                        , we present the close-up versions of these efficient frontiers for the mean upward jump case and mean downward jump case, respectively. We make the following observations:

                           
                              •
                              Overall, for both upward and downward jump cases, the efficient frontiers produced by the semi-self-financing MV strategies dominate those produced by a self-financing MV strategy.

The effect on the MV efficient frontiers of the semi-self-financing MV strategies are more pronounced for mean upward jumps than with mean downward jumps. This is an expected result, since for mean downward jumps, the probability that the Wc
                                 (t) exceeds Wopt
                                 (t) is much smaller than that in the mean upward jump case.

For mean downward jumps, the effect of our proposed MV strategies on the efficient frontiers is very small (see Fig. 6.4).

The effect on the MV efficient frontiers of our proposed MV strategies appear to be more pronounced with discrete re-balancing than with continuous re-balancing, assuming the same dynamics for the risky asset. This behavior is also expected.

We conclude that the semi-self-financing strategies are clearly more advantageous than self-financing strategies. From Proposition 2.1, we are ensured that the semi-self-financing strategies are never inferior to a self-financing strategy. But, in some cases, i.e. Wc
                        (t) > Wopt
                        (t), for some 
                           
                              t
                              ∈
                              T
                              ,
                           
                         which is likely to occur in a general setting, the semi-self-financing strategies are superior to those obtained by a self-financing strategy. This is because semi-self-financing efficient frontiers can be no worse than those obtained using a self-financing strategy, and the semi-self-financing strategies have the ability to generate a positive free cash flow during the investment.

We assume that the SDE followed by a stock market index is given by Eq. (2.1) and (2.2). Recall that the log-normal distribution for the jump size density p(ξ) (from Eq. (2.1)) has mean ν and standard deviation ζ, with 
                        
                           E
                           
                              [
                              ξ
                              ]
                           
                           =
                           exp
                           
                              (
                              ν
                              +
                              
                                 ζ
                                 2
                              
                              /
                              2
                              )
                           
                           ,
                        
                      where E[·] denotes the expectation operator, and 
                        
                           κ
                           =
                           E
                           [
                           ξ
                           ]
                           −
                           1
                        
                     .

In order to determine appropriate parameters for the jump diffusion model, we use the daily total return data from the Center for Research in Security Prices (CRSP).
                        1
                     
                     
                        1
                        See http://www.crsp.com/ .
                      The CRSP VWD index is a value (capitalization) weighted index of all securities traded on major US exchanges, dating from 1925. The returns include all dividends and distributions.

We use the daily total return (including dividends) series from December 31, 1925 to December 31, 2014, a span of 89 years. We also extract monthly returns from the same series. We convert the daily simple returns into index prices.

Consider a discrete series of index prices 
                        
                           S
                           
                              (
                              
                                 t
                                 i
                              
                              )
                           
                           =
                           
                              S
                              i
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                           
                           +
                           
                           1
                           ,
                        
                      observed at equally spaced time intervals 
                        
                           Δ
                           t
                           =
                           
                              t
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              t
                              i
                           
                           ,
                           ∀
                           i
                           ,
                        
                      with 
                        
                           T
                           =
                           N
                           Δ
                           t
                        
                     .
                        2
                     
                     
                        2
                        We assume equal spacing for ease of exposition.
                      Let

                        
                           (7.1)
                           
                              
                                 
                                    
                                       
                                          Δ
                                          
                                             X
                                             i
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          log
                                          
                                             (
                                             
                                                
                                                   S
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   S
                                                   i
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     be the log  return. We also define the detrended log  returns 
                        
                           Δ
                           
                              
                                 X
                                 ^
                              
                              i
                           
                        
                      as

                        
                           (7.2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Δ
                                          
                                             
                                                X
                                                ^
                                             
                                             i
                                          
                                          =
                                          Δ
                                          
                                             X
                                             i
                                          
                                          −
                                          
                                             m
                                             ^
                                          
                                          Δ
                                          t
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             m
                                             ^
                                          
                                          =
                                          
                                             
                                                log
                                                
                                                   (
                                                   
                                                      S
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                log
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   )
                                                
                                             
                                             T
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

As a first example, we assume that there are no jumps (i.e. 
                           
                              λ
                              =
                              0
                           
                         in Eq. (2.2)), so that the index is assumed to follow pure GBM. We determine the two parameters μ, σ by maximum likelihood estimation (MLE), which in this case are given by the simple expressions

                           
                              (7.3)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             μ
                                             −
                                             
                                                
                                                   σ
                                                   2
                                                
                                                2
                                             
                                             =
                                             
                                                m
                                                ^
                                             
                                             
                                             
                                                
                                                (from
                                                
                                                Eq.
                                                
                                                (7.2))
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                σ
                                                2
                                             
                                             =
                                             
                                                1
                                                
                                                   Δ
                                                   t
                                                
                                             
                                             v
                                             a
                                             r
                                             
                                                (
                                                
                                                   {
                                                   Δ
                                                   
                                                      X
                                                      i
                                                   
                                                   }
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where var is the variance.

The results for both daily and monthly log  returns are shown in Table 7.1
                        
                        . The estimates for μ and σ are insensitive to the choice of daily or monthly observations. Table 7.2
                         also shows the mean treasury rates for the entire period as well.

In order to determine the set of parameters for the full jump-diffusion model, use of maximum likelihood is well known to be problematic, due to multiple local maxima and the ill-posedness of attempting to distinguish high frequency small jumps from diffusion (Honore, 1998).

From a long term investor perspective, the most important feature of a jump diffusion model is that it allows modeling of infrequent large jumps in asset prices. Small, frequent jumps look like enhanced volatility, when examined on a large scale, hence these effects are probably not important in constructing a long term investment strategy.


                        Ait-Sahalia and Jacod (2012) discuss several econometric techniques that have been developed for detecting the presence of jumps in high frequency data (i.e. with the time scale of seconds). However, these high frequency jumps are not of particular interest to the long-term investor, hence we will use the thresholding technique described in Cont and Mancini (2011) and Mancini (2009). This technique is considered to be more efficient for low frequency data.

Suppose we have an estimate for the diffusive volatility component 
                           
                              
                                 σ
                                 ^
                              
                              ,
                           
                         then we detect a jump in period i if (Shimizu, 2013)

                           
                              (7.4)
                              
                                 
                                    
                                       
                                          
                                             
                                                |
                                                Δ
                                             
                                             
                                                
                                                   X
                                                   ^
                                                
                                                i
                                             
                                             
                                                |
                                                >
                                                α
                                             
                                             
                                                σ
                                                ^
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      t
                                                   
                                                
                                                
                                                   
                                                      (
                                                      Δ
                                                      t
                                                      )
                                                   
                                                   β
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where β, α > 0 are tuning parameters. The intuition behind Eq. (7.4)
can be explained simply. If we choose 
                           
                              α
                              =
                              4
                              ,
                           
                         say, and β ≪ 1, then Eq. (7.4) labels a return as a jump if the observed return is larger than a 4 standard deviation Brownian motion change, which would be extremely improbable. Hence we would consider this return to be due to a jump. If we choose a smaller time interval, i.e. reduce Δt, keeping the total time T fixed, then Eq. (7.4)
indicates that we should increase the threshold which filters out the Brownian motion increments. Intuitively, this is because we have increased the number of samples, and we expect to observe some large deviation events purely by chance. Typically, β in Eq. (7.4) is quite small, 
                           
                              β
                              ≃
                              .
                              01
                              −
                              .
                              02
                           
                        .

In Fig. 7.1
                         we show a histogram of the monthly and daily log  returns from the CRSP index, scaled to unit standard deviation and zero mean. We also plot a standard normal density as well.

Based on the monthly log  returns in Fig. 7.1 we set the jump detection indicator 1
                        
                           i
                         as follows

                           
                              (7.5)
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                i
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               if
                                                               
                                                            
                                                            Δ
                                                            
                                                               
                                                                  X
                                                                  ^
                                                               
                                                               i
                                                            
                                                            >
                                                            
                                                               α
                                                               
                                                                  u
                                                                  p
                                                               
                                                            
                                                            
                                                               σ
                                                               ^
                                                            
                                                            
                                                               
                                                                  Δ
                                                                  t
                                                               
                                                            
                                                            
                                                            
                                                               
                                                               or
                                                               
                                                            
                                                            
                                                            Δ
                                                            
                                                               
                                                                  X
                                                                  ^
                                                               
                                                               i
                                                            
                                                            <
                                                            
                                                               α
                                                               
                                                                  l
                                                                  o
                                                                  w
                                                               
                                                            
                                                            
                                                               σ
                                                               ^
                                                            
                                                            
                                                               
                                                                  Δ
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Criterion (7.5) allows us to separate out the downward jumps and the upward jumps. From an investment risk management perspective, we may be more concerned with downward as opposed to upward jumps.

Define

                           
                              (7.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                1
                                                i
                                             
                                             =
                                             
                                                N
                                                
                                                   j
                                                   p
                                                   s
                                                
                                             
                                             ;
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   1
                                                   i
                                                
                                                )
                                             
                                             =
                                             
                                                N
                                                
                                                   g
                                                   b
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Njps
                         is the number of jumps detected, and Ngbm
                         is the number of GBM increments. Our estimate of the volatility is then

                           
                              (7.7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                   ^
                                                
                                                2
                                             
                                             =
                                             
                                                1
                                                
                                                   Δ
                                                   t
                                                
                                             
                                             v
                                             a
                                             r
                                             
                                                (
                                                
                                                   {
                                                   Δ
                                                   
                                                      
                                                         X
                                                         ^
                                                      
                                                      i
                                                   
                                                   |
                                                   
                                                      1
                                                      i
                                                   
                                                   =
                                                   0
                                                   }
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that Eqs. (7.5)–(7.7) constitute an implicit equation for 
                           
                              
                                 σ
                                 ^
                              
                              ,
                           
                         which must be solved by an iterative method (Clewlow & Strickland, 2000). Once we have an estimate for the Brownian motion volatility 
                           
                              
                                 σ
                                 ^
                              
                              ,
                           
                         we can estimate the jump parameters, the jump intensity λ, the mean jump size ν and the jump size standard deviation ζ using the method suggested by Tauchen and Zhou (2011), assuming only one jump occurs in 
                           
                              [
                              
                                 t
                                 i
                              
                              ,
                              
                                 t
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           
                        
                        
                           
                              (7.8)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             λ
                                             =
                                             
                                                
                                                   N
                                                   
                                                      j
                                                      p
                                                      s
                                                   
                                                
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ν
                                             =
                                             m
                                             e
                                             a
                                             n
                                             (
                                             
                                                {
                                                Δ
                                                
                                                   
                                                      X
                                                      ^
                                                   
                                                   i
                                                
                                                |
                                                
                                                   1
                                                   i
                                                
                                                =
                                                1
                                                }
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                ζ
                                                2
                                             
                                             =
                                             v
                                             a
                                             r
                                             
                                                (
                                                
                                                   {
                                                   Δ
                                                   
                                                      
                                                         X
                                                         ^
                                                      
                                                      i
                                                   
                                                   |
                                                   
                                                      1
                                                      i
                                                   
                                                   =
                                                   1
                                                   }
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Once we fix the estimates for σ, λ, ν, ζ, we estimate the drift term μ in two ways. The simplest method is to note that, from Eq. (2.2) we have (
                           
                              X
                              =
                              log
                              S
                           
                        )

                           
                              (7.9)
                              
                                 
                                    
                                       
                                          
                                             d
                                             X
                                             =
                                             
                                                (
                                                μ
                                                −
                                                λ
                                                κ
                                                −
                                                
                                                   
                                                      σ
                                                      2
                                                   
                                                   2
                                                
                                                )
                                             
                                             d
                                             t
                                             +
                                             σ
                                             
                                             d
                                             Z
                                             +
                                             d
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      π
                                                      t
                                                   
                                                
                                                log
                                                
                                                   ξ
                                                   i
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Taking expectations of both sides of Eq. (7.9), and assuming only one jump takes place in 
                           
                              [
                              t
                              ,
                              t
                              +
                              d
                              t
                              ]
                           
                         gives

                           
                              (7.10)
                              
                                 
                                    
                                       
                                          
                                             E
                                             [
                                             d
                                             
                                                X
                                                ]
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                μ
                                                −
                                                λ
                                                κ
                                                −
                                                
                                                   
                                                      σ
                                                      2
                                                   
                                                   2
                                                
                                                )
                                             
                                             d
                                             t
                                             +
                                             λ
                                             E
                                             
                                                [
                                                log
                                                ξ
                                                ]
                                             
                                             d
                                             t
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Writing Eq. (7.10) in discrete time, gives (
                           
                              κ
                              =
                              exp
                              (
                              ν
                              +
                              
                                 ζ
                                 2
                              
                              /
                              2
                              )
                              −
                              1
                           
                        )

                           
                              (7.11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                   e
                                                   a
                                                   n
                                                   (
                                                   
                                                      {
                                                      Δ
                                                      
                                                         X
                                                         i
                                                      
                                                      }
                                                   
                                                   )
                                                
                                                
                                                   Δ
                                                   t
                                                
                                             
                                             =
                                             
                                                (
                                                μ
                                                −
                                                λ
                                                κ
                                                −
                                                
                                                   
                                                      σ
                                                      2
                                                   
                                                   2
                                                
                                                )
                                             
                                             +
                                             λ
                                             ν
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             Δ
                                             
                                                X
                                                i
                                             
                                             =
                                             log
                                             
                                                (
                                                
                                                   S
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             −
                                             log
                                             
                                                (
                                                
                                                   S
                                                   i
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Alternatively, we can determine an estimate for the drift rate μ using maximum likelihood (MLE) (Honore, 1998). Let 
                           
                              
                                 f
                                 N
                              
                              
                                 (
                                 x
                                 ;
                                 M
                                 ,
                                 
                                    V
                                    2
                                 
                                 )
                              
                           
                         be the normal density function with mean 
                           M
                         and variance 
                           
                              
                                 V
                                 2
                              
                              ,
                           
                         evaluated at point x. The density function for the log return ΔX is then (assuming only one jump occurs in 
                           
                              [
                              
                                 t
                                 i
                              
                              ,
                              
                                 t
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           
                        )

                           
                              (7.12)
                              
                                 
                                    
                                       
                                          
                                             P
                                             (
                                             Δ
                                             X
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                Δ
                                                t
                                                )
                                             
                                             
                                                f
                                                N
                                             
                                             
                                                (
                                                Δ
                                                X
                                                ;
                                                
                                                   (
                                                   μ
                                                   −
                                                   λ
                                                   κ
                                                   −
                                                   
                                                      σ
                                                      2
                                                   
                                                   /
                                                   2
                                                   )
                                                
                                                Δ
                                                t
                                                ,
                                                
                                                   σ
                                                   2
                                                
                                                Δ
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             λ
                                             Δ
                                             t
                                             
                                                f
                                                N
                                             
                                             
                                                (
                                                Δ
                                                X
                                                ;
                                                
                                                   (
                                                   μ
                                                   −
                                                   λ
                                                   κ
                                                   −
                                                   
                                                      σ
                                                      2
                                                   
                                                   /
                                                   2
                                                   )
                                                
                                                Δ
                                                t
                                                +
                                                ν
                                                ,
                                                
                                                   σ
                                                   2
                                                
                                                Δ
                                                t
                                                +
                                                
                                                   ζ
                                                   2
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Assuming σ, λ, ν, ζ are known, the MLE estimate for μ is determined from

                           
                              (7.13)
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                                μ
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   i
                                                
                                                log
                                                P
                                                
                                                   (
                                                   Δ
                                                   
                                                      X
                                                      i
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We will use both methods in the following.


                        Table 7.3
                         shows the estimates for the jump diffusion parameters using various values of the cutoff thresholds αlow, αhigh
                        . We can see from this table that as we increase |α|, we find smaller jump intensities with an increasing estimate for the Brownian volatility. In other words, the smaller more frequent jumps are now considered to be modeled by a diffusion process. We can also see that use of a one sided downward jump detection threshold has larger, more infrequent jumps, as expected. From an investment perspective, we are mainly concerned with the downward jumps, since upward jumps are a pleasant surprise. Both maximum likelihood (MLE, as in Eq. (7.13)) and the expected value (EVal, as in Eq. (7.11) give consistent estimates of the drift rate μ.


                        Fig. 7.2
                         shows a zoom of the right hand plot in Fig. 7.1, the daily return CRSP index (1925–2015). As before, we have scaled the plot to have unit standard deviation and zero mean. The standard normal density is also shown. Now that we have a higher sampling frequency, the large jumps are much smaller in (relative) numbers, with a much wider range of jump sizes, in terms of standard deviations, compared to the monthly series. As we expect, our criteria for a jump has to become stricter compared to the monthly return series, otherwise we detect a very large number of (relatively) small jumps. It becomes more difficult now to separate the jumps from the diffusion increments. In fact, it is perhaps more desirable, for the long term investor, to use a coarser sampling (i.e. monthly) since in this case it is easy to differentiate the significant jumps. We can see from these plots, that in some sense, our idea of a jump for a long term investor, depends on the time scale of interest.

In Table 7.4
                        , we show the results for the CRSP index, daily log  returns. In this case, the MLE estimate for the drift rate μ and the expected value estimates differ considerably for strict jump threshold detection parameters. At all values of jump cutoff parameters, the jumps appear to occur with a high frequency compared to the monthly observations.

We can see from Section 7 that the estimated parameters which model the SDE of a market index depend on several tuning parameters. We choose three possible sets of parameters, and we will compute the mean-variance results for each set.

We select the following cases:
                        
                           •
                           Pure-diffusion model (GBM), i.e. 
                                 
                                    λ
                                    =
                                    0
                                 
                               in Eq. (2.2). Parameters obtained from daily log  returns, Table 7.1.

Jump-diffusion with parameters obtained from daily log  returns. This is the case 
                                 
                                    
                                       α
                                       
                                          l
                                          o
                                          w
                                       
                                    
                                    =
                                    −
                                    5
                                    ,
                                 
                               and 
                                 
                                    
                                       α
                                       
                                          u
                                          p
                                       
                                    
                                    =
                                    +
                                    5
                                    ,
                                 
                               from Table 7.4. μ estimated using Eq. (7.11).

Jump-diffusion with parameters obtained from monthlylog  returns. This is the case 
                                 
                                    
                                       α
                                       
                                          l
                                          o
                                          w
                                       
                                    
                                    =
                                    −
                                    4
                                    ,
                                 
                              
                              
                                 
                                    
                                       α
                                       
                                          u
                                          p
                                       
                                    
                                    =
                                    +
                                    ∞
                                    ,
                                 
                               in Table 7.3. μ estimated using Eq. (7.11).

In all cases, we use the one year T-bill rate from Table 7.2. Note that the drift rates estimated from Eq. (7.11) are always lower than the drift rates obtained using MLE (maximum likelihood), hence we use these more conservative estimates. The parameters for the representative cases are summarized in Table 8.1
                     . Note that the drift rates and volatilities are not too different for all cases, however the jump parameters are quite different for the jump diffusion cases. Since the jump parameters are difficult to estimate, we can examine the effect of differing estimates on the investment results.

In this test, we use 
                           
                              T
                              =
                              30
                           
                         (years), 360 timesteps, and the same numbers of S and B nodes as for refinement 2 in Table 6.1. In Fig. 8.1
                        , we present efficient frontiers obtained from three sets of parameters in Table 8.1. In all cases we use the semi-self-financing strategy. We do not include the free cash. We observe from Fig. 8.1 that the efficient frontiers obtained from the three sets of parameters are essentially the same.

As a further check on our results, we carry out the following tests. We assume that, for each set of parameters in Table 8.1, the real world dynamics for S follows the corresponding stochastic differential equations. We then we use the PDE method, described earlier, to find the optimal semi-self-financing strategy strategies for a given value of γ. These controls are stored for each discrete state value and timestep. We then carry out Monte-Carlo (MC) simulations from 
                           
                              t
                              =
                              0
                           
                         to 
                           
                              t
                              =
                              T
                           
                         following these stored PDE-computed optimal strategies. Finally, we compare the MC-computed means and variances with the PDE-computed counterparts. In Table 8.2
                        , as an illustrative example, we present MC-computed means and standard deviations for the three cases when 
                           
                              γ
                              =
                              1510
                           
                        . We observe that the MC-computed means and standard deviations of the three cases agree with each other, and with the PDE-computed results, and that we obtain very similar mean and variance for each case.

To study the method’s robustness with respect to parameter estimation ambiguity, we proceed as follows. First, using the PDE method, we compute and store the optimal strategies under a specific model assumption, for example, when the risky asset follows a pure-diffusion (GBM) model. We then carry out MC simulations for the portfolio from 
                           
                              t
                              =
                              0
                           
                         to 
                           
                              t
                              =
                              T
                           
                         following these stored PDE-computed optimal strategies, but assuming the real world’s dynamics of the risky asset follow a different model, for example jump-diffusion (daily). We then compare the MC-computed mean and variance for each pair of real world model and strategy computing model. In other words, we assume that the real world follows a jump diffusion process, but the investor assumes that the process is a GBM, and computes the optimal strategy based on GBM parameter estimates. This, then, is a test of strategy robustness in the face of model parameter estimation ambiguity.


                        Table 8.3
                         shows the results for all combinations of representative test cases.


                        Table 8.3 demonstrates that the strategy appears to be insensitive to model parameter estimation errors, which is, of course, a very desirable result. We should also mention that a test of model robustness for the case of a stochastic volatility model compared to GBM, also shows that the semi-self-financing MV GBM strategy produces excellent results compared with the true stochastic volatility strategy (Ma & Forsyth, 2015).

@&#CONCLUSIONS@&#

In this paper, we generalize the idea of semi-self-financing strategies developed in Cui and Li (2010), Cui et al. (2012), and Ehrbar (1990) for the MV optimal portfolio allocation problem, which can be re-formulated as an embedded MV optimization problem (Li & Ng, 2000; Zhou & Li, 2000) in terms of the numerical solution of an HJB equation. Under this fully numerical approach, it is straightforward to determine an MV embedded optimal strategy over all possible semi-self-financing strategies, in a very general setting, namely continuous or discrete re-balancing, jump-diffusions with finite activity, and realistic portfolio constraints. If the portfolio wealth is above a critical threshold, then we prove that a scalarization MV optimal strategy is (i) to withdraw wealth exceeding this threshold, and (ii) to invest the remaining wealth in the risk-free asset for the remainder of the investment horizon.

In certain cases, we can prove that an optimal scalarization MV strategy is to not withdraw cash if the portfolio wealth is below the critical threshold. However, it remains an open question as to whether or not this is true in general for the case of jump-diffusions and discrete re-balancing. Nonetheless, we always observe that it is non-optimal to withdraw below the threshold in all of our numerical experiments.

We show that, in general, embedded MV optimal semi-self-financing strategies are not unique. However, in case of non-uniqueness, all embedded MV optimal semi-self-financing strategies produce the same embedded MV points. Using the results of Dang et al. (2015) and Tse et al. (2014), we show that all of these strategies generate the same set of points on the MV efficient frontier. Moreover, semi-self-financing strategies have the ability to produce a free cash flow during the investment, and can never be inferior, in terms of MV efficiency, to a self-financing strategy.

We have carried out an empirical data analysis using historical long term market returns. We obtain estimates for a GBM model, as well as estimates for jump diffusion models. Jump diffusion models are probably the simplest models which account for the observed fat tails of market returns. Based on several representative test cases, we find that the semi-self-financing pre-commitment mean-variance strategies are robust to model parameter estimation errors.

We present a characterization of the main property of the embedding technique given in Li and Ng (2000) and Zhou and Li (2000) in terms of the achievable objective set. This main property is summarized in Theorem 2.1. We follow along the lines of Li and Ng (2000) and Zhou and Li (2000) to prove this result, although we use slightly different steps. We include this proof to illustrate the generality of the embedding result, i.e. it is essentially independent of the specification of the admissible set for the control c(·).

                        Proof
                        Assume to the contrary that (2.13) does not hold. Then,

                              
                                 (A.1)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   inf
                                                   
                                                      (
                                                      V
                                                      ,
                                                      E
                                                      )
                                                      ∈
                                                      Y
                                                   
                                                
                                                V
                                                +
                                                
                                                   E
                                                   2
                                                
                                                −
                                                γ
                                                E
                                                <
                                                
                                                   V
                                                   0
                                                
                                                +
                                                
                                                   E
                                                   0
                                                   2
                                                
                                                −
                                                γ
                                                
                                                   E
                                                   0
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then there exists 
                              
                                 (
                                 
                                    V
                                    *
                                 
                                 ,
                                 
                                    E
                                    *
                                 
                                 )
                                 ∈
                                 Y
                              
                            such that

                              
                                 (A.2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   *
                                                
                                                +
                                                
                                                   E
                                                   *
                                                   2
                                                
                                                −
                                                γ
                                                
                                                   E
                                                   *
                                                
                                                <
                                                
                                                   V
                                                   0
                                                
                                                +
                                                
                                                   E
                                                   0
                                                   2
                                                
                                                −
                                                γ
                                                
                                                   E
                                                   0
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Rearranging Eq. (A.2) and multiplying by ρ > 0 gives

                              
                                 (A.3)
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   (
                                                   
                                                      V
                                                      *
                                                   
                                                   +
                                                   
                                                      E
                                                      *
                                                      2
                                                   
                                                   )
                                                
                                                −
                                                ρ
                                                
                                                   (
                                                   
                                                      V
                                                      0
                                                   
                                                   +
                                                   
                                                      E
                                                      0
                                                      2
                                                   
                                                   )
                                                
                                                −
                                                γ
                                                ρ
                                                
                                                   (
                                                   
                                                      E
                                                      *
                                                   
                                                   −
                                                   
                                                      E
                                                      0
                                                   
                                                   )
                                                
                                                <
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Substitute Eq. (2.14) into Eq. (A.3) to obtain

                              
                                 (A.4)
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   (
                                                   
                                                      V
                                                      *
                                                   
                                                   +
                                                   
                                                      E
                                                      *
                                                      2
                                                   
                                                   )
                                                
                                                −
                                                ρ
                                                
                                                   (
                                                   
                                                      V
                                                      0
                                                   
                                                   +
                                                   
                                                      E
                                                      0
                                                      2
                                                   
                                                   )
                                                
                                                
                                                −
                                                
                                                   (
                                                   1
                                                   +
                                                   2
                                                   ρ
                                                   
                                                      E
                                                      0
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      E
                                                      *
                                                   
                                                   −
                                                   
                                                      E
                                                      0
                                                   
                                                   )
                                                
                                                <
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Further manipulation gives

                              
                                 (A.5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   ρ
                                                   
                                                      V
                                                      *
                                                   
                                                   −
                                                   
                                                      E
                                                      *
                                                   
                                                   )
                                                
                                                −
                                                
                                                   (
                                                   ρ
                                                   
                                                      V
                                                      0
                                                   
                                                   −
                                                   
                                                      E
                                                      0
                                                   
                                                   )
                                                
                                                +
                                                ρ
                                                
                                                   (
                                                   
                                                      E
                                                      *
                                                      2
                                                   
                                                   −
                                                   
                                                      E
                                                      0
                                                      2
                                                   
                                                   −
                                                   2
                                                   
                                                      E
                                                      0
                                                   
                                                   
                                                      E
                                                      *
                                                   
                                                   +
                                                   2
                                                   
                                                      E
                                                      0
                                                      2
                                                   
                                                   )
                                                
                                                <
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 (A.6)
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   V
                                                   *
                                                
                                                −
                                                
                                                   E
                                                   *
                                                
                                             
                                          
                                          
                                             <
                                          
                                          
                                             
                                                ρ
                                                
                                                   V
                                                   0
                                                
                                                −
                                                
                                                   E
                                                   0
                                                
                                                −
                                                ρ
                                                
                                                   
                                                      (
                                                      
                                                         E
                                                         *
                                                      
                                                      −
                                                      
                                                         E
                                                         0
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and hence

                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   V
                                                   *
                                                
                                                −
                                                
                                                   E
                                                   *
                                                
                                                <
                                                ρ
                                                
                                                   V
                                                   0
                                                
                                                −
                                                
                                                   E
                                                   0
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           which contradicts Eq. (2.12). Hence (2.13) holds.□

Finally, we note that the embedded objective function can be written as

                        
                           (A.7)
                           
                              
                                 
                                    
                                       
                                          V
                                          +
                                          
                                             E
                                             2
                                          
                                          −
                                          γ
                                          E
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             E
                                             
                                                c
                                                (
                                                ·
                                                )
                                             
                                             
                                                
                                                   x
                                                   0
                                                
                                                ,
                                                
                                                   t
                                                   0
                                                
                                             
                                          
                                          
                                             [
                                             
                                                W
                                                c
                                             
                                             
                                                
                                                   (
                                                   T
                                                   )
                                                
                                                2
                                             
                                             ]
                                          
                                          −
                                          
                                             
                                                (
                                                
                                                   E
                                                   
                                                      c
                                                      (
                                                      ·
                                                      )
                                                   
                                                   
                                                      
                                                         x
                                                         0
                                                      
                                                      ,
                                                      
                                                         t
                                                         0
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      W
                                                      c
                                                   
                                                   
                                                      (
                                                      T
                                                      )
                                                   
                                                   ]
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             
                                                (
                                                
                                                   E
                                                   
                                                      c
                                                      (
                                                      ·
                                                      )
                                                   
                                                   
                                                      
                                                         x
                                                         0
                                                      
                                                      ,
                                                      
                                                         t
                                                         0
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      W
                                                      c
                                                   
                                                   
                                                      (
                                                      T
                                                      )
                                                   
                                                   ]
                                                
                                                )
                                             
                                             2
                                          
                                          −
                                          γ
                                          
                                             E
                                             
                                                c
                                                (
                                                ·
                                                )
                                             
                                             
                                                
                                                   x
                                                   0
                                                
                                                ,
                                                
                                                   t
                                                   0
                                                
                                             
                                          
                                          
                                             [
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                T
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             E
                                             
                                                c
                                                (
                                                ·
                                                )
                                             
                                             
                                                
                                                   x
                                                   0
                                                
                                                ,
                                                
                                                   t
                                                   0
                                                
                                             
                                          
                                          
                                             [
                                             
                                                W
                                                c
                                             
                                             
                                                
                                                   (
                                                   T
                                                   )
                                                
                                                2
                                             
                                             −
                                             γ
                                             
                                                W
                                                c
                                             
                                             
                                                (
                                                T
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             E
                                             
                                                c
                                                (
                                                ·
                                                )
                                             
                                             
                                                
                                                   x
                                                   0
                                                
                                                ,
                                                
                                                   t
                                                   0
                                                
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      W
                                                      c
                                                   
                                                   
                                                      (
                                                      T
                                                      )
                                                   
                                                   −
                                                   γ
                                                   /
                                                   2
                                                   )
                                                
                                                2
                                             
                                             ]
                                          
                                          −
                                          
                                             
                                                (
                                                γ
                                                /
                                                2
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

So minimizing the above embedded objective function is equivalent to (2.15).

In this section, we briefly describe the HJB PIDEs for the case of continuous re-balancing and jump-diffusions. For brevity, we omit the PIDEs for the case of discrete re-balancing which can be found in Dang et al. (2015). For the case of continuous re-balancing with jump-diffusions, the MV optimal portfolio allocation problem can be formulated as the solution to a 2-dimensional (2-D) impulse control problem, in the form of a non-linear HJB PIDE. This approach is suggested in Dang and Forsyth (2014). We refer the reader to Dang and Forsyth (2014) for a complete discussion of the formulation. We define the solution domain as

                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          Ω
                                          =
                                          {
                                          (
                                          s
                                          ,
                                          b
                                          ,
                                          t
                                          )
                                          ∈
                                          [
                                          0
                                          ,
                                          ∞
                                          )
                                          ×
                                          (
                                          −
                                          ∞
                                          ,
                                          +
                                          ∞
                                          )
                                          ×
                                          [
                                          0
                                          ,
                                          T
                                          ]
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We define the solvency region, denoted by 
                        
                           S
                           ,
                        
                      as

                        
                           (B.2)
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             ∞
                                             )
                                          
                                          ×
                                          
                                             (
                                             −
                                             ∞
                                             ,
                                             +
                                             ∞
                                             )
                                          
                                          :
                                          
                                             W
                                             c
                                          
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          >
                                          0
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and the bankruptcy (insolvency) region 
                        
                           B
                           =
                           Ω
                           ∖
                           S
                        
                     . Let 
                        
                           Q
                           =
                           {
                           
                              (
                              s
                              ,
                              b
                              )
                           
                           ∈
                           S
                           :
                           s
                           /
                           
                              (
                              s
                              +
                              b
                              )
                           
                           >
                           
                              q
                              
                                 m
                                 a
                                 x
                              
                           
                           }
                        
                      be the region where the leverage constraint is violated. We respectively denote by 
                        
                           L
                           V
                        
                      and 
                        
                           J
                           V
                        
                      the diffusion and jump operators, where

                        
                           (B.3)
                           
                              
                                 
                                    
                                       
                                          L
                                          V
                                       
                                    
                                    
                                       ≡
                                    
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   s
                                                   2
                                                
                                             
                                             2
                                          
                                          
                                             V
                                             
                                                s
                                                s
                                             
                                          
                                          +
                                          
                                             (
                                             μ
                                             −
                                             λ
                                             κ
                                             )
                                          
                                          s
                                          
                                             V
                                             s
                                          
                                          +
                                          r
                                          b
                                          
                                             V
                                             b
                                          
                                          −
                                          λ
                                          V
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          J
                                          V
                                       
                                    
                                    
                                       ≡
                                    
                                    
                                       
                                          
                                             ∫
                                             0
                                             ∞
                                          
                                          p
                                          
                                             (
                                             ξ
                                             )
                                          
                                          V
                                          
                                             (
                                             ξ
                                             s
                                             ,
                                             b
                                             ,
                                             τ
                                             )
                                          
                                          
                                          d
                                          ξ
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Following standard arguments (Øksendal & Sulem, 2009; Pham, 2009), the value function V(s, b, t) is the viscosity solution of the HJB PIDE

                        
                           (B.5)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          max
                                          [
                                          
                                             V
                                             t
                                          
                                          
                                          +
                                          
                                          L
                                          V
                                          
                                          +
                                          
                                          J
                                          V
                                          ,
                                          V
                                          
                                          −
                                          
                                          
                                             inf
                                             
                                                c
                                                ∈
                                                Z
                                             
                                          
                                          
                                             (
                                             M
                                             
                                                (
                                                c
                                                )
                                             
                                             
                                             V
                                             )
                                          
                                          ]
                                          
                                          =
                                          
                                          0
                                          ;
                                          
                                          
                                          
                                          
                                          
                                          
                                             
                                             if
                                             
                                          
                                          
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          ∈
                                          S
                                          ∖
                                          Q
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.6)
                           
                              
                                 
                                    
                                       
                                          max
                                          [
                                          
                                             V
                                             t
                                          
                                          +
                                          r
                                          b
                                          
                                             V
                                             b
                                          
                                          ,
                                          V
                                          −
                                          
                                             inf
                                             
                                                c
                                                ∈
                                                Z
                                             
                                          
                                          
                                             (
                                             M
                                             
                                                (
                                                c
                                                )
                                             
                                             
                                             V
                                             )
                                          
                                          ]
                                          =
                                          0
                                          ;
                                          
                                          
                                             
                                             if
                                             
                                          
                                          
                                          s
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.7)
                           
                              
                                 
                                    
                                       
                                          V
                                          −
                                          
                                             inf
                                             
                                                c
                                                ∈
                                                Z
                                             
                                          
                                          
                                             (
                                             M
                                             
                                                (
                                                c
                                                )
                                             
                                             
                                             V
                                             )
                                          
                                          =
                                          0
                                          ;
                                          
                                          
                                             
                                             if
                                             
                                          
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          ∈
                                          Q
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.8)
                           
                              
                                 
                                    
                                       
                                          V
                                          
                                             (
                                             s
                                             ,
                                             b
                                             ,
                                             t
                                             )
                                          
                                          =
                                          V
                                          (
                                          0
                                          ,
                                          
                                             W
                                             c
                                          
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          ,
                                          t
                                          )
                                          ;
                                          
                                          
                                             
                                             if
                                             
                                          
                                          
                                          
                                             (
                                             s
                                             ,
                                             b
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.9)
                           
                              
                                 
                                    
                                       
                                          V
                                          
                                             (
                                             s
                                             ,
                                             b
                                             ,
                                             T
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            s
                                                            +
                                                            b
                                                            −
                                                            γ
                                                            /
                                                            2
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         Z
                                                         =
                                                         
                                                            Z
                                                            
                                                               s
                                                               e
                                                               l
                                                               f
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            max
                                                            
                                                               (
                                                               γ
                                                               /
                                                               2
                                                               −
                                                               
                                                                  (
                                                                  s
                                                                  +
                                                                  b
                                                                  )
                                                               
                                                               ,
                                                               0
                                                               )
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         Z
                                                         =
                                                         
                                                            Z
                                                            
                                                               s
                                                               e
                                                               m
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     defined on the domain Ω. The intervention operator 
                        
                           M
                           (
                           c
                           )
                           V
                           (
                           s
                           ,
                           b
                           ,
                           t
                           )
                        
                      is defined as

                        
                           (B.10)
                           
                              
                                 
                                    
                                       
                                          M
                                          (
                                          c
                                          )
                                          
                                          V
                                          (
                                          s
                                          ,
                                          b
                                          ,
                                          t
                                          )
                                          =
                                          V
                                          (
                                          S
                                          (
                                          s
                                          ,
                                          b
                                          ,
                                          c
                                          )
                                          ,
                                          B
                                          ,
                                          t
                                          )
                                          +
                                          ϱ
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Here, ϱ > 0 is an arbitrarily small switching cost required to ensure that the impulse control HJB PIDE problem is well-posed, the control c ≡ (d, B) is defined in (2.3), and S(s, b, c) is defined in (2.4).

For computational purposes, we localize the original domain to

                        
                           (B.11)
                           
                              
                                 
                                    
                                       
                                          
                                             Ω
                                             
                                                l
                                                o
                                                c
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                (
                                                s
                                                ,
                                                b
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                
                                                   s
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                                )
                                             
                                             ×
                                             
                                                [
                                                −
                                                
                                                   b
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   b
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                                ]
                                             
                                             ×
                                             
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where smax
                      and bmax
                      are positive and sufficiently large. We assume that the boundary conditions at smax
                     , 
                        
                           −
                           
                              b
                              
                                 m
                                 a
                                 x
                              
                           
                           ,
                        
                      and bmax
                      used in this paper are the asymptotic forms of the HJB PDE/PIDE as s, |b| → ∞ (Dang & Forsyth, 2014).

@&#REFERENCES@&#

