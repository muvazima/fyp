@&#MAIN-TITLE@&#Combined scheduling and capacity planning of electricity-based ammonia production to integrate renewable energies

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Scheduling and capacity planning of an innovative, flexible ammonia process.


                        
                        
                           
                           Physical and chemical characteristics require non-linear modeling.


                        
                        
                           
                           We use convex non-linear programming to combine scheduling and capacity planning.


                        
                        
                           
                           We demonstrate the working principle using hourly market electricity prices.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Non-linear programming

Heuristics

Hydrogen storage

Ammonia

@&#ABSTRACT@&#


               
               
                  Economic assessment of energy-related processes needs to adapt to the development of large-scale integration of renewable energies into the energy system. Flexible electrochemical processes, such as the electrolysis of water to produce hydrogen, are foreseen as cornerstones to renewable energy systems. These types of technologies require the current methods of energy storage scheduling and capacity planning to incorporate their distinct non-linear characteristics in order to be able to fully assess their economic impact. A combined scheduling and capacity planning model for an innovative, flexible electricity-to-hydrogen-to-ammonia plant is derived in this paper. A heuristic is presented, which is able to translate the depicted, non-convex and mixed-integer problem into a set of convex and continuous non-linear problems. These can be solved with commercially available solvers. The global optimum of the original problem is encircled by the heuristic, and, as the numerical illustration with German electricity market data of 2013 shows, can be narrowed down and approximated very well. The results show, that it is not only meaningfulness, but also feasible to solve a combined scheduling and capacity problem on a convex non-linear basis for this and similar new process concepts. Application to other hydrogen based concepts is straightforward and to other, non-linear chemical processes generally possible.
               
            

@&#INTRODUCTION@&#

Integrating intermittent electricity generation technologies requires new techniques and technologies, as well as the adaption of proven processes for emerging applications, to cope with the increased level of market flexibility and volatility. In addition, interdependencies between the electricity market and the markets of electricity consumers increase, such as between the electricity and the natural gas or the hydrogen market via electrolytic production of hydrogen (Marbán and Valdés-Solís, 2007; Barbir, 2009; Schüth, 2011; Azcarate, Blanco, Mallor, Garde, and Aguado, 2012).

R&D-needs range from technology issues to emerging markets and regulatory frameworks. Furthermore, the changing circumstances require currently used assessment techniques and evaluation approaches to adapt. An illustrative example for these new technology concepts can be observed at integrating hydrogen into the electricity market as electricity storage option (Rasmussen, Andresen, and Greiner, 2012) or as resource for the production of base chemicals such as methanol or ammonia (Benner, van Lieshout, and Croezen, 2012). The basic idea of these concepts is the use of volatile electricity production (identifiable through price signals or availability) for an intermittent production of hydrogen, and in a possible second step to hydrogen-rich chemicals. Capacity planning and scheduling methods for these processes need to consider the characteristics of the conversion of electricity to hydrogen, for example its load dependent efficiency.

In energy economics, scheduling problems are well known and widely used to analyze power plant scheduling with mixed-integer linear programming under volatile electricity prices. For an overview, see for example Gatzen (2008),Connolly, Lund, Mathiesen, and Leahy (2010) or Möst and Keles (2010). However, chemical processes usually feature distinct load-dependent (and therefore non-linear) consumption and efficiency characteristics, which need to be modeled in order to be able to assess the full potential of these technologies. This paper focuses on explicitly integrating the occurring non-linear operation characteristics into a combined scheduling and capacity planning model.


We will analyze the details of an exemplary hydrogen-based process, the production of ammonia from hydrogen produced in water electrolyzers. This is a new and innovative process concept, which intends to use cheap electricity to produce hydrogen in a first step, buffers hydrogen in a second step and produces ammonia in a third consecutive step (Schulte Beerbühl, Kolbe, Roosen, and Schultmann, 2014). Intermediate buffering decouples the price-signal driven scheduling decisions of individual subunits and introduces the choice of subunit capacity as a new degree of freedom. As both scheduling and subunit capacity planning are clearly linked, a combined approach—combined scheduling and capacity planning—is required.

The difference between this concept and the production of methane, methanol or other fuels and chemicals on the basis of hydrogen is solely at the last stage. The underlying challenge of non-linear, i. e. load dependent efficiencies remain. The general principle of ammonia production from electricity is well known and established for decades by using electricity from steadily operated hydro power plants (Grundt and Christiansen, 1982). The use of flexible water electrolyzers for absorbing solar- or wind-generated electricity is widely analyzed as well (Miland, Glöckner, Taylor, Jarle Aaberg, and Hagen, 2006; Clarke, Giddey, Ciacchi, Badwal, Paul, and Andrews, 2009; Millet, Dragoe, Grigoriev, Fateev, and Etievant, 2009). The combination of both, however, is new. Necessary technical adaptions to the ammonia production technology are described in Schulte Beerbühl et al. (2014), which enable the ammonia process to be flexible enough to follow an intermittently operated electrolysis, as it is foreseen in this paper.

In order to identify the challenges with this innovative technology and to present our approach to solve these, this paper is organized as follows: Section 2 introduces the new process concept and their modeling challenges. In Section 3 a general scheduling and capacity planning model with intermediate buffering is formulated, at which the modeling challenges as well as the literature approach to tackle these and similar challenges is discussed. Section 4 presents the electricity-to-hydrogen-to-ammonia model formulation on the basis of the general model. Herein, the process characteristics of the water electrolysis (Section 4.2), the intermediate buffer (Section 4.3) and the ammonia synthesis (Section 4.4) are derived in detail. However, as this section shows, load dependent characteristics will lead to a non-convex mixed-integer non-linear program, which is too big and too time-intensive to solve. Therefore, a heuristic procedure is developed in Section 5, which transforms the program into a set of convex and continuous non-linear programs. The described heuristic procedure is able to approach the global optimum of the original problem to a satisfying degree, as can be seen in the numerical example, which is presented in Section 6. Within this example, the effect of the heuristic is analyzed in detail (Section 6.2), as well as the importance of non-linear modeling (Sections 6.3 and 6.4). Conclusions with regard to the strengths, limitations and implications of this approach are drawn in Section 7.

The novel electricity-to-hydrogen-to-ammonia plant concept, which is subject of this paper, consists of three subunits, as depicted in Fig. 1
                        :

                           
                              •
                              A water electrolysis, which splits water into its elements hydrogen and oxygen by applying an electrical current. Cooling water is needed for removing developed heat.

An intermediate hydrogen buffer, which is realized as a gas buffer. Electricity and cooling water for compressor operation may be required at low buffer filling levels.

The ammonia synthesis, which converts hydrogen, together with nitrogen from air, into ammonia. Electricity and cooling water are required for process equipment operation.

Though both buffer and NH3-synthesis require electricity for operations, the water electrolysis is the main consumer (approximate 95 percent; Schulte Beerbühl et al. 2014). Cooling water consumption implies further electricity demand for pumping and air fan operation in the cooling water cycle, usually between 0.005 kilowatt hour and 0.03 kilowatt hour electricity per kilowatt hour cooling water. Technical details of the plant concept have been published in Schulte Beerbühl et al. (2014). For the scope of this paper, load dependent transformation functions, i. e. yields and specific consumption functions will be determined in Section 4.

Electro- and thermochemical processes usually feature non-linear efficiency characteristics due to chemical and physical effects (Penkuhn, Spengler, Püchert, and Rentz, 1997). In most cases, load-dependency functions comprise quadratic or exponential components. For example, Abbaspour, Satkin, Mohammadi-Ivatloo, Hoseinzadeh Lotfi, and Noorollahi (2013) use a quadratic expression to model operating costs during partial load. In addition, plant minimum loads can be limited due to economical reasons, so that plant schedulers need to choose, whether to temporarily switch off or to operate between minimum and full load.


Water electrolysis is somewhat different to thermal power plants, as specific consumption rates do not increase but decrease in partial load mode, so that efficiency rises for lower loads (LeRoy, Bowen, and LeRoy, 1980; Hamann, Hamnett, and Vielstich, 2007). Current best available technology in water electrolysis features a design full load consumption of 4.40 kilowatt hours per newton cubic meter H2 (efficiency of approximate 80 percent). As depicted in Fig. 2
                        (black line), specific consumption decreases with partial load toward the thermodynamic minimum of 3.54 kilowatt hours per newton cubic meter H2, which is the higher heating value (HHV) and represents an energetic efficiency of 100 percent (Manabe et al., 2013; Marini et al., 2012; Smolinka, Günter, and Garche, 2010). Efficiency increases toward, but never reaches 100 percent. Reasons for this development are exponential correlations between voltage losses and area-specific output (Hamann et al., 2007; LeRoy et al., 1980). In contrast to e. g. thermal power plants, it is technically possible and economically attractive to operate at very low loads, which are assumed to be as low as 5 percent of nominal output (Smolinka et al., 2010) for single elements (stacks). Large, multi-stack units can therefore operate at loads close to zero.

For scheduling optimization, however, integration of exponential functions lead to very complex models, so that these types of characteristics usually are simplified to constant (dashed line in Fig. 2) or linear load-dependencies (gray line), which lead to linear respectively quadratic hourly electricity consumption functions.

                           
                              Table 1
                              
                                 Declaration of units, abbreviations, parameters and variables.
                              
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       Chemical substances
                                    
                                 
                                 
                                    
                                       H
                                             
                                                
                                                2
                                             
                                          
                                       
                                       Hydrogen
                                       NH
                                             
                                                
                                                3
                                             
                                          
                                       
                                       Ammonia
                                    
                                    
                                       H
                                             
                                                
                                                2
                                             
                                          O
                                       Water
                                       O
                                             
                                                
                                                2
                                             
                                          
                                       
                                       Oxygen
                                    
                                    
                                       N
                                             
                                                
                                                2
                                             
                                          
                                       
                                       Nitrogen
                                       
                                       
                                    
                                    
                                       
                                    
                                    
                                       Units
                                    
                                    
                                       
                                    
                                    
                                       mol
                                       6.022 
                                             ×
                                           23
                                             
                                                
                                                23
                                             
                                           molecules
                                       norm cubic meters
                                       Volume of volume of 1 cubic meter
                                             
                                           at standard conditions (0 degree Celsius
                                             
                                           and ambient pressure) Metric tons (1000 kilograms)
                                    
                                    
                                       (k)Wh
                                       (10
                                             
                                                
                                                3
                                             
                                          ) watt-hours energy
                                       
                                       
                                    
                                    
                                       (M)W
                                       (10
                                             
                                                
                                                6
                                             
                                          ) watt electric capacity
                                       tons
                                       
                                    
                                    
                                       
                                    
                                    
                                       Abbreviations
                                    
                                    
                                       
                                    
                                    
                                       CAES
                                       Compressed Air Energy Storage
                                       (MI)(N)LP
                                       (Mixed-Integer) (Non-)Linear Programming
                                    
                                    
                                       compr
                                       Gas compressor
                                       MIQCP
                                       Mixed-Integer Quadratic Constraint Programming
                                    
                                    
                                       CW
                                       Cooling Water
                                       PHELIX
                                       Physical Electricity Index
                                    
                                    
                                       DP
                                       Dynamic Programming
                                       PHS
                                       Pumped Hydro Storage
                                    
                                    
                                       EEX
                                       European Energy Exchange
                                       PV
                                       Photovoltaic
                                    
                                    
                                       el
                                       Electricity
                                       PW
                                       Process Water
                                    
                                    
                                       ELY
                                       Electrolysis
                                       SQP
                                       Sequential Quadratic Programming
                                    
                                    
                                       HHV
                                       Higher Heating Value
                                       SYN
                                       Ammonia Synthesis
                                    
                                    
                                       IPOPT
                                       Interior Point Optimizer
                                       ST
                                       Buffer Storage
                                    
                                    
                                       
                                    
                                    
                                       Parameters
                                    
                                    
                                       
                                    
                                    
                                       
                                          
                                             
                                                c
                                                op,fix
                                             
                                          
                                       
                                       Operating fixed costs [euros p.a.]
                                       
                                          
                                             
                                                Inv
                                                k
                                             
                                          
                                       
                                       Specific investment of unit 
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   j
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       (Time-dependent) unit cost of input or output 
                                             j
                                           [euros per unit]
                                       Load
                                             
                                                
                                                
                                                   min
                                                   /
                                                   max
                                                
                                                k
                                             
                                          
                                       
                                       Minimum and maximum load [percent] of unit 
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   CW
                                                
                                                SYN
                                             
                                          
                                       
                                       Specific cooling water consumption of synthesis [kilowatt hours per newton cubic meter H
                                             
                                                
                                                2
                                             
                                           input]
                                       
                                          
                                             
                                                M
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                   O
                                                
                                             
                                          
                                       
                                       Molar mass of water [18 grams per mole]
                                    
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   j
                                                
                                                compr
                                             
                                          
                                       
                                       Spec. demand of compressor of input 
                                             j
                                           per newtons cubic meters per hour H
                                             
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                N
                                                A
                                             
                                          
                                       
                                       Avogardo constant (6.022 
                                             ×
                                           10
                                             
                                                
                                                23
                                             
                                          )
                                    
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   el
                                                   −
                                                   CW
                                                
                                             
                                          
                                       
                                       Conversion factor for cooling water consumption [kilowatt hours per kilowatt hours]
                                       
                                          p
                                          
                                             
                                                
                                                n
                                             
                                          
                                       
                                       Pressure at stage 
                                             
                                                n
                                                =
                                                1
                                                ,
                                             
                                           out, low, up [bars]
                                    
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                   −
                                                   
                                                      NH
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       NH
                                             
                                                
                                                3
                                             
                                           yield per H
                                             
                                                
                                                2
                                             
                                           input [tons per newton cubic meter H
                                             
                                                
                                                2
                                             
                                          ]
                                       
                                          
                                             t
                                          
                                       
                                       Time step [hours]
                                    
                                    
                                       HHV
                                             
                                                
                                                
                                                   H
                                                   2
                                                
                                             
                                          
                                       
                                       Higher heating value of hydrogen [3.54 kilowatt hours per newton cubic meter H
                                             
                                                
                                                2
                                             
                                          ]
                                       
                                          
                                             
                                                x
                                                
                                                   el,design
                                                
                                                ELY
                                             
                                          
                                       
                                       Electrolysis design full-load electricity consumption [kilowatt hours per newton cubic meter
                                             
                                           H
                                             
                                                
                                                2
                                             
                                          ]
                                    
                                    
                                       
                                          
                                             
                                                i
                                                CRF
                                             
                                          
                                       
                                       Capital recovery factor [percent]
                                       
                                          
                                             
                                                ϱ
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                   O
                                                
                                             
                                          
                                       
                                       Density of water [at standard conditions: 998 kilograms per cubic meter
                                             
                                          ]
                                    
                                    
                                       
                                    
                                    
                                       Variables
                                    
                                    
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                                
                                                   (
                                                   adj
                                                   )
                                                
                                                *
                                             
                                          
                                       
                                       (Adjusted) Maximum annuity [euros per annum]
                                    
                                    
                                       
                                          
                                             
                                                Cap
                                                k
                                             
                                          
                                       
                                       Capacity of units in megawatts (electrolysis), newtons cubic meters
                                             
                                           H
                                             
                                                
                                                2
                                             
                                           (buffer) and tons per hour NH
                                             
                                                
                                                3
                                             
                                           (synthesis)
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Load
                                                   k
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       Relative load of unit 
                                             k
                                           at time 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   
                                                      j
                                                   
                                                   k
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       Input or output of factor 
                                             j
                                           to/from unit 
                                             k
                                           at time 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   
                                                      j
                                                   
                                                   k
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       Specific input or output of factor 
                                             j
                                           per newton cubic meter
                                             
                                           H
                                             
                                                
                                                2
                                             
                                           to/from unit 
                                             k
                                           at time 
                                             t
                                          
                                       
                                    
                                    
                                       
                                    
                                    
                                       Indices
                                    
                                    
                                       
                                    
                                    
                                       
                                          j
                                       
                                       CW [cubic meters], el [kilowatt hours], NH
                                             
                                                
                                                3
                                             
                                           [tons], PW [cubic meters
                                             
                                          ]
                                       
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                compr
                                                ,
                                             
                                          
                                          
                                             
                                                ELY
                                                ,
                                             
                                          
                                          
                                             
                                                ST
                                                ,
                                             
                                          
                                          
                                             SYN
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Within this section, we will draft a general scheduling model (Section 3.1) and we will discuss related literature with regard to integrating load-dependent consumption functions. Herein, we focus upon the energy sector, for which a large variety of models have been developed for a multitude of purposes, for thermal power plants as well as for electricity storage technologies (Section 3.2). Though an electricity-to-hydrogen-to-ammonia plant does not produce electricity as an output, and is consequently not an electricity storage technology, objective and constraints are very similar.

Models for long-term analyses, such as forecasts until the year 2030 or 2050 are usually formulated as cost minimization problems, whereas short-term models and models for portfolio optimization feature a profit maximizing objective (Möst and Keles, 2010). The latter ones usually analyze individual plants, which are integrated into a large market and act as price-taker. Therefore, electricity prices are given as exogenous parameters and do not need to be determined endogenously (Garcia-Gonzalez, Parrilla, and Mateo, 2007; Fleten and Kristoffersen, 2008; Densing, 2013). Uncertainty of electricity prices can be incorporated by stochastic components (Wallace and Fleten, 2003; Parpas and Webster, 2014), limited information with regard to future price development can be incorporated by rolling horizons (Epe et al., 2009).

For the purpose of this paper, a short-term view and exogenously given electricity prices suits best. The general outline of the annuity maximizing objective (1) consists of subtracting input costs, the costs of annualized investment and operating fixed costs from annual revenue. Herein, the input and output flows X(t) are continuous decision variables.

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                             A
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                (
                                             
                                             
                                                c
                                                output
                                             
                                             
                                                X
                                                output
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                                input
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                X
                                                input
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                i
                                                CRF
                                             
                                             
                                                Inv
                                                plant
                                             
                                             
                                                Cap
                                                plant
                                             
                                             −
                                             
                                                c
                                                op,fix
                                             
                                             
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints cover the load constraint (2) and mass- respectively energy balancing (3), here defined for a system with an integrated buffer storage ST. If no intermediate buffer exists, both 
                           
                              
                                 X
                                 
                                    j
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 X
                                 
                                    j
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 −
                                 1
                                 )
                              
                           
                         are zero, so that input equals output for each time step t.

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             Load
                                             min
                                          
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             Load
                                             
                                                (
                                                t
                                                )
                                             
                                             ≤
                                             
                                                Load
                                                max
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   j
                                                
                                                ST
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                X
                                                
                                                   j
                                                   ,
                                                   input
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                X
                                                
                                                   j
                                                   ,
                                                   output
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             +
                                             
                                                X
                                                
                                                   j
                                                
                                                ST
                                             
                                             
                                                (
                                                t
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

An intermediate buffer enables to decouple the adjacent process units from each other, so that they are individually controllable and the system may reach a higher overall flexibility. Consequently, (2) has to be defined for each process unit k 
                        (4), in this case for the units electrolysis (k = ELY), buffer storage (k = ST) and NH3-synthesis (k = SYN), see Fig. 1.

                           
                              (4)
                              
                                 
                                    
                                       Load
                                       
                                          min
                                       
                                       k
                                    
                                    ≤
                                    
                                       Load
                                       k
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ≤
                                    
                                       Load
                                       
                                          max
                                       
                                       k
                                    
                                 
                              
                           
                        
                     

For electricity storage technologies, unit commitment constraints prevent storing and supplying electricity at the same time. This is not necessary at the analyzed electricity-to-hydrogen-to-ammonia plant, in which the storage medium H2 and its product NH3 can be produced at the same time.

Expenses for the initial plant investment (InvplantCapplant) are usually annualized, using the capital recovery factor i
                        CRF. If the plants capacity shall be optimized, i. e. endogenously determined, Capplant is a decision variable and Invplant is the specific investment per capacity unit. Load decoupling through intermediate buffer does not only allow individual load scheduling but also different optimal subsystem capacities, so that Cap has to be optimized for each subsystem k. This is typically observed at CAES plants as well, for which air compressor and gas turbine sizes differ (e. g. in Wolf, Kanngießer, Budt, and Doetsch 2012).

Work on optimization of storage scheduling and capacity planning can be divided into approaches using dynamic programming (DP) and (non-)linear optimization. The computational effort of dynamic programming rises exponentially with the number of possible discrete values a decision variable possesses. Therefore, DP models use special approaches to transform the originally continuous decision variables into a limited set of discrete ones (Bosman, Bakker, Molderink, Hurink, and Smit, 2012; Dias et al., 2013). DP models are often used for analyzing a large set of small reservoir hydro power plants (Korpaas, Holen, and Hildrum, 2003; Tina and Brunetto, 2010; Marano, Rizzo, and Tiano, 2012; Dias et al., 2013) or a fleet of small power plants (Bosman et al., 2012). Scheduling and capacity planning problems of one single plant, as outlined in (1), feature almost exclusively continuous decision variables, so that transformation into discrete variables would either result in a large step size at moderate computational effort or in a very high effort for a finer degree of step size and more accuracy.

(Non-) Linear optimization methods, on the other hand, can handle continuous decision variables and possess powerful commercial solvers for convex, linear and continuous problems. Computational effort increases for mixed-integer or non-linear problems and may prove to be inferior to DP approaches for mixed-integer non-linear (MINLP) and non-convex problems of e. g. scheduling for a set of hydro power plants (Korpaas et al., 2003; Tina and Brunetto, 2010; Marano et al., 2012; Dias et al., 2013). As a consequence, large (national to multinational) energy system models as well as short-term fleet scheduling models are mostly formulated as linearized problems (see Connolly et al. (2010) for an overview). The integration of binary variables for unit commitment as well as start-up costs leads to mixed-integer linear programs (MILP; Gatzen, 2008; Epe et al., 2009; Möst and Keles, 2010; Bosman et al., 2012; Densing, 2013). Shortcomings and problems of these types of models for combined short- and long-term analyses are described in Parpas and Webster (2014).

Non-linear characteristics, mostly load-dependent plant efficiencies (for fossil plants: fuel consumption, for hydro power: pump/turbine efficiency), are usually fully linearized (Korpaas et al., 2003; Garcia-Gonzalez et al., 2007; Wolf et al., 2012; Dias et al., 2013; Ferrer-Marti, Domenech, Garcia-Villoria, and Pastor, 2013), and sometimes piecewise linearized in smaller models (Epe et al., 2009; Mirzapour Al-e-hashem, Baboli, and Sazvar, 2013). Piecewise linearization can reflect the principle of load-dependency, but computational time considerably increases with the number of discrete steps (Mirzapour Al-e-hashem et al., 2013).


                        Abbaspour et al. (2013) have developed a MINLP (exactly: a mixed-integer quadratic constraint program MIQCP) using the SBB solver, in which the local plant model contains a quadratic cost function. The short time horizon (24 hours in 1 hour intervals) indicates the general problem of MINLP solvers for this type of scheduling problems: computational time increases exponentially with the number of time steps, leading to computational problems for time horizons of weeks or more at an hourly interval. Therefore, most models linearize the cost function respectively the conversion efficiency. With regard to pump storage, linearization usually results in minor inaccuracies (see Garcia-Gonzalez et al. 2007 for a three-step piecewise linearization).

Other storage or energy conversion technologies, especially technologies with electro- or thermochemical conversion processes, usually feature more distinctive load dependencies. This holds true for the electrolysis of water, as depicted in Fig. 2. Reducing the efficiency term to a constant, as did for example Rasmussen et al. (2012) to integrate the technology into large scale energy system models, leads to a high degree of inaccuracy and especially disregards the ability of these types of technologies to improve energetic and hence economic performance at partial loads. These characteristics are important when assessing the economic viability of a single plant, leading to the necessity of non-linear programming.

As soon as load-dependent variables are introduced, capacity needs to be fixed to allow piecewise linearization and therefore MILP formulation (Epe et al., 2009; Garcia-Gonzalez et al., 2007). Consequently, capacity analysis needs to be done by scenario runs (Wolf et al., 2012). This approach is acceptable for compressed air (CAES) or pumped hydro storage (PHS), in which the storage size is set by geological characteristics and possible compressor respectively pump and turbine size intervals are rather fixed. For hydrogen and other applications with storage in gas tanks or pipes, the degree of freedom is much higher, thereby requiring the capacities to be an endogenous decision variable to avoid very large numbers of scenario runs. With the capacity being a decision variable, unit loads are calculated by dividing a scheduling variable by a capacity variable. Therefore, we do not follow the route of linearization and capacity fixation, but will keep the non-linear aspects. We will illustrate this procedure in Section 4 at the described electricity-to-hydrogen-to-ammonia plant.

Within this section, we will describe the details of the optimization problem. Herein, Section 4.1 introduces the objective and the constraints without going into the plant specific details. This is done in Sections 4.2–4.4 for each of the subunits electrolysis, buffer and NH3-synthesis.

Cost-related process inputs are process (PW) and cooling water (CW) as well as electricity. Cooling water consumption is a function of electricity consumption. The overall process output is ammonia (NH3), so that the general objective function (1) translates into (5) for the electricity-to-hydrogen-to-ammonia process and the subunits k electrolysis (ELY), buffer storage (ST) and ammonia synthesis (SYN).

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             max
                                             A
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                c
                                                
                                                   NH
                                                   3
                                                
                                             
                                             
                                                X
                                                
                                                   NH
                                                   3
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                                el
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                X
                                                el
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                c
                                                PW
                                             
                                             
                                                X
                                                PW
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                                CW
                                             
                                             
                                                X
                                                CW
                                             
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                i
                                                CRF
                                             
                                             
                                                ∑
                                                k
                                             
                                             
                                                (
                                                
                                                   Inv
                                                   k
                                                
                                                
                                                   Cap
                                                   k
                                                
                                                )
                                             
                                             −
                                             
                                                c
                                                op,fix
                                             
                                             
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The unit load constraint (4) applies for all three subunits. Mass balancing and integration of the intermediate buffer is defined for the storage medium (H2), so that (3) translates into (6). Consequently, the output interface of the electrolysis and the input interface into the ammonia synthesis needs to be defined in terms of periodic hydrogen flow 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 k
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        .

                           
                              (6)
                              
                                 
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       ELY
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    +
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       −
                                       1
                                       )
                                    
                                 
                              
                           
                        
                     

In order to reduce the degree of freedom of the system, the capacity of the ammonia synthesis shall be fixed. This is required for being able to set up, analyze and evaluate a process concept of the synthesis subunit, as the technology set up will change with capacity. To prevent a zero solution of the electrolysis capacity choice, the minimum acceptable electrolysis capacity shall be set to generate as much hydrogen per period, as the ammonia synthesis can consume (7).

                           
                              (7)
                              
                                 
                                    
                                       x
                                       
                                          el,design
                                       
                                       ELY
                                    
                                    
                                       Cap
                                       ELY
                                    
                                    ≥
                                    
                                       Cap
                                       SYN
                                    
                                    
                                       f
                                       
                                          
                                             H
                                             2
                                          
                                          −
                                          
                                             NH
                                             3
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This constraint does not exist for CAES and PHS, as these technologies either operate upstream or downstream of the intermediate storage, i. e. electricity is either stored or produced. In multistep electricity conversion processes, such as in this paper, both up- and downstream subunits can operate at the same time.

The non-negativity constraints (8) for the scheduling (
                           
                              
                                 X
                                 
                                    j
                                 
                                 k
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        ) and capacity decision variables (Cap
                           k
                        ) complete the set of general system constraints. Both 
                           
                              X
                              
                                 j
                              
                              k
                           
                         and Cap
                           k
                         are real numbers, Load
                           k
                        (t) is a number between 0 and 1.

                           
                              (8)
                              
                                 
                                    
                                       Load
                                       k
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       X
                                       
                                          j
                                       
                                       k
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       Cap
                                       k
                                    
                                    ≥
                                    0
                                 
                              
                           
                        
                     

These being the objective and the constraints, we now focus on each of the subunits’ specifics to derive detailed expressions for 
                           
                              
                                 X
                                 j
                                 k
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and Load
                           k
                        (t).

A general water electrolyzer, independent of its technology type (alkaline-, proton-exchange-membrane- or solid-oxide-electrolyzer) splits water (H2O) with the help of electricity into its elements hydrogen (H2) and oxygen (O2) (Hamann et al., 2007). The specific electricity consumption per unit H2 is determined by the thermoneutral voltage (corresponding to the higher heating value of hydrogen (
                           
                              HHV
                              
                                 H
                                 2
                              
                           
                        ); see LeRoy et al., 1980), and voltage losses due to electric resistance at multiple subprocesses of the overall electrolysis process, see for example Ulleberg (2003),Hamann et al. (2007) and Marini et al. (2012) for details. Non-convex non-linear simulation models have been developed, e. g. from Ulleberg (2003) and Awasthi, Scott, and Basu (2011), all of them not suitable for a linear or a convex and continuous non-linear optimization model. As mentioned, Rasmussen et al. (2012) used an approach with constant, i. e. load-independent efficiency.

The general relationship between specific electricity consumption (i. e. efficiency) to specific output can be described by graphs as shown in Fig. 2. The degree of the function’s concavity is technology specific and is subject to further technology development, so that for this paper, linearization (gray line in Fig. 2) will be performed. Linearizing 
                           
                              
                                 x
                                 el
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         leads to a quadratic expression of the periodic consumption for a fixed capacity (9). Consequently, load dependency is integrated to a large but not to full extent, as physical simulation models do, but still goes far beyond current modelling in (non-)linear optimization modeling.

The differences between 
                           
                              
                                 x
                                 el
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and the minimum 
                           
                              HHV
                              
                                 H
                                 2
                              
                           
                         are mainly voltage losses and released as heat. Cooling water is required to remove the heat from the electrolyzer and its specific consumption is load-dependent as well (11).

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   el
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                x
                                                el
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ·
                                             
                                             
                                                [
                                                
                                                   x
                                                   
                                                      el,design
                                                   
                                                   ELY
                                                
                                                −
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      Load
                                                      ELY
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         el,design
                                                      
                                                      ELY
                                                   
                                                   −
                                                   
                                                      HHV
                                                      
                                                         H
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       Load
                                       ELY
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       ELY
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          x
                                          
                                             el,design
                                          
                                          ELY
                                       
                                       
                                          Cap
                                          ELY
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   CW
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                x
                                                CW
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                Load
                                                ELY
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      el,design
                                                   
                                                   ELY
                                                
                                                −
                                                
                                                   HHV
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The periodic electricity consumption 
                           
                              
                                 X
                                 
                                    el
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         is a quotient of a quadratic (
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ELY
                              
                              
                                 
                                    (
                                    t
                                    )
                                 
                                 2
                              
                           
                        ) and a linear (CapELY) factor, see (9) and (10). The resulting electricity consumption rate is convex for CapELY > 0 and 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                        
                        
                           
                              
                                 Cap
                                 ELY
                              
                              ϵ
                              R
                           
                         
                        (Boyd and Vandenberghe, 2012), which is the case. Therefore, the formulation in the objective 
                           
                              −
                              
                                 c
                                 el
                              
                              
                                 (
                                 t
                                 )
                              
                              
                                 X
                                 
                                    el
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         is of concave shape as long as the term is less or equal to zero. This implies c
                        el(t) ≥ 0, as 
                           
                              
                                 X
                                 
                                    el
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                        
                        
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              ≥
                              0
                           
                         per definition, and as the electrolysis efficiency cannot be above 100 percent, i. e. 
                           
                              (
                              
                                 x
                                 
                                    el,load
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              −
                              
                                 HHV
                                 
                                    H
                                    2
                                 
                              
                              )
                              ≥
                              0
                           
                        . This is shown in detail in Appendix A.

The system’s process water consumption is directly linked to the hydrogen production rate 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and is modeled by (12).

                           
                              (12)
                              
                                 
                                    
                                       X
                                       
                                          PW
                                       
                                       ELY
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       ELY
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ·
                                    
                                       
                                          M
                                          
                                             
                                                H
                                                2
                                             
                                             O
                                          
                                       
                                       
                                          
                                             ϱ
                                             
                                                
                                                   H
                                                   2
                                                
                                                O
                                             
                                          
                                          N
                                          
                                             
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Water electrolyzers are highly flexible operating units and are sometimes directly coupled to intermittent electricity generators, such as PV modules or wind turbines (Miland et al., 2006; Clarke et al., 2009; Armandi et al., 2012). Partial loads of individual stacks are usually limited to 5 percent of nominal output. Large electrolyzer units usually comprise of multiple stacks, so that an overall continuous load profile from zero to full load (0–100 percent) can be implemented in (4) for k = ELY.

The investment will be defined as the product of specific investment (InvELY) and capacity (CapELY). Large scale electrolyzers are usually assembled as modularized single electrolysis stacks, implying that investment is proportional to the capacity without any economies of scale.

The buffer storage is realized as a gas buffer and operates with a process inherent pressure differential. The upper pressure limit is set by the electrolysis operating pressure p
                        up, the lower pressure limit is set by the pressure of nitrogen supply to the gas compression train of the ammonia synthesis unit p
                        low. Consequently, the buffer load can be defined in terms of relative pressure and relative hydrogen capacity (13). Differentiating between dead and operating volume in the gas buffer (below and above p
                        low), and defining the decision variable 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         in Nm3 H2 as absolute filling level of the operating volume, results in a buffer load range (4) of 0–100 percent for k = ST. With this, the storage process can be modeled in exactly the same way as storage processes of pumped hydro and compressed air storages are modeled. However, each of these techniques feature unique factor consumption rates (here: electricity and cooling water).

As the multistage compressor’s first stage results in a pressure p
                        1, out below p
                        up, hydrogen can be directly fed to the second stage of the compressor train if the buffer pressure is above p
                        1, out (see Fig. 3
                        ). The corresponding relative buffer filling level, up to which this is possible, can be determined by the pressure ratios, i. e. with p(t) = p
                        1, out. Below this level, hydrogen needs to be fed to the first compressor stage, leading to additional specific electricity (14) and cooling water consumption (15).

                           
                              (13)
                              
                                 
                                    
                                       Load
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          p
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             p
                                             low
                                          
                                       
                                       
                                          
                                             p
                                             up
                                          
                                          −
                                          
                                             p
                                             low
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             X
                                             
                                                
                                                   H
                                                   2
                                                
                                             
                                             ST
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          Cap
                                          ST
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       x
                                       
                                          el
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   if
                                                   
                                                   p
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ≥
                                                   
                                                      p
                                                      1,out
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   
                                                      el
                                                   
                                                   compr
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   p
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   <
                                                   
                                                      p
                                                      1,out
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       x
                                       
                                          CW
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   if
                                                   
                                                   p
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ≥
                                                   
                                                      p
                                                      1,out
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                   
                                                      CW
                                                   
                                                   compr
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   p
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   <
                                                   
                                                      p
                                                      1,out
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The periodic electricity and cooling water consumption rates 
                           
                              
                                 X
                                 
                                    el
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 X
                                 
                                    CW
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         are the product of the periodic hydrogen withdrawal 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 −
                                 1
                                 )
                              
                              −
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and the specific consumption rates 
                           
                              
                                 x
                                 
                                    j
                                 
                                 ST
                              
                              ,
                           
                         see (14) and (15). Of course, these costs only occur at hydrogen withdrawal from the storage, i. e. if 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 −
                                 1
                                 )
                              
                              −
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                              ≥
                              0
                           
                        . (13) is a non-linear expression, as LoadST(t) is derived by dividing two decision variables. Furthermore, (14) and (15) feature discrete choices between two options, so that it is necessary to introduce binary variables and the expression is non-differentiable.

The installed buffer capacity CapST is a decision variable, so that the total buffer investment will be defined as a product of specific investment (InvST) and capacity (CapST). Buffer storage shall be done in pipes, so that additional buffer capacity requires the installation of further pipes. This modularized construction principle allows a linear modeling.

The extent of the ammonia reaction is subject to chemical and phase equilibria, both featuring highly non-linear characteristics. Penkuhn et al. (1997) for example optimized the partial load mode of natural gas-based NH3 production with the help of sequential quadratic programming (SQP) in combination with a flowsheeting program for the thermodynamic and chemical characteristics.

The chemical process modeling environment used in this paper (AspenPlus®) is similar to Penkuhn et al. (1997). However, as this paper focuses on scheduling and capacity planning with respect to varying electricity prices, we cannot follow the approach of Penkuhn et al. (1997) and use AspenPlus integrated SQP tools, but have to focus on thermodynamic modeling in AspenPlus and scheduling and capacity planning in a separate modeling environment (here: General Algebraic Modeling System, GAMS). AspenPlus output, and therefore GAMS input, are factor consumption and output rates (here: electricity and water consumption as well as ammonia yield).

The circumstances of an electricity-based NH3 production reduce the complexity of the model in Penkuhn et al. (1997) for obtaining an optimal partial load operating point to an electricity consumption minimization problem. Hereby, process and cooling water costs shall be disregarded, as its costs are comparatively small ( < 5 percent of revenue; see Schulte Beerbühl et al. 2014). This type of reduced input factor minimization problem has been solved in the flowsheeting software environment for discrete load stages across the full load range. The mass balances have been expressed as a function of specific NH3 output (16), specific cooling water (17) and specific electricity consumption 
                           
                              
                                 x
                                 
                                    el
                                 
                                 SYN
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        . Both ammonia yield 
                           
                              x
                              
                                 
                                    NH
                                    3
                                 
                              
                              SYN
                           
                         and specific cooling water consumption 
                           
                              x
                              
                                 CW
                              
                              SYN
                           
                         have been identified as nearly constant across the load profile and will be treated as constant in the following. Details of the underlying synthesis technology can be found in Schulte Beerbühl et al. (2014).

                           
                              (16)
                              
                                 
                                    
                                       X
                                       
                                          
                                             NH
                                             3
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       x
                                       
                                          
                                             NH
                                             3
                                          
                                       
                                       SYN
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       X
                                       
                                          CW
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       x
                                       
                                          CW
                                       
                                       SYN
                                    
                                 
                              
                           
                        
                     

The electricity consumption of the NH3-synthesis is load-dependent, requiring more elaborate modeling. In Schulte Beerbühl, Fröhling, and Schultmann (2014) different MILP- and NLP-variants as part of a heuristic approach have been compared for fitting the experimental data to linear respectively non-linear modeling. However, the best fit functions to simulation data leads to (19), which is not concave throughout LoadSYN = [0.2, …, 1]. As the synthesis capacity is fixed, CapSYN is a parameter, so that LoadSYN(t) is solely dependent upon the variable 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 SYN
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         (see (20)).

                           
                              (18)
                              
                                 
                                    
                                       X
                                       
                                          el
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       x
                                       
                                          el
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   el
                                                
                                                SYN
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ·
                                             
                                                10
                                                3
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             327.62
                                             −
                                             240.10
                                             
                                                
                                                   (
                                                   
                                                      Load
                                                      SYN
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             576.64
                                             
                                                
                                                   (
                                                   
                                                      Load
                                                      SYN
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             −
                                             427.69
                                             
                                             
                                                Load
                                                SYN
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       Load
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       X
                                       
                                          
                                             H
                                             2
                                          
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       1
                                       
                                          
                                             f
                                             
                                                
                                                   H
                                                   2
                                                
                                                −
                                                
                                                   NH
                                                   3
                                                
                                             
                                          
                                          
                                             Cap
                                             SYN
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The load range (4) for the synthesis has been set to 20– 100 percent. Cold and warm starts of high pressure and high temperature catalytic processes, such as the ammonia synthesis process, are cost- and time-consuming. Additionally, high temperature and pressure changes due to frequent start-ups and shutdowns decrease the equipment lifetime due to severe exposure to thermomechanical stress. In order to prevent this and to gain a maximum of flexibility with regard to the upstream process of the electrolysis, load shall be reduced to a minimum, but not leading to a shut-down. Simulations have revealed that 20 percent of nominal output seems to be the minimum, which can be achieved under an economically justifiable effort, see Schulte Beerbühl et al. (2014) and Ostuni and Zardi (2012) for a similar NH3-process. With the synthesis not being able to shut down for electricity price reasons, binary variables for on/off decisions become unnecessary.

The synthesis investment is estimated on the basis of the process simulation. The capacity is fixed in this optimization task and is therefore constant.


                     Sections 4.2 –4.4 feature non-linear components, most importantly at the water electrolysis (Section 4.2). Its improving economic performance at partial load operations can be integrated only by non-linear modeling. Other non-linear components have been observed at the ammonia synthesis unit.

Unit commitment and start-up decisions, which are typical variables in energy models with thermal power plants, require the integration of binary variables, but do not exist in the described concept. The electrolysis is a highly flexible process with no distinct start-up cost, whereas the NH3-synthesis is defined to operate continuously between 20 percent and 100 percent load, i. e. without shut down. Therefore, the only discrete choices which require binary variables are needed for modeling the additional costs of hydrogen buffer storage at low filling levels (Section 4.3).

As mentioned in Section 3, we transform the original mixed-integer non-linear program into a continuous and convex non-linear program (NLP), not into a mixed-integer linear program (MILP). The reduction is achieved by omitting the discrete choices of the buffer, see (14) and (15). The extent of simplification is at maximum 
                        
                           
                              f
                              
                                 j
                              
                              compr
                           
                           
                              (
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 −
                                 1
                                 )
                              
                              −
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        
                      and otherwise zero, which is by far less than any kind of linearization of (9) and (11), see Fig. 2. Furthermore, (18) needs to be transformed into convex shape through linearization. In its current state, (18) is partly non-convex for LoadSYN(t) = [0.2, …, 1], as the second derivative of (18) shows.

The described reduction procedure leads to an under- or overestimation of costs, the extent depends upon the linearized scalar. Consequently, the convex NLP will under- or overestimate the annuity as well as the capacity variables. Inaccuracies in cost calculations shall be corrected by a post-optimization adjustment mechanism, which performs cost calculation as depicted in Section 4 on the basis of the optimization results and re-introduces non-convex as well as non-differentiable functions. Consequently, appropriate (and thereby feasible) annuities can be derived on the basis of suboptimal, but still feasible capacity and scheduling variables. The idea of this adjustment mechanism is therefore similar to the one described in Rong, Lahdelma, and Luh (2008), but focuses solely on non-decision variables (costs associated to the scheduling decision variables). However, as optimization is performed with the reduced problem, we can only approximate the global optimum of the MINLP. Nonetheless, selecting appropriate simplifications lead to lower and upper boundaries of the global capacity optimum and annuity maximum. The following procedure provides the route to encircle the global optimum of the given MINLP by a set of convex NLPs.

At first, (14), (15) and (18) are linearized to their lower boundaries:

                        
                           1.
                           Linearizing (14) and (15) by defining 
                                 
                                    
                                       x
                                       
                                          j
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    0
                                 
                               on p
                              low < p(t) < p
                              up, i. e. no compression efforts at any time. Furthermore, linearizing (18) by setting (19) to its minimum on LoadSYN = [0.2, …, 1].

Optimization of the continuous and convex non-linear program.

Adjustment mechanism, which corrects 
                                 
                                    
                                       x
                                       
                                          j
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               to 
                                 
                                    f
                                    
                                       j
                                    
                                    compr
                                 
                               in case p(t) < p
                              1, out and which corrects the reduced form of 
                                 
                                    
                                       x
                                       
                                          el
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               to (19). The result is the adjusted maximum annuity 
                                 
                                    A
                                    adj
                                    *
                                 
                              .

So far, the results are not globally optimal and provide an upper boundary to it. Furthermore, the extent of capacity overestimation and annuity underestimation (of the adjusted annuity of Step 3) is unknown as well. A lower boundary of the optimum capacities can be determined by using the upper boundaries of (14), (15) and (19) in a second optimization run:

                        
                           4.
                           Linearizing (14) and (15) by defining 
                                 
                                    
                                       x
                                       
                                          j
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       f
                                       
                                          j
                                       
                                       compr
                                    
                                 
                               on p
                              low < p(t) < p
                              up, i. e. compression in “Compr. 1” at all times. Furthermore, linearizing (18) by setting (19) to its maximum on LoadSYN = [0.2, …, 1].

Optimization of the continuous and convex non-linear program.

Adjustment mechanism, which corrects 
                                 
                                    
                                       x
                                       
                                          j
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               down to zero in case p(t) > p
                              1, out and which corrects the reduced form of 
                                 
                                    
                                       x
                                       
                                          el
                                       
                                       SYN
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               to (19).

So far, these two sets of convex NLPs have provided the lower and the upper boundaries of the capacity variables CapELY and CapST and a minimum value of the adjusted annuity. As minima and maxima have been used, the optimum capacities have been encircled. The optimum annuity has been encircled by the maximum of the adjusted annuities 
                        
                           A
                           rep
                           *
                        
                      (Steps 3 and 6) and the pre-adjustment annuity A* of Step 2 (cost underestimation).

As a third step, the weighted average of (14), (15) and (19) across t = 1, …, T of Steps 2 and 5 shall provide a further proximity of the optimum capacities and maximum annuity to the global optimum. The following derived capacities are near the globally optimal capacities, however, it is unknown, whether they are above or below the optimum. Again, the adjusted annuity is a lower boundary to the maximum annuity of the MINLP.

                        
                           7.
                           Counting t in T, in which p(t) < p
                              1, out of both optimization runs.

Calculating the average synthesis load of both optimization runs.

Replacing (14) and (15) by 
                                 
                                    
                                       x
                                       
                                          j
                                       
                                       ST
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       t
                                       T
                                    
                                    
                                       f
                                       
                                          j
                                       
                                       compr
                                    
                                 
                               and (19) by the electricity consumption at the average synthesis load.

Optimization of the continuous and convex non-linear program.

Adjustment mechanism, which corrects the costs according to (14), (15) and (19).

The adjustment mechanism in Step 11 is active at every period t of T, as the simplified costs do not reflect the reality at any time. However, as this is a weighted average, the sum of adjusted costs across T are supposed to be far less than in the previous adjustment procedures, so that the global optimum should be approached better. If this is the case, the optimal capacities are in the interval described by the capacities of Steps 2 and 5 and the adjusted annuity is higher than both adjusted annuities of Steps 3 and 6. The annuity of Step 10 and the adjusted annuity of Step 11 are less than the annuity before adjustment of Step 2, which represents the case of cost underestimation.

This section illustrates the working principle of the heuristic developed in Section 5, its superiority to a linear approach on detailed as well as on global level. Section 6.1 introduces the set of data used for the example. Section 6.2 illustrates the working principle and the results of the heuristic step by step. Section 6.3 compares the results of the non-linear to the results of a linear approach, for which the reductions of Steps 1 and 4 are performed in a way so that the reduced problem is a MILP. Section 6.4 provides an illustrative example of how non-linear and linear scheduling differ on an hourly basis.

For this purpose, the hourly day-ahead market prices of the PHELIX market area (Germany and Austria) of the European Energy Exchange (EEX, 2013) of the year 2013 are used as exogenous price parameters, implying that the time period t is one hour. The parametric set of c
                        el(t) for t = 1, …, 8760 is altered for convexity reasons to min(c
                        el(t)) = 0. Typical prices for ammonia and water for central Europe have been used as input. The model is implemented in GAMS v23.9.1 using the IPOPT solver v3.11 (Wächter and Biegler, 2006), which is a free commercially available solver for convex and continuous non-linear programming.


                        Table 2
                        summarizes statistical data of the electricity price in 2013. The percentage of hours below 56.82 euros per megawatt hour is especially interesting, as this price is the marginal electricity cost of NH3 at the given ammonia (520 euros per ton) and water prices at full load operations. Consequently, positive contribution margins can be earned up to a price of 56.82 euros per megawatt hour. The marginal electricity cost is above the mean (37.88 euros per megawatt hour) and median (36.07 euros per megawatt hour), implying that electricity purchase in more than 50 percent (here: 85.9 percent) of that year generates a positive contribution margin for covering fixed costs. Load reduction leads to efficiency increases at the electrolysis, resulting in increasing marginal electricity costs up to 67.35  euros per megawatt hour for 20 percent electrolysis load, and even 70.62 euros per megawatt hour for almost 0 percent of nominal electrolyzer capacity. Across 2013, the day-ahead market price at the EEX has been below 70.62 euros per megawatt hour in 97.6 percent of the time.

During scheduling and capacity optimization, a trade-off between electricity purchase above marginal electricity cost levels, additional electrolyzer capacity and synthesis load reduction has to be performed to guarantee the synthesis load minimum of 20 percent nominal capacity at each hour. The NH3 synthesis capacity is set to a design load output of 3 tons NH3 per hour, which equals 6050 newtons cubic meters per hour H2.


The results of the heuristic procedure are summarized in Table 3
                        , displaying the values of the capacity-related decision variables and the annuities, which itself represent the scheduling-related decision variables at the chosen capacities.

Step 1: Simplification of (14), (15) and (19).

Step 2: Optimization of the cost-underestimating relaxed NLP, using the objective (5) and its constraints (4), and (6)–(8). Hereby, each of the process units are described by its hourly input and output factor rates 
                           
                              
                                 X
                                 
                                    j
                                 
                                 k
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                         which have been derived in Section 5, and the simplified buffer storage and electricity consumption rates of Step 1. This optimization problem for T = 8760 hours translates into 288,821 non-zero variables, thereof 30.3 percent non-linear ones (87430). An Intel® Core™  2 Duo CPU with 2.4 gigahertz took 105 seconds to solve this non-linear program in 59 iterations.

This cost-underestimating problem derives upper boundaries of the capacity choices, which are, as displayed in Table 3, 34.76 megawatts for CapELY and 53824 newtons cubic meters H2 for CapST. The electrolysis capacity equals a full load hydrogen production of 7900 newtons cubic meters per hour , which is 30.6 percent more than needed for full load operation of the NH3-synthesis (6050 newtons cubic meters H2).

Step 3: The adjustment mechanism repairs the buffer simplification of Step 1 in t = 2266 hours, i. e. for 25.9 percent of the year and adds total annual costs of 39.6 × 103 euros, which have been neglected so far, hereby reducing the annuity from 504.5 × 103 euros to 464.9 × 103 euros.

Step 4: Simplification of (14), (15) and (19).

Step 5: Optimization of the cost-overestimating relaxed NLP, using the same objective and constraints as in Step 2, but now with the simplified consumption functions of Step 4 instead. Model size and computational time do not differ from the optimization run in Step 2, as no additional functions are added.

This cost-overestimating model represents the lower boundary of the capacity choices, which are 34.01 megawatts for CapELY and 46825 newtons cubic meters H2 for CapST. The electrolysis capacity represents a full load hydrogen production of 7731 newtons cubic meters per hour, which is 28.8 percent more than needed for full load operation of the NH3-synthesis (6050 newtons cubic meters H2), but 2 percent less in absolute size and 8 percent less in terms of excess hydrogen production rate of Step 2. As costs are overestimated, the resulting annuity before adjustment is lower than both A* and 
                           
                              A
                              rep
                              *
                           
                         of the upper boundary.

Step 6: The adjustment mechanism repairs the buffer consumption rate simplification of Step 4 in t = 6468 hours, so that in t = 2292 hours, i. e. for 26.2 percent of the year, hydrogen compression at the first compressor stage apply. The mechanism subtracts falsely included total annual costs of 140.3 × 103 euros, increasing the annuity from 323.1 × 103 euros to 463.3 × 103 euros.

Summing up so far, the derived upper and lower boundaries narrow down the area of optimal capacities to 34.01 to 34.76 megawatts for the electrolysis and 46,825 newtons cubic meters to 53,825 newtons cubic meters H2 for the hydrogen buffer.

The optimum capacity of the MINLP is in between these limits with an annuity of at minimum 464.9 × 103 euros. Due to the proximity of both adjusted annuities (δ ∼ 0.33%), one can expect that these values represent fairly good estimates of the maximum annuity of the MINLP. The difference of 26 hours in hydrogen flowing through the first compressor stage reveals only minor differences in scheduling due to different strategies and, of course, different capacities.

Having derived these intervals, Steps 7–11 use weighted average consumption functions for the buffer and the NH3-synthesis to derive an intermediate solution.

Step 7: On average of both runs, hydrogen is flowing in 2279 hours through the first compression stage, i. e. in 26.0 percent of the time.

Step 8: The average load on the ammonia synthesis is 92 percent.

Step 9: The weighted continuous and linear consumption functions are 
                           
                              
                                 x
                                 
                                    j
                                 
                                 ST
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              0.26
                              
                                 f
                                 
                                    j
                                 
                                 compr
                              
                           
                         for the buffer, and 
                           
                              
                                 x
                                 el
                                 SYN
                              
                              =
                              0.2366
                           
                          kilowatt hours per newton cubic meter for the ammonia synthesis.

Step 10: As displayed in Table 3, optimum capacities (34.55 megawatts and 51779 newtons cubic meters) are in between the previously derived intervals, and more close to the upper than the lower boundary. This is in line with the share 
                           
                              
                                 t
                                 T
                              
                              ,
                           
                         which is clearly below 50 percent.

Step 11: The adjustment sums up to only 12.8 × 103 euros, which is due to the fact, that positive and negative adjustments almost compensate each other. The adjusted annuity (465.0 × 103 euros) is above the current maximum adjusted annuity of 464.9 × 103 euros (derived in Step 3). The little extent of adjustment as well as the proximity of the adjusted annuity to the previously calculated adjusted annuities may be interpreted as an indicator for a flat shape of the curve of 
                           
                              
                                 A
                                 adj
                                 *
                              
                              =
                              f
                              
                                 (
                                 
                                    Cap
                                    ELY
                                 
                                 ,
                                 
                                    Cap
                                    ST
                                 
                                 )
                              
                           
                         in the discussed range of capacity variables.


The global optimum of the original MINLP has been encircled with the help of two convex NLPs, a third convex NLP with weighted average consumption functions provides an indication of the globally optimal solution. Consequently, a total of three optimization runs at each ∼ 105 seconds is needed. The computational time increases exponentially with the number of time intervals. Tests with past electricity market data indicate a relationship between time intervals t and computational time in the order of exp 1.5 to exp 1.7 for variations between half a year to two years on an hourly interval, i. e. 4380–17,520 time steps.

As Section 3 has shown, it is common practice to reduce the MINLP into mixed-integer linear formulation. For a combined scheduling and capacity planning problem as presented in this paper, linearization has to be performed either by fixing capacities and linearizing (or piecewise linearizing) the load-dependent consumption functions, or by neglecting the load dependencies while keeping the capacities as decision variables. Piecewise linearization at endogenous capacity choice still leads to non-linear formulation of the load expressions, see (10) and (13).

Capacity choice is very important for the scope of this paper, therefore we will keep the capacity as a decision variable and neglect load dependencies for the reference linear approach. Still, the heuristic of Section 5 can be used to encircle the global optimum of the MINLP through upper and lower boundaries. While (19) is reduced in the same way as done for the continuous and convex NLP, (9) and (11) need to be turned into a scalar, as depicted in Fig. 2. The dashed line represents the lower boundary (
                           
                              
                                 x
                                 el
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 x
                                 el,design
                                 ELY
                              
                           
                        ), whereas a similar consumption rate at 
                           
                              
                                 x
                                 el
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 HHV
                                 
                                    H
                                    2
                                 
                              
                              =
                              3.54
                           
                         kilowatt hours per newton cubic meter H2 represents the upper boundary of the capacity variables.

Now, optimizing the linear problems using IBM ILOG CPLEX V23.9.1 on the same computer leads to a problem with 236,391 non-zero variables, which can be solved in less than 20 seconds. Linear modeling reduces the computational time significantly compared to non-linear modeling, in this case by a factor of more than five. However, as Fig. 4
                        shows, the better modeling of the electrolysis using non-linear modeling leads to far smaller capacity (here − 86 percent and − 88 percent) and (unadjusted) annuity intervals. The adjustment mechanism corrects the cost calculations and therefore provides accurate annuities of (for the MINLP) non-optimal solutions, so that both derived 
                           
                              A
                              adj
                              *
                           
                         consequently form lower boundaries to the MINLP maximum.

The solutions of all four scenarios, both upper (#) and lower (*) boundary linear (LP) and non-linear (NLP), as well as the weighted average scenario (WA) of the non-linear case (Steps 10 and 11) are depicted in Fig. 4. The first two rows visualize the clearly smaller capacity intervals, which can be determined by using the load-dependent non-linear modeling. The third row (A*) shows the corresponding maximum annuities before adjustment, whereas the fourth and last row depicts the adjusted maximum annuities 
                           
                              A
                              adj
                              *
                           
                        . The last two rows do not only emphasize the meaningfulness of the adjustment mechanism, but also the improved overall economic assessment through non-linear modeling (in this case, the lower boundary of 
                           
                              A
                              adj
                              *
                           
                         has been increased by + 13 percent).

The main difference between scheduling solutions of linear and non-linear programming can be observed at the hydrogen production rate of the water electrolyzer 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 ELY
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and the chosen ammonia production rate, represented through the hydrogen input into the ammonia synthesis, 
                           
                              
                                 X
                                 
                                    
                                       H
                                       2
                                    
                                 
                                 SYN
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        .

The electrolyzer efficiency is load-dependent, as described in (9), leading to higher efficiency at partial load and thereby higher marginal electricity costs. Consequently, as can be seen in Fig. 5
                        a, electrolyzer operation at full load only occurs at t = 18 − 24 and t = 41 − 48, shut down occurs at t = 13, 14, 36, 37 and partial load operations occur at the rest of the time. In contrast, Fig. 5b shows, that the electrolyzer is shut down in 48 percent of the time and otherwise at full load, except for t = 53, when using linear modeling. The marginal electricity price of 56.82 euros per megawatt hour represents a fixed, i. e. not load-dependent switching point, at which the electrolyzer load should be reduced from 100 percent to 0 percent, if no hydrogen production for guaranteeing the minimum synthesis load of 20 percent is necessary. This is not the case in Fig. 5b but in long periods of prices above 56.82 euros per megawatt hour.

In total, the H2 production through non-linear modeling rises by 18,000 newtons cubic meters H2 ( + 7.6 percent), leading to a contribution margin increase by 5500 euros to 22,750 euros throughout the depicted 62 hours.

@&#DISCUSSION AND CONCLUSIONS@&#

Scheduling and capacity planning problems of all kinds of applications usually feature both non-linear and binary decision. Especially applications in the energy sector feature a planning horizon of thousands of time steps, so that handling of these mixed-integer non-linear problems becomes a difficult task. Therefore, these kinds of problems are usually tackled by simplifying through linearization, which reduces the program to a mixed-integer linear type. This approach is useful, especially if the extent of non-linearity is small or can be approximated quite well with reasonable efforts, such as Garcia-Gonzalez et al. (2007) do by using a piecewise linearization at a pumped hydro storage system.

However, if the non-linearities cannot be approximated well, this procedure will produce large deviations and might lead to misleading results. Thermo- and electrochemical processes cannot be linearized well in many cases, so that one has to think about using non-linear programming instead. Furthermore, endogenous capacity selection is possible, which is important for determining optimal process and process subunit capacities. Hereby, as shown for the electrolysis of water, very important characteristics can be included into the analysis, which would have to be omitted otherwise. However, to be able to use convex non-linear programming, binary decisions need to be relaxed and a concave objective for maximizing problems needs to be achieved. Hydrogen energy systems usually contain binary decisions of only minor overall effect, as start-up or partial load costs do not occur or are integrated in the non-linear characteristics.

In contrast to piecewise linearized load-dependent efficiency functions for MILP modeling, capacity choice can still remain an endogenous decision variable. The innovative electricity-to-hydrogen-to-ammonia concept, which is presented and analyzed in this paper as an example, features such a load-dependent objective, which can be solved by available convex NLP solvers, such as IPOPT, which is used in this case.

The developed heuristic provides an approach to derive a convex and continuous NLP, as well as an adjustment mechanism, which corrects the previously conducted relaxation. The decomposition of the original MINLP to a set of convex NLP is done in a way, that upper and lower boundaries for the relevant capacity decision variables can be determined, as well as a lower boundary of the maximum annuity, which represents plant scheduling. Total computational effort is clearly higher than in linear formulation, but is seen as acceptable with regard to the achieved improvements in capacity selection and economic assessment. As the analyzed question is a question of strategic matter, minimum computational effort is not required.

The numerical example, using German electricity market data of 2013, resulted in a maximum annuity of at least 465 × 103 euros for the described electricity-to-hydrogen-to-ammonia plant at an ammonia price of 520 euros per ton. The interval of optimum electrolysis capacity has been determined as 34.0–34.76 megawatts and the optimum hydrogen buffer capacity to 46,825 –53,825 newtons cubic meters3 H2. Using weighted average functions for relaxation suggests optimum capacities of 34.55 megawatts and 51,779 newtons cubic meters.

The comparison to linear modeling clearly shows the advantages of integrating non-linear plant characteristics. However, as convex programming is used, load dependent efficiency functions need to be convex. The case of electricity consumption of the ammonia synthesis subunit has shown, that non-convex functions need to be modified to convexity in order to be used in the developed approach. As modifications have been at a minor extent, it has been regarded as acceptable in this case. Of course, it cannot be generalized, so that the approach may proof to be inferior to linear or other type of modeling for convex functions. Non-linear modeling leads to higher computational effort than linear modeling and increases exponentially with the number of time steps. However, total effort is acceptable, as long as the number of time steps is limited to not more than two years at an hourly interval.

Besides technology issues, further analyses on the heuristics performance, the performance sensitivity with regard to different input data (especially more sets of electricity prices) and MINLP solvers for scheduling problems with many time steps seem to be attractive fields for further research.

To conclude, the presented heuristic procedure, which is based on convex non-linear optimization, is able to perform a combined capacity and scheduling planning task for intermittently operated chemical processes with intermediate buffers, linking the electricity market at the chemical market. This is of relevance for other concepts than the presented one as well, for example methane, methanol and other hydrogen-rich production concepts, which rely on using price-volatile electricity. All these processes are characterized by the strong load-dependency of the water electrolysis. For these, small intervals of subunit capacities (here electrolysis and buffer size) and a lower boundary of the maximum annuity can be determined, which are clearly superior to solutions derived by linear modeling. The analyzed innovative and new electricity-to-hydrogen-to-ammonia concept has been used as an illustrative example. Its modeling with German price data of 2013 has shown the technology’s economic potential to support the integration of fluctuating renewable electricity generation technologies into the German market by being a price-sensitive and flexible consumer of electricity.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank the referees for their in-depth comments and very valuable suggestions.

As mentioned in Section 4, the objective needs to be of concave shape in order to use convex optimization methods at a maximization problem. The non-linear parts of the described objective concern the part of the water electrolysis, which features load-dependent efficiency characteristics.

As all other parts of proving the concavity of the objective are fairly straight forward due to linearity, we focus on showing that 
                        
                           
                              
                                 δ
                                 
                                    Obj
                                    2
                                 
                              
                              
                                 
                                    δ
                                    2
                                 
                                 
                                    X
                                    
                                       
                                          H
                                          2
                                       
                                    
                                    ELY
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                           <
                           0
                        
                     . (A.1) shows the first derivative of (5) with respect to 
                        
                           
                              X
                              
                                 
                                    H
                                    2
                                 
                              
                              ELY
                           
                           
                              (
                              t
                              )
                           
                        
                      and is solely based on (9) and (11). (A.3) is a regrouping of (A.2). It is directly obvious in (A.3), that 
                        
                           
                              
                                 δ
                                 
                                    Obj
                                    2
                                 
                              
                              
                                 
                                    δ
                                    2
                                 
                                 
                                    X
                                    
                                       
                                          H
                                          2
                                       
                                    
                                    ELY
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                           <
                           0
                           ,
                        
                      as all components are parameters and defined as being zero or positive. Furthermore, 
                        
                           (
                           
                              x
                              el,design
                              ELY
                           
                           −
                           
                              HHV
                              
                                 H
                                 2
                              
                           
                           )
                           >
                           0
                           ,
                        
                      as the production of hydrogen contains energetic losses (i. e. 
                        
                           
                              x
                              el,design
                              ELY
                           
                           >
                           
                              HHV
                              
                                 H
                                 2
                              
                           
                        
                     ) and (1 − f
                     el − CW) > 0. f
                     el − CW quantifies the electricity consumption per unit cooling water and ranges from 0.005 kilowatt hours/kilowatt hours to 0.03 kilowatt hours/kilowatt hours (see Section 2.1), so that (1 − f
                     el − CW) > 0.

                        
                           (A.1)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                             Obj
                                          
                                          
                                             δ
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             c
                                             el
                                          
                                          
                                             (
                                             
                                                x
                                                el,design
                                                ELY
                                             
                                             −
                                             
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                
                                                   Cap
                                                   ELY
                                                
                                             
                                             +
                                             2
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                
                                                   Cap
                                                   ELY
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             (
                                             
                                                x
                                                el,design
                                                ELY
                                             
                                             −
                                             
                                                HHV
                                                
                                                   H
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             c
                                             el
                                          
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   el
                                                   −
                                                   CW
                                                
                                             
                                             2
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                
                                                   Cap
                                                   ELY
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                −
                                                
                                                   HHV
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                Obj
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                                2
                                             
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             c
                                             el
                                          
                                          
                                             (
                                             2
                                             
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                
                                                   Cap
                                                   ELY
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                −
                                                
                                                   HHV
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             c
                                             el
                                          
                                          
                                             (
                                             2
                                             
                                                f
                                                
                                                   el
                                                   −
                                                   CW
                                                
                                             
                                             
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                
                                                   Cap
                                                   ELY
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   el,design
                                                   ELY
                                                
                                                −
                                                
                                                   HHV
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                Obj
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                                2
                                             
                                             
                                                X
                                                
                                                   
                                                      H
                                                      2
                                                   
                                                
                                                ELY
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             c
                                             el
                                          
                                          2
                                          
                                             
                                                x
                                                el,design
                                                ELY
                                             
                                             
                                                Cap
                                                ELY
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             (
                                             
                                                x
                                                el,design
                                                ELY
                                             
                                             −
                                             
                                                HHV
                                                
                                                   H
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                f
                                                
                                                   el
                                                   −
                                                   CW
                                                
                                             
                                             )
                                          
                                          <
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

