@&#MAIN-TITLE@&#Regularized generalized canonical correlation analysis for multiblock or multigroup data analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Multiblock and multigroup data analysis methods are reviewed in the introduction.


                        
                        
                           
                           We propose a new version of the RGCCA algorithm so that it can be used for both multiblock and multigroup data.


                        
                        
                           
                           We remind that many multiblock data analysis methods are special cases of RGCCA.


                        
                        
                           
                           We show how to use RGCCA for multigroup data analysis.


                        
                        
                           
                           We illustrate RGCCA for multiblock and multigroup data on two real datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multiblock data analysis

Multigroup data analysis

Regularized generalized canonical correlation analysis

@&#ABSTRACT@&#


               
               
                  This paper presents an overview of methods for the analysis of data structured in blocks of variables or in groups of individuals. More specifically, regularized generalized canonical correlation analysis (RGCCA), which is a unifying approach for multiblock data analysis, is extended to be also a unifying tool for multigroup data analysis. The versatility and usefulness of our approach is illustrated on two real datasets.
               
            

@&#INTRODUCTION@&#

In this paper, we consider a data matrix X structured in groups (partition of rows) or in blocks (partition of columns). Rows of X are related to individuals and columns to variables. Multiblock data analysis concerns the analysis of several sets of variables (blocks) observed on the same set of individuals. Multigroup data analysis concerns the analysis of one set of variables observed on several groups of individuals. Note that there is no established consensus in the literature on the use of the terms “multiblock” and “multigroup”. Therefore these two terms are clearly defined in this paper.

In the multiblock framework, a column partition X
                     =[X
                     1, …, X
                     
                        j
                     , …, X
                     
                        J
                     ] is considered. In this case, each n
                     ×
                     p
                     
                        j
                      data matrix X
                     
                        j
                      is called a block and represents a set of p
                     
                        j
                      variables observed on n individuals. The number and the nature of the variables usually differ from one block to another but the individuals must be the same across blocks. The main aim is to investigate the relationships between blocks. The data might be preprocessed in order to ensure comparability between variables and blocks. To make variables comparable, standardization is applied (zero mean and unit variance). To make blocks comparable, a possible strategy is to divide each block by 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                      (Wold, Hellberg, Lundstedt, Sjostrom, & Wold, 1987). This two-step procedure leads to 
                        
                           Trace
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                           =
                           n
                        
                      for each block.

In the multigroup framework, a row partition 
                        
                           X
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      is considered. In this framework, the same set of variables is observed on different groups of individuals. Each n
                     
                        i
                     
                     ×
                     p data matrix X
                     
                        i
                      is called a group. The number of individuals of each group can differ from one group to another. The main aim is to investigate the relationships among variables within the various groups. Following the proposal of Kiers and Ten Berge (1994) variables are centered and normalized (i.e. set to unit norm) within each group. This preprocessing leads to 
                        
                           Trace
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                           =
                           p
                        
                      for each group.

Many methods exist for multiblock and multigroup data analysis.

Two families of methods have come to the fore in the field of multiblock data analysis. These methods rely on correlation-based or covariance-based criteria. Canonical correlation analysis (Hotelling, 1936) is the seminal paper for the first family and Tucker’s inter-battery factor analysis (Tucker, 1958) for the second one. These two methods have been extended to more than two blocks in many ways:
                        
                           (1)
                           Main contributions for generalized canonical correlation analysis (GCCA) are found in Horst (1961), Carroll (1968a), Kettenring (1971), Wold (1982, 1985) and Hanafi (2007).

Main contributions for extending Tucker’s method to more than two blocks come from Carroll (1968b), Chessel and Hanafi (1996), Hanafi and Kiers (2006), Hanafi, Kohler, and Qannari (2010, 2011), Hanafi, Mazerolles, Dufour, and Qannari (2006), Krämer (2007), Smilde, Westerhuis, and de Jong (2003), Ten Berge (1988), Van de Geer (1984), Westerhuis, Kourti, and MacGregor (1998), Wold (1982, 1985).


                              Carroll (1968b) proposed the “mixed” correlation and covariance criterion. van den Wollenberg (1977) combined correlation and variance for the two-block situation (redundancy analysis). This method is extended to a multiblock situation in this paper.

Regularized generalized canonical correlation analysis (Tenenhaus & Tenenhaus, 2011) includes many of these references as particular cases.

For multigroup data analysis, we may distinguish three families of methods:

(1) Several methods combine the covariance matrices S
                     
                        i
                      or the correlation matrices R
                     
                        i
                      related to the various groups.

In a seminal paper, Levin (1966), considering the problem of simultaneous factor analysis, proposed the diagonalization of 
                        
                           
                              
                                 R
                              
                              
                                 ‾
                              
                           
                           =
                           (
                           1
                           /
                           I
                           )
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        
                     . The acronym SUMPCA
                        c
                      for the Levin method was proposed by Kiers (1991). Kiers and Ten Berge (1994) proposed several simultaneous component analysis methods (see paragraph 3 below): one of them (SCA-P) leads also to the diagonalization of 
                        
                           
                              
                                 R
                              
                              
                                 ‾
                              
                           
                        
                     . Krzanowski (1984) proposed to carry out a multigroup PCA (MGPCA) by diagonalizing either 
                        
                           T
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                      or the within group covariance matrix 
                        
                           S
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           /
                           n
                           )
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     .


                     Krzanowski (1979) proposed to use an approach similar to Carroll’s GCCA (correlation criterion) for comparing group correlation matrices R
                     1, …, R
                     
                        I
                     . Since GCCA on these matrices yields a trivial solution, Krzanowski replaced each matrix R
                     
                        i
                      by its k first eigenvectors and then applied GCCA on the obtained matrices.


                     Flury (1984) proposed a method called common principal component analysis (CPC) for I groups by supposing a special structure on the covariance matrices Σ
                     1, …, Σ
                     
                        I
                      defined at the population level. In CPC, the I covariance matrices have the same eigenvectors but the eigenvalues are specific to each group: Σ
                     
                        i
                     
                     =
                     AΛ
                     
                        i
                     
                     A
                     
                        t
                      where A is orthogonal and Λ
                     
                        i
                      diagonal. Flury (1987) also proposed a partial common principal component analysis (PCPC) where only q eigenvectors of Σ
                     
                        i
                      are common to all populations. Flury’s approach is based on normal-theory maximum likelihood and a complicated iterative algorithm is required. Two alternative algorithms have been proposed: (1) Krzanowski (1984) showed empirically that MGPCA and PCPC give very close results; (2) a sequential least squares solution to PCPC can be obtained by using the CCSWA algorithm (Common components and specific weight analysis) described in Hanafi et al. (2006). It is also worth mentioning that CCSWA and HPCA (Hierarchical principal component analysis described in Westerhuis et al. (1998)) are two equivalent methods (Hanafi et al., 2010).

(2) It is always possible to use a multiblock method on multigroup data by considering the transpose of each group. Eslami, Qannari, Kohler, and Bougeard (2013a) proposed to use an approach similar to Carroll’s GCCA (correlation and covariance criteria) on the transpose groups 
                        
                           
                              
                                 X
                              
                              
                                 1
                              
                              
                                 t
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 X
                              
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                     . This approach has later been extended to a multiblock/multigroup situation in Eslami, Qannari, Kohler, and Bougeard (2013b).

(3) Kiers and Ten Berge (1989, 1994) and later Timmerman and Kiers (2003) proposed a generalization of PCA to a multigroup situation under the generic name of Simultaneous Component Analysis (SCA). Each data group X
                     
                        i
                      of dimension n
                     
                        i
                     
                     ×
                     p is modeled by a lower rank n
                     
                        i
                     
                     ×
                     p matrix 
                        
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      where W
                     
                        i
                      is a p
                     ×
                     q (q
                     <
                     p) weight matrix and P
                     
                        i
                      a p
                     ×
                     q pattern matrix. A factor matrix F
                     
                        i
                     
                     =
                     X
                     
                        i
                     
                     W
                     
                        i
                      and a loading (or structure) matrix L
                     
                        i
                     
                     =
                     R
                     
                        i
                     
                     W
                     
                        i
                      are also introduced. PCA and SCA methods are about minimizing 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                      subject to specific constraints on the weight/pattern/structure/factor matrices which are summarized in Table 1
                     .

The reconstructed matrix 
                        
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      is invariant up to an orthogonal (rotation) matrix A: 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              
                                 A
                              
                              
                                 t
                              
                           
                           
                              
                                 AP
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                     . This invariance can be used to improve interpretation. Various rotation methods are described in Niesing (1997). Moreover, Niesing shows in a comparative study that SCA-P gives the best practical results.


                     De Roover, Ceulemans, and Timmerman (2012), De Roover, Ceulemans, Timmerman, and Onghena (2013) and De Roover, Timmerman, Van Mechelen, and Ceulemans (2013) have developed a clusterwise approach to SCA-P, SCA-PF2, SCA-IND and SCA-ECP for tracing structural differences and similarities between different groups of individuals.

Finally, Van Deun, Smilde, van der Werf, Kiers, and Van Mechelen (2009) proposed a simultaneous component analysis framework for multiblock and multigroup data analysis.

In this paper, a modified version of RGCCA, which can be applied to multiblock and multigroup data, is described. The acronym RGCCA will be kept for this more general method. This paper is organized as follows: the general optimization problem for both multiblock and multigroup data analysis is presented in Section 2. A monotonically convergent algorithm is presented in Section 3. An overview of applications of RGCCA for multiblock and multigroup data analysis is given in Sections 4 and 5. The versatility and usefulness of our approach is illustrated on two real datasets in Sections 6 and 7.

RGCCA for multiblock and multigroup data analyses is based on a single optimization problem that we present in this section. We consider I matrices Q
                     1, …, Q
                     
                        I
                     . Each matrix Q
                     
                        i
                      is of dimension m
                     ×
                     p
                     
                        i
                     . We also associate to each matrix Q
                     
                        i
                      a weight column vector w
                     
                        i
                      of dimension p
                     
                        i
                      and a symmetric definite positive matrix M
                     
                        i
                      of dimensions p
                     
                        i
                     
                     ×
                     p
                     
                        i
                     . Moreover, a design matrix C
                     ={c
                     
                        iℓ} is defined with c
                     
                        iℓ
                     =1 if matrices Q
                     
                        i
                      and Q
                     ℓ are connected, and c
                     
                        iℓ
                     =0 otherwise. The core optimization problem considered in this paper is defined as follows:
                        
                           (1)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Maximize
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   ℓ
                                                   ,
                                                   i
                                                   ≠
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ℓ
                                             
                                          
                                          g
                                          (
                                          〈
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                ℓ
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                ℓ
                                             
                                          
                                          〉
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          c
                                          .
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          1
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          I
                                       
                                    
                                 
                              
                           
                        
                     where 〈x, y〉=
                     x
                     
                        t
                     
                     y is the usual scalar product and g stands for the identity, the absolute value or the square function. By setting 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 i
                              
                              
                                 1
                                 /
                                 2
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 Q
                              
                              
                                 i
                              
                           
                           
                              
                                 M
                              
                              
                                 i
                              
                              
                                 -
                                 1
                                 /
                                 2
                              
                           
                        
                      optimization problem (1) becomes
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Maximize
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   ℓ
                                                   ,
                                                   i
                                                   ≠
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ℓ
                                             
                                          
                                          g
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          c
                                          .
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          1
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          I
                                       
                                    
                                 
                              
                           
                        
                     A monotone convergent algorithm can be developed for optimization problem (2). This algorithm will be presented in detail in the next section. It is worth mentioning that all the multiblock and multigroup methods to be presented in this paper are special cases of optimization problem (2).

The following Lagrangian function related to optimization problem (2) is considered:
                        
                           (3)
                           
                              F
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    I
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    I
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       ℓ
                                       ,
                                       i
                                       ≠
                                       ℓ
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ℓ
                                 
                              
                              g
                              (
                              〈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    ℓ
                                 
                              
                              〉
                              )
                              -
                              φ
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                        
                     where λ
                     1, …, λ
                     
                        I
                      are the Lagrange multipliers, where φ
                     =1 when g is the identity or the absolute value and φ
                     =2 when g is the square function. We may suppose that 
                        
                           〈
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 ℓ
                              
                           
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           〉
                        
                      is different from 0, because if this were not the case, we would just set the design coefficient c
                     
                        iℓ to zero. Therefore, we may also consider the derivative g′ when g is the absolute value.

Canceling the derivatives of the Lagrangian function with respect to v
                     
                        i
                      and λ
                     
                        i
                      yields the following stationary equations:
                        
                           (4)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             φ
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                ℓ
                                                =
                                                1
                                                ,
                                                ℓ
                                                ≠
                                                i
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ℓ
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           
                        
                     with the normalization constraint
                        
                           (5)
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              .
                           
                        
                     These stationary equations have no closed-form solution, but they can be used to build a monotonically convergent algorithm for optimization problem (2).


                        Wold (1982, 1985) proposed a PLS (partial least squares) algorithm for component-based structural equation modeling. This approach can be applied to multiblock data (Tenenhaus, Esposito Vinzi, Chatelin, & Lauro, 2005). This PLS algorithm has a severe drawback: its convergence properties are unknown, except for some specific situations. The RGCCA algorithm proposed in Tenenhaus and Tenenhaus (2011) is a slightly modified PLS algorithm with known convergence properties. The RGCCA algorithm is extended in this paper in order to cover the multigroup situation.

It is useful to introduce the function w(x)=(1/φ)g′(x). The function w(x) is equal to 1 when g is equal to the identity, to x when g is equal to the square function and to sign(x) when g is equal to the absolute value. This function w(x) has a useful property: w(x)x
                        =
                        g(x) for g equal to the identity, to the square or to the absolute value. Indeed, if g is the identity w(x)x
                        =
                        x
                        =
                        g(x); if g is the square function w(x)x
                        =
                        x
                        2
                        =
                        g(x); and if g is the absolute value w(x)x
                        =
                        sign(x)×
                        x
                        =∣x∣=
                        g(x).

Using the “PLS path modeling” terminology, v
                        
                           i
                         is a vector of outer weights, y
                        
                           i
                        
                        =
                        P
                        
                           i
                        
                        v
                        
                           i
                         is called an outer component, and an inner component z
                        
                           i
                         is defined as follows:
                           
                              (6)
                              
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ℓ
                                          =
                                          1
                                          ,
                                          ℓ
                                          ≠
                                          i
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ℓ
                                    
                                 
                                 w
                                 (
                                 〈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 〉
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                              
                           
                        The inner component z
                        
                           i
                         represents the quantity between brackets in the stationary Eq. (4). For the various types of g functions, we obtain the following inner components:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             g
                                             =
                                             identity
                                             :
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                      ,
                                                      ℓ
                                                      ≠
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             g
                                             =
                                             square
                                             
                                             function
                                             :
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                      ,
                                                      ℓ
                                                      ≠
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             〈
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                             
                                             〉
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             g
                                             =
                                             absolute
                                             
                                             value
                                             :
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                      ,
                                                      ℓ
                                                      ≠
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             sign
                                             (
                                             〈
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                             
                                             〉
                                             )
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The inner component z
                        
                           i
                         is useful to simplify stationary Eq. (4). Using the normalization constraint (5), stationary Eq. (4) become
                           
                              (7)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 /
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                              
                           
                        It is worth noting that stationary Eq. (7) are also obtained by considering the maximum of 〈P
                        
                           i
                        
                        v
                        
                           i
                        , z
                        
                           i
                        〉 with respect to a vector v
                        
                           i
                         subject to the normalization constraint ∥v
                        
                           i
                        ∥=1. This result is central to the proof of Proposition 2 below. The following proposition (similar to Proposition 1 in Tenenhaus & Tenenhaus (2011)) specifies the role of the inner components in the criterion to be maximized.
                           Proposition 1
                           
                              For g equal to the identity, to the square, or to the absolute value, we obtain the following result:
                              
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                ℓ
                                                =
                                                1
                                                ,
                                                i
                                                ≠
                                                ℓ
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ℓ
                                          
                                       
                                       g
                                       (
                                       〈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ℓ
                                          
                                       
                                       〉
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                I
                                             
                                          
                                       
                                       〈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       〉
                                    
                                 
                              
                           

Equality (8) is obtained from the identity w(x)x
                              =
                              g(x) for g equal to the identity, to the square or to the absolute value:
                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   〈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   〉
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     ℓ
                                                                     =
                                                                     1
                                                                     ,
                                                                     ℓ
                                                                     ≠
                                                                     i
                                                                  
                                                                  
                                                                     I
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                                  ℓ
                                                               
                                                            
                                                            w
                                                            (
                                                            〈
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            〉
                                                            )
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ,
                                                            ℓ
                                                            =
                                                            1
                                                            ,
                                                            i
                                                            ≠
                                                            ℓ
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ℓ
                                                      
                                                   
                                                   w
                                                   (
                                                   〈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   〉
                                                   )
                                                   〈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   〉
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ,
                                                            ℓ
                                                            =
                                                            1
                                                            ,
                                                            i
                                                            ≠
                                                            ℓ
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ℓ
                                                      
                                                   
                                                   g
                                                   (
                                                   〈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   〉
                                                   )
                                                   
                                                   □
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

It is possible to construct a monotonically convergent algorithm related to optimization problem (2); that is to say, the bounded criterion 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    ℓ
                                    =
                                    1
                                    ,
                                    i
                                    ≠
                                    ℓ
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ℓ
                                 
                              
                              g
                              (
                              〈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    ℓ
                                 
                              
                              〉
                              )
                           
                         to be maximized in (2) increases at each step of the proposed iterative procedure. Stationary Eq. (7) and Proposition 1 suggest an iterative algorithm for optimization problem (2):
                           
                              •
                              Begin with arbitrary normalized outer weights v
                                 
                                    i
                                 , i
                                 =1, …, I.

Compute the inner component z
                                 
                                    i
                                  according to formula (6).

Compute new normalized outer weights using formula (7).

Iterate this procedure.

To obtain a monotonically convergent algorithm, it is necessary to use a sequence of operations similar to the ones used for RGCCA in Tenenhaus and Tenenhaus (2011). This PLS algorithm for optimization problem (2) is described in Algorithm 1. The procedure begins by an arbitrary choice of initial normalized outer weights vectors 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                           
                         (step A in Algorithm 1). Suppose outer weights vectors 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                    -
                                    1
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                           
                         have been constructed. The outer weight vector 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    s
                                    +
                                    1
                                 
                              
                           
                         is computed by considering the inner component 
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                           
                         given in step B in Algorithm 1, and the formula given in Step C in Algorithm 1. The procedure is iterated until convergence of the bounded criterion 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    ℓ
                                    =
                                    1
                                    ,
                                    i
                                    ≠
                                    ℓ
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ℓ
                                 
                              
                              g
                              (
                              〈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    ℓ
                                 
                              
                              〉
                              )
                           
                         which is due to proposition 2 below.
                           Proposition 2
                           
                              Let 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   1
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    s
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                 
                               
                              be a sequence of outer weight vectors generated by the PLS algorithm for optimization problem 
                              (2). Let f be the function defined by
                              
                                 
                                    (10)
                                    
                                       f
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             I
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                ℓ
                                                =
                                                1
                                                ,
                                                i
                                                ≠
                                                ℓ
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ℓ
                                          
                                       
                                       g
                                       (
                                       〈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ℓ
                                          
                                       
                                       〉
                                       )
                                    
                                 
                              
                              The following inequalities hold:
                              
                                 
                                    (11)
                                    
                                       ∀
                                       s
                                       
                                       f
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      I
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       f
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      s
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      s
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      I
                                                   
                                                   
                                                      s
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              The monotone convergence of 
                              Algorithm 1 
                              is guaranteed by inequality 
                              (11).

See appendix. □

A PLS algorithm for optimization problem (2). 
                                 
                                    
                                       
                                       
                                          
                                             
                                                A. Initialization
                                             
                                          
                                          
                                             Choose I arbitrary normalized vectors 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                Repeat (s
                                                =0, 1, 2, …)
                                          
                                          
                                             
                                                
                                                For 
                                                i
                                                =1, 2, …, I
                                             
                                          
                                          
                                             
                                                
                                                B. Computing the inner component 
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Compute the inner component according to the selected type of g function:
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            ℓ
                                                            <
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                            ℓ
                                                         
                                                      
                                                      w
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              ℓ
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              ℓ
                                                                           
                                                                           
                                                                              s
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            ℓ
                                                            >
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                            ℓ
                                                         
                                                      
                                                      w
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              ℓ
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              ℓ
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                where w(x)=1 when g is the identity, x when g is the square function and sign (x) when g is the absolute value.
                                          
                                          
                                             
                                                
                                                C. Computing the outer weight vector 
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Compute the outer weight vector
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                End For
                                             
                                          
                                          
                                             
                                                Until 
                                                
                                                   
                                                      f
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      f
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ⩽
                                                      ε
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

In the multiblock framework, a column partition X
                     =[X
                     1, …, X
                     
                        j
                     , …, X
                     
                        J
                     ] is defined. Each n
                     ×
                     p
                     
                        j
                      data matrix X
                     
                        j
                      is called a block and represents a set of p
                     
                        j
                      standardized variables observed on the same set of n individuals. In the event of unbalanced block size, it is possible to divide each block by 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                      to make them comparable. We associate with each block X
                     
                        j
                     , a block component X
                     
                        j
                     
                     w
                     
                        j
                      (where w
                     
                        j
                      is a weight column vector of dimension p
                     
                        j
                     ) and a p
                     
                        j
                     
                     ×
                     p
                     
                        j
                      positive definite symmetric matrix M
                     
                        j
                     . The role of M
                     
                        j
                      will be clarified later in the paper. Moreover, a design matrix C
                     ={c
                     
                        jk
                     } is defined with c
                     
                        jk
                     
                     =1 if blocks j and k are related, and c
                     
                        jk
                     
                     =0 otherwise. The following optimization problem is considered:
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Maximize
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   j
                                                   ≠
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                jk
                                             
                                          
                                          g
                                          (
                                          cov
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          c
                                          .
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          1
                                          ,
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          J
                                       
                                    
                                 
                              
                           
                        
                     where g stands for the identity, the absolute value or the square function. The block components being centered, cov(X
                     
                        j
                     
                     w
                     
                        j
                     , X
                     
                        k
                     
                     w
                     
                        k
                     ) is equal to (1/n)〈X
                     
                        j
                     
                     w
                     
                        j
                     , X
                     
                        k
                     
                     w
                     
                        k
                     〉. Therefore optimization problem (12) is a special case of optimization problem (2) with Q
                     
                        i
                     
                     =
                     X
                     
                        i
                      and m equals to the number n of individuals.

For each block, higher dimension components can be obtained by using orthogonality constraints on the previous block components. Orthogonality is insured by considering the residual matrices in the regression of each block X
                     
                        j
                      on the previous block components (deflation process). Optimization problem (12) is then applied to these residual matrices to obtain higher dimension components.

RGCCA, initially described in Tenenhaus and Tenenhaus (2011), is a special case of problem (12) with 
                        
                           
                              
                                 M
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 τ
                              
                              
                                 j
                              
                           
                           I
                           +
                           (
                           1
                           -
                           
                              
                                 τ
                              
                              
                                 j
                              
                           
                           )
                           
                              
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 X
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 j
                              
                           
                        
                     , the shrinkage constant τ
                     
                        j
                      varying between 0 and 1. When τ
                     
                        j
                     
                     =1 problem (12) gathers covariance-based multiblock methods; when τ
                     
                        j
                     
                     =0 problem (12) gathers correlation-based multiblock methods; and when 0<
                     τ
                     
                        j
                     
                     <1 problem (12) insures a continuum between these two approaches. To follow the nomenclature of PLS path modeling in this paper, a choice of τ
                     
                        j
                     
                     =1 is also called “mode A” and a choice of τ
                     
                        j
                     
                     =0 “mode B”.

All the various methods described in Tables 2–5
                     
                     
                     
                      are special cases of problem (12). It is quite remarkable that a single, very simple monotone convergent algorithm can be used for all those methods. A full description of these methods is given in Tenenhaus and Tenenhaus (2011) and references therein.

In the multigroup framework, a row partition 
                        
                           X
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      of the data matrix is considered. In this framework, the same set of variables is observed on different groups of individuals. Each n
                     
                        i
                     
                     ×
                     p matrix X
                     
                        i
                      is called a group and represents a set of p centered and normalized (i.e. unit norm) variables observed on a set of n
                     
                        i
                      individuals. This normalization implies that (i) the correlation matrix R
                     
                        i
                      related to X
                     
                        i
                      is equal to 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      and (ii) the correlation matrix R related to the whole data matrix X is equal to 
                        
                           
                              
                                 R
                              
                              
                                 ¯
                              
                           
                           =
                           (
                           1
                           /
                           I
                           )
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        
                     .

The SCA approach for multigroup data analysis is global: for each group, q components are found in one step. However the weight matrix W (in SCA-W) or the pattern matrix P (in SCA-P, SCA-PF2, SCA-IND, SCA-ECP) must be the same for all groups, or column-wise proportional for the loading matrix L (in SCA-S).

In this paper, we propose to use RGCCA for multigroup data analysis. This approach is more flexible than SCA as regards group-loading vectors in that they do not have to be the same across groups. The objective of RGCCA for multigroup data analysis is to find group-loading vectors with small angles and high norms. However, the group-loading vectors are obtained sequentially: the related group components are constrained to be orthogonal to the previous ones. A p
                     ×
                     p positive definite symmetric matrix M
                     
                        i
                      is associated with each X
                     
                        i
                     . A design matrix C
                     ={c
                     
                        iℓ} and a function g are defined as previously in problem (12).

The following optimization problem is considered:
                        
                           (13)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Maximize
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   ℓ
                                                   ,
                                                   i
                                                   ≠
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ℓ
                                             
                                          
                                          g
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          c
                                          .
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          1
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          I
                                       
                                    
                                 
                              
                           
                        
                     This optimization problem is a special case of optimization problem (2) with 
                        
                           
                              
                                 Q
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      and m and p
                     
                        i
                      both equal to the number p of variables. Vector 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      is called a group-loading vector. We also introduce the standardized group-loading vector 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           /
                           ‖
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ‖
                        
                     . Due to the unit norm of each column of 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           /
                           ‖
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ‖
                        
                      represents the vector of correlations between the columns of X
                     
                        i
                      and the group component X
                     
                        i
                     
                     w
                     
                        i
                     .

We now consider three typical situations which give a good idea of the generality and powerfulness of the optimization problem (13) for multigroup data analysis.

We consider a situation where all groups are related: c
                        
                           iℓ
                        =1 for all i
                        ≠ℓ. The matrix 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         is considered for each group. Therefore, in this situation, matrices X
                        
                           i
                         are supposed to be full rank (M
                        
                           i
                         is supposed to be positive definite, see Section 2). For g equals to the identity, problem (13) becomes:
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      ℓ
                                                      ,
                                                      i
                                                      ≠
                                                      ℓ
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ℓ
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        As the maximization of 
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         s.c. ∥X
                        
                           i
                        
                        w
                        
                           i
                        ∥=1 yields the normalized first principal component of group X
                        
                           i
                        , problem (14) leads to a compromise between separate one dimension PCA’s of the various groups X
                        
                           i
                        ’s and group-loading vectors with small angles. Due to the chosen normalization, the group-loading vectors 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         represent the vectors of correlations between the various columns x
                        
                           ij
                         of group X
                        
                           i
                         and the group component X
                        
                           i
                        
                        w
                        
                           i
                        . Due to cosines being as high as possible between the group-loading vectors, interpretations of the various group components are expected to be similar.

Higher dimension solutions are searched for by deflation on the previous components. Let us examine in detail the procedure for the second dimension. We denote by 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           
                         the optimal solution for problem (14). The second dimension components are constrained to be orthogonal to the first dimension components. The second dimension solution is thus obtained by considering the following optimization problem:
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      ℓ
                                                      ,
                                                      i
                                                      ≠
                                                      ℓ
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ℓ
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             
                                             and
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        As any vector X
                        
                           i
                        
                        w
                        
                           i
                         orthogonal to 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         can be written as 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         where 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         is the residual matrix of the regression of X
                        
                           i
                         on 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                        , problem (15) can also be written as
                           
                              (16)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      ℓ
                                                      ,
                                                      i
                                                      ≠
                                                      ℓ
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ℓ
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        As 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         is orthogonal to 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                        , we obtain the following equality: 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                        . Therefore optimization problem (16) becomes equivalent to optimization problem (17):
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      ℓ
                                                      ,
                                                      i
                                                      ≠
                                                      ℓ
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   1
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ℓ
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            1
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        Therefore, searching for the second dimension group-loading vectors boils down to replacing in optimization problem (14) each matrix X
                        
                           i
                         by the residual matrix 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         of the regression of X
                        
                           i
                         on the first dimension group component 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                        . The same procedure is used for higher dimensions.

Dataset matrices X
                        
                           i
                         are not necessarily full rank. When this full rank condition is not satisfied, we may modify problem (14) by using M
                        
                           i
                        
                        =
                        I for each group and consider this new problem:
                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      ℓ
                                                      ,
                                                      i
                                                      ≠
                                                      ℓ
                                                   
                                                
                                             
                                             cos
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             ‖
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        As the maximization of 
                           
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         s.c. ∥w
                        
                           i
                        ∥=1 also yields the first principal component of group X
                        
                           i
                        , problem (18) also leads to a compromise between separate one dimension PCA’s of the various groups X
                        
                           i
                        ’s and group-loading vectors with small angles. So, what is the difference between problems (14) and (18)? The criterion used in (18) can be re-written using standardized group-loading vectors and this yields the following expression:
                           
                              (19)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          ℓ
                                          ,
                                          i
                                          ≠
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          cos
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                          
                                          ×
                                          
                                             
                                                Var
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ×
                                          
                                             
                                                Var
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                )
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                                
                                                   
                                                      cor
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                                
                                                   
                                                      cor
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ℓ
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Therefore, group sizes are taken into account in problem (18) and not in problem (14).

Higher dimension solutions will be sought by deflation as explained above.

We consider a super-group X
                        
                           I+1 equal to the row concatenation of the various groups X
                        
                           i
                         followed by a normalization: 
                           
                              
                                 
                                    X
                                 
                                 
                                    I
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              /
                              
                                 
                                    I
                                 
                              
                           
                        . This insures that each column of X
                        
                           I+1 has a norm equal to 1. From this we deduce
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       I
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       I
                                       +
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       I
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                X
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 [
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       I
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       ‾
                                    
                                 
                              
                           
                        We consider a situation where all groups 1 to I are only related to the super-group X
                        
                           I+1: c
                        
                           iℓ
                        =1 for i
                        =1, …, I, ℓ=
                        I
                        +1 and 0 otherwise. Matrix 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         is considered for each group and for the super-group.

For g equals to the square function, optimization problem (13) becomes:
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   cos
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            I
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            I
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            I
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               I
                                                               +
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               I
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               I
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                             +
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Optimization problem (20) leads to a compromise between the various one-dimension PCA’s of the X
                        
                           i
                        ’s, the one-dimension PCA of X
                        
                           I+1 and small angles between the group-loading vectors and the super-group-loading vector. Due to the chosen normalization, the loading vectors 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         represent the vectors of correlations between the various columns of each group X
                        
                           i
                         and their group component X
                        
                           i
                        
                        w
                        
                           i
                        . The solution of optimization problem (20) and useful properties are given in proposition 3 below.
                           Proposition 3
                           
                              Let 
                              w
                              
                                 1
                              
                              , …, 
                              w
                              
                                 I+1
                               
                              be the solution of optimization problem 
                              (20). The following results are obtained:
                              
                                 
                                    (a)
                                    
                                       The super-group-weight vector 
                                       w
                                       
                                          I+1
                                        
                                       is the eigenvector of 
                                       R
                                       
                                          I+1
                                        
                                       associated with the largest eigenvalue.
                                    


                                       The group-weight vector 
                                       w
                                       
                                          i
                                        
                                       is equal to 
                                       w
                                       
                                          I+1
                                       
                                       /∥X
                                       
                                          i
                                       
                                       w
                                       
                                          I+1
                                       ∥.
                                    


                                       The super-group component 
                                       t
                                       
                                          I+1
                                       
                                       
                                       =
                                       
                                       X
                                       
                                          I+1
                                        
                                       w
                                       
                                          I+1
                                        
                                       is the normalized first principal component of 
                                       X
                                       
                                          I+1
                                       
                                       .
                                    


                                       The group component 
                                       t
                                       
                                          i
                                       
                                       
                                       =
                                       
                                       X
                                       
                                          i
                                       
                                       w
                                       
                                          i
                                        
                                       is equal to 
                                       X
                                       
                                          i
                                       
                                       w
                                       
                                          I+1
                                       
                                       /∥X
                                       
                                          i
                                       
                                       w
                                       
                                          I+1
                                       ∥; this means that 
                                       t
                                       
                                          i
                                        
                                       is the normalized fragment of 
                                       t
                                       
                                          I+1
                                        
                                       related to group i.
                                    


                                       The cosine between the group-loading vector 
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                          
                                        
                                       and the super-group-loading vector 
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                          
                                        
                                       is positive. This means that all group-loading vectors are pointing out in the direction of the super-group-loading vector.
                                    

Setting t
                              
                                 i
                              
                              =
                              X
                              
                                 i
                              
                              w
                              
                                 i
                              , i
                              =1, …, I
                              +1 optimization problem (20) can also be written as
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Maximize
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  I
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     I
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     I
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   c
                                                   .
                                                   
                                                   ‖
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ‖
                                                   =
                                                   1
                                                   ,
                                                   
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   I
                                                   +
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              For a fixed vector t
                              
                                 I+1, maximization of 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               s.c. ∥t
                              
                                 i
                              ∥=1 yields
                                 
                                    (22)
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             I
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             I
                                             +
                                             1
                                          
                                       
                                       /
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and consequently
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      I
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Therefore problem (21) becomes
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         Maximize
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               I
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         I
                                                         +
                                                         1
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     I
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     I
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         I
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   c
                                                   .
                                                   
                                                   ‖
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         I
                                                         +
                                                         1
                                                      
                                                   
                                                   ‖
                                                   =
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The solution of problem (24) is obtained for the normalized first principal component of X
                              
                                 I+1. This gives points (a) and (c). Using Eq. (22), we deduce points (b) and (d). Eq. (23) leads to point (e). □


                        Remarks
                        
                           
                              (1)
                              It is quite remarkable that optimization problem (20) produces group-weight vectors w
                                 
                                    i
                                  all proportional to the super-group-weight vector w
                                 
                                    I+1, although this was not a constraint of the problem.

Optimization problem (20) has already been considered in Eslami et al. (2013a).

SCA-P and optimization problem (20) give the same results for q
                                 =1. This property is also verified for q
                                 >1 provided that the deflation procedure is carried out in optimization problem (20) on the super-group only.

If orthogonality is required for higher dimension solutions at group and super-group levels, the RGCCA algorithm can be used. This will be illustrated in Section 7.2. SCA-IND and SCA-ECP yield also orthogonal components at the group level.

RGCCA for multiblock data is illustrated on a dataset describing a tasting experiment on various red Loire wines. This dataset has already been analyzed using PLS path modeling in Tenenhaus and Esposito Vinzi (2005) and in Tenenhaus and Tenenhaus and Hanafi (2010).

This dataset is fully described in Pagès, Asselin, Morlat, and Robichet (1987). It concerns a set of 21 red wines with Bourgueil, Chinon and Saumur origins, produced on 4 soils, and described by 27 variables grouped into four blocks (Olfaction at rest, View, Olfaction after shaking and Tasting). The description of the four blocks is given below:
                           
                              
                                 X
                                 1
                                 =
                                 Olfaction at rest
                              

Rest1=olfaction intensity at rest, Rest2=aromatic quality at rest, Rest3=fruity note at rest, Rest4=floral note at rest, Rest5=spicy note at rest.


                                 X
                                 2
                                 =
                                 View
                              

View1=visual intensity, View2=shading (from orange to purple), View3=surface impression.


                                 X
                                 3
                                 =
                                 Olfaction after shaking
                              

Shaking1=olfaction intensity, Shaking2=olfaction quality, Shaking3=fruity note, Shaking4=floral note, Shaking5=spicy note, Shaking6=vegetable note, Shaking7=phenolic note, Shaking8=aromatic intensity in the mouth, Shaking9=aromatic persistence in the mouth, Shaking10=aromatic quality in the mouth.


                                 X
                                 4
                                 =
                                 Tasting
                              

Tasting1=intensity of attack, Tasting2=acidity, Tasting3=astringency, Tasting4=alcohol. Tasting5=balance (acidity, astringency, alcohol), Tasting6=mellowness, Tasting7=bitterness, Tasting8=final intensity in the mouth, Tasting9=harmony.

Furthermore, a global quality measure is available for each wine. This is an illustrative variable to be used for interpreting the results of the multiblock data analysis.

The main aim of multiblock data analysis is to investigate the relationships between blocks. We propose in this paper a two-step methodology. The first step consists in searching a set of sub-blocks of the various blocks such that all the variables belonging to this set of sub-blocks are well correlated. This set of sub-blocks is found by considering variables well correlated with the first principal component of the whole data table. The second step consists in applying RGCCA for multiblock data analysis to this set of sub-blocks (one of the methods given in Table 2) in order to modeling the relationships between the sub-blocks. Then we can repeat this methodology on the variables which have not been selected at the first step.

Multiblock principal component analysis (MBPCA) applied to blocks X
                           1, X
                           2, X
                           3, X
                           4 (see Table 5, footnote c) plays an implicit central role in this step. It corresponds to the following optimization problem:
                              
                                 (25)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Maximize
                                                      
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      Cov
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      5
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                c
                                                .
                                                
                                                ‖
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                                =
                                                1
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                5
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           where X
                           5 is the super-block [X
                           1, X
                           2, X
                           3, X
                           4].

It is a special case of RGCCA with mode A (special case of problem (12) with M
                           
                              j
                           
                           =
                           I) for the four original blocks and for the super-block and g equals to the square function. It is worth pointing out that the RGCCA algorithm has not to be used because problem (25) is similar to problem (20) above. For a fixed vector w
                           5, the solution of optimization problem (25) is obtained for 
                              
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       5
                                    
                                 
                                 /
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                5
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                 
                              
                           .

Using the following expression
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       
                                          Cov
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          5
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          5
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      5
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          5
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          5
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          5
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          5
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          5
                                       
                                    
                                 
                              
                           optimization problem (25) boils down to maximizing 
                              
                                 
                                    
                                       w
                                    
                                    
                                       5
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   5
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   5
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       5
                                    
                                 
                              
                            s.c. ∥w
                           5 ∥=1.


                              
                                 
                                    (1)
                                    The super-block component X
                                       5
                                       w
                                       5 is exactly the first principal component of the super-block X
                                       5 and the vectors w
                                       
                                          j
                                       ’s are the normalized fragments of w
                                       5 related to block X
                                       
                                          j
                                       . In fact, an “average” one-component PLS regression between the super-block and each original block is equivalent to separate one-component PLS regressions between the first principal component of the super-block and each original block.

Optimization problem (25), multiple co-inertia analysis (MCoA) (Chessel & Hanafi, 1996) and consensus PCA (version CPCA-W by Smilde et al., 2003) have similar solution: the super-block component is the first principal component of the super-block (usual one for problem (25) and normalized one for MCoA and CPCA-W); block components are the same for the three methods.

We may consider that the variables well-correlated with the first principal component of the super-block are defining sub-blocks which are interconnected.

The set of related sub-blocks is well summarized by the first principal component of the “super-sub-block”. This is intuitive, but also justified by MBPCA which takes into account the block structure.

Results of PCA on the whole dataset are given in Table 6
                              . We decide to study in this section the set of sub-blocks built with variables correlated to the first principal component and to global quality.

We may use the SUMCOV method (see Table 2) to relate the sub-blocks. The following optimization problem is considered:
                              
                                 (27)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Maximize
                                                      
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                         =
                                                         1
                                                         ,
                                                         j
                                                         ≠
                                                         k
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                Cov
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                c
                                                .
                                                
                                                ‖
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                                =
                                                1
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                4
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           RGCCA with mode A for all blocks and g equals to the identity is used to solve optimization problem (27). This problem (27) can be considered as an “average” one-component PLS regression between the various pairs of blocks X
                           
                              j
                            and X
                           
                              k
                           .

The multiblock analysis has been carried out with the RGCCA R package (Tenenhaus & Guillemot, 2013). RGCCA is also available in the PLS-PM option of the XLSTAT software (Addinsoft, 2013). Using the SUMCOV criterion on the set of sub-blocks selected in step 1, we obtain the results given in Fig. 1
                              . Based on a bootstrap strategy, all correlations which appear in Fig. 1 are significant.

We summarize all the variables appearing in Fig. 1 by their standardized first principal component. Using this component (labeled Factor 1) and global quality, we obtain the graphical display shown in Fig. 2
                              : wines are visualized using soil markers (actually, appellation is not a good indicator of quality for these Loire wines). High quality wines coming from the reference soil are well recognized by the experts. The reader interested in wine can even detect that the Saumur 1DAM is one of the best wines from this sample. We can testify that we drank outstanding Saumur-Champigny produced at Dampierre-sur-Loire.

@&#DISCUSSION@&#

The selected variables are related to global quality. RGCCA for multiblock data analysis brings out the fact that experts are able to connect the four sub-blocks described in Fig. 1. They are able to predict the taste of wine from a three-step inspection: (1) olfaction at rest, (2) view and (3) olfaction after shaking. For example, harmony (tasting9) is well correlated to its block component (corr =.963) and also to the other block paragons: correlation of harmony with aromatic quality at rest (rest2) is equal to .672; with visual intensity (view1) correlation is equal to .806; and with aromatic quality in mouth (shaking10) correlation is equal to .808.


                     De Roover, Ceulemans, Timmerman, Vansteelandt et al. (2012) illustrated and motivated Clusterwise SCA-ECP through an example stemming from social psychology. In this section, RGCCA for multigroup data analysis and Clusterwise SCA-ECP are compared in a simplified version of this example.

This example is related to the public good dilemma. Public goods are goods where everyone will gain a benefit if the good is produced, whether they pay for it or not. Those who pay for the public good are named cooperators and those who do not pay are named free-riders. The example describes the emotional reactions of 282 participants (playing the role of cooperators) in the presence of free-riders under various equality/empathy conditions. Both players receive a reward. In the equality condition (E), the rewards for the cooperator and the free-rider are equal, but in the unequal condition (UE) the free-rider receives a higher reward. Some information on the free-rider is eventually given to the cooperator. In the high empathy condition (HE), the cooperator receives a message about a negative personal event that happened to the free-rider and is asked to imagine how the free-rider feels. In the low empathy condition (LE), the cooperator also receives a message, but is asked to take an objective perspective. In the control condition (C), the cooperator does not receive any message. The two equality conditions (E/UE) are fully crossed with the three empathy conditions (HE/LE/C). The 282 participants are partioned in 6 equality/empathy groups and are asked how they feel about 21 emotion terms. Using the results of De Roover et al., we have simplified the example by selecting 8 emotion terms only: Frustated, Fearful, Surprised, Happy, Satisfied, Sympathetic, Tenderhearted, Tender. These terms have been selected from Table 6 of their paper in order to maintain the same similarities and differences between equal and unequal conditions groups while limiting redundancy. RGCCA for multigroup data analysis is used on this simplified example.

The whole data matrix X is partitioned into 6 groups: X
                        1 for the 47 participants of the E/HE group, X
                        2 for the 46 participants of the E/LE group, X
                        3 for the 48 participants of the E/C group, X
                        4 for the 47 participants of the UE/HE group, X
                        5 for the 48 participants of the UE/LE group and X
                        6 for the 46 participants of the UE/C group. Each column j of each group i is centered and normalized. In addition, a super-group X
                        7 is obtained by row concatenation of the 6 groups X
                        
                           i
                         and division by 
                           
                              
                                 
                                    6
                                 
                              
                           
                        .

RGCCA for multigroup data analysis is sequential. A first common dimension to the 6 groups is sought by considering the following optimization problem:
                           
                              (28)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   7
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   7
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   7
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            7
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                             =
                                             1
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             7
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        This optimization problem is similar to situation 3 above, but with g equal to the identity instead of the square function. Therefore optimization problem (28) yields a compromise between PCA of each group and of the super-group and small angles between group-loading vectors and the super-group-loading vector. The obtained loading vectors 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         are given in Table 7
                        .

The average variance explained (AVE) by a component is defined as the mean of the square correlations between the variables and the component. We notice that the ratios AVE(RGCCA)/AVE(PCA) as well as the cosines between the group-loading vectors and the super-group-loading vector are fairly high for all groups. We also notice that the super-group component is very close to the first principal component of the super-group (very close AVE). Optimization problem (28) (the g function is equal to the identity) and optimization problem (20) (g is the square function) yield very similar results.

Then, second components orthogonal to the previous ones are obtained by considering the following optimization problem:
                           
                              (29)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                             cos
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   7
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   7
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   7
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            7
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                             =
                                             1
                                             
                                             and
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             0
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             7
                                          
                                       
                                    
                                 
                              
                           
                        Optimization problem (29) is solved by deflation as explained in Section 5.1. The second dimension group-loading vectors 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                         are given in Table 8
                        . All cosines between the group-loading vectors (dim 2) and the super-group-loading vector (dim 2) are fairly high for all groups. We may notice that the ratios AVE(RGCCA)/AVE(PCA) for two components are all close to 1.

The use of RGCCA described here is closer to SCA-ECP (or to SCA-IND) than to SCA-P because orthogonal group and super-group components have been sought.

We now study the proximities between groups with respect to their loadings. Due to the method used, all group-loading vectors for dimensions 1 and 2 are pointing out in the same direction. More precisely, the cosines between group-loading vectors given in Table 7 for dimension 1 and in Table 8 for dimension 2 are all positive. Therefore, it makes sense to row concatenate group-loading vectors for dimensions 1 and 2. Cosines between these vectors measure similarities between groups and are given in Table 9
                        . A partition of the 6 groups into two clusters (Equal vs. Unequal conditions) clearly appears in Table 9 and Fig. 3
                        : the correlation structures between the 8 variables are more similar within equality conditions than between equality conditions.

To better identify the difference between equal and unequal conditions with respect to correlation structure, separate PCA are carried out with oblique rotation for each equality condition. Correlations between the data normalized by group and the rotated factors are given in Table 10
                        .

Five items have similar loadings on both components for the two clusters. These 5 items also have similar loadings across the 6 groups (they are put in bold normal in Tables 7, 8 and 10). Using these 5 items, the interpretation of components is similar for both clusters: first component opposes positive affect (happy, satisfied) to negative affect (frustrated); second component is related to empathy (tenderhearted, tender). However, a very different loading pattern across the two clusters is found for three emotions: fearful, surprised and sympathetic (they are put in bold italic in Tables 7, 8 and 10). As De Roover et al. obtained very similar results using Clusterwise SCA-ECP on the complete dataset, we may summarize their interpretation of these differences:
                           
                              (1)
                              Fearful is negatively correlated to the first component in the equal condition cluster; therefore it is a negative affect for this cluster. Fearful is positively correlated to the second component in the unequal condition cluster; people of this cluster who react empathically also feel fearful (more details on this point are given in De Roover et al.).

Sympathetic is uncorrelated to both components in the equal condition cluster. Sympathetic is positively correlated to the emotion component in the unequal condition cluster; people of this cluster who react with sympathy to the free-riders because they take into account some negative personal event that happened to them also feel tenderhearted.

Surprise is positively correlated to the empathy component in the equal condition cluster. Therefore in this cluster, it is a positive emotion. Surprise is negatively correlated to the first component in the unequal condition cluster. In this cluster this emotion is negative and associated with frustration.

Clusterwise SCA-ECP is defined in De Roover, Ceulemans, and Timmerman (2012). They consider the following optimization problem:
                           
                              (30)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Maximize
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     I
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     K
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     IK
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  k
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  K
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               ik
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             c
                                             .
                                             
                                             (
                                             1
                                             /
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             I
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        where W
                        
                           i
                         is a p
                        ×
                        q (q
                        <
                        p) weight matrix related to group X
                        
                           i
                        , i
                        =1,…, I, P
                        
                           k
                         a p
                        ×
                        q pattern matrix related to cluster k, k
                        =1,…, K and g
                        
                           ik
                        
                        =1 if group X
                        
                           i
                         belongs to cluster k and g
                        
                           ik
                        
                        =0 otherwise. We have used the Multiblock component analysis (MBCA) software (downloaded from http://ppw.kuleuven.be/okp/software/MBCA/) on the above example for q
                        =2 and K
                        =1 to 6. For K
                        =1 cluster, optimization problem (30) corresponds to SCA-ECP. For K
                        =6 clusters, optimization problem (30) corresponds to separate PCA on each group X
                        
                           i
                        .

Denoting by L
                        
                           K
                         the loss function in (30), the percentage of variance accounted for (VAF) is defined in De Roover et al. by
                           
                              (31)
                              
                                 VAF
                                 (
                                 K
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             I
                                          
                                       
                                       ‖
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             L
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             I
                                          
                                       
                                       ‖
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        De Roover et al. select the optimal number of clusters by using the maximal value of the Scree ratio defined by
                           
                              (32)
                              
                                 SR
                                 (
                                 K
                                 )
                                 =
                                 
                                    
                                       VAF
                                       (
                                       K
                                       )
                                       -
                                       VAF
                                       (
                                       K
                                       -
                                       1
                                       )
                                    
                                    
                                       VAF
                                       (
                                       K
                                       +
                                       1
                                       )
                                       -
                                       VAF
                                       (
                                       K
                                       )
                                    
                                 
                              
                           
                        Values of VAF and SR for K
                        =1 to 6 are given in Table 11
                        . This leads to the choice of two clusters. The first cluster contains all equal conditions and the second cluster all unequal conditions. Therefore, RGCCA and Clusterwise SCA-ECP lead to the same two clusters on this example. The oblique rotation option has been selected in the MBCA program. Correlations between the normalized data and the rotated factors are given in Table 12
                        . Comparing Tables 10 and 12, we may conclude that PCA and SCA-ECP (both followed by an oblique rotation) give very similar results on this example. Both methods reveal the basic structure of the data.

@&#CONCLUSION@&#

In this paper, the distinction between multiblock and multigroup data analysis is clearly defined. Multiblock data concerns the case of several sets of variables observed on the same individuals, while multigroup data concerns the situation where the same variables are observed on several sets of individuals. The main aim of multiblock data analysis is to investigate the relationships between blocks, while the main aim of multigroup data analysis is to investigate the relationships among variables within the various groups. We have shown in this paper that a single simple and powerful algorithm can be used for both multiblock and multigroup data. In the multiblock situation, RGCCA is applied on the blocks 
                        
                           
                              
                                 X
                              
                              
                                 j
                              
                              
                                 ′
                              
                           
                        
                      s while in the multigroup situation it is applied on the within-group correlation matrices 
                        
                           
                              
                                 R
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      s.

Much experience has been accumulated in multiblock data analysis and an overview of these methods is presented from a RGCCA perspective. The novelty of this paper concerns the extension of RGCCA to the multigroup situation. RGCCA for multigroup data analysis is based on the idea of carrying out connected PCA’s on the various groups of individuals.

It is worth pointing out that PCA plays a central role in multiblock and multigroup data analysis. Well-known reference methods such as Consensus PCA for multiblock data and SCA-P for multigroup data boil down to a PCA of the whole data table (after preprocessing) and are both a special case of RGCCA.

We have illustrated RGCCA for multiblock data on a wine testing example. We have compared RGCCA for multigroup data and Clusterwise SCA-ECP on an example from the field of social psychology.

@&#ACKNOWLEDGEMENTS@&#

We would like to gratefully thank the three anonymous referees for their comments which have greatly improved our manuscript.

The proof of Proposition 2 relies on the following lemma, where the outer weight vectors 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 s
                              
                           
                        
                      and the inner component 
                        
                           
                              
                                 z
                              
                              
                                 i
                              
                              
                                 s
                              
                           
                        
                      are defined in Algorithm 1:
                        Lemma 1
                        
                           For i
                           
                           =
                           
                           1, …, I, s
                           
                           =
                           
                           0, 1, 2, …, let 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                              
                            
                           be the function defined by
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Then the following property holds:
                           
                              
                                 (33)
                                 
                                    ∀
                                    s
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The function 
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                            may be written as
                              
                                 (34)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    w
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    w
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      <
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             w
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      >
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             w
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Using the definitions of 
                              
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                              
                           , the following inequality holds:
                              
                                 (35)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and we get the equality
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    w
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    w
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Then, we have to consider separately the three types of function g.


                           
                              g
                           
                           
                           
                              =
                           
                           
                           
                              identity and w (x)
                           
                           
                           
                              =
                           
                           
                           1
                        

In this situation, equality (36) becomes
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and therefore 
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                s
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           .


                           
                              g
                           
                           
                           
                              =
                           
                           
                           
                              absolute value and w(x)
                           
                           
                           
                              =
                           
                           
                           
                              sign(x)
                           
                        

In this situation, equalities (34) and (36) become respectively
                              
                                 (38)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Therefore, we obtain
                              
                                 (40)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              g
                           
                           
                           
                              =
                           
                           
                           
                              square function and w(x)
                           
                           
                           
                              =
                           
                           
                           
                              x
                           
                        

In this situation, equalities (34) and (36) become respectively
                              
                                 (41)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                   
                                                   
                                                      s
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           and
                              
                                 (42)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             <
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ℓ
                                             >
                                             i
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The right term of (42) is the scalar product between two vectors. Using the Cauchy–Schwartz inequality and the fact that 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ℓ
                                    
                                 
                              
                           , we obtain
                              
                                 (43)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         ℓ
                                                         <
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  s
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         ℓ
                                                         >
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         ℓ
                                                         <
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  s
                                                                  +
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  s
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         ℓ
                                                         >
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  s
                                                                  +
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                           From that we deduce
                              
                                 (44)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      s
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      s
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                           and therefore
                              
                                 (45)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                    □
                                 
                              
                           
                        


                           Proposition 2 is deduced from lemma 1 and the following equality:
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      <
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      >
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      <
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      >
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      <
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ℓ
                                                      >
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             ℓ
                                             =
                                             1
                                             ,
                                             i
                                             ≠
                                             ℓ
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             ℓ
                                             =
                                             1
                                             ,
                                             i
                                             ≠
                                             ℓ
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ℓ
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             f
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            s
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             f
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    □
                                 
                              
                           
                        

@&#REFERENCES@&#

