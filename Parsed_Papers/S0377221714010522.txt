@&#MAIN-TITLE@&#Optimal deleveraging with nonlinear temporary price impact

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a portfolio management model to balance equity and liability.


                        
                        
                           
                           Efficient frontiers are constructed to visualize tradeoff between equity/liability.


                        
                        
                           
                           We further study portfolio management under leverage requirement.


                        
                        
                           
                           The deleveraging problem is a non-convex constrained polynomial program.


                        
                        
                           
                           An efficient algorithm is developed to solve the polynomial optimization problem.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Portfolio deleveraging

Equity and liability

Polynomial optimization

Nonlinear temporary price impact

Lagrangian method

@&#ABSTRACT@&#


               
               
                  In this paper, we first propose a portfolio management model where the objective is to balance equity and liability. The asset price dynamics includes both permanent and temporary price impact, where the permanent impact is a linear function of the cumulative trading amount and the temporary impact is a kth (between 0 and 1) order power function of the instantaneous trading rate. We construct efficient frontiers to visualize the tradeoff between equity and liability and obtain analytical properties regarding the optimal trading strategies. In the second part, we further consider an optimal deleveraging problem with leverage constraints. It reduces to a non-convex polynomial optimization program with polynomial and box constraints. A Lagrangian method for solving the problem is presented and the quality of the solution is studied.
               
            

@&#INTRODUCTION@&#

It is pointed out in the world bank report (D’Hulster, 2009) that one of the main contributors to the recent global financial crisis is the excessive leverage of financial institutions. As a result, the leverage ratio, a non-risk-based capital measure, has been introduced to supplement minimum capital requirements (Basel Committee on Banking Supervision, 2011). The leverage ratio, or equivalently, the debt-to-equity ratio, is a key factor that reflects an institution’s ability to bear risk and sustain losses. By analyzing 15 trading losses with amounts exceeding $1 billion since 1990, Barth and McCarthy (2012) finds that a strong capital ratio, or equivalently, a small leverage ratio, allows an institution to withstand difficult economic times and survive from catastrophes better. Keeping a good balance between equity and liability is thus particularly important to individual institutions as well as to the financial system as a whole.

Asset and liability management has been widely studied in the field of financial accounting (see Carino and Ziemba, 1998; Kusy and Ziemba, 1986; Zenios, 1995; Ziemba and Mulvey, 1998). The main purpose of asset and liability management is to choose a portfolio of the least cost or maximal return so that the asset meets the liability. See Zenios and Ziemba (2006) for a comprehensive survey of the theories and methodologies for asset and liability management. In our article, we propose a portfolio management model where the objective is to obtain a good balance between equity and liability during a rapid deleveraging process. With a pre-determined leverage ratio as a benchmark, we define the excessive liability as the difference between the actual and the benchmark liabilities. The higher the excessive liability, the further the leverage ratio is away from the desired level. Hence, the excessive liability, to some extent, can be viewed as a risk measure. We take into account that rapidly deleveraging a portfolio to reduce excessive liability is costly and market impact must be considered. There is a vast literature on how to liquidate portfolios to minimize both trading cost and trading risk. Various risk measures have been suggested (see Almgren and Chriss, 2000; Forsyth, Kennedy, Tse, and Windcliff, 2009; Gatheral and Schied, 2011; Schied and Schöneborn, 2009; Schied, Schöneborn, and Tehranchi, 2010). These works focus on seeking a liquidation strategy that depletes the whole portfolio within a small trading period. Unlike them, our objective is to decide what fraction of the portfolio should be liquidated for the purpose of reducing the leverage ratio. Our model thus has both similarities and differences with asset liability management models and portfolio liquidation models.

In the second part of the paper, we further investigate the deleveraging problem with a non-positive excessive liability constraint. The leverage ratio after liquidation must reach the benchmark value. This type of optimal deleveraging problems have been studied in Brown, Carlin, and Lobo (2010) and Chen, Feng, Peng, and Ye (2014), where the price impact functions are assumed to be linear. However, both theoretical studies and empirical works have shown evidence of nonlinearity in the price impact. For example, Lillo, Farmer, and Mantegna (2003) show that the temporary price impact function is strictly concave. The concavity is also explained in Gabaix, Gopikrishnan, Plerou, and Stanley (2006), Chacko, Jurek, and Stafford (2008) and Bouchaud, Farmer, and Lillo (2008). Many empirical works are in favor of a power temporary impact function with an exponent between zero and one (see Almgren, Thum, Hauptmann, and Li, 2005; Engle, Ferstenberg, and Russell, 2006; Gabaix, Gopikrishnan, Plerou, and Stanley, 2003; Kempf and Korn, 1999; Moro et al., 2009; Torre and Ferrari, 1997; Toth et al., 2011). For example, Almgren et al. (2005) demonstrate that a power of 0.6 is plausible when data from Citigroup equity trading is used. Toth et al. (2011) report a power of around 0.5 for small tick contracts and 0.6 for large tick ones by analyzing proprietary trading data from Capital Fund Management. In our work, we assume an arbitrary exponent between 0 and 1 and study the corresponding optimal deleveraging problem.

With a power temporary price impact function, the portfolio deleveraging problem in the first part becomes a polynomial program with box constraints. We obtain analytical results on how the optimal trading strategy responses to changes in the liability-aversion parameter and the benchmark leverage ratio. Under a convexity assumption, the uniqueness of the optimal solution is guaranteed. We construct efficient frontiers to visualize the tradeoff between the equity and liability. We further investigate how liquidation priority is influenced by intrinsic characteristics such as initial asset price and price impact. Our results show that trading preference is given to those assets with higher initial prices or smaller price impact.

The optimal deleveraging problem in the second part is modeled as a non-convex polynomial program with polynomial and box constraints, where the polynomial constraint corresponds to the non-positivity of the excessive liability. In the absence of convexity, the optimization problem is rather challenging, even in the linear temporary price impact case with quadratic objective and constraint (see Chen et al., 2014). We extend the Lagrangian method proposed in Chen et al. (2014) to the case of non-convex polynomial programs. The method is closely related to the portfolio management problem in the first part. We provide conditions under which the Lagrangian algorithm provides a global optimal solution. When such conditions are not satisfied, the algorithm returns an approximate solution and an upper bound on the loss in equity induced by adopting a suboptimal strategy is derived.

The optimal deleveraging strategies may differ significantly under linear and nonlinear temporary price impact. We consider the case of a permanent price impact dominant market, where the permanent price impact outweighs the temporary impact. This often arises in practice. For instance, Schöneborn and Schied (2009) show that in markets that do not suffer from extreme cash outflows, the impact of stock sales is predominantly permanent. Holthausen, Leftwich, and Mayers (1990) observe from their data that the permanent impact accounts for 85 percent of the total impact (Schöneborn and Schied, 2009). Coval and Stafford (2007) also show that the permanent price impact could be strongly dominant. In a permanent impact dominant market, we show that, when the temporary price impact is linear, at most one asset in the portfolio could be partially liquidated. All other assets either are fully liquidated or remain intact. This does not generally hold when the temporary price impact is nonlinear.

The contributions of this article are three-fold. First, we propose a portfolio management model, where the objective is to gain a good balance between equity and liability when a portfolio is deleveraged and market impact is taken into account. Under a power temporary price impact, the problem reduces to a polynomial program with box constraints that can be solved using standard optimization softwares. Second, we derive analytical properties regarding the optimal deleveraging strategies, which provide general guidelines for practical applications. Third, we extend the Lagrangian method of Chen et al. (2014) to non-convex polynomial programs with polynomial and box constraints that result from the optimal deleveraging problem with a leverage constraint.

The paper is organized in the following way. In Section 2, we present our first portfolio deleveraging problem, analyze the effects of the liability-aversion parameter and the benchmark leverage ratio on the optimal trading strategies, construct efficient frontiers to visualize the tradeoff between equity and excessive liability, and investigate the influences of initial asset prices and price impact on the liquidation priority. In Section 3, we study the optimal deleveraging problem with a leverage constraint, present a Lagrangian method for solving the resulting non-convex polynomial optimization program with polynomial and box constraints, and analyze the effects of linearity on the optimal trading strategy in a permanent price dominant market. In Section 4, we present numerical experiments verifying the properties of the optimal trading strategies. We conclude in Section 5 with a discussion on future research.

In this section, we consider a portfolio management problem where the objective is to reduce liability and hence obtain a better balance between equity and liability. The problem is reduced to a polynomial optimization program with box constraints. We construct efficient frontiers to visualize the tradeoff between equity and excessive liability and obtain analytical properties of the optimal trading strategy.

The asset price dynamics is given by

                           
                              (2.1)
                              
                                 
                                    
                                       p
                                       t
                                    
                                    =
                                    
                                       p
                                       0
                                    
                                    +
                                    Γ
                                    
                                       (
                                       
                                          x
                                          t
                                       
                                       −
                                       
                                          x
                                          0
                                       
                                       )
                                    
                                    −
                                    Λ
                                    
                                       y
                                       t
                                       k
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 p
                                 t
                              
                              ,
                              
                              
                                 x
                                 t
                              
                              ,
                              
                              
                                 y
                                 t
                              
                              ≥
                              
                                 0
                              
                              ∈
                              
                                 R
                                 m
                              
                           
                         are vectors of initial prices, holdings and trading rates at time t, 
                           
                              y
                              t
                              k
                           
                         (0 < k ≤ 1) is a vector with 
                           
                              y
                              
                                 i
                                 ,
                                 t
                              
                              k
                           
                         as its ith entry, and Γ and Λ are positive definite diagonal matrices with permanent and temporary price impact coefficients on the diagonals respectively (i.e., γi
                         = Γ
                        
                           i, i
                         > 0 and λi
                         = Λ
                        
                           i, i
                         > 0). Since our primary goal is to deleverage a portfolio, we consider pure selling strategies only (and hence the minus sign before 
                           
                              Λ
                              
                                 y
                                 t
                                 k
                              
                           
                        ). The permanent price impact is related to the cumulative trading amount while the temporary price impact is related to the amount traded per unit time. Denote q = p
                        0 − Γx
                        0. The price dynamics then becomes

                           
                              (2.2)
                              
                                 
                                    
                                       p
                                       t
                                    
                                    =
                                    q
                                    +
                                    Γ
                                    
                                       x
                                       t
                                    
                                    −
                                    Λ
                                    
                                       y
                                       t
                                       k
                                    
                                    .
                                 
                              
                           
                        The price process (2.2) generalizes those in Brown et al. (2010) and Chen et al. (2014). The temporary price impact here is no longer restricted to a linear function as in Brown et al. (2010) and Chen et al. (2014). It is given by a power function with an arbitrary exponent between zero and one. As explained in Introduction, such a nonlinear temporary price impact has been supported by many empirical works on price impact.

We assume continuous execution during the trading period. The holding dynamics is thus 
                           
                              
                                 x
                                 t
                              
                              =
                              
                                 x
                                 0
                              
                              −
                              
                                 ∫
                                 
                                    0
                                 
                                 t
                              
                              
                                 y
                                 s
                              
                              d
                              s
                           
                        . Without loss of generality, let the trading period be T = 1. The asset price is p
                        0 = q + Γx
                        0 before trading and p
                        1 = q + Γx
                        1 after trading. The amount of cash generated is

                           
                              
                                 
                                    K
                                    =
                                    
                                       ∫
                                       0
                                       1
                                    
                                    
                                       
                                          p
                                          t
                                          ⊤
                                       
                                       
                                          y
                                          t
                                       
                                    
                                    d
                                    t
                                    .
                                 
                              
                           
                        After paying the debt, the remaining liability becomes 
                           
                              
                                 l
                                 1
                              
                              =
                              
                                 l
                                 0
                              
                              −
                              K
                              =
                              
                                 l
                                 0
                              
                              −
                              
                                 ∫
                                 0
                                 1
                              
                              
                                 
                                    p
                                    t
                                    ⊤
                                 
                                 
                                    y
                                    t
                                 
                              
                              d
                              t
                              ,
                           
                         where l
                        0 is the initial liability. Denote the value of the portfolio after liquidation by 
                           
                              
                                 a
                                 1
                              
                              =
                              
                                 p
                                 1
                                 ⊤
                              
                              
                                 x
                                 1
                              
                           
                        . The net equity at time T = 1 is hence given by

                           
                              (2.3)
                              
                                 
                                    
                                       
                                          
                                             e
                                             1
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                a
                                                1
                                             
                                             −
                                             
                                                l
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                p
                                                1
                                                ⊤
                                             
                                             
                                                x
                                                1
                                             
                                             −
                                             
                                                l
                                                0
                                             
                                             +
                                             
                                                ∫
                                                0
                                                1
                                             
                                             
                                                
                                                   p
                                                   t
                                                   ⊤
                                                
                                                
                                                   y
                                                   t
                                                
                                             
                                             d
                                             t
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                q
                                                ⊤
                                             
                                             
                                                x
                                                1
                                             
                                             +
                                             
                                                x
                                                1
                                                ⊤
                                             
                                             Γ
                                             
                                                x
                                                1
                                             
                                             +
                                             
                                                ∫
                                                0
                                                1
                                             
                                             
                                                (
                                                
                                                   q
                                                   ⊤
                                                
                                                
                                                   y
                                                   t
                                                
                                                +
                                                
                                                   x
                                                   t
                                                   ⊤
                                                
                                                Γ
                                                
                                                   y
                                                   t
                                                
                                                −
                                                
                                                   
                                                      
                                                         y
                                                         t
                                                      
                                                   
                                                   ⊤
                                                
                                                Λ
                                                
                                                   y
                                                   t
                                                   k
                                                
                                                )
                                             
                                             d
                                             t
                                             −
                                             
                                                l
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We assume constant trading rate as in Brown et al. (2010) and Chen et al. (2014). That is, yt
                         ≔ y is constant. Since the liquidation duration is T = 1, the trading rate y equals the trading amount over the whole liquidation period: y = x
                        0 − x
                        1. We thus get

                           
                              (2.4)
                              
                                 
                                    
                                       l
                                       1
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       y
                                       ⊤
                                    
                                    Γ
                                    y
                                    +
                                    
                                       
                                          y
                                       
                                       ⊤
                                    
                                    Λ
                                    
                                       y
                                       k
                                    
                                    −
                                    
                                       p
                                       0
                                       ⊤
                                    
                                    y
                                    +
                                    
                                       l
                                       0
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (2.5)
                              
                                 
                                    
                                       e
                                       1
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       y
                                       ⊤
                                    
                                    Γ
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       ⊤
                                    
                                    Λ
                                    
                                       y
                                       k
                                    
                                    −
                                    
                                       x
                                       0
                                       ⊤
                                    
                                    Γ
                                    y
                                    +
                                    
                                       e
                                       0
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 e
                                 0
                              
                              =
                              
                                 p
                                 0
                                 ⊤
                              
                              
                                 x
                                 0
                              
                              −
                              
                                 l
                                 0
                              
                           
                         is the initial net equity.

Let ρ
                        1 denote the benchmark leverage ratio at time 1, where the leverage ratio is defined as the ratio of liability over net equity. From the practical viewpoint, the original leverage ratio is such that l
                        0/e
                        0 ≫ ρ
                        1 and we would like to reduce the leverage ratio from l
                        0/e
                        0 towards ρ
                        1. Namely, l
                        0 − ρ
                        1
                        e
                        0 ≫ 0 and we would like to liquidate some assets to reduce f
                        1 ≔ l
                        1 − ρ
                        1
                        e
                        1 towards zero. We call f
                        1 the excessive liability after liquidation. It is given by

                           
                              (2.6)
                              
                                 
                                    
                                       
                                          
                                             f
                                             1
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                
                                                   ρ
                                                   1
                                                
                                                )
                                             
                                             
                                                1
                                                2
                                             
                                             
                                                y
                                                ⊤
                                             
                                             Γ
                                             y
                                             +
                                             
                                                (
                                                
                                                   ρ
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                
                                                   y
                                                
                                                ⊤
                                             
                                             Λ
                                             
                                                y
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   (
                                                   
                                                      p
                                                      0
                                                   
                                                   −
                                                   
                                                      ρ
                                                      1
                                                   
                                                   Γ
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             y
                                             +
                                             
                                                l
                                                0
                                             
                                             −
                                             
                                                ρ
                                                1
                                             
                                             
                                                e
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        On the other hand, due to market impact, liquidation leads to trading cost and hence loss in equity. It is desirable to also minimize the loss in equity. The portfolio deleveraging problem is thus to balance the equity and the excessive liability. Let α > 0 represent the level of liability-aversion. We also assume no shortselling as in Chen et al. (2014) and Brown et al. (2010). The optimization problem is then given by the following:

                           
                              (2.7)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                y
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                e
                                                1
                                             
                                             −
                                             α
                                             
                                                f
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             y
                                             ≤
                                             
                                                x
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Plugging in the expressions of e
                        1 and f
                        1, (2.7) becomes the following bounded nonlinear program:

                           
                              (2.8)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   y
                                                   ∈
                                                   
                                                      R
                                                      m
                                                   
                                                
                                             
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                1
                                                +
                                                α
                                                
                                                   ρ
                                                   1
                                                
                                                −
                                                α
                                                )
                                             
                                             
                                                y
                                                ⊤
                                             
                                             Γ
                                             y
                                             −
                                             
                                                (
                                                1
                                                +
                                                α
                                                
                                                   ρ
                                                   1
                                                
                                                +
                                                α
                                                )
                                             
                                             
                                                y
                                                ⊤
                                             
                                             Λ
                                             
                                                y
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                                
                                                   [
                                                   α
                                                   
                                                      p
                                                      0
                                                   
                                                   −
                                                   
                                                      (
                                                      1
                                                      +
                                                      α
                                                      
                                                         ρ
                                                         1
                                                      
                                                      )
                                                   
                                                   Γ
                                                   
                                                      x
                                                      0
                                                   
                                                   ]
                                                
                                                ⊤
                                             
                                             y
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             subject
                                             
                                             to
                                             
                                             0
                                             ≤
                                             y
                                             ≤
                                             
                                                x
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here we have dropped the constant term in e
                        1 − αf
                        1 since it does not affect the solution of the optimization problem.

In the following, we first analyze how the liability-aversion parameter α and the benchmark leverage ratio ρ
                        1 affect the optimal trading strategy. We then generate efficient frontiers by sweeping out a range of the liability-aversion parameter for different temporary impact functions (i.e., different exponent k). Finally, we investigate how initial prices and price impact affect the liquidation priorities.

                           Proposition 2.1
                           The optimal trading amount y* is increasing with respect to the liability-aversion parameter α.

Let y
                              1,* and y
                              2,* denote the optimal solutions corresponding to α
                              1 and α
                              2, respectively, where α
                              1 < α
                              2. We want to show that y
                              1,* ≤ y
                              2,* elementwise. Assume to the contrary that there exists an asset i such that 
                                 
                                    
                                       y
                                       i
                                       
                                          1
                                          ,
                                          *
                                       
                                    
                                    >
                                    
                                       y
                                       i
                                       
                                          2
                                          ,
                                          *
                                       
                                    
                                 
                              . Note that functions e
                              1(y) and f
                              1(y) are separable due to the fact that Γ and Λ are diagonal matrices. Then 
                                 
                                    y
                                    i
                                    
                                       1
                                       ,
                                       *
                                    
                                 
                               and 
                                 
                                    y
                                    i
                                    
                                       2
                                       ,
                                       *
                                    
                                 
                               are the optimal solutions of

                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      y
                                                      ∈
                                                      R
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      e
                                                      1
                                                      i
                                                   
                                                   −
                                                   α
                                                   
                                                      f
                                                      1
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   subject
                                                   
                                                   to
                                                
                                             
                                             
                                             
                                                
                                                   0
                                                   ≤
                                                   y
                                                   ≤
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              with α = α
                              1 and α = α
                              2, respectively. Here

                                 
                                    (2.9)
                                    
                                       
                                          
                                             e
                                             1
                                             i
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             γ
                                             i
                                          
                                          
                                             y
                                             2
                                          
                                          −
                                          
                                             λ
                                             i
                                          
                                          
                                             y
                                             
                                                1
                                                +
                                                k
                                             
                                          
                                          −
                                          
                                             γ
                                             i
                                          
                                          
                                             x
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          y
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    (2.10)
                                    
                                       
                                          
                                             l
                                             1
                                             i
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             γ
                                             i
                                          
                                          
                                             y
                                             2
                                          
                                          +
                                          
                                             λ
                                             i
                                          
                                          
                                             y
                                             
                                                1
                                                +
                                                k
                                             
                                          
                                          −
                                          
                                             p
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          y
                                          ,
                                       
                                    
                                 
                              and

                                 
                                    (2.11)
                                    
                                       
                                          
                                             f
                                             1
                                             i
                                          
                                          =
                                          
                                             l
                                             1
                                             i
                                          
                                          −
                                          
                                             ρ
                                             1
                                          
                                          
                                             e
                                             1
                                             i
                                          
                                          .
                                       
                                    
                                 
                              Note that we have omitted the constant terms in (2.4) and (2.5), which are irrelevant for the optimization problem. By optimality, we have

                                 
                                    (2.12)
                                    
                                       
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   1
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             1
                                          
                                          
                                             f
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   1
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          ≥
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   2
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             1
                                          
                                          
                                             f
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   2
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              and

                                 
                                    (2.13)
                                    
                                       
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   2
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             2
                                          
                                          
                                             f
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   2
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          ≥
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   1
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             2
                                          
                                          
                                             f
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                
                                                   1
                                                   ,
                                                   *
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Adding the above two inequalities, we get

                                 
                                    (2.14)
                                    
                                       
                                          
                                             (
                                             
                                                α
                                                2
                                             
                                             −
                                             
                                                α
                                                1
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                f
                                                1
                                                i
                                             
                                             
                                                (
                                                
                                                   y
                                                   i
                                                   
                                                      1
                                                      ,
                                                      *
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                f
                                                1
                                                i
                                             
                                             
                                                (
                                                
                                                   y
                                                   i
                                                   
                                                      2
                                                      ,
                                                      *
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              According to (2.5),

                                 
                                    (2.15)
                                    
                                       
                                          
                                             d
                                             
                                                d
                                                y
                                             
                                          
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          =
                                          
                                             γ
                                             i
                                          
                                          y
                                          −
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                             y
                                             k
                                          
                                          −
                                          
                                             γ
                                             i
                                          
                                          
                                             x
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          <
                                          0
                                       
                                    
                                 
                              since 
                                 
                                    0
                                    ≤
                                    y
                                    ≤
                                    
                                       x
                                       0
                                       i
                                    
                                 
                              . Thus we have 
                                 
                                    
                                       e
                                       1
                                       i
                                    
                                    
                                       (
                                       
                                          y
                                          i
                                          
                                             1
                                             ,
                                             *
                                          
                                       
                                       )
                                    
                                    <
                                    
                                       e
                                       1
                                       i
                                    
                                    
                                       (
                                       
                                          y
                                          i
                                          
                                             2
                                             ,
                                             *
                                          
                                       
                                       )
                                    
                                 
                              . From (2.12), we get 
                                 
                                    
                                       f
                                       1
                                       i
                                    
                                    
                                       (
                                       
                                          y
                                          i
                                          
                                             1
                                             ,
                                             *
                                          
                                       
                                       )
                                    
                                    <
                                    
                                       f
                                       1
                                       i
                                    
                                    
                                       (
                                       
                                          y
                                          i
                                          
                                             2
                                             ,
                                             *
                                          
                                       
                                       )
                                    
                                 
                              . But this contradicts (2.14). Therefore, 
                                 
                                    
                                       y
                                       i
                                       
                                          1
                                          ,
                                          *
                                       
                                    
                                    ≤
                                    
                                       y
                                       i
                                       
                                          2
                                          ,
                                          *
                                       
                                    
                                 
                               must hold for all 1 ≤ i ≤ m. This finishes the proof of the proposition.□

This result is consistent with our intuition. An investor that is more liability-averse prefers to liquidate more assets. On the other hand, an investor that is less liability-averse is reluctant to liquidate due to the trading cost incurred by market impact.

                           Corollary 2.2
                           The optimal net equity and excessive liability are decreasing with respect to α.

The corollary follows immediately from the proof of Proposition 2.1.

                           Proposition 2.3
                           The optimal trading amount y* is decreasing with respect to ρ
                              1.

For 
                                 
                                    
                                       ρ
                                       1
                                    
                                    <
                                    
                                       
                                          ρ
                                          ¯
                                       
                                       1
                                    
                                    ,
                                 
                               let y* and 
                                 
                                    
                                       y
                                       ¯
                                    
                                    *
                                 
                               be the optimal solutions corresponding to ρ
                              1 and 
                                 
                                    
                                       
                                          ρ
                                          ¯
                                       
                                       1
                                    
                                    ,
                                 
                               respectively. We want to show that 
                                 
                                    
                                       y
                                       *
                                    
                                    ≥
                                    
                                       
                                          y
                                          ¯
                                       
                                       *
                                    
                                 
                               elementwise. By optimality, we have

                                 
                                    
                                       
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                          −
                                          α
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   ρ
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                          ≥
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          −
                                          α
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   ρ
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          −
                                          α
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          ≥
                                          
                                             e
                                             1
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                          −
                                          α
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                       
                                    
                                 
                              for each asset i. Here 
                                 
                                    e
                                    1
                                    i
                                 
                               and 
                                 
                                    f
                                    
                                       1
                                       ,
                                       ρ
                                    
                                    i
                                 
                               are given in (2.9) and (2.11). We have used the subscript ρ to stress the dependence of 
                                 
                                    f
                                    
                                       1
                                       ,
                                       ρ
                                    
                                    i
                                 
                               on ρ. Adding the above, we get

                                 
                                    
                                       
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   ρ
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                          +
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          ≤
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   ρ
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                          +
                                          
                                             f
                                             
                                                1
                                                ,
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                   1
                                                
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Since 
                                 
                                    
                                       f
                                       
                                          1
                                          ,
                                          
                                             ρ
                                             1
                                          
                                       
                                       i
                                    
                                    =
                                    
                                       l
                                       1
                                       i
                                    
                                    −
                                    
                                       ρ
                                       1
                                    
                                    
                                       e
                                       1
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       f
                                       
                                          1
                                          ,
                                          
                                             
                                                ρ
                                                ¯
                                             
                                             1
                                          
                                       
                                       i
                                    
                                    =
                                    
                                       l
                                       1
                                       i
                                    
                                    −
                                    
                                       
                                          ρ
                                          1
                                       
                                       ¯
                                    
                                    
                                       e
                                       1
                                       i
                                    
                                    ,
                                 
                               it follows that

                                 
                                    
                                       
                                          
                                             (
                                             
                                                ρ
                                                1
                                             
                                             −
                                             
                                                
                                                   ρ
                                                   1
                                                
                                                ¯
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                e
                                                1
                                                i
                                             
                                             
                                                (
                                                
                                                   y
                                                   i
                                                   *
                                                
                                                )
                                             
                                             −
                                             
                                                e
                                                1
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              Therefore, 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    ≥
                                    
                                       
                                          y
                                          ¯
                                       
                                       i
                                       *
                                    
                                 
                               according to (2.15).□

Intuitively, when the desired leverage ratio is smaller, liquidation of more assets becomes necessary. Proposition 2.3 shows that this is indeed the case from a theoretical perspective. A similar property is derived for the optimal deleveraging problem considered in Brown et al. (2010). But in Brown et al. (2010), linear price impact is assumed and the deleveraging problem is such that the desired leverage ratio must be satisfied.


                        Corollary 2.2 shows the monotonicity of the net equity and excessive liability with respect to the liability aversion parameter α, implying a tradeoff between equity and liability. In this subsection, we construct efficient frontiers to visualize the tradeoff. We start with the following assumption.

                           Assumption 2.4
                           
                              
                                 
                                    
                                       γ
                                       i
                                    
                                    <
                                    k
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                    
                                       λ
                                       i
                                    
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                               for i = 1, …, m.

For the purpose of illustrating efficient frontiers, we impose the above assumption to ensure the strict concavity of the problem (2.8) for all liability-aversion parameters. In this case, there exists a unique optimal trading strategy to (2.8). Although we may not be able to get the optimal solution analytically, we can easily obtain the optimal trading strategy numerically using standard softwares. Assumption 2.4 is only made for Sections 2.3 and 2.4. As for the portfolio deleveraging problem in Section 3, we no longer impose this restriction.

For each α, we compute the optimal solution y*(α) and then obtain the optimal net equity e
                        1(y*(α)) and the excessive liability f
                        1(y*(α)) according to (2.5) and (2.6). Consider an asset with γ = 0.6 ($/share)/million shares, λ = 1.4 ($/share)/(million shares/unit of time)
                           k
                        , x
                        0 = 1 million shares, p
                        0 = $40, ρ
                        1 = 11, l
                        0 = $37 million. Let α sweep out the values in [0.021, 0.245]. We construct efficient frontiers for k = 0.25, 0.5, 0.75. See Fig. 1
                         for the generated efficient frontiers.

The three curves correspond to the optimal trading strategies under different temporary price impact functions when α varies from 0.021 to 0.245. The vertical axis is the net equity. The horizontal axis is the negative excessive liability. The three marked points on the efficient frontiers correspond to the three optimal trading strategies that end up with zero excessive liability. Each efficient frontier consists of a family of trading strategies that achieve the optimal balance between the equity and the excessive liability. When α increases, the corresponding point on each efficient frontier moves towards the lower right corner. That is, the optimal equity and excessive liability decrease. This was shown in Corollary 2.2 mathematically. We can also see that the efficient frontier shifts upward when k increases in this particular example. This is because the trading amount y is between 0 and 1 (million shares). A larger k thus implies a smaller temporary price impact and hence smaller trading cost.

This section studies liquidation priorities among different assets. We find that intrinsic factors (e.g., initial prices, permanent and temporary price impact) of the assets affect the liquidation preference. Liquidation priorities have been studied for the deleveraging problems in Brown et al. (2010) and Chen et al. (2014), where both the permanent and temporary price impact are linear. Here we consider a more general and realistic case: a power temporary price impact function. Under Assumption 2.4, we have the following properties.

                           Proposition 2.5
                           For assets with the same initial holdings and price impact, the one with higher initial price is prioritized for selling, i.e. 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    ≤
                                    
                                       y
                                       j
                                       *
                                    
                                 
                               if p
                              0, i
                               ≤ p
                              0, j
                              , x
                              0, i
                               = x
                              0, j
                              , γi
                               = γj
                               and λi
                               = λj
                              .

Assume to the contrary that 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    >
                                    
                                       y
                                       j
                                       *
                                    
                                 
                              . We will find a direction 
                                 
                                    Σ
                                    ∈
                                    
                                       R
                                       m
                                    
                                 
                               along which the liability l
                              1 is strictly decreasing but the equity e
                              1 is strictly increasing. Consider 
                                 
                                    Σ
                                    ∈
                                    
                                       R
                                       m
                                    
                                 
                               with − 1 on ith entry, 1 on jth entry and zero elsewhere. Denote x
                              0 = x
                              0, i
                               = x
                              0, j
                              , γ = γi
                               = γj
                               and λ = λi
                               = λj
                              . From (2.4), we have

                                 
                                    (2.16)
                                    
                                       
                                          ∇
                                          
                                             l
                                             1
                                             ⊤
                                          
                                          Σ
                                          =
                                          
                                             p
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          −
                                          γ
                                          
                                             y
                                             i
                                             *
                                          
                                          −
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          λ
                                          
                                             
                                                
                                                   y
                                                   i
                                                   *
                                                
                                             
                                             k
                                          
                                          −
                                          
                                             p
                                             
                                                0
                                                ,
                                                j
                                             
                                          
                                          +
                                          γ
                                          
                                             y
                                             j
                                             *
                                          
                                          +
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          λ
                                          
                                             
                                                
                                                   y
                                                   j
                                                   *
                                                
                                             
                                             k
                                          
                                          <
                                          0
                                          .
                                       
                                    
                                 
                              From (2.5), we get

                                 
                                    (2.17)
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      e
                                                      1
                                                      ⊤
                                                   
                                                   Σ
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   −
                                                   γ
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   +
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   λ
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   +
                                                   γ
                                                   
                                                      x
                                                      0
                                                   
                                                   +
                                                   γ
                                                   
                                                      y
                                                      j
                                                      *
                                                   
                                                   −
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   λ
                                                   
                                                      
                                                         
                                                            y
                                                            j
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   −
                                                   γ
                                                   
                                                      x
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   λ
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               y
                                                               i
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               y
                                                               j
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   +
                                                   γ
                                                   
                                                      (
                                                      
                                                         y
                                                         j
                                                         *
                                                      
                                                      −
                                                      
                                                         y
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                >
                                             
                                             
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   λ
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               y
                                                               i
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               y
                                                               j
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   +
                                                   λ
                                                   k
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      x
                                                      0
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         j
                                                         *
                                                      
                                                      −
                                                      
                                                         y
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   λ
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   −
                                                   k
                                                   
                                                      x
                                                      0
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               y
                                                               j
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      −
                                                      k
                                                      
                                                         x
                                                         0
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         y
                                                         j
                                                         *
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The first inequality is due to Assumption 2.4, that is, 
                                 
                                    γ
                                    <
                                    k
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                    λ
                                    
                                       x
                                       0
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                 
                              . The last inequality is because 
                                 
                                    
                                       y
                                       k
                                    
                                    −
                                    k
                                    
                                       x
                                       0
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    y
                                 
                               is non-decreasing on [0, x
                              0]. Thus, there exists a small enough ε > 0 such that y* + εΣ is a feasible solution with higher equity, lower liability and hence higher e
                              1 + α(ρ
                              1
                              e
                              1 − l
                              1). This contradicts the optimality of y*. Therefore, we must have 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    ≤
                                    
                                       y
                                       j
                                       *
                                    
                                 
                              . This finishes the proof of the proposition.□


                        Proposition 2.5 shows that we prefer to sell assets with higher initial prices when other factors are the same, since it helps generate more cash and reduce the liability more effectively. The following proposition shows that trading priority is given to assets with smaller price impact.

                           Proposition 2.6
                           For assets i and j with the same initial holding and price, the one with smaller price impact is prioritized for selling, i.e., 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    ≥
                                    
                                       y
                                       j
                                       *
                                    
                                 
                               if p
                              0, i
                               = p
                              0, j
                              , x
                              0, i
                               = x
                              0, j
                              , γi
                               ≤ γj
                               and λi
                               ≤ λj
                              .

Assume to the contrary that 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    <
                                    
                                       y
                                       j
                                       *
                                    
                                 
                              . We find a direction 
                                 
                                    Σ
                                    ∈
                                    
                                       R
                                       m
                                    
                                 
                               along which the liability is strictly decreasing but the equity is strictly increasing. Let Σ = (Σ
                              1, …Σm
                              ), where Σi
                               = 1, Σj
                               = −1 and Σn
                               = 0, n ≠ i, j. According to (2.4), we have

                                 
                                    
                                       
                                          ∇
                                          
                                             l
                                             1
                                             ⊤
                                          
                                          Σ
                                          =
                                          
                                             γ
                                             i
                                          
                                          
                                             y
                                             i
                                             *
                                          
                                          +
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                             
                                                
                                                   y
                                                   i
                                                   *
                                                
                                             
                                             k
                                          
                                          −
                                          
                                             γ
                                             j
                                          
                                          
                                             y
                                             j
                                             *
                                          
                                          −
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          
                                             λ
                                             j
                                          
                                          
                                             
                                                
                                                   y
                                                   j
                                                   *
                                                
                                             
                                             k
                                          
                                          <
                                          0
                                          ,
                                       
                                    
                                 
                              since γj
                               ≥ γi, λj
                               ≥ λi
                               and 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    >
                                    
                                       y
                                       i
                                       *
                                    
                                 
                              . According to (2.5),

                                 
                                    (2.18)
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      e
                                                      1
                                                      ⊤
                                                   
                                                   Σ
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      γ
                                                      i
                                                   
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   −
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   −
                                                   
                                                      γ
                                                      i
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      j
                                                   
                                                   
                                                      y
                                                      j
                                                      *
                                                   
                                                   +
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            j
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   +
                                                   
                                                      γ
                                                      j
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         j
                                                      
                                                      −
                                                      
                                                         γ
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      i
                                                   
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   −
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         γ
                                                         j
                                                      
                                                      
                                                         y
                                                         j
                                                         *
                                                      
                                                      −
                                                      
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                      
                                                         λ
                                                         j
                                                      
                                                      
                                                         
                                                            
                                                               y
                                                               j
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Note that, according to Assumption 2.4, γjy − (k + 1)λjyk
                               is strictly decreasing with respect to y for y ∈ [0, x
                              0, j
                              ]. Therefore,

                                 
                                    (2.19)
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      e
                                                      1
                                                      ⊤
                                                   
                                                   Σ
                                                
                                             
                                             
                                                >
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         j
                                                      
                                                      −
                                                      
                                                         γ
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      i
                                                   
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   −
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         γ
                                                         j
                                                      
                                                      
                                                         y
                                                         i
                                                         *
                                                      
                                                      −
                                                      
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                      
                                                         λ
                                                         j
                                                      
                                                      
                                                         
                                                            
                                                               y
                                                               i
                                                               *
                                                            
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         j
                                                      
                                                      −
                                                      
                                                         γ
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            0
                                                            ,
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         y
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         j
                                                      
                                                      −
                                                      
                                                         λ
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            i
                                                            *
                                                         
                                                      
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              As can be seen in the proof of Proposition 2.5, this contradicts the optimality of y*. Therefore, we must have 
                                 
                                    
                                       y
                                       i
                                       *
                                    
                                    ≥
                                    
                                       y
                                       j
                                       *
                                    
                                 
                              . This finishes the proof of the proposition.□

Assets with smaller price impact tend to be more liquid. Proposition 2.6 simply tells that, everything else being equal, more liquid assets are prioritized for selling.

In this section, we study the portfolio deleveraging problem with a non-positive excessive liability constraint. That is, we want to deleverage the portfolio until the resulting leverage ratio reaches a predetermined level. The optimal deleveraging problem has been studied in Brown et al. (2010) and Chen et al. (2014), under the assumption of linear price impact functions. In that case, the deleveraging problem reduces to a quadratic program with quadratic and box constraints. In Brown et al. (2010), the quadratic program is convex under the assumption that the temporary price impact is greater than half of the permanent price impact. In Chen et al. (2014), a general non-convex case is studied. A Lagrangian method is proposed to solve the non-convex quadratic program optimally under certain conditions. When such conditions are violated, an approximate solution is obtained and an upper bound on the loss in equity caused by adopting a suboptimal strategy is derived.

In this work, with a power temporary price impact function, the resulting optimization problem is a non-convex polynomial program with polynomial and box constraints. We first describe the problem formulation and derive properties regarding the optimal solution. Then we analyze the connections between this optimal deleveraging problem and the deleveraging problem with liability aversion in (2.7). By adapting the Lagrangian method proposed in Chen et al. (2014), we obtain a numerical algorithm for solving the optimization problem. We then estimate the quality of the solution.

The optimal deleveraging problem is defined to be

                           
                              (3.1)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                y
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             e
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                       
                                          
                                             
                                                ρ
                                                1
                                             
                                             
                                                e
                                                1
                                             
                                             ≥
                                             
                                                l
                                                1
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             y
                                             ≤
                                             
                                                x
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here the notations are the same as in Section 2.1. Rewrite the problem explicitly as follows:

                           
                              (3.2)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                y
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                y
                                                ⊤
                                             
                                             
                                                (
                                                
                                                   1
                                                   2
                                                
                                                Γ
                                                )
                                             
                                             y
                                             −
                                             
                                                y
                                                ⊤
                                             
                                             Λ
                                             
                                                y
                                                k
                                             
                                             −
                                             
                                                x
                                                0
                                                ⊤
                                             
                                             Γ
                                             y
                                             +
                                             
                                                e
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   ρ
                                                   1
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                1
                                                2
                                             
                                             
                                                y
                                                ⊤
                                             
                                             Γ
                                             y
                                             −
                                             
                                                (
                                                
                                                   ρ
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                y
                                                ⊤
                                             
                                             Λ
                                             
                                                y
                                                k
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      p
                                                      0
                                                   
                                                   −
                                                   
                                                      ρ
                                                      1
                                                   
                                                   Γ
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             y
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ρ
                                                1
                                             
                                             
                                                e
                                                0
                                             
                                             −
                                             
                                                l
                                                0
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             y
                                             ≤
                                             
                                                x
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We assume that (3.2) is strictly feasible and the initial leverage ratio does not meet the requirement (i.e. ρ
                        1
                        e
                        0 < l
                        0). Otherwise, the investor will simply not liquidate since liquidation is costly due to market impact (see (2.15)). We next show in Proposition 3.1 that the excessive liability is exactly zero at the optimal solution. The investor will deleverage to the level that the leverage requirement is just satisfied. This property has also been reported in Brown et al. (2010) and Chen et al. (2014). Proposition 3.1 demonstrates that in the case of nonlinear temporary price impact function, it is still optimal to just deleverage to the desired leverage ratio.

                           Proposition 3.1
                           The leverage constraint of the optimal deleveraging problem (3.2) is active at the optimal solution.

Denote the optimal solution by y*. Assume to the contrary that the constraint is not active at the optimal solution. Then the linear independence constraint qualification (LICQ) holds at y*.
                                 1
                              
                              
                                 1
                                 LICQ holds if the set of gradients of active constraints is linearly independent.
                               According to the first order optimality condition, there exists 
                                 
                                    
                                       μ
                                       *
                                    
                                    =
                                    
                                       (
                                       
                                          μ
                                          0
                                          *
                                       
                                       ,
                                       
                                          μ
                                          1
                                          *
                                       
                                       ,
                                       …
                                       ,
                                       
                                          μ
                                          m
                                          *
                                       
                                       ,
                                       
                                          μ
                                          
                                             m
                                             +
                                             1
                                          
                                          *
                                       
                                       ,
                                       …
                                       ,
                                       
                                          μ
                                          
                                             2
                                             m
                                          
                                          *
                                       
                                       )
                                    
                                    ≥
                                    0
                                 
                               satisfying the following conditions:

                                 
                                    (3.3)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      μ
                                                      0
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         ρ
                                                         1
                                                      
                                                      
                                                         e
                                                         1
                                                      
                                                      −
                                                      
                                                         l
                                                         1
                                                      
                                                      )
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3.4)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      μ
                                                      i
                                                      *
                                                   
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                   =
                                                   0
                                                   ,
                                                   
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3.5)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         m
                                                         +
                                                         i
                                                      
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            0
                                                            ,
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         y
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                   =
                                                   0
                                                   ,
                                                   
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3.6)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   ∇
                                                   
                                                      e
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         *
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      μ
                                                      0
                                                      *
                                                   
                                                   ∇
                                                   
                                                      f
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         *
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         μ
                                                         i
                                                         *
                                                      
                                                      ∇
                                                      
                                                         g
                                                         i
                                                      
                                                      
                                                         (
                                                         
                                                            y
                                                            *
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         μ
                                                         
                                                            m
                                                            +
                                                            i
                                                         
                                                         *
                                                      
                                                      ∇
                                                      
                                                         g
                                                         
                                                            m
                                                            +
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            y
                                                            *
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where

                                 
                                    
                                       
                                          
                                             g
                                             i
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          =
                                          
                                             y
                                             i
                                          
                                          ,
                                          
                                          
                                             g
                                             
                                                m
                                                +
                                                i
                                             
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          =
                                          
                                             x
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          −
                                          
                                             y
                                             i
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                          .
                                       
                                    
                                 
                              If the leverage constraint is inactive (i.e., ρ
                              1
                              e
                              1 > l
                              1), we have 
                                 
                                    
                                       μ
                                       0
                                       *
                                    
                                    =
                                    0
                                 
                               from (3.3). For i = 1, …, m, Eq. (3.6) can be rewritten as

                                 
                                    (3.7)
                                    
                                       
                                          
                                             γ
                                             i
                                          
                                          
                                             y
                                             i
                                             *
                                          
                                          −
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                             
                                                
                                                   y
                                                   i
                                                   *
                                                
                                             
                                             k
                                          
                                          −
                                          
                                             γ
                                             i
                                          
                                          
                                             x
                                             
                                                0
                                                ,
                                                i
                                             
                                          
                                          +
                                          
                                             μ
                                             i
                                             *
                                          
                                          −
                                          
                                             μ
                                             
                                                m
                                                +
                                                i
                                             
                                             *
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              For each asset i, it can be seen from (3.4) and (3.5) that 
                                 
                                    μ
                                    i
                                    *
                                 
                               and 
                                 
                                    μ
                                    
                                       m
                                       +
                                       i
                                    
                                    *
                                 
                               cannot be non-zero simultaneously. Therefore, we only need to consider the following three cases.

                                 
                                    1.
                                    
                                       
                                          
                                             
                                                μ
                                                i
                                                *
                                             
                                             =
                                             0
                                             ,
                                             
                                                μ
                                                
                                                   m
                                                   +
                                                   i
                                                
                                                *
                                             
                                             ≠
                                             0
                                          
                                       : From (3.5), we obtain 
                                          
                                             
                                                y
                                                i
                                                *
                                             
                                             =
                                             
                                                x
                                                
                                                   0
                                                   ,
                                                   i
                                                
                                             
                                          
                                       . According to Eq. (3.7), we get 
                                          
                                             
                                                μ
                                                
                                                   m
                                                   +
                                                   i
                                                
                                                *
                                             
                                             =
                                             −
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             
                                                x
                                                
                                                   0
                                                   ,
                                                   i
                                                
                                                k
                                             
                                             <
                                             0
                                             ,
                                          
                                        contradicting to μ* ≥ 0.


                                       
                                          
                                             
                                                μ
                                                i
                                                *
                                             
                                             =
                                             
                                                μ
                                                
                                                   m
                                                   +
                                                   i
                                                
                                                *
                                             
                                             =
                                             0
                                          
                                       : By Eq. (3.7), we obtain 
                                          
                                             
                                                γ
                                                i
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      0
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                
                                                   y
                                                   i
                                                   *
                                                
                                                )
                                             
                                             =
                                             −
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             
                                                
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                
                                                k
                                             
                                          
                                       . Since 
                                          
                                             
                                                γ
                                                i
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      0
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                
                                                   y
                                                   i
                                                   *
                                                
                                                )
                                             
                                             ≥
                                             0
                                          
                                        and 
                                          
                                             −
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             
                                                
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                
                                                k
                                             
                                             ≤
                                             0
                                             ,
                                          
                                        we have 
                                          
                                             
                                                γ
                                                i
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      0
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                
                                                   y
                                                   i
                                                   *
                                                
                                                )
                                             
                                             =
                                             −
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             
                                                
                                                   
                                                      y
                                                      i
                                                      *
                                                   
                                                
                                                k
                                             
                                             =
                                             0
                                          
                                       . That is, 
                                          
                                             
                                                y
                                                i
                                                *
                                             
                                             =
                                             
                                                x
                                                
                                                   0
                                                   ,
                                                   i
                                                
                                             
                                          
                                        and 
                                          
                                             
                                                y
                                                i
                                                *
                                             
                                             =
                                             0
                                             ,
                                          
                                        which itself is a contradiction.


                                       
                                          
                                             
                                                μ
                                                i
                                                *
                                             
                                             ≠
                                             0
                                             ,
                                             
                                                μ
                                                
                                                   m
                                                   +
                                                   i
                                                
                                                *
                                             
                                             =
                                             0
                                          
                                       : From (3.4), 
                                          
                                             y
                                             i
                                             *
                                          
                                        should be 0.

Summarizing the above, we obtain that y* = 0. But this contradicts the assumption that l
                              0/e
                              0 > ρ
                              1 and deleveraging is required. Therefore, the leveraging constraint must be active. This finishes the proof of the proposition.□

In this section, we adapt the Lagrangian method of Chen et al. (2014) to solve the deleveraging problem (3.2) numerically. The liability-aversion parameter α can be treated as a Lagrangian multiplier and the optimization problem (2.7) can be viewed as a Lagrangian problem associated with (3.1). Connections between the optimal solutions to (2.7) and (3.1) are investigated and a Lagrangian algorithm is used to solve (3.1) optimally under certain conditions. When such conditions are not satisfied, we obtain an approximate solution and estimate the loss in the objective value caused by adopting such a suboptimal deleveraging strategy.

Since the price impact matrices Λ and Γ are both diagonal, the Lagrangian problem (2.8) can be solved by solving m univariate polynomial optimization programs with box constraints:

                           
                              (3.8)
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                P
                                                i
                                             
                                             )
                                          
                                       
                                       
                                          
                                             max
                                             
                                                
                                                   y
                                                   i
                                                
                                                ∈
                                                R
                                             
                                          
                                       
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                1
                                                +
                                                α
                                                
                                                   ρ
                                                   1
                                                
                                                −
                                                α
                                                )
                                             
                                             
                                                γ
                                                i
                                             
                                             
                                                y
                                                i
                                                2
                                             
                                             −
                                             
                                                (
                                                1
                                                +
                                                α
                                                
                                                   ρ
                                                   1
                                                
                                                +
                                                α
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             
                                                y
                                                i
                                                
                                                   1
                                                   +
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                [
                                                α
                                                
                                                   p
                                                   
                                                      0
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                
                                                   (
                                                   1
                                                   +
                                                   α
                                                   
                                                      ρ
                                                      1
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   i
                                                
                                                
                                                   x
                                                   
                                                      0
                                                      ,
                                                      i
                                                   
                                                
                                                ]
                                             
                                             
                                                y
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                y
                                                i
                                             
                                             ≤
                                             
                                                x
                                                
                                                   0
                                                   ,
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Since the case k = 1 has been fully studied in Chen et al. (2014), in the remainder of this paper, we will assume 0 < k < 1. In this case, it can be easily seen that the above program could have multiple solutions (however, it cannot have more than four solutions). For each Lagrangian multiplier α, let 
                           
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 α
                                 )
                              
                           
                         be the set of values of f
                        1 at all possible optimal solutions of the Lagrangian problem. It is a set-valued map. We start with the following definition of breakpoint.

                           Definition 3.2
                           
                              α is said to be a breakpoint of 
                                 
                                    f
                                    1
                                    *
                                 
                               if 
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       α
                                       )
                                    
                                 
                               has distinct values.


                              
                                 
                                    f
                                    1
                                    *
                                 
                               has no breakpoint if 
                                 
                                    
                                       γ
                                       i
                                    
                                    <
                                    k
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                    
                                       λ
                                       i
                                    
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                               for 1 ≤ i ≤ m.

If 
                           
                              
                                 γ
                                 i
                              
                              <
                              k
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                              
                                 λ
                                 i
                              
                              
                                 x
                                 
                                    0
                                    ,
                                    i
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           
                         for each asset i, the Lagrangian problem (2.7) is strictly concave and there exists a unique optimal solution for any α. Hence, no breakpoint exists.

Next we present some key properties of 
                           
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 α
                                 )
                              
                           
                         that are essential for the design of the algorithm.

                           Theorem 3.4
                           
                              
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       α
                                       )
                                    
                                 
                               is a piecewise continuous non-increasing map.
                                 2
                              
                              
                                 2
                                 Here a non-increasing map means that 
                                       
                                          
                                             f
                                             1
                                             *
                                          
                                          
                                             (
                                             α
                                             )
                                          
                                       
                                     is a monotone set-valued map: (α
                                    1 − α
                                    2)(ξ
                                    1 − ξ
                                    2) ≤ 0, 
                                       
                                          ∀
                                          
                                             ξ
                                             i
                                          
                                          ∈
                                          
                                             f
                                             1
                                             *
                                          
                                          
                                             (
                                             
                                                α
                                                i
                                             
                                             )
                                          
                                       
                                    . For details of set-valued maps, refer to Aubin, Frankowska, and Frankowska (2008).
                               In particular, 
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    >
                                    0
                                 
                               and 
                                 
                                    ∃
                                    
                                       α
                                       
                                          
                                          ′
                                       
                                    
                                    >
                                    0
                                 
                               such that 
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       
                                          α
                                          
                                             
                                             ′
                                          
                                       
                                       )
                                    
                                    <
                                    0
                                 
                              .

The monotonicity of 
                                 
                                    f
                                    1
                                    *
                                 
                               can be shown in a similar manner as in Theorem 1 in Chen et al. (2014). Note that in the current paper, f
                              1 = l
                              1 − ρ
                              1
                              e
                              1; while in Chen et al. (2014), the corresponding function is f = ρ
                              1
                              e
                              1 − l
                              1. When α = 0, we maximize e
                              1. Since e
                              1 is strictly decreasing with respect to each yi
                               according to (2.15), the optimal solution is y* = 0. Then we have 
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    =
                                    
                                       f
                                       1
                                    
                                    
                                       (
                                       
                                          0
                                       
                                       )
                                    
                                    =
                                    
                                       l
                                       0
                                    
                                    −
                                    
                                       ρ
                                       1
                                    
                                    
                                       e
                                       0
                                    
                                    >
                                    0
                                 
                              . The remaining of the proof follows similarly as in Theorem 1 in Chen et al. (2014).□


                        Theorem 3.4 implies that there exists a α* such that zero is contained in either 
                           
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                           
                         or an interval defined by two different values of 
                           
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                           
                        . When 
                           
                              0
                              ∈
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                              ,
                           
                         we have the following:

                           Theorem 3.5
                           If there exists α* such that 
                                 
                                    0
                                    ∈
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       
                                          α
                                          *
                                       
                                       )
                                    
                                    ,
                                 
                               an optimal solution y(α*) to the Lagrangian problem (2.7) satisfying f
                              1(y(α*)) = 0 is also optimal to (3.1).

Refer to Theorem 2 in Chen et al. (2014) for a detailed proof. Theorem 3.5 shows that when there exists a Lagrangian multiplier α* such that 
                           
                              0
                              ∈
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                              ,
                           
                         we can obtain the optimal deleveraging strategy by solving the corresponding Lagrangian problem.

Before presenting the algorithm, we make the following assumption. For each i = 1, …, m, let Bi
                         denote the set of Lagrangian multipliers α under which (3.8) has multiple optimal solutions.

                           Assumption 3.6
                           For any i ≠ j, 
                                 
                                    
                                       B
                                       i
                                    
                                    ⋂
                                    
                                       B
                                       j
                                    
                                    =
                                    ⌀
                                 
                              .


                        Assumption 3.6 implies that there is no α such that (3.8) has multiple solutions for two different assets. Any breakpoint is due to multiple solutions of (3.8) for only one i ∈ {1, 2, …, m}.

The Lagrangian algorithm aims to find α* and a corresponding y(α*) such that f
                        1(y(α*)) = 0. When such α* and y(α*) exist, y(α*) is an optimal solution of the deleveraging problem (3.1). Otherwise, when there exists α* such that 0 falls in an open interval defined by two values of 
                           
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                              ,
                           
                         we construct an approximate solution yL
                         in a similar way as in Chen et al. (2014). Suppose α* is such that the Lagrangian problem (3.8) has multiple solutions for only i (see Assumption 3.6). By Assumption 3.6, all these solutions only differ in their ith entry. For any such solution y(α*), let 
                           
                              
                                 y
                                 j
                                 L
                              
                              =
                              
                                 y
                                 j
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                              ,
                           
                         
                        j ≠ i. 
                           
                              y
                              i
                              L
                           
                         is set to be the smallest zero of f
                        1(yL
                        ) as a function of 
                           
                              y
                              i
                              L
                           
                        . Here we use the smallest zero since, according to (2.15), the net equity is decreasing with respect to the trading amount in asset i. The approximate solution constructed in this way obviously is feasible to (3.2). Below is the detailed algorithm. ε > 0 is a small error tolerance level.


                        
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Algorithm
                                       
                                    
                                 
                                 
                                    
                                       1.
                                       Let 
                                             
                                                a
                                                =
                                                0
                                             
                                          . Find a large enough 
                                             b
                                           such that 
                                             
                                                max
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   b
                                                   )
                                                
                                                <
                                                0
                                             
                                           (i.e., all values in the set 
                                             
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   b
                                                   )
                                                
                                             
                                           are less than 0).
                                    
                                    
                                       2.
                                       Set 
                                             
                                                α
                                                =
                                                (
                                                a
                                                +
                                                b
                                                )
                                                /
                                                2
                                             
                                          . If 
                                             
                                                
                                                   min
                                                   |
                                                
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   
                                                      (
                                                      α
                                                      )
                                                   
                                                   |
                                                   ≤
                                                   ϵ
                                                
                                             
                                          : set 
                                             
                                                
                                                   y
                                                   L
                                                
                                                =
                                                y
                                                
                                                   (
                                                   α
                                                   )
                                                
                                             
                                           where 
                                             
                                                y
                                                (
                                                α
                                                )
                                             
                                           satisfies 
                                             
                                                
                                                   |
                                                
                                                
                                                   f
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      y
                                                      
                                                         (
                                                         α
                                                         )
                                                      
                                                      )
                                                   
                                                   |
                                                   ≤
                                                   ϵ
                                                
                                             
                                          . Stop.
                                    
                                    
                                       3.
                                       Else If 
                                             
                                                min
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   α
                                                   )
                                                
                                                <
                                                0
                                                <
                                                max
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   α
                                                   )
                                                
                                             
                                          : find 
                                             i
                                           that leads to multiple solutions for (3.8); set 
                                             
                                                
                                                   y
                                                   j
                                                   L
                                                
                                                =
                                                
                                                   y
                                                   j
                                                
                                                
                                                   (
                                                   α
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                j
                                                ≠
                                                i
                                                ,
                                             
                                           where 
                                             
                                                y
                                                (
                                                α
                                                )
                                             
                                           is any optimal solution of (3.8); set 
                                             
                                                y
                                                i
                                                L
                                             
                                           to be the smallest zero of 
                                             
                                                
                                                   f
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      L
                                                   
                                                   )
                                                
                                             
                                           as a function of 
                                             
                                                y
                                                i
                                                L
                                             
                                          . Stop.
                                    
                                    
                                       4.
                                       Else If 
                                             
                                                max
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   α
                                                   )
                                                
                                                <
                                                −
                                                ϵ
                                                ,
                                             
                                           set 
                                             
                                                b
                                                ←
                                                (
                                                a
                                                +
                                                b
                                                )
                                                /
                                                2
                                             
                                          . Go to Step 2.
                                    
                                    
                                       5.
                                       Else If 
                                             
                                                min
                                                
                                                   f
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   α
                                                   )
                                                
                                                >
                                                ϵ
                                                ,
                                             
                                           set 
                                             
                                                a
                                                ←
                                                (
                                                a
                                                +
                                                b
                                                )
                                                /
                                                2
                                             
                                          . Go to Step 2.
                                    
                                 
                              
                           
                        
                     

For the case when there is no breakpoint or there exists a breakpoint α* such that 
                           
                              0
                              ∈
                              
                                 f
                                 1
                                 *
                              
                              
                                 (
                                 
                                    α
                                    *
                                 
                                 )
                              
                              ,
                           
                         the optimal solution can be obtained with the above algorithm efficiently. Otherwise, a feasible approximate solution is constructed. We estimate the loss in equity caused by using such an approximate solution.

                           Theorem 3.7
                           Suppose α* is a breakpoint of 
                                 
                                    f
                                    1
                                    *
                                 
                               that leads to multiple solutions for the problem Pi
                              , 
                                 
                                    0
                                    ∉
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       
                                          α
                                          *
                                       
                                       )
                                    
                                 
                               and is included in an open interval defined by two values in 
                                 
                                    
                                       f
                                       1
                                       *
                                    
                                    
                                       (
                                       
                                          α
                                          *
                                       
                                       )
                                    
                                 
                              . The loss in the net equity caused by adopting a suboptimal strategy yL
                               obtained in the Lagrangian algorithm is bounded by 
                                 
                                    
                                       
                                          γ
                                          i
                                       
                                       2
                                    
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                       2
                                    
                                    +
                                    
                                       λ
                                       i
                                    
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                       
                                          1
                                          +
                                          k
                                       
                                    
                                 
                              .

Let 
                                 
                                    y
                                    ^
                                 
                               be an optimal solution for the Lagrangian problem (2.8) such that 
                                 
                                    
                                       f
                                       1
                                    
                                    
                                       (
                                       
                                          y
                                          ^
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              . Let y* be an optimal solution to (3.1). Since y* is feasible to the Lagrangian problem (2.8), we have

                                 
                                    (3.9)
                                    
                                       
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                *
                                             
                                             )
                                          
                                          =
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                *
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             *
                                          
                                          
                                             f
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                *
                                             
                                             )
                                          
                                          ≤
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                ^
                                             
                                             )
                                          
                                          −
                                          
                                             α
                                             *
                                          
                                          
                                             f
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                ^
                                             
                                             )
                                          
                                          <
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                ^
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where the first equality is due to Proposition 3.1. Then

                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                *
                                             
                                             )
                                          
                                          −
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                L
                                             
                                             )
                                          
                                          <
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                ^
                                             
                                             )
                                          
                                          −
                                          
                                             e
                                             1
                                          
                                          
                                             (
                                             
                                                y
                                                L
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Since 
                                 
                                    y
                                    ^
                                 
                               and yL
                               differ only in the ith entry, we have

                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                ≤
                                             
                                             
                                                
                                                   
                                                      e
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         *
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      e
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         L
                                                      
                                                      )
                                                   
                                                   <
                                                   
                                                      e
                                                      1
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            y
                                                            ^
                                                         
                                                         i
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      e
                                                      1
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                         L
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      e
                                                      1
                                                      i
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   −
                                                   
                                                      e
                                                      1
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            0
                                                            ,
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                         i
                                                      
                                                      2
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      λ
                                                      i
                                                   
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                      
                                                         1
                                                         +
                                                         k
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Here 
                                 
                                    e
                                    1
                                    i
                                 
                               was defined in (2.9) and the last inequality is because 
                                 
                                    e
                                    1
                                    i
                                 
                               is decreasing (see 2.15).□

Consider the case of a linear temporary price impact function (i.e., k = 1). The optimal deleveraging problem is

                           
                              (3.10)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                y
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             −
                                             
                                                y
                                                ⊤
                                             
                                             
                                                (
                                                Λ
                                                −
                                                
                                                   1
                                                   2
                                                
                                                Γ
                                                )
                                             
                                             y
                                             −
                                             
                                                x
                                                0
                                                ⊤
                                             
                                             Γ
                                             y
                                             +
                                             
                                                p
                                                0
                                                ⊤
                                             
                                             
                                                x
                                                0
                                             
                                             −
                                             
                                                l
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                       
                                          
                                             −
                                             
                                                y
                                                ⊤
                                             
                                             
                                                (
                                                
                                                   ρ
                                                   1
                                                
                                                
                                                   (
                                                   Λ
                                                   −
                                                   
                                                      1
                                                      2
                                                   
                                                   Γ
                                                   )
                                                
                                                +
                                                Λ
                                                +
                                                
                                                   1
                                                   2
                                                
                                                Γ
                                                )
                                             
                                             y
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                
                                                   (
                                                   
                                                      p
                                                      0
                                                   
                                                   −
                                                   
                                                      ρ
                                                      1
                                                   
                                                   Γ
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             y
                                             +
                                             
                                                ρ
                                                1
                                             
                                             
                                                p
                                                0
                                                ⊤
                                             
                                             
                                                x
                                                0
                                             
                                             −
                                             
                                                (
                                                
                                                   ρ
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                l
                                                0
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             y
                                             ≤
                                             
                                                x
                                                0
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        (3.10) is the same as the one studied in Brown et al. (2010) and Chen et al. (2014). As explained in Introduction, permanent impact dominant market may arise (Coval and Stafford, 2007; Holthausen et al., 1990; Schöneborn, 2011). In such a market, we have the following property:

                           Proposition 3.8
                           When ρ
                              1 > 1 and 
                                 
                                    Λ
                                    ≺
                                    
                                       
                                          
                                             ρ
                                             1
                                          
                                          −
                                          1
                                       
                                       
                                          2
                                          (
                                          
                                             ρ
                                             1
                                          
                                          +
                                          1
                                          )
                                       
                                    
                                    Γ
                                    ,
                                 
                               there exists at most one asset i such that the optimal solution to (3.10) satisfies 
                                 
                                    0
                                    <
                                    
                                       y
                                       i
                                       *
                                    
                                    <
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                    
                                 
                              .For any other asset j in the portfolio, j ≠ i, we have either 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    =
                                    
                                       x
                                       
                                          0
                                          ,
                                          j
                                       
                                    
                                 
                               or 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    =
                                    0
                                 
                              .

Denote y* as an optimal solution to (3.10). Assume to the contrary that there exist two assets i and j such that 
                                 
                                    0
                                    <
                                    
                                       y
                                       i
                                       *
                                    
                                    <
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    0
                                    <
                                    
                                       y
                                       j
                                       *
                                    
                                    <
                                    
                                       x
                                       
                                          0
                                          ,
                                          j
                                       
                                    
                                 
                              . By the optimality of y*, 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                               is an optimal solution to the following optimization problem, which is obtained by fixing yk
                               at 
                                 
                                    
                                       y
                                       k
                                       *
                                    
                                    ,
                                 
                               
                              k ≠ i, j, in (3.10):

                                 
                                    (3.11)
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      
                                                         (
                                                         
                                                            y
                                                            i
                                                         
                                                         ,
                                                         
                                                            y
                                                            j
                                                         
                                                         )
                                                      
                                                      ∈
                                                      
                                                         R
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      ,
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      A
                                                      1
                                                   
                                                   
                                                      y
                                                      i
                                                      2
                                                   
                                                   +
                                                   
                                                      B
                                                      1
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   +
                                                   
                                                      C
                                                      1
                                                   
                                                   
                                                      y
                                                      j
                                                      2
                                                   
                                                   +
                                                   
                                                      D
                                                      1
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   subject
                                                   
                                                   to
                                                
                                             
                                             
                                             
                                                
                                                   c
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      ,
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      A
                                                      2
                                                   
                                                   
                                                      y
                                                      i
                                                      2
                                                   
                                                   +
                                                   
                                                      B
                                                      2
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   +
                                                   
                                                      C
                                                      2
                                                   
                                                   
                                                      y
                                                      j
                                                      2
                                                   
                                                   +
                                                   
                                                      D
                                                      2
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   F
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   0
                                                   ≤
                                                   
                                                      y
                                                      i
                                                   
                                                   ≤
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         i
                                                      
                                                   
                                                   ,
                                                   0
                                                   ≤
                                                   
                                                      y
                                                      j
                                                   
                                                   ≤
                                                   
                                                      x
                                                      
                                                         0
                                                         ,
                                                         j
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Here,

                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                   1
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      γ
                                                      i
                                                   
                                                   −
                                                   
                                                      λ
                                                      i
                                                   
                                                   >
                                                   0
                                                   ,
                                                   
                                                      A
                                                      2
                                                   
                                                   =
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         ρ
                                                         1
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      γ
                                                      i
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         ρ
                                                         1
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                   >
                                                   0
                                                   ,
                                                   
                                                      C
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      γ
                                                      j
                                                   
                                                   −
                                                   
                                                      λ
                                                      j
                                                   
                                                   >
                                                   0
                                                   ,
                                                   
                                                      C
                                                      2
                                                   
                                                   =
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         ρ
                                                         1
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      γ
                                                      j
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         ρ
                                                         1
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      λ
                                                      j
                                                   
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              By Proposition 3.1, 
                                 
                                    c
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                    =
                                    0
                                 
                              .

Since 
                                 
                                    0
                                    <
                                    
                                       y
                                       i
                                       *
                                    
                                    <
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    0
                                    <
                                    
                                       y
                                       j
                                       *
                                    
                                    <
                                    
                                       x
                                       
                                          0
                                          ,
                                          j
                                       
                                    
                                    ,
                                 
                               the LICQ holds. Moreover, because the box constraints are non-active, by the KKT conditions, there exists a Lagrangian parameter λ ≥ 0 such that

                                 
                                    
                                       
                                          ∇
                                          g
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             ,
                                             
                                                y
                                                j
                                                *
                                             
                                             )
                                          
                                          +
                                          λ
                                          ∇
                                          c
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             ,
                                             
                                                y
                                                j
                                                *
                                             
                                             )
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              Note that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      ,
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                   +
                                                   λ
                                                   c
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      ,
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         A
                                                         1
                                                      
                                                      +
                                                      λ
                                                      
                                                         A
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      y
                                                      i
                                                      2
                                                   
                                                   +
                                                   
                                                      (
                                                      
                                                         B
                                                         1
                                                      
                                                      +
                                                      λ
                                                      
                                                         B
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   +
                                                   
                                                      (
                                                      
                                                         C
                                                         1
                                                      
                                                      +
                                                      λ
                                                      
                                                         C
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      y
                                                      j
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                      (
                                                      
                                                         D
                                                         1
                                                      
                                                      +
                                                      λ
                                                      
                                                         D
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   λ
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              has positive coefficients A
                              1 + λA
                              2 > 0, C
                              1 + λC
                              2 > 0. Since the gradient of g(yi, yj
                              ) + λc(yi, yj
                              ) at 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                               is zero, 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                               is the unique global minimum for g(yi, yj
                              ) + λc(yi, yj
                              ).

Note that c(yi, yj
                              ) = 0 intersects with the box 0 ≤ yi
                               ≤ x
                              0, i
                              , 0 ≤ yj
                               ≤ x
                              0, j
                               at an interior point 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                              . There exists another point 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       i
                                    
                                    ,
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                               such that 
                                 
                                    c
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       i
                                    
                                    ,
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    )
                                    =
                                    0
                                 
                               and 
                                 
                                    0
                                    ≤
                                    
                                       
                                          y
                                          ¯
                                       
                                       i
                                    
                                    ≤
                                    
                                       x
                                       
                                          0
                                          ,
                                          i
                                       
                                    
                                    ,
                                    
                                    0
                                    ≤
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    ≤
                                    
                                       x
                                       
                                          0
                                          ,
                                          j
                                       
                                    
                                 
                              . Since 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                               is the unique global minimum for g(yi, yj
                              ) + λc(yi, yj
                              ),

                                 
                                    
                                       
                                          g
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             ,
                                             
                                                y
                                                j
                                                *
                                             
                                             )
                                          
                                          +
                                          λ
                                          c
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             ,
                                             
                                                y
                                                j
                                                *
                                             
                                             )
                                          
                                          =
                                          g
                                          
                                             (
                                             
                                                y
                                                i
                                                *
                                             
                                             ,
                                             
                                                y
                                                j
                                                *
                                             
                                             )
                                          
                                          <
                                          g
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                             
                                             ,
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          +
                                          λ
                                          c
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                             
                                             ,
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          =
                                          g
                                          
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                             
                                             ,
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              We thus have found a point 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       i
                                    
                                    ,
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                               that is feasible for (3.11) but with larger objective value. This contradicts the optimality of 
                                 
                                    (
                                    
                                       y
                                       i
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                    )
                                 
                              .□


                        Proposition 3.8 indicates that under certain conditions, there can be at most one asset that is partially liquidated when the temporary price impact is linear. The other assets in the portfolio either are completely liquidated or remain intact. Proposition 2 in Chen et al. (2014) shows that more liquid assets are prioritized for selling when initial prices and holdings are the same. Proposition 3.8 then allows one to easily determine the optimal deleveraging strategy in certain cases. More specifically, for a portfolio consisting of m assets with the same initial price and holding, suppose the conditions of Proposition 3.8 are satisfied and the assets can be ordered according to their liquidity as suggested in Proposition 2 in Chen et al. (2014). Consider the following candidate solution: asset i, (1 ≤ i ≤ m), is partially liquidated; all assets that are more liquid than asset i are fully liquidated; all assets that are less liquid remain intact; the amount of asset i to sell is obtained as the smallest non-negative zero of f
                        1 as a function of yi
                         (by Proposition 3.1). There are at most m such feasible solutions. The optimal strategy is obtained as the one that gives the largest objective value.

When the temporary price impact is nonlinear, Proposition 3.8 does not generally hold.


                     
                        Example 4.1
                        In this example, we consider the portfolio deleveraging problem (2.8) with x
                           0, i
                            = 1, 1 ≤ i ≤ 6, α = 0.05, l
                           0 = 220. The temporary price impact function is assumed to have a power of k = 0.5. We solve the problem under two different benchmark leverage ratios ρ
                           1 = 10 and ρ
                           1 = 11. The units of the parameters are the same as in Section 2.3. See Table 1
                            for the optimal trading strategies.

It can be seen that when the benchmark leverage ratio is larger, the optimal liquidation amount is smaller for each asset. This is consistent with Proposition 2.3. For assets with the same price impact (i.e. assets 1 and 4, assets 2 and 5, assets 3 and 6), the one with higher initial price is prioritized for selling (see Proposition 2.5). Table 1 also illustrates that we prefer to sell assets with smaller price impact when the initial prices and holdings are the same. This can be seen from the optimal trading amounts of assets 1, 2 and 3 when the initial asset prices are all 39 or from the optimal trading amounts of assets 4, 5 and 6 when the initial asset prices are all 40. Such trading priorities are shown in Proposition 2.6.

In this example, we consider the optimal deleveraging problem (3.2). We first consider the same portfolio as in Example 4.1 with ρ
                           1 = 11 and l
                           0 = 222. For these assets, 
                              
                                 
                                    γ
                                    i
                                 
                                 <
                                 k
                                 
                                    (
                                    k
                                    +
                                    1
                                    )
                                 
                                 
                                    λ
                                    i
                                 
                                 
                                    x
                                    
                                       0
                                       ,
                                       i
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                              
                            1 ≤ i ≤ 6, implying concavity for the associated Lagrangian problems. Solving the problem with the Lagrangian algorithm, we get α* = 0.0545. The corresponding optimal trading amounts are in Table 2
                           . We also consider another portfolio where Assumption 2.4 no longer holds. The parameters are given in Table 3
                           . The Lagrangian algorithm returns α* = 0.0689 and an approximate solution with objective value e
                           1 = 12.7336. The optimal objective value of the corresponding Lagrangian problem is 12.8288, giving an upper bound on the optimal objective value of the deleveraging problem. Thus, the loss in equity due to the suboptimality of the strategy is bounded by 0.0952, which is around 0.63 percent of the initial equity.

In this example, we compare the optimal deleveraging strategies obtained under linear and nonlinear temporary price impact respectively. Consider a two-asset portfolio with x
                           0, i
                            = 0.05, p
                           0, i
                            = 2, 1 ≤ i ≤ 2, l
                           0 = 0.185, ρ
                           0 = 12.65. The desired leverage ratio ρ
                           1 = 11. We solve the problem (3.2) under linear (k = 1) and square root (k = 0.5) temporary price impact functions respectively. See Table 4
                            for the optimal liquidation strategies.

This is a permanent impact dominant market. Under linear temporary price impact, one asset is partially liquidated and the other remains intact. However, under the square root temporary price impact, both assets are partially liquidated. The numerical result is consistent with Proposition 3.8.

@&#CONCLUSIONS@&#

We study two related optimal deleveraging problems under nonlinear price impact. The temporary price impact is given by a power function. The objective of the first deleveraging problem is to optimally balance equity and liability. We derive analytical properties of the optimal trading policies and construct efficient frontiers to visualize the tradeoff between the net equity and excessive liability. The objective of the second problem is to liquidate to a desired level of the leverage ratio and maximize equity. It is formulated as a non-convex polynomial program with polynomial and box constraints. An efficient Lagrangian algorithm is used to find the global optimal solution numerically under certain conditions. When such conditions are violated, an approximate solution is obtained and an upper bound on the equity loss due to suboptimality is derived.

In Brown et al. (2010), a two-period deleveraging problem is studied where there might be a liquidation shock in the second period. The main focus in Brown et al. (2010) is to analyze how the possibility of such a liquidation shock affect the optimal deleveraging strategy. This is a practically important problem, in particular, during difficult economic times when liquidation shocks are much more likely. The resulting optimization problem involves more complex non-convex objective values and constraints. The extension of the current work to a multi-period model is thus interesting but challenging. We leave that for future research.

@&#REFERENCES@&#

