@&#MAIN-TITLE@&#Segmentation of the left ventricle in cardiac cine MRI using a shape-constrained snake model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Proposal of the gradient vector convolution (GVC) external force for snake model.


                        
                        
                           
                           Adoption of the circle-shape energy for endocardium segmentation.


                        
                        
                           
                           Proposal of the shape similarity energy for epicardium segmentation.


                        
                        
                           
                           Modification of the edge map for epicardium segmentation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Left ventricle segmentation

Cardiac MRI

Active contour model

Gradient vector convolution

Shape constraint

@&#ABSTRACT@&#


               
               
                  Segmentation of the left ventricle (LV) is a hot topic in cardiac magnetic resonance (MR) images analysis. In this paper, we present an automatic LV myocardial boundary segmentation method using the parametric active contour model (or snake model). By convolving the gradient map of an image, a fast external force named gradient vector convolution (GVC) is presented for the snake model. A circle-based energy is incorporated into the GVC snake model to extract the endocardium. With this prior constraint, the snake contour can conquer the unexpected local minimum stemming from artifacts and papillary muscle, etc. After the endocardium is detected, the original edge map around and within the endocardium is directly set to zero. This modified edge map is used to generate a new GVC force filed, which automatically pushes the snake contour directly to the epicardium by employing the endocardium result as initialization. Meanwhile, a novel shape-similarity based energy is proposed to prevent the snake contour from being strapped in faulty edges and to preserve weak boundaries. Both qualitative and quantitative evaluations on our dataset and the publicly available database (e.g. MICCAI 2009) demonstrate the good performance of our algorithm.
               
            

@&#INTRODUCTION@&#

Cardiac magnetic resonance imaging has proven to be a versatile and noninvasive imaging modality. It can acquire the anatomical and functional information of a heart within a short period of time, and thus be widely used in clinical diagnosis [1]. The segmentation of cardiac magnetic resonance images (MRIs) is one of the most critical prerequisites for quantitative study of the left ventricle (LV). Many clinically established diagnosis indices such as wall thickness and ejection fraction are evaluated by the segmentation results of the LV.

In clinical practice, the LV segmentation task is often performed manually by an experienced clinician. The manual segmentation, however, is tedious, time consuming, subjective and irreproducible. This issue has motivated the development of automatically extracting contours of the LV. Although an impressive research effort has been devoted to automatic LV segmentation, it remains a challenging problem, mainly because of the difficulties inherent from MR cardiac images [2]. There have been extensive researches such as graph cuts [3,4], morphological operations [5,6], dynamic weights fuzzy connectedness framework [7,8], active contours or snake model [9–13,2] and supervised learning methods [14–17], to overcome challenges of the LV segmentation. Petitjean and Dacher [18] presented a comprehensive review of LV segmentation algorithms.

Among approaches mentioned above, the snake model is one of the most successful methods. It deforms a closed curve using both the intrinsic properties of the curve and the image information to capture the boundaries of the region of interest (ROI). However, the information (e.g. intensity, texture) only deriving from the image itself is not sufficient to get satisfactory segmentation results of the LV. The prior knowledge concerning the LV, therefore, is necessary to be incorporated into the snake model. In this paper, we propose an automatic LV segmentation method that addresses the following challenges: (1) image inhomogeneity; (2) effect of papillary muscle; and (3) lack of edge information. The proposed approach consists of the following steps as shown in Fig. 1
                     :
                        
                           (a)
                           Automatic localization of the LV. Hough transform is applied to intensity difference image to locate the LV centroid and the ROI.

Designing the external force for snake model. The external force field plays a leading role in driving the active contours to approach objects boundaries in the snake model, and thus significantly influences the segmentation performance. A novel external force called gradient vector convolution (GVC) is proposed. The GVC snake is of great capture range, and is much more robust toward detecting and preserving the weak edges.

The endocardium segmentation. Considering that the LV is roughly a circle, a circle-shape based energy functional is integrated into the GVC snake model to extract the endocardium.

The epicardium segmentation. We adopt the segmentation result of the endocardium as a priori shape and construct a new shape-similarity based energy for GVC snake model, to get an accurate estimate of the epicardium.

Assessment of segmentation accuracy. The segmentation results are compared with the state-of-the-art methods using the mean absolute distance (MAD) and Dice metric (DM).

This paper is organized as follows. Section 2 briefly reviews the relevant literature. In Section 3, we detail the gradient vector convolution external force for the snake model. Section 4 introduces our framework of segmenting the LV and experiments are reported in Section 5. Finally, we conclude this paper in Section 6.

@&#RELATED WORK@&#

Active contour model or snake model proposed in 1988 by Kass et al. [9], has gained popularity in the field of the LV segmentation. Ranganath [19] tracked the LV endocardium in cardiac MRI sequences by propagating the conventional snake from one frame to another. Makowski et al. [20] employed the balloon snake to extract the LV endocardium and introduced an antitangling strategy to exclude the papillary muscles. Based on the discrete contour model, Hautvast et al. [21] developed a method that attempts to maintain a constant contour environment in the vicinity of the cavity boundary. Due to the high performance of capture range enlarging, Santarelli et al. [22] employed the gradient vector flow (GVF) snake [23] for the LV segmentation [22], but did not consider the effect of weak boundaries, papillary muscle and artifacts stemming from swirling blood. Lee et al. [24] presented the iterative thresholding method to extract the endocardium, which effectively alleviates the interference of papillary muscle. However, the endocardial contour is not smooth enough and the movement constraint based on image intensity for the snake is too empirical. Nguyen et al. [25] compared the conventional snake, balloon snake and GVF snake on extracting the LV endocardium and concluded that the GVF snake has the best performance.

User-predefined constraints facilitate segmentation methods by incorporating the prior information of the LV into a snake model. The prior information may be the statistical shape from a training set [10,26,27], be anatomical information such as an ellipse [28–30], or be intensity statistics [31,32]. Paragios [26] introduced an intensity consistency energy constraint into the variational level set approach [33]. Folkesson et al. [27] presented a segmentation method that extends the geodesic active region method by the incorporation of a statistical classifier trained using feature selection. Ben Ayed et al. [11] proposed to get curve evolution equations by minimizing two functionals each containing an original overlap prior constraint between the intensity distributions of the cavity and myocardium. Although excellent results have been achieved in [26,27,11] where the LV shape is learned from an annotated training data set, the segmentation performance depends heavily on the size and richness of images in the training set.

To relax the dependence on the choice of a training set, Zhu et al. [34] built a subject-specific dynamic model from a user-provided segmentation of one frame in the current cardiac sequence, which is able to simultaneously handle temporal dynamics (intrasubject variability) and intersubject variability. Ayed et al. [2] introduced a novel max-flow segmentation of the LV by recovering subject-specific distributions learned from the first frame via a bound of the Bhattacharyya measure. Pluempitiwiriyawej et al. [29] incorporated the ellipse constraint into the segmentation scheme. However, estimating the five parameters of the ellipse is an isolated step, which does not comply with the evolution of the snake contour. Liang et al. [13] proposed a radial gradient vector flow (RGVF) snake to segment LV automatically. In [13], the ROI could be transformed into polar coordinates where myocardium looks more like a horizontal band rather than a circle. This shape characteristic enables snake to evolve towards 1D radial direction instead of 2D image plane, which simplifies snake energy functions to 1D. Jolly [35] combined the edge, region and shape information to extract the LV endocardium, the approximate shape of the LV is obtained based on the maximum discrimination method.

Different from the methods in [26,27], we focus on achieving an automatic method to delineate the LV boundaries using the anatomical shape of the LV, rather than using the constraints derived from a finite training set. The proposed strategy is based on the parametric snake model, in which the external force is gradient vector convolution (GVC). The GVC snake model possesses similar properties of the GVF snake model, and it can be implemented in real time due to its convolutional nature. Left ventricle centroid and the ROI are located using temporal intensity difference along with Hough transform. Considering the LV is roughly a circle, a circle-shape based energy is integrated into the GVC snake model to extract the endocardium of the LV. Compared with the shape constraints employed in [29], the proposed method does not need to estimate the shape parameters explicitly. In terms of epicardium segmentation, supposing the epicardium resembles the endocardium in shape, we develop a shape-similarity energy functional to prevent the snake contour from leaking out from weak boundaries. With all these strategies, we can extract the endocardium and epicardium of the LV from MR images robustly and accurately. This paper is an extension of our approaches presented in [36,12,37], with more complete literature review, methodology derivations and experiments (including a new comparison with MICCAI 2009 database [38]).

Active contour models, or snakes [9], have been proven to be very effective tools for the community of image segmentation and computer vision. It integrates an initial estimate, geometrical properties of the contour, image data and knowledge-based constraints into a single process, and provides a good solution to shape recovery of objects of interest in visual data. A traditional active contour model is represented by a curve C(s)= (x(s), y(s)), s
                        ∈[0,1]. It moves through the spatial domain of an image to minimize the energy functional
                           
                              (1)
                              
                                 E
                                 (
                                 C
                                 )
                                 =
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                α
                                                |
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                s
                                                )
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                β
                                                |
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                (
                                                s
                                                )
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                ︸
                                             
                                          
                                       
                                       
                                          Internal
                                          
                                          energy
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                g
                                                (
                                                C
                                                (
                                                s
                                                )
                                                )
                                             
                                             
                                                ︸
                                             
                                          
                                       
                                       
                                          External
                                          
                                          energy
                                       
                                    
                                 
                                 ds
                                 ,
                              
                           
                        where C′(s) and C″(s) denote the first and second derivatives of C with respect to s, respectively. The first term of the integral stands for the internal force that keeps the contour continuous and smooth during deformation, the second term is the external force that drives the contour toward an object boundary or the other desired features within an image. By using the calculus of variation, the Euler equation to minimize E(C) is
                           
                              (2)
                              
                                 α
                                 
                                    
                                       C
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 s
                                 )
                                 -
                                 β
                                 
                                    
                                       C
                                    
                                    
                                       ⁗
                                    
                                 
                                 (
                                 s
                                 )
                                 -
                                 ∇
                                 g
                                 (
                                 C
                                 (
                                 s
                                 )
                                 )
                                 =
                                 0
                                 .
                              
                           
                        
                     

Notwithstanding the marvelous ability in representing object shapes, the traditional active contour model is limited to capture range and poor convergence to boundary concavities. Gradient vector flow (GVF) was proposed by Xu and Prince [23] as a new external force for active contour model to overcome these issues. It is a dense vector field, generated by diffusing the gradient vectors of a gray-level or binary edge map derived from an image. The GVF field is defined as a vector field 
                           V
                        (x,
                        y)=[u(x,
                        y), v(x,
                        y)] that minimizes the following energy functional:
                           
                              (3)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 ∫
                                 ∫
                                 
                                 
                                    
                                       
                                          μ
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          |
                                          ∇
                                          f
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          V
                                          -
                                          ∇
                                          f
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 dxdy
                                 ,
                              
                           
                        where f is the edge map, ∣∇f∣ is high near the edges and nearly zero in homogeneous regions and μ is a positive weight to control the balance between smoothness energy and edge energy. By the calculus of variation, the minimization of Eq. (3) reduces to solving the following Euler–Lagrange equation:
                           
                              (4)
                              
                                 μ
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 V
                                 -
                                 (
                                 V
                                 -
                                 ∇
                                 f
                                 )
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The equations evolving Eq. (4), embedded into a dynamic scheme by treating 
                           V
                        (x,
                        y) as the function of t, x and y, formally are
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   μ
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   u
                                                   -
                                                   (
                                                   u
                                                   -
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  y
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   μ
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   v
                                                   -
                                                   (
                                                   v
                                                   -
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  y
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ∇2 is the Laplacian operator. The active contour model with 
                           V
                        (x,
                        y) as external force is called GVF active contour model.

For any bounded 
                           
                              g
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                        , the linear diffusion process u
                        
                           t
                        
                        =∇2
                        u, u(x,0)=
                        g(x) possesses the unique solution 
                           
                              u
                              (
                              x
                              ,
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   2
                                                   t
                                                
                                             
                                          
                                       
                                       ⊗
                                       g
                                    
                                 
                              
                              (
                              x
                              )
                           
                        , t
                        >0, where ⊗ denotes convolution, 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          2
                                          t
                                       
                                    
                                 
                              
                           
                         is the Gaussian kernel of standard deviation 
                           
                              
                                 
                                    2
                                    t
                                 
                              
                           
                        . We argue that the solution of Eq. (5) can be approximated by convolving the ∇ f
                        =[f
                        
                           x
                        ,
                        f
                        
                           y
                        ] with a kernel. This convolution-based external force is referred to as gradient vector convolution (GVC). Followed by fast Fourier transform, this convolution operation can be implemented in real time and the snake model would benefit much from this property in computation time. Denote the convolution kernel by K
                        
                           con
                        , the GVC takes the following form:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   =
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         con
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   v
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   =
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         con
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In practice, we take 
                           
                              
                                 
                                    K
                                 
                                 
                                    con
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    r
                                 
                                 
                                    h
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    h
                                 
                              
                           
                        , h
                        ∈
                        R
                        +, n
                        ∈
                        R
                        +. K
                        
                           con
                         always works well in terms of extending and smoothing gradient vector. Generally, the factor h plays a role that is analogous to scale space filtering. The greater the value of h is, the greater the smoothing effect on the results will be. This property suggests that GVC is robust to noise. In addition, large n makes the potential to degrade fast with distance and vice versa. Thereby it allows the GVC snake to preserve edges and to drive into C-shape concavities.

In order to well understand the behavior of h and n, we plot the proposed kernel K
                        
                           con
                         in 1D case with different h and n in Fig. 2
                        . It can be seen from Fig. 2a that, the larger the value of h is, the smaller the value of K
                        
                           con
                         at points nearby x
                        =0 will be, but almost unchanged at points far from x
                        =0. Note that K
                        
                           con
                         is not defined at x
                        =0 when h
                        =0, we set K
                        
                           con
                        (0)=
                        K
                        
                           con
                        (1) for the sake of exhibition. Similar strategy is employed in Fig. 2b. From Fig. 2b, we can observe that the faster K
                        
                           con
                         degrades with distance as the value of n grows. For example, although point A is 3 while B which is far from x
                        =0 is 9, due to varying n, the values of K
                        
                           con
                         at points A and B are almost identical. It seems as if the point B is as near as A to x
                        =0 in terms of the value of K
                        
                           con
                        . Similar results can be observed for points C and D and it seems as if the point C is as far as D from x
                        =0. As a result, if one wants to separate two closely-neighbored objects or preserve edges, the large n can be used such that nearby points are less weighed as if they are far away. On the other hand, if the concavity is too deep, small n can be employed to weigh relatively more on faraway points as if they are nearby.


                        Fig. 3
                         shows two examples of the GVC snake. These experiments are implemented in MATLAB on an Intel Core2 2.66GHz processor with 2GB RAM. The room and U-shape images are coined in [23] to demonstrate capture range enlarging and concavity convergence. The size of both images is 64×64. The parameters for GVC are h
                        =0, n
                        =2.0, the kernel size is the same as that of the image. The GVC is able to obtain similar results as the GVF (see [23]). It is worth noting that the execution time of GVC for both images is 0.027s while that of GVF is 2.36s with 50 iterations.

Furthermore, we use the C-shape image of 256×256pixels to verify the performance of the GVC snake on concavity convergence. We apply the GVF [23], VEF [39], VFC [40] and GVC snakes to a C-shape image, as shown in Fig. 4
                        . The difference between C-shape concavity and U-shape concavity is that the C-shape is semi-close, while the U-shape is open. The results show that the GVC snake evolves into the concave region progressively, steadily and correctly. In contrast, others fail. The success of GVC snake is ascribed to the larger weight on faraway points with a small n. The parameters of GVC snake are: α
                        =0.5, β
                        =0.5, time step τ
                        =1, h
                        =1 and n
                        =2.6.

In a short-axis view of cardiac MR images, the myocardium is a dark area between two concentric circles enclosing a bright area corresponding to the blood in LV. Under breath-hold condition, LV moves more obviously than its surrounding structures that are almost static during the cardiac cycle. This trait encourages intensity difference algorithm upon two consecutive frames in temporal image sequences to remove stationary background structures, and then localizes the moving region of the left ventricle.

To more robustly localize the LV, we adopt the fourth-order partial differential equations (PDEs) for noise removal [41]. The Euler equation of fourth-order PDEs is expressed as
                           
                              (7)
                              
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 c
                                 (
                                 |
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 I
                                 |
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 I
                                 ]
                                 ,
                              
                           
                        where ∇2 denotes Laplacian operator, and c(·) is a nonnegative and decreasing function. This anisotropic diffusion can selectively smooth the image to preserve the object edge and to remove the noise within homogeneous regions. Applying Eq. (7) to cardiac MR images, the myocardium region would be highlighted.

Suppose a cardiac MR images sequence I
                        
                           t
                        (x,
                        y), where (x,
                        y) denotes the spatial coordinates of an image and t
                        ∈
                        T is the time instant. The nearly non-moving background pixels in two consecutive frames are excluded by the difference or subtraction operation defined as D(x,
                        y)=[I
                        
                           t+1(x,
                        y)−
                        I
                        
                           t
                        (x,y)]>
                        Th. Here D(x,y) is the intensity difference image, Th is a threshold value which we consider as non-moving background. Th is estimated by the OTSU method [42]. Observing the Fig. 5
                        , the intensity values near the myocardial boundaries are different from those in other regions because of larger movement of the LV. The dense highlighted circle-like region implies that the endocardium moves faster than the epicardium. Applying Hough transform to the difference image, we can obtain the LV centroid and the region of interest represented by a yellow solid circle.

Though MRI provides quite good contrast between the myocardium and the blood pool, the difficulties in segmenting the endocardium originate primarily from artifacts and papillary muscles. In the classical internal energy of snake model (see Eq. (1)), the first and second derivatives control the continuity and smoothness of the curve, respectively. However, continuity and smoothness are only local geometrical properties. For example, if there exist weak boundaries, the snake contour is not able to bridge such gaps in which there is no prior information accounting for the holistic shape of an object. In addition, if there are local minima caused by imperfectness of the external force, the snake contour would be strapped. A solution to these issues is to incorporate the shape prior into snake energies. Observed that the endocardium of the LV is roughly a circle, a circle-shape constraint [43] is adopted for the endocardium segmentation. It is formulated as
                           
                              (8)
                              
                                 
                                    
                                       E
                                    
                                    
                                       endo
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       R
                                       (
                                       s
                                       )
                                       -
                                       
                                          
                                             R
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ds
                                 ,
                              
                           
                        where 
                           
                              R
                              (
                              s
                              )
                              =
                              
                                 
                                    
                                       
                                          (
                                          x
                                          (
                                          s
                                          )
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          y
                                          (
                                          s
                                          )
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              x
                              (
                              s
                              )
                              ds
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              y
                              (
                              s
                              )
                              ds
                           
                        , 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              R
                              (
                              s
                              )
                              ds
                           
                        . (x
                        
                           c
                        ,
                        y
                        
                           c
                        ) is the centroid of the snake contour. The energy Eq. (8) measures the deviation of the snake contour from a circle with radius 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         and center (x
                        
                           c
                        ,
                        y
                        
                           c
                        ). Both 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         and (x
                        
                           c
                        ,
                        y
                        
                           c
                        ) are dynamic with the evolution of the snake contour. If the snake contour is attracted by artifacts or papillary muscle, this constraint would penalize the snake contour to be a circle, thus, the global shape of the LV would be maintained.

Suppose that there are n discrete points on the snake contour, the center (x
                        
                           c
                        ,
                        y
                        
                           c
                        ) can be estimated by 
                           
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        , and 
                           
                              R
                              (
                              i
                              )
                              =
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        , i
                        =1,2,…,
                        n, 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                        . Since
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         R
                                                         (
                                                         s
                                                         )
                                                         -
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         R
                                                         (
                                                         s
                                                         )
                                                         -
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   2
                                                   π
                                                   s
                                                   )
                                                   +
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   2
                                                   π
                                                   s
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         R
                                                         (
                                                         s
                                                         )
                                                         cos
                                                         (
                                                         2
                                                         π
                                                         s
                                                         )
                                                         -
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         cos
                                                         (
                                                         2
                                                         π
                                                         s
                                                         )
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         R
                                                         (
                                                         s
                                                         )
                                                         sin
                                                         (
                                                         2
                                                         π
                                                         s
                                                         )
                                                         -
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         sin
                                                         (
                                                         2
                                                         π
                                                         s
                                                         )
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   R
                                                   (
                                                   s
                                                   )
                                                   cos
                                                   (
                                                   2
                                                   π
                                                   s
                                                   )
                                                   =
                                                   x
                                                   (
                                                   s
                                                   )
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   R
                                                   (
                                                   s
                                                   )
                                                   sin
                                                   (
                                                   2
                                                   π
                                                   s
                                                   )
                                                   =
                                                   y
                                                   (
                                                   s
                                                   )
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        by the calculus of variation, the discrete Euler equation of Eq. (8) is given by
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   cos
                                                   (
                                                   2
                                                   π
                                                   i
                                                   /
                                                   n
                                                   )
                                                   )
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   sin
                                                   (
                                                   2
                                                   π
                                                   i
                                                   /
                                                   n
                                                   )
                                                   )
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The solution of Eq. (9) obtained by treating x and y as the functions of time t is expressed as
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         Δ
                                                         t
                                                      
                                                   
                                                   +
                                                   λ
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   -
                                                   λ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            cos
                                                            (
                                                            2
                                                            π
                                                            i
                                                            /
                                                            n
                                                            )
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         Δ
                                                         t
                                                      
                                                   
                                                   +
                                                   λ
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   -
                                                   λ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            sin
                                                            (
                                                            2
                                                            π
                                                            i
                                                            /
                                                            n
                                                            )
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Eq. (2) will collaborate with Eq. (10) to extract the endocardium, and the force vector −∇g(C(s)) in Eq. (2) will be replaced by [u(x,
                        y), v(x,
                        y)] in Eq. (6).

The contrast between the myocardium and surrounding tissues (e.g. fat, lung and liver) is poor, and thus it would be more difficult to segment the epicardium [18]. In practice, the segmented endocardium would be beneficial significantly to segment the epicardium. We exploit the relationship between the endocardium and the epicardium in shape and position for the epicardium segmentation in the following aspects: (1) using the endocardium result as initialization to automatically segment the epicardium; (2) the endocardium is always encircled by or nearby the epicardium so that one can build new external force according to this position relationship; (3) the endocardium usually resembles the epicardium in shape, thus, the endocardium may serve as a priori shape to guide the segmentation of the epicardium. With these strategies, the epicardium is automatically extracted after the endocardium is segmented.

Since the endocardium is a local minimum, this prevents the GVC active contour moving into the boundary of epicardium. In order to extract automatically the epicardium by taking the endocardium as initialization, the local minimum stemming from the endocardium edge should be filtered out. To this end, we directly set the original edge map around and within the endocardium to zero. This modified edge map is used to generate a new GVC force field, which leads to the fact that the endocardium is no longer a local minimum of the new GVC force. This new GVC force, thus, can push the endocardium forward to the epicardium directly. In addition, since the endocardium and epicardium are adjacent, the capture range of the new GVC force needs not to be very large, so it takes even shorter time to calculate.


                           Fig. 6
                            illustrates the effectiveness of the modified edge map for the epicardium segmentation. From left to right, the upper row in Fig. 6 shows the original edge map, the GVC field and the segmentation result, respectively. Since the myocardium is thin and the initial contour should avoid critical points in the force field [44], it is feasible to segment the epicardium using the original force field. Moreover, the original force field flows into the myocardium at the weak epicardium boundaries (see the white ellipse on the upper row in Fig. 6). In contrast, when the edge map is modified using the proposed strategy, as shown in lower row in Fig. 6, the associated force field can characterize the epicardium very well.

Generally speaking, there would be spurious edges on the myocardium, and the contrast between myocardium and surrounding structures is low. Even though the endocardium edge is removed, the new external force would not be good enough to prevent the snake contour from leaking out from weak boundaries. In order to get a more accurate segmentation result of the epicardium, we employ the endocardium result as a priori shape and construct a new shape-similarity based constraint given by
                              
                                 (11)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          epi
                                       
                                    
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          (
                                          R
                                          (
                                          s
                                          )
                                          -
                                          
                                             
                                                R
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                          -
                                          (
                                          r
                                          (
                                          s
                                          )
                                          -
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    ds
                                    .
                                 
                              
                           The variables in Eq. (11) have similar meanings as in Eq. (8), but R and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                              
                            are for epicardium while r and 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                            are for segmented endocardium. The snake contour for epicardium is supposed to be identically centered with the endocardium. It is clear in Section 4.2 that 
                              
                                 r
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                            measures the deviation of the endocardium contour from a circle with radius 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                            at snaxel s
                           
                              i
                           , thus 
                              
                                 R
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                              
                            measures the deviation of the snake contour for epicardium from a circle with radius 
                              
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                              
                            at snaxel s
                           
                              i
                           . Minimizing the energy E
                           
                              epi
                            will make two deviations small, finally the snake contour for epicardium will resemble the endocardium in shape although their scales, i.e., 
                              
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                            are different.

Similar to Eq. (8), by the calculus of variation, we obtain the Euler equation for Eq. (11) as follows:
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            endo
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                      -
                                                      (
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                      cos
                                                      (
                                                      2
                                                      π
                                                      s
                                                      )
                                                      )
                                                      =
                                                      0
                                                   
                                                
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            endo
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                      -
                                                      (
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                      sin
                                                      (
                                                      2
                                                      π
                                                      s
                                                      )
                                                      )
                                                      =
                                                      0
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

It is discretized as
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            endo
                                                         
                                                      
                                                      -
                                                      (
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                      cos
                                                      (
                                                      2
                                                      π
                                                      i
                                                      /
                                                      n
                                                      )
                                                      )
                                                      =
                                                      0
                                                   
                                                
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            endo
                                                         
                                                      
                                                      -
                                                      (
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                      sin
                                                      (
                                                      2
                                                      π
                                                      i
                                                      /
                                                      n
                                                      )
                                                      )
                                                      =
                                                      0
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           This equation can be solved in the same way as Eq. (10) by taking x and y as the function of time t. Similarly, Eq. (2) will collaborate with Eq. (13) to extract the epicardium, and the force vector −∇g(C(s)) in Eq. (2) will be replaced by [u(x,
                           y), v(x,
                           y)] in Eq. (6) using the modified edge map in Section 4.3.1.

To evaluate the performance of the proposed algorithm, we compare our method with three shape-based snake methods including the radial GVF snake (referred to as RGVF) [13], level-set method (referred to as LSM) [11] and max-flow method (referred to as MFM) [2]. The parameters of our model are α
                     =0.5, β
                     =0.5, λ
                     =0.4, ρ
                     =1.2, h
                     =8 and n
                     =2.6.

In our experiments, we test the above-mentioned methods on two datasets: MICCAI 2009 and our own dataset. Cardiac cine MRI data of MICCAI 2009 is provided by the MICCAI 2009 cardiac MR LV segmentation challenge organizers. The scanning protocol and evaluation criterion of this dataset are fully described in [38]. Images of our own dataset (126 images) were acquired using a 1.5T Siemens MRI scanner from a healthy volunteer. Typical parameters were TR: 29.16ms; TE: 1.08ms; flip angle: 50°; image dimension: 192×156; typical spatial resolution: 1.82×1.82mm2 in-plane; and slice thickness: 8mm. There are 7 slices covering the entire LV from the apex to the base, and 21 cardiac phases in each slice.

In this paper, we evaluate the RGVF, LSM, MFM and our methods qualitatively and quantitatively. For qualitative assessments, we present representative segmentation results from each dataset. For quantitative evaluation, we use the mean absolute distance (MAD) [45] as well as the Dice metric (DM) [2]. Suppose there are n points on the snake contour denoted by S
                        ={s
                        1,
                        s
                        2,…,
                        s
                        
                           n
                        }, k points on the ground truth expressed as M
                        ={m
                        1,
                        m
                        2,…,
                        m
                        
                           k
                        }, the MAD is defined as
                           
                              (14)
                              
                                 MAD
                                 (
                                 S
                                 ,
                                 M
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          d
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          M
                                          )
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          d
                                          (
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          S
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        whered(s
                        
                           i
                        ,
                        M)=min
                           j
                        ∥s
                        
                           i
                        
                        −
                        s
                        
                           j
                        ∥ is the distance from point s
                        
                           i
                         to the closet point on contour M. The Dice metric (DM) [2] is a measure of contour overlap utilizing the contour areas automatically segmented 
                           A
                        
                        
                           a
                        , manually segmented 
                           A
                        
                        
                           m
                        , and their intersection 
                           A
                        
                        
                           am
                        . It is given by
                           
                              (15)
                              
                                 DM
                                 =
                                 2
                                 
                                    
                                       A
                                    
                                    
                                       am
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       +
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 .
                              
                           
                        DM is always between 0 and 1, with higher DM indicating better match between automatic and manual segmentations.

In this section, we demonstrate the effectiveness of the proposed circle-shape constraint and the shape-similarity constraint for segmenting the LV. Fig. 7
                         illustrates segmentation results of the endocardium using the circle-shape energy to conquer the papillary muscle and artifacts. The images are taken from mid-ventricle slice, where the papillary muscles are obstacles for the GVC snake model. When the initial contour excludes the papillary muscles, the snake contour halts at the papillary muscles and artifacts (see Fig. 7a) unless the initial contour is close enough to the endocardium. In contrast, when the global shape constraint is incorporated into the GVC snake model, the snake contour conquers the papillary muscles successfully and sticks to the endocardium (see Fig. 7b). In addition, we demonstrate the effectiveness of the shape similarity energy for epicardium extraction, as shown in Fig. 8
                        . Although the enhanced external force characterizes the epicardium very well, the result in the upper row of Fig. 8 leaked out due to the nearby artifacts in the lung region. In contrast, when the shape similarity energy is incorporated, the snake contour works well to delineate the epicardium (see the lower row of Fig. 8).


                        Fig. 9
                         depicts the segmentation results of LV with and without shape prior information on MICCAI 2009 dataset. Without shape based constraint, the external force field pulls the snake to a false contour shown in Fig. 9a. These results are hardly to be accepted. Fig. 9b shows that the shape based energy functionals presented in Eqs. (8) and (11) are efficient to push the snake contours to the desire solution. Fig. 10
                         illustrates the MAD errors corresponding to Fig. 9 of one subject on MICCAI 2009 dataset with and without constraints. Overall, the shape information of LV is integrated to the GVC snake model to effectively alleviate the effect of papillary muscle and noise, and to prevent the snake contour from leaking out from weak boundaries.

From the qualitative comparisons depicted in Fig. 11
                        , we can see that the segmentation results of both LSM and RGVF methods are noticeably worse than those of both MFM and our methods, at some frames (such as around the frames 9, 19, 20 and 21). It can be explained that the LSM method is based on the assumption that the overlap is approximately constant, thus a high variation of the overlap in the given sequence will affect segmentation accuracy. Since the myocardium is thin during ventricular diastole, the RGVF contour is evaluated along 1D radial direction rather than 2D image plane, as a result, the segmented contour is sensitive to the neighbor organs such as the liver. In contrast, The MFM and our methods obtain good results.


                        Table 1
                         and Fig. 12
                         show quantitative evaluations on our own dataset (126 images) for RGVF, MFM, LSM and our methods. The first two rows in Table 1 report the DM statistics, where DM is given by mean±standard deviation. For the cavity detection, MFM and our methods lead to a region accuracy slightly better than both LSM and RGVF methods. The second two rows in Table 1 shows average MAD (in pixels) of these models. We see that our method outperforms the other approaches.

We also run our algorithm on the MICCAI 2009 dataset. Look from visuality, these methods obtain similar results, as shown in Fig. 13
                        . However, our method is able to achieve much more accurate and consistent segmentation results, as shown in Fig. 14
                        . The average MAD of RGVF, LSM, MFM and our methods for the endocardium segmentation are 9.06pixels, 7.21pixels, 4.79pixels and 5.06pixels, respectively, and those of the epicardium are 7.85pixels, 5.70pixels, 5.23pixels and 5.18pixels, respectively. Overall, the proposed method could conquer image noise, artifacts, weak boundaries and papillary muscles perfectly on both endocardial and epicardial boundaries extraction. Nevertheless, our method remains great MAD errors during segmenting the endocardium, especially at the frames 7, 13 and 17. Around at these frames, the blood pool has almost the same intensity profile (e.g. the papillary muscles within the cavity and the myocardium). More representative images on MICCAI 2009 dataset are shown in Fig. 15
                        .

@&#DISCUSSION@&#

Although the results obtained by our method are desirable, one significant assumption is that the shape of the LV is pre-defined circularly. This assumption limits a more extensive exploration of our method for the LV segmentation. Moreover, A major difficulty in segmentation of MR images is the intensity inhomogeneity due to the radio-frequency coils or acquisition sequences. There exists the inefficiency in handling images with severe intensity inhomogeneity. Fig. 16
                         shows failed segmentation cases of our method, in which the myocardium and its neighbor organs such as the liver are connected, resulting in the same intensity profile. Segmenting such region of interest is extremely difficult because the contour is almost indistinguishable in this situation, even for human eyes. Different from the MFM method [2], the proposed approach requires a large number of iterative updates of the segmentation, thus, is computationally onerous. Running on a Intel Core2 2.66GHz processor with 2GB RAM, on average, our implementation needs 4.76s to process a frame of 256×256pixels. These issues motivate us to develop a more efficient LV segmentation algorithm in future.

We have presented an automatic algorithm for left ventricle segmentation in cardiac cine MRI based on the gradient vector convolution (GVC) snake model. The GVC model possesses similar properties of the GVF model and it can be implemented in real time due to its convolutional nature. Based on GVC snake model, Hough transform is first applied to intensity difference image computed between two consecutive frames in temporal image sequences to locate LV centroid and the region of interest (ROI). A circle-shape based energy is integrated into the snake model for extracting the endocardium to conquer papillary muscle and artifacts. After endocardium extraction, both the GVC external force modified skillfully and shape-similarity based constraint reactivate the snake contour forward to epicardial contour successively. Comparative results on both our dataset and the MICCAI 2009 dataset demonstrated a good performance of the proposed segmentation approach against the state-of-the-art methods.

@&#ACKNOWLEDGMENTS@&#

The authors thank both the editor and the reviewers for the invaluable comments and suggestions that help a great deal in improving the manuscript. This work was supported in part by the Natural Science Foundation of China (NSFC) under Grant Nos. 90920009 and 60602050, and the Key Program from the Tianjin Commission of Technology of China under Grant No. 11JCZDJC15600.

@&#REFERENCES@&#

