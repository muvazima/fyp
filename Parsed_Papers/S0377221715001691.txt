@&#MAIN-TITLE@&#A semidefinite optimization-based approach for global optimization of multi-row facility layout

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a new model for the Multi-Row Facility Layout Problem.


                        
                        
                           
                           We expresses the problem as a discrete optimization problem.


                        
                        
                           
                           We construct a semidefinite relaxation of the discrete optimization formulation.


                        
                        
                           
                           The proposed approach yields promising computational results.


                        
                        
                           
                           This is the first global optimization approach for general multi-row layouts.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facilities planning and design

Flexible manufacturing systems

Semidefinite programming

Combinatorial optimization

Global optimization

@&#ABSTRACT@&#


               
               
                  This paper is concerned with the Multi-Row Facility Layout Problem. Given a set of rectangular departments, a fixed number of rows, and weights for each pair of departments, the problem consists of finding an assignment of departments to rows and the positions of the departments in each row so that the total weighted sum of the center-to-center distances between all pairs of departments is minimized. We show how to extend our recent approach for the Space-Free Multi-Row Facility Layout Problem to general Multi-Row Facility Layout as well as some special cases thereof. To the best of our knowledge this is the first global optimization approach for multi-row layout that is applicable beyond the double-row case. A key aspect of our proposed approach is a model for multi-row layout that expresses the problem as a discrete optimization problem, and thus makes it possible to exploit the underlying combinatorial structure. In particular we can explicitly control the number and size of the spaces between departments. We construct a semidefinite relaxation of the discrete optimization formulation and present computational results showing that the proposed approach gives promising results for several variants of multi-row layout problems on a variety of benchmark instances.
               
            

@&#INTRODUCTION@&#

The general facility layout design problem is concerned with placing departments of given areas within a given facility. To each possible placement is assigned a cost based on the interactions between each pair of departments. These costs reflect an appropriate measure of adjacency preferences between departments. In some versions of the problem, the dimensions of the departments are also given. When this is not the case, finding their optimal shape is also a part of the problem. This problem is known to be NP-hard in general.

Versions of the facility layout problem occur in many practical contexts, not only in the planning of production and logistics facilities but also in applications such as VLSI chip design. A thorough survey of the facility layout problem is given in Meller and Gau (1996), where the papers on facility layout are divided into three broad areas. The first is concerned with algorithms for tackling the layout problem as defined above. The second area is concerned with extensions of the problem in order to account for additional issues that arise in applications, such as designing dynamic layouts by taking time-dependency issues into account, designing layouts under uncertainty conditions, and achieving layouts that optimize two or more objectives simultaneously. The third area is concerned with specially structured instances of the problem, such as the linear layout of machines along production lines. This paper is concerned with one such structured instance, namely the Multi-Row Facility Layout Problem (MRFLP).

An instance of
                      the Multi-Row Facility Layout Problem (MRFLP) consists of a set of rectangular departments, a given number of rows, and weights for each pair of departments. We assume without loss of generality that each department can be assigned to any of the given rows, that the rows all have the same height, that the distances between adjacent rows are all equal, and that the departments all have the same height (equal to the row height). The problem is to find an assignment of departments to rows and the positions of the departments in each row so that the total weighted sum of the center-to-center distances between all pairs of departments is minimized. The (MRFLP) has many applications such as computer backboard wiring (Steinberg, 1961), campus planning (Dickey and Hopkins, 1972), scheduling (Geoffrion & Graves, 1976), typewriter keyboard design (Pollatschek, Gershoni, & Radday, 1976), hospital layout (Elshafei, 1977), the layout of machines in an automated manufacturing system (Heragu and Kusiak, 1991), balancing hydraulic turbine runners (Laporte and Mercure, 1988), numerical analysis (Brusco and Stahl, 2000) and optimal digital signal processors memory layout generation (Wess and Zeitlhofer, 2004). There has not been much research done on metaheuristic approaches to row layout problems with spacing, see e.g. the recent papers of Murray, Smith, and Zhang (2013) and Zuo, Murray, and Smith (2014). In this paper, we focus on mathematical programming approaches that can certify global optimality of solutions, or at least provide a guaranteed bound on the gap to optimality.

Row layout problems in general are of special interest for optimizing flexible manufacturing systems (FMSs). FMSs are automated production systems, typically consisting of numerically controlled machines and material handling devices under computer control, which are designed to produce a variety of parts. In FMSs the layout of the machines has a significant impact on the materials handling cost and time, on throughput, and on productivity of the facility. A poor layout may also negate some of the flexibilities of an FMS (Hassan, 1994). The type of material-handling devices used such as handling robots, automated guided vehicles (AGVs), and gantry robots typically determines machine layout in an FMS (Nearchou, 2006).

Possible row layout types are single-row (Fig. 1), double-row and multi-row layout (Fig. 2). The Single-Row Facility Layout Problem (SRFLP) requires that the departments be placed next to each other along a single row; this simplifies the problem significantly. In particular, there is no need to assign each department to a row, and the optimal solution will not have any empty space between departments. Therefore solving the (SRFLP) consists of finding the optimal permutation of the departments. This problem arises for example as the problem of ordering stations on a production line where the material flow is handled by an AGV travelling in both directions on a straight-line path (Heragu and Kusiak, 1988) (see Fig. 1). Several heuristic algorithms have been suggested to tackle large instances; the best ones to date are Datta, Amaral, and Figueira (2011), Kothari and Ghosh (2013a, 2013b, 2014) and Samarghandi and Eshghi (2010).

Three problems closely related to the (SRFLP) are the Single-Row Equidistant Facility Layout Problem (SREFLP), the Linear Arrangement Problem (LAP), and the k-Parallel Row Ordering Problem (kPROP). The (SREFLP) is the special case of the (SRFLP) with all departments equal in shape and the positions where they can be placed on the rows fixed in advance; it is sometimes also called one-dimensional machine location problem (Sarker, Wilhelm, & Hogg, 1998) or linear machine-cell location problem (Yu & Sarker, 2003). On the other hand, the (kPROP) is an extension of the (SRFLP) that considers arrangements of the departments along more than one row but with each department being assigned to a specific row in advance; hence the objective of the (kPROP) is to find a permutation of the departments within each row so that the total weighted sum of the center-to-center distances between all pairs of departments (with a common left origin) is minimized. If the (kPROP) is restricted to two rows we simply call it (PROP). Applications of the (kPROP) are the arrangement of departments along two or more parallel straight lines on a floor plan, the construction of multi-floor buildings, and the layout of machines in FMSs. We mention that even the (LAP), which is a special case of the (SREFLP) where all weights are binary, is already an NP-hard problem (Garey, Johnson, & Stockmeyer, 1974), and it remains so even if the underlying graph is bipartite (Garey & Johnson, 1979).

In layout problems, the pairwise connectivities are usually assumed to be non-negative to ensure boundedness of the objective value of the optimal layout. For the (SRFLP) and the other problems closely related to it, this further guarantees that all departments are placed next to each other without spacing. More generally, the (kPROP) can be further extended to the Space-Free Multi-Row Facility Layout Problem (SF-MRFLP) in which the optimization is also carried out with respect to the row assignments. This is a particular version of the (MRFLP) in which all the rows have a common left origin and no empty space is allowed between departments (Hungerl√§nder & Anjos, 2012). If we restrict the (SF-MRFLP) to two rows we obtain the Space-Free Double-Row Facility Layout Problem (SF-DRFLP) as a special case that has been applied in spine layout design. Spine layouts, introduced by Tompkins (1980), require departments to be located along both sides of specified corridors along which all the traffic between departments takes place. Although in general some spacing is allowed, layouts with no spacing are much preferable since spacing often translates into higher construction costs for the facility.

The special case of the Double-Row Facility Layout Problem (DRFLP) can be viewed as a natural extension of the (SRFLP) in the manufacturing context when one considers that an AGV can support stations located on both sides of its linear path of travel (see Fig. 2). This is a common approach in practice for improved material handling and space usage. Furthermore, since real factory layouts most often reduce to double-row problems or a combination of single-row and double-row problems, the (DRFLP) and its space-free counterpart (SF-DRFLP), sometimes called the corridor allocation problem, are especially relevant for real-world applications.

We use a small example to illustrate the differences between the (SRFLP), the (kPROP), the (SF-MRFLP) and the (MRFLP). We consider a problem with two rows so that we actually have instances of the (SRFLP), (PROP), (SF-DRFLP) and (DRFLP) respectively. Consider four departments with lengths ‚Ñì1 = 1,‚Äâ‚Ñì2 = 2,‚Äâ‚Ñì3 = 3,‚Äâ‚Ñì4 = 4 and pairwise connectivities c
                              12 = c
                              14 = c
                              34 = 1,‚Äâc
                              13 = c
                              24 = 2. Fig. 3
                               illustrates the optimal layouts and the associated costs for the four different problems:

                                 
                                    ‚Ä¢
                                    In (a) we display the optimal layout for the (SRFLP) with corresponding total cost of 3 ¬∑ 2 + 2.5 ¬∑ 1 + 2 ¬∑ 2 + 5.5 ¬∑ 1 + 4.5 ¬∑ 1 = 22.5.

In (b) we show the optimal layout for the (PROP) with departments 2 and 3 assigned to row 1 and departments 1 and 4 assigned to row 2. The corresponding cost is 3.5 ¬∑ 1 + 1 ¬∑ 2 + 1 ¬∑ 2 + 1.5 ¬∑ 1 + 2.5 ¬∑ 1 = 11.5.

In (c) we display the optimal layout for the (SF-DRFLP). The associated cost is 1.5 ¬∑ 1 + 2 ¬∑ 2 + 0.5 ¬∑ 1 + 1 ¬∑ 2 + 2.5 ¬∑ 1 = 10.5.

Finally we depict the optimal layout for the (DRFLP) in (d). The corresponding cost is 2.5 ¬∑ 1 + 2.5 ¬∑ 1 + 2.5 ¬∑ 1 = 7.5.

The contribution of this paper is a new model for (MRFLP) that expresses the problem as a discrete optimization problem. This makes it possible to exploit the underlying combinatorial structure, and in particular to explicitly control the number and size of the spaces between departments. This discrete optimization model is an extension of our recent approach for the (SF-MRFLP) to the more general (MRFLP) and also captures some of its important special cases. We then construct a semidefinite relaxation of the discrete optimization formulation and present computational results showing that the proposed approach gives promising results for several variants of multi-row layout problems on a variety of benchmark instances. To the best of our knowledge this is the first global optimization approach for (MRFLP) that is applicable beyond the double-row case.

The paper is structured as follows. In Section 2 we summarize the various global optimization approaches in the literature for row layout problems closely related to multi-row layout, including the (SF-MRFLP). Section 3 presents the theoretical results underpinning our new discrete optimization model for (MRFLP). The key result is Theorem 2 showing that if all departments lengths are integer then there is always an optimal solution to the (MRFLP) on the half grid. Section 4 covers the main techniques used for solving the SDP relaxations, and detailed computational results are reported in Section 5.

In this section we review the literature on global optimization approaches for the single-row, double-row and space-free versions of the (MRFLP), with an emphasis on the most recent developments. This sets the foundations for the methodology we propose in Section 3 for the general (MRFLP).

The (SRFLP) is one of the few layout problems for which strong global lower bounds and even optimal solutions can be computed for instances of reasonable size. Pioneering approaches for (SRFLP) were based on dynamic programming (Picard & Queyranne, 1981), integer linear optimization (ILO; Love & Wong, 1967) and nonlinear optimization (Heragu & Kusiak, 1988). We outline here the more recent global optimization approaches that are based on either ILO or semidefinite optimization (SDO) relaxations.

Let œÄ = (œÄ
                        1, ‚Ä¶, œÄn
                        ) denote a permutation of the indices [n] ‚âî {1, 2, ‚Ä¶, n} of the departments. Given œÄ and two distinct departments i and j, the center-to-center distance between i and j with respect to this permutation is 
                           
                              
                                 1
                                 2
                              
                              
                                 ‚Ñì
                                 i
                              
                              +
                              
                                 D
                                 œÄ
                              
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 ‚Ñì
                                 j
                              
                              ,
                           
                         where DœÄ
                        (i, j) denotes the sum of the lengths of the departments between i and j in the ordering defined by œÄ. In other words, the (SRFLP) is:

                           
                              
                                 
                                    
                                       min
                                       
                                          œÄ
                                          ‚àà
                                          
                                             Œ†
                                             n
                                          
                                       
                                    
                                    
                                       ‚àë
                                       
                                          
                                             
                                                
                                                   i
                                                   ,
                                                   j
                                                   ‚àà
                                                   [
                                                   n
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                   <
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       [
                                       
                                          1
                                          2
                                       
                                       
                                          ‚Ñì
                                          i
                                       
                                       +
                                       
                                          D
                                          œÄ
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          ‚Ñì
                                          j
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where Œ†n
                         denotes the set of all permutations of [n], and the weights cij
                         are usually assumed to be non-negative to ensure boundedness of the objective value of the optimal layout.

It was already observed by Simmons (1969) that the crux of the problem is to minimize ‚àë
                           i < j
                        
                        cijDœÄ
                        (i, j) over all permutations œÄ ‚àà Œ†n
                        . It is also clear that 
                           
                              
                                 D
                                 œÄ
                              
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                              =
                              
                                 D
                                 
                                    œÄ
                                    ‚Ä≤
                                 
                              
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                              ,
                           
                         where œÄ‚Ä≤ denotes the permutation symmetric to œÄ, defined by 
                           
                              
                                 œÄ
                                 i
                                 ‚Ä≤
                              
                              =
                              
                                 œÄ
                                 
                                    n
                                    +
                                    1
                                    ‚àí
                                    i
                                 
                              
                              ,
                              
                              i
                              ‚àà
                              
                                 [
                                 n
                                 ]
                              
                           
                        . Hence, it is possible to simplify the problem by considering only the permutations for which, say, department 1 is on the left half of the arrangement. This type of symmetry-breaking strategy is important for reducing the computational requirements of most algorithms, including those based on LO or dynamic programming.

It is also clear that the key concept required for modelling the (SRFLP) is betweenness. This is because DœÄ
                        (i, j) is precisely the sum of the lengths of the departments between i and j. We thus define the betweenness variables Œ∂ijk
                         for triplets i, j, k of departments

                           
                              
                                 
                                    
                                       Œ∂
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   department
                                                   
                                                   
                                                   k
                                                   
                                                   
                                                      lies
                                                      
                                                      between
                                                      
                                                      departments
                                                   
                                                   
                                                   i
                                                   
                                                   and
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and the betweenness polytope as the convex hull of the incidence vectors Œ∂ijk
                         corresponding to feasible solutions:

                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             Btw
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             conv
                                             {
                                             Œ∂
                                             ‚àà
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   n
                                                   (
                                                   n
                                                   ‚àí
                                                   1
                                                   )
                                                   (
                                                   n
                                                   ‚àí
                                                   2
                                                   )
                                                
                                             
                                             :
                                             Œ∂
                                             
                                             arises
                                             
                                             from
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             a
                                             
                                             permutation
                                             
                                             of
                                             
                                             [
                                             n
                                             ]
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        This polytope is well understood, see e.g. Christof (1997). Using betweenness variables, one can express DœÄ
                        (i, j) = ‚àë
                           k
                        ‚Ñì
                           k
                        
                        Œ∂ijk
                         and hence the (SRFLP) as a linear optimization problem over the betweenness polytope.

The ILO model proposed by Amaral (2009) uses precisely this idea. Since an exact description of 
                           
                              P
                              Btw
                           
                         is not known, Amaral proposes to optimize over a partial description of it. The starting LO relaxation is:

                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   i
                                                   <
                                                   j
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                [
                                                
                                                   1
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      ‚Ñì
                                                      i
                                                   
                                                   +
                                                   
                                                      ‚Ñì
                                                      j
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ‚àë
                                                   
                                                      k
                                                      ‚â†
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                   ‚Ñì
                                                   k
                                                
                                                
                                                   Œ∂
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                Œ∂
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   i
                                                   k
                                                   j
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             {
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             }
                                             ‚äÜ
                                             [
                                             n
                                             ]
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œ∂
                                                
                                                   i
                                                   j
                                                   d
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   j
                                                   k
                                                   d
                                                
                                             
                                             ‚àí
                                             
                                                Œ∂
                                                
                                                   i
                                                   k
                                                   d
                                                
                                             
                                             ‚â•
                                             0
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             {
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ,
                                             d
                                             }
                                             ‚äÜ
                                             [
                                             n
                                             ]
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œ∂
                                                
                                                   i
                                                   j
                                                   d
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   j
                                                   k
                                                   d
                                                
                                             
                                             ‚àí
                                             
                                                Œ∂
                                                
                                                   i
                                                   k
                                                   d
                                                
                                             
                                             ‚â•
                                             0
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             {
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ,
                                             d
                                             }
                                             ‚äÜ
                                             [
                                             n
                                             ]
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œ∂
                                                
                                                   i
                                                   j
                                                   d
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   j
                                                   k
                                                   d
                                                
                                             
                                             +
                                             
                                                Œ∂
                                                
                                                   i
                                                   k
                                                   d
                                                
                                             
                                             ‚â§
                                             2
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             {
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ,
                                             d
                                             }
                                             ‚äÜ
                                             [
                                             n
                                             ]
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ‚â§
                                             
                                                Œ∂
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ‚â§
                                             1
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             {
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             }
                                             ‚äÜ
                                             [
                                             n
                                             ]
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where the indices i, j, k, d are always all different. Amaral also proposes a class of valid inequalities for 
                           
                              P
                              Btw
                           
                         that can be used as cuts to improve the (LP) relaxation:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   t
                                                   <
                                                   q
                                                   ,
                                                   t
                                                   ‚àà
                                                   
                                                      S
                                                      1
                                                   
                                                   ,
                                                   q
                                                   ‚àà
                                                   
                                                      S
                                                      1
                                                   
                                                
                                             
                                             
                                                Œ∂
                                                
                                                   t
                                                   q
                                                   r
                                                
                                             
                                             +
                                             
                                                ‚àë
                                                
                                                   t
                                                   <
                                                   q
                                                   ,
                                                   t
                                                   ‚àà
                                                   
                                                      S
                                                      2
                                                   
                                                   ,
                                                   q
                                                   ‚àà
                                                   
                                                      S
                                                      2
                                                   
                                                
                                             
                                             
                                                Œ∂
                                                
                                                   t
                                                   q
                                                   r
                                                
                                             
                                             ‚àí
                                             
                                                ‚àë
                                                
                                                   t
                                                   ‚àà
                                                   
                                                      S
                                                      1
                                                   
                                                   ,
                                                   q
                                                   ‚àà
                                                   
                                                      S
                                                      2
                                                   
                                                
                                             
                                             
                                                Œ∂
                                                
                                                   min
                                                   {
                                                   t
                                                   ,
                                                   q
                                                   }
                                                   ,
                                                   max
                                                   {
                                                   t
                                                   ,
                                                   q
                                                   }
                                                   ,
                                                   r
                                                
                                             
                                             ‚â§
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        where Œ≤ ‚â§ n is a positive even integer, S‚äÜ[n] such that |S| = Œ≤, and (S
                        1, S
                        2) is a partition of S\{r} such that r ‚àà S and 
                           
                              
                                 |
                              
                              
                                 S
                                 1
                              
                              
                                 |
                                 =
                              
                              
                                 1
                                 2
                              
                              Œ≤
                           
                        . It is easy to check that for Œ≤ = 4, (1) is a triangle inequality already present in the LO relaxation, Amaral uses inequalities arising from Œ≤ = 6 for computational purposes. His approach is able to solve instances with up to 35 departments to optimality.

There are many interesting and important connections between the betweenness polytope and the well-known cut polytope. For instance, the classes of inequalities above are known to be facet-defining for the cut polytope, and Sanjeevi and Kianfar (2010) showed that they remain facet-inducing for the face of the cut polytope induced by 
                           
                              P
                              Btw
                           
                        .

A different approach to model the (SRFLP) is to use 
                           
                              (
                              
                                 n
                                 2
                              
                              )
                           
                         continuous distance variables zij, i, j ‚àà [n] corresponding to each pair of departments. The polytope containing the feasible positive distance variables zij
                         for n departments is called the distance polytope:

                           
                              
                                 
                                    
                                       P
                                       
                                          Dis
                                       
                                       n
                                    
                                    :
                                    =
                                    conv
                                    
                                       {
                                       z
                                       ‚àà
                                       
                                          
                                             R
                                          
                                          
                                             (
                                             
                                                n
                                                2
                                             
                                             )
                                          
                                       
                                       :
                                       ‚àÉ
                                       œÄ
                                       ‚àà
                                       Œ†
                                       
                                       :
                                       
                                       
                                          z
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          z
                                          
                                             i
                                             j
                                          
                                          œÄ
                                       
                                       ,
                                       
                                       i
                                       ,
                                       j
                                       ‚àà
                                       N
                                       ,
                                       i
                                       <
                                       j
                                       }
                                    
                                    .
                                 
                              
                           
                        Recently Amaral and Letchford (2013) achieved significant progress in improving this approach by identifying several classes of valid inequalities and using them as cutting planes. In particular they show that the equation

                           
                              
                                 
                                    
                                       ‚àë
                                       
                                          i
                                          ,
                                          j
                                          ‚àà
                                          N
                                          ,
                                          i
                                          <
                                          j
                                       
                                    
                                    
                                       ‚Ñì
                                       i
                                    
                                    
                                       ‚Ñì
                                       j
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       1
                                       6
                                    
                                    
                                       [
                                       
                                          
                                             (
                                             
                                                ‚àë
                                                
                                                   i
                                                   ‚àà
                                                   N
                                                
                                             
                                             
                                                ‚Ñì
                                                i
                                             
                                             )
                                          
                                          3
                                       
                                       ‚àí
                                       
                                          ‚àë
                                          
                                             i
                                             ‚àà
                                             N
                                          
                                       
                                       
                                          ‚Ñì
                                          
                                             i
                                          
                                          3
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        defines the smallest linear subspace that contains 
                           
                              P
                              
                                 Dis
                              
                              n
                           
                        . They prove that clique inequalities, strengthened pure negative type inequalities and special types of hypermetric inequalities induce facets of 
                           
                              P
                              
                                 Dis
                              
                              n
                           
                        . They further show the validity of rounded psd inequalities and star inequalities for 
                           
                              P
                              
                                 Dis
                              
                              n
                           
                         and use them together with the facet inducing inequalities as cutting planes in a Branch-and-Cut approach that can solve instances with up to 30 departments to optimality.

Alternatively, semidefinite programming (SDP) models have been proposed to obtain tight global bounds for the (SRFLP). (SDP) is the extension of (LP) to linear optimization over the cone of symmetric positive semidefinite matrices. The handbooks edited by Wolkowicz, Saigal, and Vandenberghe (2000) and Anjos and Lasserre (2011) provide a thorough coverage of the theory, algorithms and software in this area, as well as a discussion of many application areas where (SDP) has had a major impact.

The first (SDP) relaxation was proposed in Anjos, Kennings, and Vannelli (2005) and was used by Anjos and Vannelli (2008) to compute globally optimal solutions for instances with up to 30 departments. A more compact relaxation that can compute useful bounds for instances with up to 100 departments was proposed by Anjos and Yen (2009). The state-of-the-art is the approach of Hungerl√§nder and Rendl (2013a) that uses an improved (SDP) relaxation to compute globally optimal solutions for instances with up to 42 departments and bounds for instances with up to 100 departments. These approaches are all based on modelling betweenness using products of binary ¬± 1 variables yij
                         defined as

                           
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                   
                                                      œÄ
                                                      j
                                                   
                                                   <
                                                   
                                                      œÄ
                                                      i
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ‚àí
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                   
                                                   
                                                      œÄ
                                                      i
                                                   
                                                   <
                                                   
                                                      œÄ
                                                      j
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        for each pair of integers ij with 1 ‚â§ i < j ‚â§ n, and for a given permutation œÄ of [n]. The order of the subscripts matters, and yij
                         = ‚àíyji
                        . Thus, department k is between i and j if and only if yikyjk
                         = ‚àí1. Furthermore, given a particular assignment of ¬± 1 values to the yij
                         variables, this assignment represents a permutation of [n], if the transitivity condition

                           if i is to the right of j and j is to the right of k, then i is to the right of k is fulfilled. This necessary condition can be formulated as a set of quadratic constraints:
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       y
                                       
                                          j
                                          k
                                       
                                    
                                    ‚àí
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          k
                                       
                                    
                                    ‚àí
                                    
                                       y
                                       
                                          i
                                          k
                                       
                                    
                                    
                                       y
                                       
                                          j
                                          k
                                       
                                    
                                    =
                                    ‚àí
                                    1
                                    
                                    for
                                    
                                    all
                                    
                                    triples
                                    
                                    1
                                    ‚â§
                                    i
                                    <
                                    j
                                    <
                                    k
                                    ‚â§
                                    n
                                    .
                                 
                              
                           
                        The resulting formulation of the (SRFLP) is:

                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             min
                                             
                                             
                                                ‚àë
                                                
                                                   i
                                                   <
                                                   j
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                [
                                                
                                                   1
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      ‚Ñì
                                                      i
                                                   
                                                   +
                                                   
                                                      ‚Ñì
                                                      j
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ‚àë
                                                   
                                                      k
                                                      <
                                                      i
                                                   
                                                
                                                
                                                   ‚Ñì
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         ‚àí
                                                         
                                                            y
                                                            
                                                               k
                                                               i
                                                            
                                                         
                                                         
                                                            y
                                                            
                                                               k
                                                               j
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                +
                                                
                                                   ‚àë
                                                   
                                                      i
                                                      <
                                                      k
                                                      <
                                                      j
                                                   
                                                
                                                
                                                   ‚Ñì
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            y
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         
                                                            y
                                                            
                                                               k
                                                               j
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ‚àë
                                                   
                                                      j
                                                      <
                                                      k
                                                   
                                                
                                                
                                                   ‚Ñì
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         ‚àí
                                                         
                                                            y
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         
                                                            y
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             =
                                             ‚àí
                                             1
                                             
                                             for
                                             
                                             all
                                             
                                             triples
                                             
                                             i
                                             <
                                             j
                                             <
                                             k
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                2
                                             
                                             =
                                             1
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             i
                                             <
                                             j
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        One advantage of the SDO-based approaches is that they implicitly account for the symmetry in the (SRFLP)
because if every yij
                         variable is replaced by its negative, then there is no change whatsoever to the formulation. (We note in passing that Buchheim, Wiegele, and Zheng (2010) proved (2) is the minimum equation system for the quadratic linear ordering problem, and we refer the reader to the survey chapter by Anjos and Liers (2012) for more details concerning the problem and corresponding global optimization approaches.)

To obtain SDO relaxations we collect the ordering variables in a vector y and define the matrix Y ‚âî yy
                        ‚ä§. The main diagonal entries of Y correspond to 
                           
                              y
                              
                                 i
                                 j
                              
                              2
                           
                         and hence diag(Y) = e, the vector of all ones. Now we can formulate the (SRFLP) as a semidefinite optimization program as was first proposed in Anjos et¬†al. (2005):

                           
                              (4)
                              
                                 
                                    min
                                    
                                    {
                                    „Äà
                                    C
                                    ,
                                    Y
                                    „Äâ
                                    
                                    +
                                    
                                    K
                                    :
                                    
                                    Y
                                    
                                    satisfies
                                    
                                    (
                                    2
                                    )
                                    ,
                                    
                                    
                                    diag
                                    (
                                    Y
                                    )
                                    
                                    =
                                    
                                    e
                                    ,
                                    
                                    rank
                                    (
                                    Y
                                    )
                                    
                                    =
                                    
                                    1
                                    ,
                                    
                                    Y
                                    ‚âΩ
                                    0
                                    }
                                    ,
                                 
                              
                           
                        where the cost matrix C and the constant K are deduced from (3). Dropping the rank constraint yields the basic semidefinite relaxation of the (SRFLP)
                        
                           
                              
                                 
                                    min
                                    
                                    
                                       {
                                       
                                          „Äà
                                          C
                                          ,
                                          Y
                                          „Äâ
                                       
                                       +
                                       K
                                       :
                                       
                                       Y
                                       
                                       satisfies
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                       ,
                                       
                                       
                                       diag
                                       
                                          (
                                          Y
                                          )
                                       
                                       =
                                       e
                                       ,
                                       
                                       Y
                                       ‚âΩ
                                       0
                                       }
                                    
                                    ,
                                    
                                    
                                       SDP
                                       trivial
                                    
                                 
                              
                           
                        providing a lower bound on the optimal value of the (SRFLP).

Because the matrices Y with rank equal to 1 have only { ‚àí 1, 1} entries, Anjos and Vannelli (2008) proposed to tighten 
                           
                              (
                              
                                 SDP
                                 trivial
                              
                              )
                           
                         by adding the triangle inequalities. These inequalities are known to be facet-defining for the cut polytope, see e.g. Deza and Laurent (1997), and they define the metric polytope 
                           M
                        :

                           
                              (5)
                              
                                 
                                    M
                                    =
                                    
                                       {
                                       Y
                                       :
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      ‚àí
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      Y
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Y
                                                      
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Y
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ‚â§
                                       e
                                       ,
                                       
                                       i
                                       <
                                       j
                                       <
                                       k
                                       ‚àà
                                       
                                          (
                                          
                                             n
                                             2
                                          
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        Adding the triangle inequalities to 
                           
                              
                                 (
                                 
                                    SDP
                                    trivial
                                 
                                 )
                              
                              ,
                           
                         we obtain the following relaxation of the (SRFLP)
                        
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                             {
                                             
                                             „Äà
                                             C
                                             ,
                                             Y
                                             „Äâ
                                             +
                                             K
                                             :
                                             
                                             Y
                                             
                                             satisfies
                                             
                                             (
                                             2
                                             )
                                             ,
                                             
                                             Y
                                             ‚àà
                                             M
                                             ,
                                             
                                             diag
                                             (
                                             Y
                                             )
                                             =
                                             e
                                             ,
                                             
                                             Y
                                             ‚âΩ
                                             0
                                             
                                             }
                                             .
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                             
                                             
                                                SDP
                                                basic
                                             
                                          
                                       
                                    
                                 
                              
                           
                        To reduce the computational burden, Anjos and Vannelli (2008) do not solve 
                           
                              (
                              
                                 SDP
                                 basic
                              
                              )
                           
                         directly but rather use the 
                           
                              ‚âà
                              
                                 1
                                 12
                              
                              
                                 n
                                 6
                              
                           
                         triangle inequalities as cutting planes. This approach made it possible to solve instances of (SRFLP) with up to 30 departments to global optimality.


                        Hungerl√§nder and Rendl (2013a) suggested a further strengthening of 
                           
                              (
                              
                                 SDP
                                 basic
                              
                              )
                           
                         as well as an alternative algorithmic approach to handle the resulting large number of inequalities. They use the matrix

                           
                              (6)
                              
                                 
                                    Z
                                    :
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   y
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                Y
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        and relax the equation Y ‚àí yy
                        ‚ä§ = 0 to

                           
                              
                                 
                                    Y
                                    ‚àí
                                    y
                                    
                                       y
                                       T
                                    
                                    ‚âΩ
                                    0
                                    ‚áî
                                    Z
                                    ‚âΩ
                                    0
                                    ,
                                 
                              
                           
                        which is convex due to the Schur-complement lemma. Note that Z‚âΩ0 is in general a stronger constraint than Y‚âΩ0. Additionally they use an approach suggested by Lov√°sz and Schrijver (1991) to further improve the relaxation by adding the following inequalities:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             ‚àí
                                             1
                                             ‚àí
                                             
                                                y
                                                
                                                   l
                                                   m
                                                
                                             
                                             ‚â§
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   k
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             ‚â§
                                             1
                                             +
                                             
                                                y
                                                
                                                   l
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                             i
                                             <
                                             j
                                             <
                                             k
                                             ‚àà
                                             [
                                             n
                                             ]
                                             ,
                                             
                                             l
                                             <
                                             m
                                             ‚àà
                                             [
                                             n
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‚àí
                                             1
                                             +
                                             
                                                y
                                                
                                                   l
                                                   m
                                                
                                             
                                             ‚â§
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   i
                                                   k
                                                   ,
                                                   l
                                                   m
                                                
                                             
                                             ‚â§
                                             1
                                             ‚àí
                                             
                                                y
                                                
                                                   l
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                             i
                                             <
                                             j
                                             <
                                             k
                                             ‚àà
                                             [
                                             n
                                             ]
                                             ,
                                             
                                             l
                                             <
                                             m
                                             ‚àà
                                             [
                                             n
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The inequalities (7) are generated by multiplying the valid 3-cycle inequalities

                           
                              
                                 
                                    
                                       
                                          
                                             1
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚â•
                                             0
                                             ,
                                             
                                             1
                                             +
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚â•
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        by the nonnegative expressions (1 ‚àí ylm
                        ) and (1 + ylm
                        ). These constraints define the polytope 
                           
                              L
                              S
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       L
                                       S
                                    
                                    :
                                    =
                                    {
                                    
                                    Z
                                    :
                                    Z
                                    
                                    satisfies
                                    
                                    (
                                    7
                                    )
                                    }
                                    ,
                                 
                              
                           
                        consisting of 
                           
                              ‚âà
                              
                                 1
                                 3
                              
                              
                                 n
                                 5
                              
                           
                         constraints. The result is the following relaxation of the (SRFLP):

                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             {
                                             „Äà
                                             C
                                             ,
                                             Y
                                             „Äâ
                                             +
                                             K
                                             :
                                             Y
                                             
                                             satisfies
                                             
                                             (
                                             2
                                             )
                                             ,
                                             Z
                                             ‚àà
                                             (
                                             M
                                             ‚à©
                                             
                                                L
                                                S
                                             
                                             )
                                             ,
                                             diag
                                             (
                                             Z
                                             )
                                             =
                                             e
                                             ,
                                             Z
                                             ‚âΩ
                                             0
                                             }
                                             .
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                             
                                             
                                                SDP
                                                standard
                                             
                                          
                                       
                                    
                                 
                              
                           
                        To make 
                           
                              (
                              
                                 SDP
                                 standard
                              
                              )
                           
                         computationally tractable, Hungerl√§nder and Rendl (2013a) handle the triangle inequalities (5) and 
                           
                              L
                              S
                           
                        -cuts (7) through Lagrangian duality. This allowed them to solve instances with up to 42 departments to optimality and obtain tight global bounds for instances with up to 110 departments.

The semidefinite approach we have described is also the best method known for the (SREFLP) 
                        (Hungerl√§nder, 2014) and one of the best methods for the (LAP) on dense graphs (Hungerl√§nder and Rendl, 2013b). We will use a similar approach in Section 4.

None of the approaches for the (SRFLP) can be applied directly to the (MRFLP) because when two or more rows are available, the betweenness variables do not suffice to model the problem. There are three additional modeling issues that arise in the (MRFLP) but not in the (SRFLP):

                           
                              1.
                              Expressing the center-to-center distance between departments assigned to different rows;

Assigning each department to exactly one row;

Handling the possibility of empty space between departments.

We summarize in this section the approaches that have been proposed to handle 1 and 2 by extending the models for the (SRFLP) in Section 2.1.

On the ILO side, Amaral (2013b) extended the approach for the (SRFLP) based on distance variables (Amaral, 2006) to the (PROP) and was able to provide optimal solutions for instances with up to 23 departments. Amaral (2012) also suggested mixed integer linear programming formulation based on distance variables for the (SF-DRFLP) that allows him to solve instances with up to 13 departments to optimality.

On the (SDP) side, the authors recently extended the (SDP)-based methodology for (SRFLP) to the (kPROP) and the (SF-MRFLP). The recent paper by Hungerl√§nder and Anjos (2012) includes results suggesting that the proposed semidefinite optimization approach provides high-quality global bounds in reasonable time for instances with up to 15 departments and 5 rows. For the (kPROP) tight global bounds can be computed for instances with up to 100 departments and for an arbitrary number of rows (Hungerl√§nder, 2014).

To generalize the (SDP) approach from the (SRFLP) to the (kPROP) and the (SF-MRFLP) we introduce the function 
                           
                              r
                              :
                              
                              [
                              n
                              ]
                              ‚Üí
                              R
                           
                         that assigns each department to one of the m rows 
                           
                              R
                              :
                              =
                              {
                              1
                              ,
                              ‚Ä¶
                              ,
                              m
                              }
                           
                        . Now the center-to-center distances of departments can be expressed as quadratic terms in ordering variables whether two departments are in the same row:

                           
                              (9a)
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                +
                                                
                                                   ‚Ñì
                                                   j
                                                
                                                )
                                             
                                             +
                                             
                                                ‚àë
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ‚àà
                                                            [
                                                            n
                                                            ]
                                                            ,
                                                            
                                                            k
                                                            <
                                                            i
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                            (
                                                            k
                                                            )
                                                            =
                                                            r
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ‚Ñì
                                                k
                                             
                                             
                                                
                                                   1
                                                   ‚àí
                                                   
                                                      y
                                                      
                                                         k
                                                         i
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         k
                                                         j
                                                      
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                ‚àë
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ‚àà
                                                            [
                                                            n
                                                            ]
                                                            ,
                                                            
                                                            i
                                                            <
                                                            k
                                                            <
                                                            j
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                            (
                                                            k
                                                            )
                                                            =
                                                            r
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ‚Ñì
                                                k
                                             
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         k
                                                         j
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ‚àë
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ‚àà
                                                            [
                                                            n
                                                            ]
                                                            ,
                                                            
                                                            k
                                                            >
                                                            j
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                            (
                                                            k
                                                            )
                                                            =
                                                            r
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ‚Ñì
                                                k
                                             
                                             
                                                
                                                   1
                                                   ‚àí
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                2
                                             
                                             ,
                                             
                                             r
                                             
                                                (
                                                i
                                                )
                                             
                                             =
                                             r
                                             
                                                (
                                                j
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        or in different rows:

                           
                              (9b)
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                [
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ‚Ñì
                                                         j
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                                  
                                                                  k
                                                                  <
                                                                  j
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  k
                                                                  )
                                                                  =
                                                                  r
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            y
                                                            
                                                               k
                                                               j
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                                  
                                                                  k
                                                                  >
                                                                  j
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  k
                                                                  )
                                                                  =
                                                                  r
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   
                                                      
                                                         1
                                                         ‚àí
                                                         
                                                            y
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ‚àí
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ‚Ñì
                                                         i
                                                      
                                                      2
                                                   
                                                   
                                                   +
                                                   
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                                  
                                                                  k
                                                                  <
                                                                  i
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  k
                                                                  )
                                                                  =
                                                                  r
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            y
                                                            
                                                               k
                                                               i
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   
                                                   +
                                                   
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                                  
                                                                  k
                                                                  >
                                                                  i
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  k
                                                                  )
                                                                  =
                                                                  r
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   
                                                      
                                                         1
                                                         ‚àí
                                                         
                                                            y
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                
                                                ]
                                             
                                             
                                             ,
                                             r
                                             
                                                (
                                                i
                                                )
                                             
                                             
                                             ‚â†
                                             
                                             r
                                             
                                                (
                                                j
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where additionally the distances between pairs of departments in non-adjacent rows have to be non-negative:

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚â•
                                             0
                                             ,
                                             
                                             i
                                             ,
                                             j
                                             ‚àà
                                             
                                                [
                                                n
                                                ]
                                             
                                             ,
                                             
                                             i
                                             <
                                             j
                                             ,
                                             
                                             r
                                             
                                                (
                                                i
                                                )
                                             
                                             ‚â†
                                             r
                                             
                                                (
                                                j
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Now building on the (SDP) formulations of the (SRFLP) we can formulate the (kPROP) as a semidefinite optimization problem.

                           Theorem 1
                           
                              The following optimization problem is equivalent to the 
                              (kPROP):

                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                   
                                                   
                                                      {
                                                      
                                                         „Äà
                                                         
                                                            C
                                                            d
                                                         
                                                         ,
                                                         Z
                                                         „Äâ
                                                      
                                                      :
                                                      Z
                                                      
                                                      
                                                         s
                                                         a
                                                         t
                                                         i
                                                         s
                                                         f
                                                         i
                                                         e
                                                         s
                                                      
                                                      
                                                      
                                                         (
                                                         2
                                                         )
                                                      
                                                      
                                                      
                                                         a
                                                         n
                                                         d
                                                      
                                                      
                                                      
                                                         (
                                                         10
                                                         )
                                                      
                                                      ,
                                                      
                                                      Z
                                                      ‚àà
                                                      E
                                                      ,
                                                      
                                                      y
                                                      ‚àà
                                                      
                                                         {
                                                         ‚àí
                                                         1
                                                         ,
                                                         1
                                                         }
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              where the cost matrix Cd is deduced by equating the coefficients of the following equation
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   2
                                                   „Äà
                                                   
                                                      C
                                                      d
                                                   
                                                   ,
                                                   Z
                                                   „Äâ
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                      =
                                                      !
                                                   
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  i
                                                                  <
                                                                  j
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  i
                                                                  )
                                                                  =
                                                                  r
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     i
                                                                     <
                                                                     k
                                                                     <
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                      ‚àí
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     <
                                                                     i
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            i
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                      ‚àí
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     >
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            i
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  i
                                                                  <
                                                                  j
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  i
                                                                  )
                                                                  ‚â†
                                                                  r
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         L
                                                         
                                                            r
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                      ‚àí
                                                      
                                                         L
                                                         
                                                            r
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     <
                                                                     i
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                      ‚àí
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     >
                                                                     i
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      ‚àí
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     <
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     j
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ‚àë
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                     ‚àà
                                                                     [
                                                                     n
                                                                     ]
                                                                     ,
                                                                     
                                                                     k
                                                                     >
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                     (
                                                                     k
                                                                     )
                                                                     =
                                                                     r
                                                                     (
                                                                     j
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ‚Ñì
                                                         k
                                                      
                                                      
                                                         y
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                      ‚àë
                                                      
                                                         h
                                                         ‚àà
                                                         R
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         (
                                                         
                                                            ‚àë
                                                            
                                                               
                                                                  
                                                                     
                                                                        i
                                                                        ,
                                                                        j
                                                                        ‚àà
                                                                        [
                                                                        n
                                                                        ]
                                                                        ,
                                                                        
                                                                        i
                                                                        <
                                                                        j
                                                                        ,
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        r
                                                                        (
                                                                        i
                                                                        )
                                                                        =
                                                                        r
                                                                        (
                                                                        j
                                                                        )
                                                                        =
                                                                        h
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            c
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            ‚àë
                                                            
                                                               
                                                                  
                                                                     
                                                                        i
                                                                        <
                                                                        j
                                                                        ‚àà
                                                                        [
                                                                        n
                                                                        ]
                                                                        ,
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        r
                                                                        (
                                                                        i
                                                                        )
                                                                        =
                                                                        r
                                                                        (
                                                                        j
                                                                        )
                                                                        =
                                                                        h
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ‚Ñì
                                                            i
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and Li denotes the sum of the length of the departments on row i
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                      i
                                                   
                                                   =
                                                   
                                                      ‚àë
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  ‚àà
                                                                  [
                                                                  n
                                                                  ]
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                                  (
                                                                  k
                                                                  )
                                                                  =
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   ,
                                                   
                                                   i
                                                   ‚àà
                                                   R
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Since 
                                 
                                    
                                       y
                                       i
                                       2
                                    
                                    =
                                    1
                                    ,
                                    
                                    i
                                    ‚àà
                                    
                                       {
                                       1
                                       ,
                                       ‚Ä¶
                                       ,
                                       Œî
                                       ‚àí
                                       1
                                       }
                                    
                                 
                               we have diag(Y ‚àí yy
                              ‚ä§) = 0, which together with Y ‚àí yy
                              ‚ä§‚âΩ0 shows that in fact Y = yy
                              ‚ä§ is integral. The Eq. (2) model transitivity for y ‚àà { ‚àí 1, 1} (Buchheim et¬†al., 2010). Hence the integrality on Y together with (2) and (10) suffice to describe all feasible layouts of the (kPROP) and the objective function „ÄàCd, Z„Äâ gives the costs for feasible layouts.‚ÄÉ‚ñ°

As we are able to model the (kPROP) using the same variables as the (SRFLP), namely products of ordering variables, it makes sense to adopt the strongest (SDP) relaxation from the previous section:

                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                             {
                                             
                                                „Äà
                                                
                                                   C
                                                   d
                                                
                                                ,
                                                Z
                                                „Äâ
                                             
                                             +
                                             K
                                             :
                                             
                                             Y
                                             
                                             satisfies
                                             
                                             (2)
                                             
                                             and
                                             
                                             (10)
                                             ,
                                             
                                             Z
                                             ‚àà
                                             
                                                (
                                                M
                                                ‚à©
                                                
                                                   L
                                                   S
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                diag
                                                
                                                   (
                                                   Z
                                                   )
                                                
                                                =
                                                e
                                                ,
                                                
                                                Z
                                                ‚âΩ
                                                0
                                                }
                                                .
                                                
                                             
                                             
                                                SDP
                                                standard
                                             
                                          
                                       
                                    
                                 
                              
                           
                        However, because the objective function of the (kPROP) is more complex than that of the (SRFLP), additional valid inequalities are necessary to tighten the relaxation. Specifically we may consider triangle inequalities relating the distances between three departments:

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚â•
                                             
                                                z
                                                
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚â•
                                             
                                                z
                                                
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             
                                                z
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                z
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚â•
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             
                                             i
                                             <
                                             j
                                             <
                                             k
                                             ‚àà
                                             
                                                [
                                                n
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        An easy inductive argument further shows that the above constraints imply the associated constraints for more than three departments. Hence we define the polytope 
                           
                              D
                              V
                           
                         containing the 
                           
                              3
                              
                                 (
                                 
                                    n
                                    3
                                 
                                 )
                              
                           
                         triangle inequalities relating the distances between three or more departments:

                           
                              (12)
                              
                                 
                                    
                                       D
                                       V
                                    
                                    :
                                    =
                                    {
                                    Z
                                    :
                                    Z
                                    
                                    satisfies
                                    
                                    (
                                    11
                                    )
                                    }
                                    .
                                 
                              
                           
                        Adding these constraints to 
                           
                              (
                              
                                 SDP
                                 standard
                              
                              )
                           
                         yields 
                           
                              (
                              
                                 SDP
                                 strong
                              
                              )
                           
                        :

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             min
                                             
                                             {
                                             
                                                „Äà
                                                
                                                   C
                                                   d
                                                
                                                ,
                                                Z
                                                „Äâ
                                             
                                             +
                                             K
                                             :
                                             
                                             Y
                                             
                                             satisfies
                                             
                                             (2)
                                             
                                             and
                                             
                                             (10)
                                             ,
                                             
                                             Z
                                             ‚àà
                                             
                                                (
                                                M
                                                ‚à©
                                                
                                                   L
                                                   S
                                                
                                                ‚à©
                                                
                                                   D
                                                   V
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                diag
                                                
                                                   (
                                                   Z
                                                   )
                                                
                                                =
                                                e
                                                ,
                                                
                                                Z
                                                ‚âΩ
                                                0
                                                }
                                                .
                                                
                                             
                                             
                                                SDP
                                                strong
                                             
                                          
                                       
                                    
                                 
                              
                           
                        It was demonstrated in Hungerl√§nder and Rendl (2013b) that using 
                           
                              L
                              S
                           
                         in the semidefinite relaxation pays off in practice for several ordering problems including the (SRFLP). However for the (kPROP) and further extensions, these additional tightening constraints did not pay off in terms of practical performance. For this reason, it is preferable to work with the following SDP relaxation

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             min
                                             
                                             {
                                             
                                                „Äà
                                                
                                                   C
                                                   d
                                                
                                                ,
                                                Z
                                                „Äâ
                                             
                                             +
                                             K
                                             :
                                             
                                             Y
                                             
                                             satisfies
                                             
                                             (2)
                                             
                                             and
                                             
                                             (10)
                                             ,
                                             
                                             Z
                                             ‚àà
                                             
                                                (
                                                M
                                                ‚à©
                                                
                                                   D
                                                   V
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                diag
                                                
                                                   (
                                                   Z
                                                   )
                                                
                                                =
                                                e
                                                ,
                                                
                                                Z
                                                ‚âΩ
                                                0
                                                }
                                                .
                                                
                                             
                                             
                                                SDP
                                                cheap
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The relaxation 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         can be solved with the same algorithmic tools as used for the most competitive approach for the (SRFLP) (see Section 4 below for details). To extend this approach from the (kPROP) to the (SF-MRFLP), Hungerl√§nder and Anjos (2012) solve 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         for all possible row assignments (e.g. 2
                           n ‚àí 1 ‚àí 1 in the double-row case). From the obtained bounds, one can deduce global upper and lower bounds: these are the minima of all upper and lower bounds respectively.

The (DRFLP) has been much less studied in the literature than the (SRFLP). We summarize here the two LO approaches that extend in different ways the LO models proposed for the (SRFLP). The key difference between the two approaches is in the number of binary variables: the first approach uses O(n
                        3) binary variables while the second uses only O(n
                        2). As a consequence, the structure of the two models is very different.

The first approach (Chung and Tanchoco, 2010; Zhang and Murray, 2012) defines the binary variables as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             Œ≥
                                             
                                                i
                                                r
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         department
                                                         
                                                         i
                                                         
                                                         is
                                                         
                                                         placed
                                                         
                                                         in
                                                         
                                                         row
                                                         
                                                         r
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         otherwise.
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             z
                                             
                                                r
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         departments
                                                         
                                                         i
                                                         
                                                         and
                                                         
                                                         j
                                                         
                                                         are
                                                         
                                                         both
                                                         
                                                         placed
                                                         
                                                         in
                                                         
                                                         row
                                                         
                                                         r
                                                         
                                                         and
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                         j
                                                         
                                                         is
                                                         
                                                         located
                                                         
                                                         to
                                                         
                                                         the
                                                         
                                                         right
                                                         
                                                         of
                                                         
                                                         i
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         otherwise.
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In other words, the variables Œ≥ encode the assignment of departments to rows and the variables z encode the relative position of two departments assigned to the same row. The resulting model is:

                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                   ‚àí
                                                   1
                                                
                                             
                                             
                                                ‚àë
                                                
                                                   j
                                                   =
                                                   i
                                                   +
                                                   1
                                                
                                                n
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                   +
                                                
                                                +
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                   ‚àí
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   r
                                                
                                             
                                             ‚â§
                                             M
                                             
                                                Œ≥
                                                
                                                   i
                                                   r
                                                
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   r
                                                   =
                                                   i
                                                
                                                m
                                             
                                             
                                                Œ≥
                                                
                                                   i
                                                   r
                                                
                                             
                                             =
                                             1
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ‚Ñì
                                                      i
                                                   
                                                   
                                                      Œ≥
                                                      
                                                         i
                                                         r
                                                      
                                                   
                                                   +
                                                   
                                                      ‚Ñì
                                                      j
                                                   
                                                   
                                                      Œ≥
                                                      
                                                         j
                                                         r
                                                      
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                a
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                z
                                                
                                                   r
                                                   j
                                                   i
                                                
                                             
                                             ‚â§
                                             
                                                x
                                                
                                                   i
                                                   r
                                                
                                             
                                             ‚àí
                                             
                                                x
                                                
                                                   j
                                                   r
                                                
                                             
                                             +
                                             M
                                             
                                                (
                                                1
                                                ‚àí
                                                
                                                   z
                                                   
                                                      r
                                                      j
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ‚Ñì
                                                      i
                                                   
                                                   
                                                      Œ≥
                                                      
                                                         i
                                                         r
                                                      
                                                   
                                                   +
                                                   
                                                      ‚Ñì
                                                      j
                                                   
                                                   
                                                      Œ≥
                                                      
                                                         j
                                                         r
                                                      
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                a
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                z
                                                
                                                   r
                                                   i
                                                   j
                                                
                                             
                                             ‚â§
                                             ‚àí
                                             
                                                x
                                                
                                                   i
                                                   r
                                                
                                             
                                             +
                                             
                                                x
                                                
                                                   j
                                                   r
                                                
                                             
                                             +
                                             M
                                             
                                                (
                                                1
                                                ‚àí
                                                
                                                   z
                                                   
                                                      r
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   r
                                                   =
                                                   i
                                                
                                                m
                                             
                                             
                                                x
                                                
                                                   i
                                                   r
                                                
                                             
                                             ‚àí
                                             
                                                ‚àë
                                                
                                                   r
                                                   =
                                                   i
                                                
                                                m
                                             
                                             
                                                x
                                                
                                                   j
                                                   r
                                                
                                             
                                             +
                                             
                                                v
                                                
                                                   i
                                                   j
                                                
                                                +
                                             
                                             ‚àí
                                             
                                                v
                                                
                                                   i
                                                   j
                                                
                                                ‚àí
                                             
                                             =
                                             0
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                z
                                                
                                                   r
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                z
                                                
                                                   r
                                                   j
                                                   i
                                                
                                             
                                             ‚â§
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   Œ≥
                                                   
                                                      i
                                                      r
                                                   
                                                
                                                +
                                                
                                                   Œ≥
                                                   
                                                      j
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                z
                                                
                                                   r
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                z
                                                
                                                   r
                                                   j
                                                   i
                                                
                                             
                                             +
                                             1
                                             ‚â•
                                             
                                                Œ≥
                                                
                                                   i
                                                   r
                                                
                                             
                                             +
                                             
                                                Œ≥
                                                
                                                   j
                                                   r
                                                
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   r
                                                
                                             
                                             ‚â•
                                             0
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                v
                                                
                                                   i
                                                   j
                                                
                                                +
                                             
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   j
                                                
                                                ‚àí
                                             
                                             ‚â•
                                             0
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œ≥
                                                
                                                   i
                                                   r
                                                
                                             
                                             ‚àà
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                z
                                                
                                                   r
                                                   i
                                                   j
                                                
                                             
                                             ‚àà
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             i
                                             ‚â†
                                             j
                                             ,
                                             
                                             r
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             m
                                             ,
                                          
                                       
                                       
                                    
                                 
                              
                           
                        where M is a sufficiently large number. Note that there are two z variables for each triplet i, j, r. Furthermore, there is one continuous variable xir
                         for each pair department-row; this variable equals zero whenever department i is not assigned to row r, and moreover if two departments i and j are both assigned to the same row r, then 
                           
                              
                                 v
                                 
                                    i
                                    j
                                 
                                 +
                              
                              +
                              
                                 v
                                 
                                    i
                                    j
                                 
                                 ‚àí
                              
                           
                         represents the distance between i and j. We observe that the presence of the variables xir
                         causes redundancy in the encoding, as the assignment of rows to departments is already encoded in the Œ≥ir
                         variables. This is not necessarily a negative feature; there are situations where models with similar ‚Äúredundancy‚Äù in the binary variables perform better in practice than alternate models with fewer binaries. For instance, this behavior was recently observed for the unit commitment problem in power systems (Ostrowski, Anjos, & Vannelli, 2012).

In this case, however, an alternate approach that eliminates redundancy achieves a better performance. The approach of Amaral (2013a) encodes all the information in only O(n
                        2) binary variables defined as

                           
                              
                                 
                                    
                                       Œª
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                   if
                                                   
                                                   departments
                                                   
                                                   i
                                                   
                                                   and
                                                   
                                                   j
                                                   
                                                   are
                                                   
                                                   both
                                                   
                                                   placed
                                                   
                                                   in
                                                   
                                                   the
                                                   
                                                   same
                                                   
                                                   row
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   and
                                                   
                                                   j
                                                   
                                                   is
                                                   
                                                   located
                                                   
                                                   to
                                                   
                                                   the
                                                   
                                                   right
                                                   
                                                   of
                                                   
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The model is:

                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                ‚àë
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                   ‚àí
                                                   1
                                                
                                             
                                             
                                                ‚àë
                                                
                                                   j
                                                   =
                                                   i
                                                   +
                                                   1
                                                
                                                n
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚â•
                                             
                                                x
                                                i
                                             
                                             ‚àí
                                             
                                                x
                                                j
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚â•
                                             
                                                x
                                                j
                                             
                                             ‚àí
                                             
                                                x
                                                i
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚àí
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                +
                                                
                                                   ‚Ñì
                                                   j
                                                
                                                )
                                             
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚àí
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                +
                                                
                                                   ‚Ñì
                                                   j
                                                
                                                )
                                             
                                             
                                                Œª
                                                
                                                   j
                                                   i
                                                
                                             
                                             ‚â•
                                             0
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                i
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                +
                                                
                                                   ‚Ñì
                                                   j
                                                
                                                )
                                             
                                             ‚â§
                                             
                                                x
                                                j
                                             
                                             +
                                             L
                                             
                                                (
                                                1
                                                ‚àí
                                                
                                                   Œª
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             i
                                             ‚â†
                                             j
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   Àú
                                                
                                             
                                             ‚â§
                                             
                                                x
                                                
                                                   j
                                                   Àú
                                                
                                             
                                             
                                             
                                             where
                                             
                                             
                                                (
                                                
                                                   i
                                                   Àú
                                                
                                                ,
                                                
                                                   j
                                                   Àú
                                                
                                                )
                                             
                                             =
                                             
                                                argmin
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                             
                                             
                                                
                                                
                                                   c
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                2
                                             
                                             ‚â§
                                             
                                                x
                                                i
                                             
                                             ‚â§
                                             L
                                             ‚àí
                                             
                                                
                                                   ‚Ñì
                                                   i
                                                
                                                2
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚àà
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             i
                                             ‚â†
                                             j
                                          
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             Œª
                                             ‚àà
                                             
                                                Œõ
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Œª denotes the vector containing all the Œªij
                         variables associated to a fixed ordering, and

                           
                              
                                 
                                    
                                       
                                          Œõ
                                       
                                       
                                          
                                             =
                                             {
                                             Œª
                                             ‚àà
                                             
                                                R
                                                
                                                   n
                                                   (
                                                   n
                                                   ‚àí
                                                   1
                                                   )
                                                
                                             
                                             :
                                             ‚àí
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                Œª
                                                
                                                   j
                                                   i
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   k
                                                   j
                                                
                                             
                                             ‚â§
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             
                                             k
                                             ‚â†
                                             i
                                             ,
                                             
                                             k
                                             ‚â†
                                             j
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ‚àí
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                Œª
                                                
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   j
                                                   i
                                                
                                             
                                             ‚àí
                                             
                                                Œª
                                                
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   k
                                                   j
                                                
                                             
                                             ‚â§
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             for
                                             
                                             j
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ,
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             j
                                             ‚àí
                                             1
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             j
                                             ‚àí
                                             1
                                             ,
                                             
                                             i
                                             ‚â†
                                             k
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   j
                                                   i
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                Œª
                                                
                                                   k
                                                   j
                                                
                                             
                                             ‚â•
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             for
                                             
                                             i
                                             =
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             2
                                             ,
                                             j
                                             =
                                             i
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                             ‚àí
                                             1
                                             ,
                                             
                                             k
                                             =
                                             j
                                             +
                                             1
                                             ,
                                             ‚Ä¶
                                             ,
                                             n
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ‚â§
                                             
                                                Œª
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             
                                                Œª
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                ‚â§
                                                1
                                                
                                                
                                                for
                                                
                                                i
                                                =
                                                1
                                                ,
                                                ‚Ä¶
                                                ,
                                                n
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                ‚Ä¶
                                                ,
                                                n
                                                ,
                                                
                                                i
                                                ‚â†
                                                j
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the continuous variable xi
                         gives the position of department i within one of the two rows, and dij
                         represents the distance between i and j. Furthermore Œõ is a relaxation of the convex hull of the 0-1 incidence vectors Œª of all possible orderings. This second model has a reduced number of variables, both binary and continuous, and eliminates some constraints relating them. On the other hand, it involves a large number of inequalities in the description of Œõ.

The differences between these models are reflected in their running times. We implemented both approaches using the CPLEX solver on our machine (for details see the first paragraph of Section 5) and obtained the following results: The model of Amaral (2013a) is at least 100 times faster for instances of challenging size with nine or more departments. Thus the method of Amaral (2013a) can solve instances with up to13 departments in a 12 hours time limit, whereas the approach by Chung and Tanchoco (2010) can only handle instances with up to 12 departments within the same time limit. This difference in running time is mainly due to the tighter relaxations provided by the formulation of Amaral (2013a), and the consequent smaller number of branch-and-bound nodes. We further note that the corrections provided by Zhang and Murray (2012), and the corresponding additional variables and constraints, result only in marginal increases of the running times compared to the original version of Chung and Tanchoco (2010).

This section presents the theoretical results used to extend the semidefinite approach outlined in Sections 2.1 and 2.2 to handle the possibility of empty space between departments. The key result is Theorem 2 showing that if all departments lengths are integer then there is always an optimal solution to the (MRFLP) on the half grid. As a consequence, the semidefinite approach from Hungerl√§nder and Anjos (2012) will provide an optimal layout for the (MRFLP) if we add a sufficient number of spacing departments of length 0.5 and with all connectivities equal to zero. Because the number of spacing departments needed will normally be too large for practical computation, this section also proposes several strategies to reduce the number of spacing departments needed.

From the description of the (MRFLP) in the Introduction, it seems intuitive that the optimal distances between departments can be arbitrary. However, Theorem 2 shows that the (MRFLP) with integer department lengths can be modelled as a purely discrete optimization problem.

                           Theorem 2
                           
                              If all the department lengths are integer, then there is always an optimal solution to the 
                              (MRFLP) 
                              on the half grid.

Let an optimal multi-row layout of the departments be given. We define a half-integer grid such that the centers of the departments with the most left centers are on a grid point. Note that if there are no spaces in the optimal layout, then all departments centers are on the half-integer grid as defined, and we are done. Hence we assume that there are spaces in the optimal layout, and that not all departments centers are on the grid. Let S be the set containing every department such that its center is on the grid, and let T be the set containing the remaining departments. Without loss of generality we assume that the indices of the departments in S are all smaller than the indices of the departments in T, i.e., i < j,‚Äâ‚àÄ‚Äâi ‚àà S,‚Äâj ‚àà T.

Observe that there exists …õ > 0 such that we can move all the departments in T simultaneously by …õ either to the left or to the right without overlapping with departments in S. The existence of …õ follows from the integrality of the department lengths and the definitions of S and T. The change in the objective function from shifting all the departments in T by …õ is equal to

                                 
                                    
                                       
                                          Œ¥
                                          =
                                          
                                             ‚àë
                                             
                                                i
                                                ‚àà
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                …õ
                                             
                                             
                                                ‚àë
                                                
                                                   j
                                                   ‚àà
                                                   S
                                                   ,
                                                   
                                                   j
                                                   
                                                      <
                                                      Àô
                                                   
                                                   i
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             ‚àí
                                             
                                                …õ
                                             
                                             
                                                ‚àë
                                                
                                                   j
                                                   ‚àà
                                                   S
                                                   ,
                                                   
                                                   i
                                                   
                                                      <
                                                      Àô
                                                   
                                                   j
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              for a shift to the left, and to ‚àí Œ¥ for a shift to the right, where 
                                 
                                    i
                                    
                                       <
                                       Àô
                                    
                                    j
                                 
                               means that the center of j is to the right of the center of i, and …õ is chosen small enough such that no center of a department in T traverses a half grid point. Due to the optimality of the given layout, Œ¥ must to be 0 (otherwise we could improve the objective value by a shift of the departments in T in the appropriate direction, contradicting the assumption that the current layout is optimal). Hence such a shift does not change the objective value.

Choosing …õ such that the center of at least one department in T lies on a half grid point after the shifting operation (to the left or right), and repeating this process allows us to arrange all departments on the grid in at most n ‚àí 1 steps without changing the objective value.‚ÄÉ‚ñ°


                              If all the department lengths are integer, then for each instance of the 
                              (MRFLP) 
                              we obtain an equivalent instance by adding spacing departments of length 0.5 such that the length of each row becomes equal to
                              
                                 
                                    M
                                    :
                                    =
                                    
                                       ‚àë
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       ‚Ñì
                                       i
                                    
                                 
                              .
                              
                           

After adding the spacing departments we know that all the department centers will lie on the half-grid. Theorem 2 guarantees that there is always an optimal solution on the half-grid for every instance of the (MRFLP). Moreover the row length M is sufficient: If there exists an interval that contains only spaces on all parallel rows, the objective value can only improve if we remove the respective spaces from each row because the pairwise center-to-center distances of the departments stay the same or are reduced by the removal.‚ÄÉ‚ñ°

Finally we show by construction that the bound M on the lengths of the rows is tight for any given number of rows. Let us start with the case of 2 rows; consider 5 departments with lengths ‚Ñì1 = ‚Ñì2 = ‚Ñì3 = ‚Ñì4 = 1,‚Äâ‚Ñì5 = n and connectivities c
                        12 = c
                        34 = n,‚Äâc
                        15 = c
                        35 = 1. Fig. 4(a) illustrates the optimal layout for this instance. We have M = n + 4 and

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                lim
                                                
                                                   n
                                                   ‚Üí
                                                   ‚àû
                                                
                                             
                                             
                                             
                                                
                                                   Length
                                                   
                                                   of
                                                   
                                                   the
                                                   
                                                   shortest
                                                   
                                                   row
                                                   
                                                   in
                                                   
                                                   the
                                                   
                                                   optimal
                                                   
                                                   layout
                                                
                                                M
                                             
                                             
                                             =
                                             
                                             
                                                
                                                   n
                                                   +
                                                   2
                                                
                                                
                                                   n
                                                   +
                                                   4
                                                
                                             
                                             
                                             =
                                             
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        This construction can be generalized to an arbitrary number of rows by simply adding for each additional row 2 departments of length 1 and connectivity n with 2 other departments of length 1 that are not connected with each other. Specifically for 3 rows we add 2 departments with lengths ‚Ñì6 = ‚Ñì7 = 1 and connectivities c
                        26 = c
                        47 = n; the optimal layout for this extended instance is depicted in Fig. 4(b). The cost of the optimal layout is n + 1 regardless of the number of rows considered.

The results in this section show that it is possible under certain assumptions to reduce the number and size of the spacing departments.


                        Lemma 4 applies to instances with equidistant department locations.

                           Lemma 4
                           
                              If all departments have the same length w, then spaces of size w are sufficient to preserve an optimal solution.

Next we illustrate that M remains a tight bound using Figs. 4(a) and 5. While this illustration is for two rows, it is straightforward to generalize it to an arbitrary number of rows in an identical manner to that in Fig. 4. First observe that the bound M from Theorem 2 on the lengths of the rows is tight if we further assume that the row assignment is fixed. (This is a reasonable assumption because our proposed (SDP) approach enumerates the row assignments.) For two rows we can simply replace department 5 from Fig. 4(a) by n departments of length 1 with connectivities c
                        
                           i(i + 1) = 1,‚Äâ5 ‚â§ i ‚â§ n + 3. Thus we obtain the following data: ‚Ñì1 = ‚Ñì2 = ‚ãÖ‚ãÖ‚ãÖ‚Äâ= ‚Ñì
                           n + 4 = 1,‚Äâc
                        12 = c
                        34 = c
                        15 = c
                        3(n + 4) = 1,‚Äâc
                        
                           i(i + 1) = 1,‚Äâ5 ‚â§ i ‚â§ n + 3, with departments 1 and 3 assigned to row 1, and the remaining departments assigned to row 2. The corresponding optimal double-row layout, with total cost 1 ¬∑ 1 ¬∑ (n + 1) = n + 1, is depicted in Fig. 5.


                        Lemma 5 shows when it is allowed to enlarge the grid size and thus reduce the number of spaces.

                           Lemma 5
                           
                              If the lengths of the departments have a greatest common divisor d, then we can divide all lengths by d, solve the resulting problem (where all department lengths are still integer) and multiply the bounds obtained by d to get bounds of the original problem.


                        Lemma 6 indicates how to further reduce the number of spaces by suitably modeling the possible distances between the departments.

                           Lemma 6
                           
                              Let pi be the number of departments assigned to row i. Then we preserve an optimal solution to the 
                              (MRFLP) 
                              if we use pi spaces of lengths2
                                 k ‚àí 1,‚Äâk = 0, 1, 2, ‚Ä¶, hi, where hi is chosen such that
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                      i
                                                   
                                                   
                                                      ‚àë
                                                      
                                                         k
                                                         =
                                                         0
                                                      
                                                      
                                                         h
                                                         i
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         k
                                                         ‚àí
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      ‚àë
                                                      
                                                         k
                                                         ‚àà
                                                         [
                                                         n
                                                         ]
                                                         ,
                                                         
                                                         r
                                                         (
                                                         k
                                                         )
                                                         =
                                                         i
                                                      
                                                   
                                                   
                                                      ‚Ñì
                                                      k
                                                   
                                                   ‚â•
                                                   M
                                                   ,
                                                   
                                                   i
                                                   ‚àà
                                                   
                                                      [
                                                      m
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We can model all feasible distances between all pairs of departments (all feasible layouts of the departments on the half grid) with the suggested spaces. Note that we also need spaces to allow a gap between the left origin the first department on each row.‚ÄÉ‚ñ°

Finally Lemma 7 builds on Lemma 6 and examines when additional spaces have no marginal value.

                           Corollary 7
                           
                              Let a row assignment be given. If we add to each row (as per 
                              Lemma 6) k
                              1 
                              spaces of the minimal necessary lengths to get the lower bound
                              
                                 
                                    
                                       v
                                       
                                          k
                                          1
                                       
                                    
                                    ,
                                 
                               
                              and if we also add k
                              2‚Äâ( > k
                              1) spaces of minimal necessary lengths to each row to get the lower bound
                              
                                 
                                    
                                       v
                                       
                                          k
                                          2
                                       
                                    
                                    ,
                                 
                               
                              then it follows from
                              
                                 
                                    
                                       v
                                       
                                          k
                                          1
                                       
                                    
                                    =
                                    
                                       v
                                       
                                          k
                                          2
                                       
                                    
                                 
                               
                              that
                              
                                 
                                    v
                                    
                                       k
                                       1
                                    
                                 
                               
                              is a lower bound for the 
                              (MRFLP) 
                              for the given row assignment.

If adding additional spaces has no effect on the value of the (SDP) relaxation then adding even more (possibly larger) spaces also does not have any effect.‚ÄÉ‚ñ°


                        Corollary 7 leads to another way of reducing the computational effort. Indeed in Section 5.2 we propose a computational strategy that does not solve the (MRFLP) directly but rather iteratively adds spaces of minimal necessary length to the (SF-MRFLP). Unlike the (DRFLP) approaches reviewed in Section 2.3, our semidefinite approach allows us to control both the number and the sizes of the spaces considered. This is a valuable feature in practice because layout with less space are normally preferable. For computational experiments with a controlled number of spaces see Sections 5.3‚Äì5.5.

The core of our (SDP) approach is to solve the relaxation 
                        
                           (
                           
                              SDP
                              cheap
                           
                           )
                        
                      for every row assignment with sufficient space added. The resulting fractional solutions provide lower bounds on the costs of the optimal layout for the given row assignment. By rounding the fractional solutions, we can also obtain upper bounds, i.e., integer solutions that describe feasible layouts for the given row assignment. By computing these lower and upper bounds for every row assignment, we can obtain global bounds for the (MRFLP). In the following two subsections we discuss how to solve 
                        
                           (
                           
                              SDP
                              cheap
                           
                           )
                        
                      and how to round the fractional solutions.

Looking at the constraint classes and their sizes in the relaxation 
                           
                              
                                 (
                                 
                                    SDP
                                    cheap
                                 
                                 )
                              
                              ,
                           
                         it is clear that explicitly maintaining O(n
                        3) or more constraints is not an attractive option. We therefore adapt an approach originally suggested in¬†Fischer, Gruber, Rendl, and Sotirov (2006) that was successful for the max-cut problem¬†(Rendl, Rinaldi, & Wiegele, 2010) and several ordering problems¬†(Chimani and Hungerl√§nder, 2013; Hungerl√§nder and Rendl, 2013b).

The idea is to combine the bundle method and an interior-point method. Initially, we only explicitly ensure satisfaction of the constraints diag(Z) = e and Z‚âΩ0; this can be achieved with standard interior-point methods, see e.g.¬†Helmberg, Rendl, Vanderbei, and Wolkowicz (1996). All other constraints are handled using Lagrangian duality. However this makes the objective function¬†f non-smooth, hence the need for the bundle method. The bundle method iteratively evaluates f at some trial points and uses subgradient information to obtain new iterates. Evaluating f amounts to again solving an (SDP) with the constraints diag(Z) = e and Z‚âΩ0, which can be done efficiently using an interior-point method. In this way we obtain an approximate minimizer of f that is guaranteed to yield a lower bound to the optimal solution of 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                        . In some experiments we also use the bundle method to obtain an initial set of constraints to add to the relaxation 
                           
                              (
                              
                                 SDP
                                 basic
                              
                              )
                           
                         and then solved the resulting relaxation exactly using Sedumi (Sturm, 1999).

To obtain feasible (MRFLP) layouts we use a rounding heuristic originally proposed by Hungerl√§nder and Anjos (2012). First we apply the hyperplane rounding algorithm of Goemans and Williamson (1995) to the solution of the (SDP) relaxation, then we take the resulting vector 
                           
                              w
                              ¬Ø
                           
                         and flip the signs of some of its entries to make it feasible with respect to the 3-cycle inequalities

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             ‚àí
                                             1
                                             ‚â§
                                             
                                                
                                                   y
                                                   ¬Ø
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   y
                                                   ¬Ø
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             ‚àí
                                             
                                                
                                                   y
                                                   ¬Ø
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             ‚â§
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        within the rows, and with respect to the inequalities (10) for the inter-row variables.

Let us give a more detailed description of the implementation of our heuristic. Let W‚Ä≤‚Ä≤ be the current fractional (primal) solution of the semidefinite relaxation, and w‚Ä≤ be an initial vector that encodes a feasible layout of the departments in all rows.

                           
                              1.
                              Compute the convex combination R ‚âî Œª(w‚Ä≤w‚Ä≤‚ä§) + (1 ‚àí Œª)W‚Ä≤‚Ä≤ using a randomly generated Œª ‚àà [0.3, 0.7]. Compute the Cholesky decomposition DD
                                 ‚ä§ of R.

Apply the Goemans‚ÄìWilliamson hyperplane rounding to D and obtain a ‚àí 1/ + 1 vector 
                                    
                                       w
                                       ¬Ø
                                    
                                  (cf.¬†Rendl et¬†al., 2010).

Compute the induced objective value 
                                    
                                       z
                                       
                                          (
                                          
                                             w
                                             ¬Ø
                                          
                                          )
                                       
                                       :
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         w
                                                         ¬Ø
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ‚ä§
                                       
                                       
                                          C
                                          Z
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                      ¬Ø
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 . If 
                                    
                                       z
                                       
                                          (
                                          
                                             w
                                             ¬Ø
                                          
                                          )
                                       
                                       ‚â•
                                       z
                                       
                                          (
                                          
                                             w
                                             ‚Ä≤
                                          
                                          )
                                       
                                    
                                 : go to step¬†2.

If 
                                    
                                       w
                                       ¬Ø
                                    
                                  satisfies (13) and (10): set 
                                    
                                       
                                          w
                                          ‚Ä≤
                                       
                                       :
                                       =
                                       
                                          w
                                          ¬Ø
                                       
                                    
                                  and go to¬†2.

Otherwise: modify 
                                    
                                       w
                                       ¬Ø
                                    
                                  by first changing the signs of one of three variables in all violated 3-cycle inequalities, afterward flipping signs of the inter-row ordering variables to satisfy (10) and go to step¬†3.

The algorithm stops after 100 executions of step¬†2. (Note that before the 51st execution of step 2, we perform step 1 again. As step 1 is quite expensive, we refrain from executing it too often.) The final w‚Ä≤ is the heuristic solution. If the duality gap is not closed after the heuristic, we return to the (SDP) optimization algorithm, and then reapply the heuristic (retaining the last vector w‚Ä≤).

We report the results for different computational experiments with the proposed semidefinite relaxation 
                        
                           (
                           
                              SDP
                              cheap
                           
                           )
                        
                     . All computations were conducted on an Intel Xeon E5160 (Dual-Core) with 24 gigabytes RAM, running Debian 5.0 in 64-bit mode. The algorithm was implemented in Matlab 7.7. We enforced a time limit of 12 hours for all the experiments.

We solve the (MRFLP) on (SRFLP) instances from the literature. Additionally we generated new equidistant instances (instances with uniform department length = 1), denoted by 
                        
                           E
                           _
                           *
                           ,
                        
                      with connectivities varying randomly between 1 and 10 and density of either 50 percent or 100 percent. Table 1
                      gives the characteristics of the small (SRFLP) instances together with their optimal (SRFLP) solutions and the computational time to solve them using the SDP approach of Hungerl√§nder and Rendl (2013a) run on our computer. Table 7 does the same for the larger instances. All the instances can be downloaded from http://miguelanjos.com/flplib. In general, while for the (SRFLP) we can round to the nearest integer because 0.5 can only occur in the constant term, for the (MRFLP) we can round the lower bound only to 0.5 as the constant term is different for distinct row assignments.

First we apply our exact semidefinite approach to the (DRFLP) in Sections 5.1‚Äì5.3. Then we expand our experiments to the case of 3 and more rows in Section 5.4. Finally we examine the effects of adding space to medium and large instances with fixed row assignments in Section 5.5.

For small (DRFLP) instances, the relaxation 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         can be solved for each of the 2
                           n ‚àí 1 ‚àí 1 possible row assignments. As per Corollary 3 we add sufficiently many spaces to the (DRFLP) instances and solve the resulting (PROP) for each row assignment. From the obtained bounds, we can deduce global upper and lower bounds: these are the minima of all upper and lower bounds respectively. The upper bounds were obtained using the SDP rounding heuristic described in Section 4.2.

For reasons of efficiency we used 10 function evaluations of the bundle method applied to 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         to obtain an initial set of constraints to add to the relaxation 
                           
                              (
                              
                                 SDP
                                 basic
                              
                              )
                           
                        . We then solved the resulting relaxation using Sedumi (Sturm, 1999); added all violated inequality constraints from 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                        ; solved again using Sedumi; and repeated this process until no more violations were found. We also tried to solve 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         directly but the running times were at least one order of magnitude greater. Solving 
                           
                              (
                              
                                 SDP
                                 strong
                              
                              )
                           
                         instead of 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         resulted in a few slightly improved lower bounds but tremendously larger running times because many of the O(n
                        5) 
                           
                              L
                              S
                           
                        -cuts are active at the optimum.

The computational results are summarized in Table 2
                        . We exploit Lemma 5 to reduce the number of spaces and hence speed up our algorithmic framework. For the equidistant instances we additionally use Lemma 6. Looking at the running times and their growth rates, we deduce that this approach is realistic only for instances with up to 10 departments within the 12-hour time limit.

The ILP approaches by Chung and Tanchoco (2010) and Amaral (2013a) focused exclusively on the (DRFLP) and allowed them to solve instances with up to 13 departments to optimality with better results achieved by Amaral (2013a). Hence our semidefinite approach exhibits a weaker practical performance for the (DRFLP), especially when we allow arbitrary lengths of the departments. Nevertheless the strengths of our approach are that it allows us to control the number and sizes of spaces considered (for details see Sections 5.3‚Äì5.5 below) and that it is applicable to the (MRFLP) with more than two rows (for details see Section 5.4 below).

Finally let us compare our results with the ones obtained for the (SF-DRFLP) using the same algorithmic framework on the same machine. We adopted part of the (SF-DRFLP) results from Hungerl√§nder and Anjos (2012) and summarized all the computational details in Table 3
                        .

We observe that the global lower and upper bounds (especially for the 
                           
                              E
                              _
                              *
                           
                        -instances) are often not improved. But nonetheless the average lower and upper bounds are always significantly improved. Hence space especially helps to improve the bounds for unbalanced (‚Äúbad‚Äù) row assignments. The computation times show that including space is quite expensive, especially if the lengths of the departments are diverse. Without using Lemmas 5 and 6 we could only compute bounds to the 
                           
                              E
                              _
                              *
                           
                        -instances for up to seven departments and the other instances for up to five departments within the time limit.

In this section we exploit Corollary 7 algorithmically and examine if this alternative strategy to handle space allows us to improve on the computational results from the previous subsection.

First let us give a description of our approach: We start with computing bounds for the space free case for a given row assignment and then

                           
                              1.
                              we add the smallest necessary space to the shortest row until the lower bound does not worsen any more,

and after that we add the smallest necessary spaces to all other rows. If the lower bound does not worsen during step 2, we have found a valid lower bound for the (MRFLP) for the given row assignment due to Corollary 7, otherwise we go back to step 1.

We summarize the results obtained by this alternative approach in Table 4
                        .

For some instances, namely the 
                           
                              E
                              _
                              *
                           
                        -instances with density 100 percent and the 
                           
                              Rand
                              _
                              *
                           
                        -instances, we are able to reduce the running times compared with the results from the previous subsection summarized in Table 2. This reduction in the running time is due to the reduction of the average number of spaces needed. Thus we solve more but cheaper relaxations to obtain the same lower bounds. For some other instances we cannot significantly reduce the number of spaces needed (see e.g. H_6) and thus the computationally effort grows. Further note that the average upper bounds are better than in the previous section because we work with smaller SDPs (with fewer spaces) for which the upper bound heuristic yields stronger feasible layouts.

Let us recall two findings concerning the usage space in our semidefinite approach from the previous subsections:

                           
                              1.
                              For promising balanced row assignments we need less space than for unbalanced ones, hence the global bounds are similar and sometimes even the same for the cases with and without space.

The average number of spaces needed to find and prove the optimal layout is significantly lower than the theoretical bound on their number (compare the ‚Äúaverage nbr spaces‚Äù columns of Tables 2 and 4).

These points motivate us to examine how much the lower and upper bounds change if we allow only a few spaces of predefined sizes and how much the running times can be reduced through this restriction. This question is also interesting because in practice layouts with fewer spaces are usually preferable.

In our experiments we added four spaces with lengths 2
                           k
                        ,‚Äâk ‚àà { ‚àí 1, 0, 1, 2}, to the shorter row for each row assignment. The results for the (DRFLP) are reported in Table 5
                        . Here we do not consider the equidistant 
                           
                              E
                              _
                              *
                           
                        -instances because space has no effect on the global lower and upper bounds of these instances (compare Tables 3 and 4).

The global bounds for the instances with space restrictions coincide with the global (DRFLP) bounds as far as they are available, i.e., for instances with at most 6 departments. For larger instances we compared the global bounds with the exact solutions obtained by the ILP approach of Amaral: the global lower and upper bounds are only slightly higher (and often the same). The results suggest that restricting the number of spaces is a very good strategy to approximate the (DRFLP) for larger instances and also for obtaining layouts that yield a good compromise between the number and sizes of spaces used and the corresponding layout costs induced. Additionally our approach can easily handle particular requirements arising in practice regarding the assignment of the departments and the spacing between them.

Next we extend the results from the previous subsections by considering 3‚Äì5 rows. The number of different row assignments is given by the recursive formula

                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             
                                                (
                                                m
                                                ,
                                                n
                                                )
                                             
                                             =
                                             
                                                
                                                   m
                                                   n
                                                
                                                
                                                   m
                                                   !
                                                
                                             
                                             ‚àí
                                             
                                                ‚àë
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                   ‚àí
                                                   1
                                                
                                             
                                             
                                                
                                                   R
                                                   (
                                                   k
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   (
                                                   m
                                                   ‚àí
                                                   k
                                                   )
                                                   !
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where m is the number of rows and n is the number of departments. Applying m ‚àà {2, 3, 4, 5} to the above formula yields:

                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             (
                                             2
                                             ,
                                             n
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                2
                                                
                                                   n
                                                   ‚àí
                                                   1
                                                
                                             
                                             ‚àí
                                             1
                                             ,
                                             
                                             R
                                             
                                                (
                                                3
                                                ,
                                                n
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      3
                                                      
                                                         n
                                                         ‚àí
                                                         1
                                                      
                                                   
                                                   ‚àí
                                                   
                                                      2
                                                      n
                                                   
                                                   +
                                                   1
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             (
                                             4
                                             ,
                                             n
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      4
                                                      
                                                         n
                                                         ‚àí
                                                         1
                                                      
                                                   
                                                   ‚àí
                                                   
                                                      3
                                                      n
                                                   
                                                   +
                                                   3
                                                   ¬∑
                                                   
                                                      2
                                                      
                                                         n
                                                         ‚àí
                                                         1
                                                      
                                                   
                                                   ‚àí
                                                   1
                                                
                                                6
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             (
                                             5
                                             ,
                                             n
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      5
                                                      
                                                         n
                                                         ‚àí
                                                         1
                                                      
                                                   
                                                   ‚àí
                                                   
                                                      4
                                                      n
                                                   
                                                   +
                                                   2
                                                   ¬∑
                                                   
                                                      3
                                                      n
                                                   
                                                   ‚àí
                                                   
                                                      2
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                24
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We use the same algorithmic approach and setup as above and again restrict the running time per instance to 12 hours. Firstly in Table 6
                         we summarize the computational results obtained for the general (MRFLP). We also restate the corresponding results for the (DRFLP) to facilitate the comparison. Note that both strategies ‚ÄúDirect Approach‚Äù and ‚ÄúMarginal value‚Äù yield the same global bounds for all instances, whereas the average upper bounds are again slightly better for the approach exploiting the marginal value of spaces.

Clearly the computation times grow for an increasing number of rows, especially as the average number of spaces per row assignment increases (and also the overall number of row assignments for larger n). Interestingly the global bounds become tighter as m increases. We also observe that exploiting the marginal value of spaces becomes more effective for a larger number of rows as the absolute gap increases between the number of spaces theoretically needed and the number relevant in practice; this is observed by comparing the first columns of ‚ÄúDirect approach‚Äù and ‚ÄúMarginal value‚Äù in Table 6.

Next we extend the experiments from Section 5.3 by considering up to 5 rows. We add four spaces with lengths 2
                           k
                        ,‚Äâk ‚àà { ‚àí 1, 0, 1, 2}, to the shortest row and summarize the corresponding results in Table 8
                        .

The results clearly show that adding only a few spaces to the shortest row help to considerably improve the optimal objective value without increasing the running time too much. Hence the layouts obtained again yield a good compromise between the number and size of spaces used and the corresponding layout costs induced. We further observe that for a growing number of rows the average impact of spaces added on the objective function increases. On the other hand there seems to be no clear connection between the spaces added and the tightness of 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                        .

For our final set of experiments, we consider the (PROP) using the data from selected (SRFLP) instances with between 20 and 70 departments. For each value of n we choose one instance from the literature. Table 7 lists the characteristics of the instances together with their optimal (SRFLP) solutions and corresponding running times.

We suggest to select balanced row assignments because similar row lengths are often of interest in the design of layouts in practice, see e.g. Langevin, Montreuil, and Riopel (1994). To do so we use the following simple heuristic: First we randomly assign 25percent of the departments to each of the two rows; then the remaining 50percent of the departments are added one at a time by taking the longest remaining department and adding it to the shorter row. Our heuristic quickly yields assignments for which the total row lengths are very close, in average they differ by less than length 2.

To examine the effect of spaces for medium and large instances we add few spaces to each row (as they are balanced). More precisely we add five spaces with lengths 2
                           k
                        , k = ‚àí1, 0, 1, 2, 3 to each row. As the considered row assignments (which are the most promising ones) are balanced, the results from Section 5.3 suggest that we do not have to insert a lot of spaces to find a strong layout for the given row assignment.

We again apply our algorithmic framework to the semidefinite relaxation 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         for the selected row assignments. To be able to solve this relaxation for medium and large instances we have to slightly adapt our algorithmic approach: We use only the bundle method (without Sedumi) to obtain reasonable bounds as solving the relaxations exactly with Sedumi becomes way too time-consuming due to the large number of constraints involved. Since the bundle method has a rather weak local convergence behavior, we limit the number of function evaluations to 125 to control the overall computational effort. In fact these evaluations constitute the computational bottleneck as they are responsible for more than 95percent of the required running time. This limitation of the number of function evaluations sacrifices some possible incremental improvement of the bounds. Similar experiments showed (Hungerl√§nder and Anjos, 2012) that the lower bounds of the bundle method quickly get close to the exact 
                           
                              (
                              
                                 SDP
                                 cheap
                              
                              )
                           
                         bounds even though the number of function evaluations is capped at 125. (Note that the results in Table 7 required a higher number of function evaluations and hence higher computation times.) We summarize the results averaged over 10 row assignments selected by our heuristic in Table 9
                        .

Examining the results in Table 9 we observe that the running times are dependent on the number of departments plus the number of spaces. The lower bound slightly decreases when we add the spaces. Nonetheless the results clearly suggest that especially for large instances the space-free layout yields a very good approximation of the (MRFLP) layout. In contrast to the previous subsections spaces do not always help to reduce the costs of the best layout found because the spaces enlarge the size of the instances and hence can have a bad effect on the performance of the rounding heuristic.

We conclude with a mention that we extended the computations to instances of (kPROP) with 3‚Äì5 rows, but as the results exhibited the same trends as for the double-row case, we chose not to report them.

This paper proposed a new model for the (MRFLP) that expresses the problem as a discrete optimization problem. This makes it possible to exploit the underlying combinatorial structure, and in particular to explicitly control the number and size of the spaces between departments. This discrete optimization model is an extension of our recent approach for the (SF-MRFLP) to the more general (MRFLP) and also captures some of its important special cases. We constructed a semidefinite relaxation of the discrete optimization formulation and presented computational results showing that the proposed approach gives promising results for several variants of multi-row layout problems on a variety of benchmark instances.

There is a large variety of important layout problems both in the literature and in practice. Future research will study the application of the discrete modelling approach proposed in this paper, particularly Theorem 2, to other classes of layout problems.

@&#REFERENCES@&#

