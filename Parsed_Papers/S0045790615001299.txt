@&#MAIN-TITLE@&#A new robust digital watermarking using local polar harmonic transform

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The stable and uniform image feature points are extracted by the improved SURF detector.


                        
                        
                           
                           The affine invariant local feature regions are constructed adaptively.


                        
                        
                           
                           A new and effective 2D transform is introduced to embed watermark in the digital image.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image watermarking

Geometric distortions

SURF detector

Probability density

Polar harmonic transform

@&#ABSTRACT@&#


               
               
                  Geometric distortions are more difficult to tackle than other types of attacks. It is a challenging work to design a robust image watermarking scheme against geometric distortions. In this paper, we propose a robust digital image watermarking scheme based on local polar harmonic transform. The proposed scheme has the following advantages: (1) the stable and uniform image feature points are extracted by the improved speeded-up robust feature (SURF) detector, in which the probability density gradient is utilized, (2) the affine invariant local feature regions are constructed adaptively according to the variation of local probability density, and (3) a new and effective 2D transform, named polar harmonic transform (PHT), is introduced to embed watermark in the digital image. Experiments are carried out on a digital image set of 100 images collected from Internet, and the preliminary results show that the proposed image watermarking is not only invisible and robust against common image processing operations such as filtering, noise adding, and JPEG compression, but also robust against the geometric distortions.
               
            

@&#INTRODUCTION@&#

With the growing applications of Internet and other multimedia systems, tremendous amount of digital products are being generated and circulated through various information systems each year. The security of these products has becoming an important technical problem which has been studied over the past few decades. A typical solution is digital watermarking, which has been applied in many information security applications, such as copyright protection, copy protection, temper detection, authentication, and broadcast monitoring [1]. Technically speaking, digital watermarking aims to hide watermark data into the actual media object without affecting its normal usage. When necessary, the owners can extract the watermark data to declare their copyright. In most of the related applications, the watermark data has to be robust against the “watermark attacks,” including common image processing operations and geometric distortions [2]. For still images, the requirement of digital watermark surviving geometrical transformations is necessary since such manipulations as rotation, and scaling are common. Nevertheless, these procedures cause challenging synchronization problems for watermark detection. So, special care has to be taken so that the embedded watermark can survive geometric distortions to achieve the related functionalities in the target application. Existing image watermarking methods to resist geometric distortions can be classified into four types, i.e., Spread spectrum modulation, Invariant transform, Synchronization correction, and Feature-based algorithm [3].


                     
                        Spread spectrum modulation
                     : Spread spectrum modulation is probably the most popular approach for data hiding, which spreads the digital watermark over the host image. Based on the distribution of the coefficients in the watermark domain, different types of optimum and locally optimum decoders have been proposed. Li et al. [4] considered the problem of extracting data embedded over a wide band in a spectrum domain of a digital medium, and developed a novel multicarrier/signature iterative generalized least-squares core procedure to seek unknown data hidden in hosts via multicarrier spread-spectrum embedding. Maity and Maity [5] proposed a collusion resilient optimized spread spectrum image watermarking scheme using genetic algorithms (GA) and multiband (M-band) wavelets. Here, M-band decomposition of the host image can offer advantages of better scale-space tiling and good energy compactness, and GA can determine threshold value of the host coefficients selection for watermark casting along with the respective embedding strengths compatible to the gain of frequency response. Despite these advantages of spread spectrum modulation, the interference effect of the host image, which causes the watermark decoding performance degradation, is a major concern of the spread spectrum modulation. Besides, spread spectrum modulations are always fragile to local geometric distortions such as column removal and local affine transformation [6].


                     
                        Invariant transform
                     : The obvious way to achieve resilience against global geometric distortions is to use an invariant transform, in which the watermark can be embedded in an affine-invariant domain by using Fourier–Mellin transform, generalized Radon transform, moment invariants, histogram shape, and singular value vector respectively. Mohammad [7] presented a new digital watermarking algorithm for ownership protection, and the algorithm embeds the watermark in the Schur decomposition components of the cover image. Bhatnagar et al. [8] proposed a novel image watermarking scheme based on wavelet frame transform, singular value decomposition and automatic thresholding. The proposed scheme essentially rectifies the ambiguity problem in the SVD-based watermarking. The core idea is to randomly upscale the size of host image using reversible random extension transform followed by the embedding of logo watermark in the wavelet frame domain. Ali and Ahn [9] presented an optimal discrete wavelet transform-singular value decomposition (DWT–SVD) based image watermarking scheme using self-adaptive differential evolution (SDE) algorithm. Here, SDE adjusts the mutation factor and the crossover rate dynamically in order to balance an individual’s exploration and exploitation capability for different evolving phases. Despite that they are robust against global geometric distortions, those techniques involving invariant domain suffer from implementation issues and are vulnerable to local geometric distortions.


                     
                        Synchronization correction
                     : One of the methods for detecting watermarks after geometric distortions is correcting distorted watermarked image before detecting. In [10], the weight Hausdorff distance is defined. It is applied to evaluate the similarity between original and geometric distorted watermarking image. A fast divide and conquer strategy in six dimension is used to search the transformation parameters. The geometric distortion is corrected by the parameters. As a result, a distorted watermarking image could be corrected based on image feature. Ahmed et al. [11] proposed an image watermarking scheme which uses the geometric properties of an image to ensure invariance of the watermark to rotation and cropping. It also incorporates a checksum based mechanism for tracking any distortion effect in the cover work. Based on Gaussian-Hermite Moments (GHMs), Wang et al. [12] proposed a SVM correction based geometrically invariant digital watermarking algorithm, which has good visual quality and reasonable resistance toward global geometric distortions. Zhang et al. [13] derived the affine invariants from Legendre moments, and exploited the affine Legendre moment invariants for estimating the geometric distortion parameters. But, experimental results show that the synchronization correction based image watermarking schemes are also not robust against the local geometric distortions.


                     
                        Feature-based
                     : The last category is feature-based image watermarking techniques. By binding the digital watermark with the geometrically invariant image features, the watermark synchronization error can be avoided. Moreover, since the watermark is embedded in a number of local feature regions formed by feature points, such watermarking methods can resist cropping. Seo and Yoo [14] presented a content-based image watermarking method based on local regions of an image. The local regions are self-adaptive image patches that deform with geometric transformations. At each local region, the watermark is embedded after geometric normalization according to the shape of the region. However, the overlapping between local feature regions has not been resolved in this approach. Nikolaidis [15] proposed a novel technique for image watermarking aiming at robustness against geometrical attacks. The first stage relies on computing a normalized version of the original image using image moments. A radial symmetry transform is then applied to the normalized image, followed by a non-maxima suppression step. The feature points extracted this way act as centers of the area where the watermark is to be embedded. To minimize image distortion, they embed the inversely normalized watermark in the original image. Deng et al. [16] proposed a new image watermarking scheme on the basis of Seo’s work [14], which is insensitive to geometric distortions as well as common image processing operations. Yuan et al. [17] proposed a local Zernike moments based watermarking scheme where the watermarked image/region can be obtained directly by inverse Zernike transform. An edge-based feature detector is proposed for local region extraction, with which, the distinct circular patch of given size can be extracted for watermark embedding and extraction. Ji et al. [18] proposed a new feature-based image watermarking scheme for improving the robustness against desynchronization attacks. First, multi-scale Gaussian filtering model is used to extract feature points in original image. The stable and non-overlapped local circular regions centered at feature points are thereafter selected by combining image segmentation and feature points refinement. Finally the watermark is embedded in the Zernike moments of the normalized circular regions.

Through in-depth research and analysis, we can see that Spread spectrum modulation, Invariant transform, and Synchronization correction image watermarking approaches are usually vulnerable to some geometric distortions, and the feature-based image watermarking methods exhibit more promising than others in terms of robustness. However, there are some main drawbacks indwelled in current feature-based image watermarking schemes: Firstly, the state-of-the-art intensity based feature point detectors are sensitive to texture region, and most detected feature points gather in high contrast regions. However, broad categories of real-world images always have non-textured regions, and regular detectors very likely miss stable feature points there. Secondly, local feature regions are built using local image intensity gradient. But intensity gradient cannot describe effectively the image content detail and is always fragile to noise, which lowers the robustness of local feature regions. Thirdly, the adopted watermark embedding strategies are so simple that the watermark schemes cannot effectively resist some common signals processing operations and provide high quality watermarked images.

Based on probability density gradient and polar harmonic transform (PHT) theory, we propose a new robust image watermarking algorithm robust to geometric distortions in this paper. The novelty of the proposed algorithm includes: (1) The stable and uniform image feature points are extracted by the improved SURF detector; (2) The affine invariant local feature regions are constructed adaptively according to the variation of local probability density; and (3) The effective PHT is introduced to embed digital watermark.

The rest of this paper is organized as follows. Section 2 introduces basic theory about speeded-up robust features (SURF) detector. Section 3 presents the improved SURF detector based on probability density gradient. In Section 4, the affine invariant local feature regions construction and selection are described. Section 5 introduces the polar harmonic transform. Section 6 contains the description of our robust image watermark embedding procedure. Section 7 covers the details of the watermark detection procedure. Simulation results in Section 8 will show the performance of our scheme. Finally, Section 9 concludes this presentation.

Recently, the SURF or Speeded-Up Robust Features descriptor has appeared as an alternative to SIFT [19]. Its main advantage is its fastest computation, while keeping a high descriptive power (including repeatability, robustness, and distinctiveness). It is partially inspired by SIFT, but instead of using the gradient image, the SURF method is based on the Hessian matrix and relies on integral images to reduce the computation time.

SURF contains Hessian matrix-based point detector, and point description and matching. The Hessian matrix-based point detector locates the salient points in the image, and the point description and matching describes the features of the salient points and constructs the feature vectors of the salient points. In this paper, we only use Hessian matrix-based point detector to extract image feature points, so only the Hessian matrix-based point detector of the SURF algorithm are described below.

For SURF algorithm, the use of integral images is the key factor, which allow for fast computation of box type convolution filters. The entry of an integral image 
                        
                           
                              
                                 I
                              
                              
                                 Σ
                              
                           
                           (
                           x
                           )
                        
                      at a location 
                        
                           x
                           =
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              
                                 T
                              
                           
                        
                      represents the sum of all points in the input image I within a rectangular region formed by the origin and 
                        
                           x
                        
                     .
                        
                           (1)
                           
                              
                                 
                                    I
                                 
                                 
                                    Σ
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       i
                                       ⩽
                                       x
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       j
                                       ⩽
                                       y
                                    
                                 
                              
                              I
                              (
                              i
                              ,
                              j
                              )
                           
                        
                     Different from SIFT using DoG to detect feature points, SURF algorithm [19] use the determinant of the approximate Hessian matrix as the base of the feature points detector. To locate the feature point, the blob-like structures are detected at locations where the determinant is at maximum. Integral images are used in Hessian matrix approximation, which reduce computation time drastically. Given a point 
                        
                           x
                           =
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              
                                 T
                              
                           
                        
                      in an image I, the Hessian matrix 
                        
                           H
                           (
                           x
                           ;
                           σ
                           )
                        
                      in 
                        
                           x
                        
                      at scale 
                        
                           σ
                        
                      is defined as follows
                        
                           (2)
                           
                              H
                              (
                              x
                              ;
                              σ
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      xx
                                                   
                                                
                                                (
                                                x
                                                ,
                                                σ
                                                )
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      xy
                                                   
                                                
                                                (
                                                x
                                                ,
                                                σ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      xy
                                                   
                                                
                                                (
                                                x
                                                ,
                                                σ
                                                )
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      yy
                                                   
                                                
                                                (
                                                x
                                                ,
                                                σ
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 L
                              
                              
                                 xx
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                        
                      is the convolution of the Gaussian second order derivative 
                        
                           
                              
                                 ∂
                              
                              
                                 2
                              
                           
                           /
                           ∂
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           g
                           (
                           σ
                           )
                        
                      with the image I in point 
                        
                           x
                        
                     , and similarly for 
                        
                           
                              
                                 L
                              
                              
                                 xy
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                        
                      and 
                        
                           
                              
                                 L
                              
                              
                                 yy
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                        
                     .

To reduce the computation time, the 9×9 box filters are approximations of a Gaussian with 
                        
                           σ
                           =
                           1.2
                        
                      and represent the lowest scale (i.e. highest spatial resolution) for computing the blob response maps [19]. We will denote them by 
                        
                           
                              
                                 D
                              
                              
                                 xx
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                           ,
                           
                              
                                 D
                              
                              
                                 yy
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                        
                     , and 
                        
                           
                              
                                 D
                              
                              
                                 xy
                              
                           
                           (
                           x
                           ,
                           σ
                           )
                        
                     . The weights applied to the rectangular regions are kept simple for computational efficiency. This yields
                        
                           (3)
                           
                              det
                              (
                              
                                 
                                    H
                                 
                                 
                                    approx
                                 
                              
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                              
                              -
                              
                                 
                                    (
                                    
                                       
                                          wD
                                       
                                       
                                          xy
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     For scale invariant, the SURF constructs a pyramid scale space, like the SIFT. Different from the SIFT to repeatedly smooth the image with a Gaussian and then sub-sample the image, the SURF directly changes the scale of box filters to implement the scale space due to the use of the box filter and integral image.


                     Fig. 1
                      shows the image feature points detection results by using SURF detector.

In order to detect watermarks without the help of the original image, we must look for reference points that are perceptually significant and can resist various common image processing operations and geometric distortions. These reference points can act as mark for locating resynchronization between watermark embedding and detection. In this paper, we will use the term “feature points” to denote these reference points.

In recent years, some feature points detectors have been proposed, and applied in object recognition and image processing. For example, Harris–Laplace and Hessian-Affine corners by Mikolajczyk and Schmid, maximally stable extended regions (MSER) by Matas et al., scale-invariant feature transform (SIFT) by Lowe et al., affine SIFT (ASIFT) by Morel et al., speeded-up robust features (SURF) by Bay et al. [19,20]. However, these state-of-the-art feature points detectors are based on intensity gradient, which cannot describe efficiently texture information of an image. So, the feature points often gather at textured portions of the image or on the edges where the change of intensity is significant, so that many feature points capture the same portion of the image, which makes the watermark be vulnerable to local geometric distortions.

In this paper, we will extract the stable and uniform image feature points by utilizing improved SURF detector, in which the probability density gradient is considered.

The SURF detector is a powerful feature points extraction tool. For SURF detector, an image (gray image) is regarded as a two-dimensional intensity function, and the local image regions are classified into three categories: (1) uniform region where the intensity gradient of each pixel is very small or almost zero, (2) edge region where the intensity gradient magnitude of each pixel is large and the gradient direction is perpendicular to edge, and (3) textured region where the intensity gradient magnitude of each pixel is large and the gradient direction is different each other. And then, the feature points are chosen inside the textured image regions with intensity variations in scale space. However, broad categories of real-world images have non-textured regions. Regular SURF detector very likely misses stable feature points there. Additionally, SURF detector is built using local image intensity gradients and thus loses its distinctiveness when built on non-textured areas. In this paper, we will utilize the improved SURF detector to extract the uniform and robust feature points, in which the second order moment matrix is redefined by using intensity probability density gradient instead of intensity gradient.

Kernel density estimation is the most popular density estimation method [21]. The intensity probability density of each image pixel can be obtained by Kernel density estimation, and the intensity probability density 
                           
                              P
                              (
                              X
                              )
                           
                         in the point 
                           
                              X
                              (
                              x
                              ,
                              y
                              )
                           
                         is given by
                           
                              (4)
                              
                                 P
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          W
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                         -
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         -
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where W denotes the viewing window centered at 
                           
                              X
                              ,
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                           
                         is an image pixel in window 
                           
                              W
                              ,
                              c
                           
                         and 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                           
                         are the intensities of points 
                           
                              X
                           
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                           
                         respectively, 
                           
                              
                                 
                                    h
                                 
                                 
                                    s
                                 
                              
                           
                         denotes the employed kernel bandwidths in image space, 
                           
                              
                                 
                                    h
                                 
                                 
                                    r
                                 
                              
                           
                         denotes the employed kernel bandwidths in intensity space, C is the corresponding normalization constant, 
                           
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           
                         are the kernel functions (generally, Gaussian function), and
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 g
                                 (
                                 σ
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       /
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 σ
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       σ
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        From Eq. (4), we can derive the intensity probability density gradient estimator 
                           
                              G
                              (
                              x
                              ,
                              y
                              )
                           
                         of image pixel 
                           
                              X
                           
                        
                        
                           
                              (5)
                              
                                 G
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       s
                                    
                                 
                                 P
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       xx
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       yy
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       xx
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       P
                                       (
                                       X
                                       )
                                    
                                    
                                       d
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          W
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                                  -
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                                  -
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       yy
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       P
                                       (
                                       X
                                       )
                                    
                                    
                                       
                                          
                                             dy
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          W
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             dy
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                                  -
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                                  -
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The SURF detector is a powerful feature points extraction tool. It has been proven that feature points extracted by SURF detector are invariant to image rotation, scaling, viewpoint changes, and JPEG compression. In this paper, we will extract the stable and uniform image feature points by utilizing improved SURF detector, in which the probability density gradient is considered.

The new image feature point detector contains three key steps: (1) Compute the probability density gradient of the image (see Section 3.1), (2) Compute the new second order moment matrix (Hessian matrix 
                           
                              H
                              )
                           
                         by using the probability density gradient of the image, (3) Detect the feature points by using SURF detector with the new second order moment matrix.


                        Fig. 2
                         shows the image feature points detection results by using the probability density-based SURF detector (our method). Obviously, for our probability density-based SURF detector, the feature points are chosen inside both the textured regions and non-textured areas, so the feature points are distributed evenly.

The local feature regions (LFRs), which reflect the important image semantics, are the subsets of the host image. Generally speaking, the LFRs can be any shapes such as triangle, rectangle, circle, ellipse, and hexagon, but it is important to assure that LFRs should be invariant to local geometric distortions. Seo and Yoo [14] proposed the triangular LFRs by using the Delaunay tessellation, one of which is generated by three feature points, but this approach is sensitive to cropping. In [15], the circular LFRs, one of which is generated by only one feature point, are proposed. Since these circular LFRs are independent with each other, the resilience against cropping therefore is improved in some measure. However, the circular LFRs cannot resist to random bending and aspect ratio changing. Seo and Deng et al. [14,16] exploited the elliptical LFRs to embed digital watermark. Their approach possesses a certain degree of robustness against projective transformations and random bending. Their elliptical LFRs are built using local image intensity gradient. But intensity gradient cannot describe effectively the image content detail and is always fragile to noise, which lowers the robustness of local feature regions. In this paper, we build adaptively the affine invariant local feature regions (elliptical regions) according to the variation of local probability density.

Below we will discuss in detail how to construct the affine invariant elliptical LFRs (including calculating the center, long semi-axis, short semi-axis, and direction angle of the LFR).

Our process for affine invariant local elliptical region construction can be summarized as follows [22].
                        
                           (1)
                           Extract image feature points by utilizing improved SURF detector (see Section 3), which are regarded as the centers 
                                 
                                    X
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                               of the elliptical LFRs.

Compute the new second order moment matrix (Hessian matrix 
                                 
                                    H
                                    )
                                 
                               by using the probability density gradient of the image.

Compute the eigenvalues (
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               and eigenvectors (
                                 
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               of the new Hessian matrix H.

Compute the long semi-axis, short semi-axis, and direction angle of the elliptical LFR

Since the magnitude of pixels in a LFR will be modified when a watermark is inserted into this region, it is preferred to select nonoverlapping regions for watermarking to avoid a major degradation of image quality. In order to select a nonoverlapping region, some reference parameters have been exploited in previous methods. For example, the regions with higher feature corner response are selected when the Harris–Laplacian or Harris-affine detector is used [14]. But corner response cannot guarantee the selection of nonoverlapping regions with the maximum robustness to various attacks, because higher corner response do not always imply higher robustness of itself. Tsai et al. [23] propose a feature region selection method based on the idea of simulated attacking and multidimensional knapsack problem (MDKP) optimization techniques. However, it has high time complexity. In this paper, the number of neighboring feature points inside an elliptical LFR is a major reference for obtaining a nonoverlapping regions set.


                     Fig. 3
                      illustrates the procedures in selecting the elliptical LFRs for Barbara. Fig. 3a illustrates the elliptical LFRs extracted by the affine invariant local elliptical region construction. Fig. 3b and c shows the elliptical LFRs selection procedure. The finally determined elliptical LFRs for watermarking are displayed in Fig. 3d.

We apply our image feature points detector (see Section 3) and affine invariant elliptical LFRs construction (see Section 4) to the popular test images 
                        
                           512
                           ×
                           512
                           ×
                           8
                           
                           bit
                        
                      Lena, Barbara, Mandrill, and Peppers. As shown in Fig. 4
                     , the number of elliptical LFRs is 11, 11, 11, and 10 in Lena, Barbara, Mandrill, and Peppers, respectively.

In 2010, Yap et al. [24] introduced a set of 2D transforms named Polar Harmonic Transform (PHT) based on a set of orthogonal projection bases. Compared with other orthogonal moment, PHT has a better image reconstruction, lower noise sensitivity, and lower computational complexity. Besides, the PHT is free of numerical instability issues so that high order moments can be obtained accurately.

The PHT coefficients 
                        
                           
                              
                                 M
                              
                              
                                 n
                                 ,
                                 l
                              
                           
                        
                      of order n with repetition 
                        
                           l
                           ,
                           
                              
                                 
                                    n
                                 
                              
                           
                           =
                           
                              
                                 
                                    l
                                 
                              
                           
                           =
                           0
                           ,
                           1
                           …
                           ,
                           ∞
                        
                     , is defined as
                        
                           (6)
                           
                              
                                 
                                    M
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    π
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              r
                              ,
                              θ
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                n
                                                ,
                                                l
                                             
                                          
                                          (
                                          r
                                          ,
                                          θ
                                          )
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              rdrd
                              θ
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                              
                                 ∗
                              
                           
                        
                      denotes the complex conjugate and the basis 
                        
                           
                              
                                 H
                              
                              
                                 n
                                 ,
                                 l
                              
                           
                           (
                           r
                           ,
                           θ
                           )
                        
                      can be decomposed into radial and circular components
                        
                           (7)
                           
                              
                                 
                                    H
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              (
                              r
                              ,
                              θ
                              )
                              =
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              
                                 
                                    e
                                 
                                 
                                    il
                                    θ
                                 
                              
                           
                        
                     with the radial kernel being a complex exponential in the radial direction
                        
                           (8)
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    i
                                    2
                                    π
                                    
                                       
                                          nr
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     and satisfying orthogonality condition
                        
                           (9)
                           
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              
                                 
                                    [
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    r
                                    )
                                    ]
                                 
                                 
                                    ∗
                                 
                              
                              rdr
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    n
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                     and also
                        
                           (10)
                           
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              (
                              r
                              ,
                              θ
                              )
                              
                                 
                                    [
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    r
                                    ,
                                    θ
                                    )
                                    ]
                                 
                                 
                                    ∗
                                 
                              
                              rdrd
                              θ
                              =
                              π
                              
                                 
                                    δ
                                 
                                 
                                    n
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    l
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           π
                        
                      is the normalization factor, 
                        
                           
                              
                                 δ
                              
                              
                                 n
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 δ
                              
                              
                                 l
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      are the Kronecker symbols, and 
                        
                           
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 (
                                 r
                                 ,
                                 θ
                                 )
                                 ]
                              
                              
                                 ∗
                              
                           
                        
                      is the conjugate of 
                        
                           
                              
                                 H
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           (
                           r
                           ,
                           θ
                           )
                        
                     .

The image (gray image) 
                        
                           f
                           (
                           r
                           ,
                           θ
                           )
                        
                      can be decomposed with the set of 
                        
                           
                              
                                 H
                              
                              
                                 n
                                 ,
                                 l
                              
                           
                           (
                           r
                           ,
                           θ
                           )
                        
                      as
                        
                           (11)
                           
                              f
                              (
                              r
                              ,
                              θ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       -
                                       ∞
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       -
                                       ∞
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              exp
                              (
                              il
                              θ
                              )
                           
                        
                     where 
                        
                           
                              
                                 M
                              
                              
                                 n
                                 ,
                                 l
                              
                           
                        
                      is the PHT coefficients of order n with repetition l.

Following the principle of orthogonal function, the image function 
                        
                           f
                           (
                           r
                           ,
                           θ
                           )
                        
                      can be reconstructed approximately by limited orders of PHT coefficients (
                        
                           n
                           ⩽
                           
                              
                                 n
                              
                              
                                 max
                              
                           
                           ,
                           l
                           ⩽
                           
                              
                                 l
                              
                              
                                 max
                              
                           
                           )
                        
                     . The more orders used, the more accurate the image description
                        
                           (12)
                           
                              
                                 
                                    f
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       r
                                       ,
                                       θ
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       -
                                       ∞
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       -
                                       ∞
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              exp
                              (
                              il
                              θ
                              )
                              ≈
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       -
                                       
                                          
                                             n
                                          
                                          
                                             max
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             max
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    n
                                    ,
                                    l
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              r
                              )
                              exp
                              (
                              il
                              θ
                              )
                           
                        
                     where 
                        
                           
                              
                                 f
                              
                              
                                 ′
                              
                           
                           (
                           r
                           ,
                           θ
                           )
                        
                      is the reconstructed image. The basis functions 
                        
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                           (
                           r
                           )
                           exp
                           (
                           il
                           θ
                           )
                        
                      of the PHT are orthogonal over the interior of the unit circle, and each order of the PHT coefficients makes an independent contribution to the reconstruction of the image.


                     Fig. 5
                      gives some examples of image reconstruction using PHT for standard gray image “Lena” and ”Barbara” (moment orders N
                     =5, 10, 15, 20, 25, 30, 35, 40, 45, 50). Fig. 6
                      shows the modulus distribution of PHT coefficients for image Lena under various attacks. It can be seen that the PHT gives better reconstruction results and the PHT coefficients modulus have good robustness against various noises, and geometric transformations. So, PHT coefficients modulus are suitable for robust image watermarking.

From the communication model of watermarking (the host image, watermark bits and various attacks are viewed as the channel, transmitted information and noises respectively), we can know that all local feature regions generated from the host image can be viewed as independent communication channels. To improve the robustness of transmitted information, all channels carry the same copy of the chosen watermark. The transmitted information passing through each channel may be disturbed by different types of transmitting noise due to intentional and unintentional attacks. During the detection process, we claim the existence of watermark if at least two copies of the embedded watermark are correctly detected. In this paper, we propose a robust digital image watermarking scheme using local PHT. Firstly, the stable and uniform image feature points are extracted by using improved SURF feature point detector, in which the probability density gradient is used. Then, the affine invariant local elliptical regions are built adaptively according to the variation of local probability density. Finally, the digital watermark is embedded into the local elliptical regions by modulating the local PHT coefficients.

Let 
                        
                           I
                           =
                           
                              
                                 
                                    f
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ,
                                    0
                                    ⩽
                                    x
                                    ⩽
                                    M
                                    -
                                    1
                                    ,
                                    0
                                    ⩽
                                    y
                                    ⩽
                                    N
                                    -
                                    1
                                 
                              
                           
                        
                      represent a host digital image, and 
                        
                           f
                           (
                           x
                           ,
                           y
                           )
                        
                      denotes the pixel value at position 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     . The digital watermark embedding scheme can be summarized as follows.


                     Step 1: Watermark Generation

A random sequence (digital watermark) 
                        
                           W
                           =
                           {
                           w
                           (
                           i
                           )
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           L
                           -
                           1
                           }
                        
                      is generated by the secret key 
                        
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                        
                     , where L is the size of the sequence. The sequence values belong to the set 
                        
                           {
                           0
                           ,
                           1
                           }
                        
                     .


                     Step 2: Image Feature Points Detection

The improved SURF feature point detector, which is based on probability density gradient, is applied to the host image, and a set of feature points, denoted as 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           (
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           -
                           1
                           )
                        
                     , is obtained (see Section 3).


                     Step 3: Local Elliptical Regions Construction

A set of affine invariant local elliptical regions, denoted as 
                        
                           
                              
                                 O
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                     , is constructed in accordance with the variation of local probability density (see Section 4).

Since the magnitude of pixels in a local elliptical region will be modified when a watermark is inserted into this region, it is preferred to select nonoverlapping regions for watermarking to avoid a major degradation of image quality. In this paper, the number of neighboring feature points inside a local elliptical region is a major reference for obtaining a nonoverlapping regions set.


                     Step 4: Mapping Local Elliptical Region to Local Circular Region

In order to embed digital watermark more easily, for the existing features-based image watermarking algorithms, the local elliptical regions are generally normalized to the circular patches with a fixed radius in the whole host image. Obviously, the smaller size of the normalized patch will cause poorer quality of the watermarked image, and the larger one will cause influence on the robustness of the watermark. In addition, different radius of the normalized local circular regions should be adopted for different host image so as to reach better result.

In this paper, we will adaptively and affinely map local elliptical regions 
                        
                           
                              
                                 O
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                      to the local circular regions 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                      according to the local image characteristics. Let 
                        
                           (
                           
                              
                                 x
                              
                              
                                 C
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 C
                              
                           
                           )
                           ,
                           
                              
                                 r
                              
                              
                                 a
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 b
                              
                           
                        
                     , and 
                        
                           θ
                        
                      represent the center coordinate, long semi-axis, short semi-axis, and direction angle of the local elliptical region respectively. Let the image pixel coordinates in local elliptical region is
                        
                           
                              
                                 
                                    
                                    
                                       
                                          x
                                          =
                                          a
                                          cos
                                          α
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          y
                                          =
                                          b
                                          sin
                                          α
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           a
                           (
                           0
                           ⩽
                           a
                           ⩽
                           
                              
                                 r
                              
                              
                                 a
                              
                           
                           )
                           ,
                           b
                           (
                           0
                           ⩽
                           b
                           ⩽
                           
                              
                                 r
                              
                              
                                 b
                              
                           
                           )
                        
                     , and 
                        
                           α
                           (
                           0
                           ⩽
                           α
                           <
                           2
                           π
                           )
                        
                      stand for the polar coordinates parameters respectively.

And the coordinate mapping can be given by
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          cos
                                          θ
                                          ·
                                          a
                                          ·
                                          cos
                                          α
                                          -
                                          sin
                                          θ
                                          ·
                                          b
                                          ·
                                          sin
                                          α
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                C
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          sin
                                          θ
                                          ·
                                          a
                                          ·
                                          cos
                                          α
                                          +
                                          cos
                                          θ
                                          ·
                                          b
                                          ·
                                          sin
                                          α
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                C
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ′
                              
                           
                        
                      is the corresponding image pixel coordinates in local circular region.


                     Step 5: Polar Harmonic Transform

We know that, compared with other orthogonal moment, PHT has a better image reconstruction, lower noise sensitivity, and lower computational complexity. Besides, the PHT is free of numerical instability issues so that high order moments can be obtained accurately. In this paper, we will embed digital watermark into local elliptical regions by modulating the robust PHT coefficients.

It is very hard to perform directly PHT of the local circular regions, so a zero-padding operation is considered to solve this problem. The local circular regions 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                      is mapped to the square image block 
                        
                           
                              
                                 B
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                      of size 
                        
                           2
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           ×
                           2
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      by using zero-padding method, where 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      is the radius of local circular region. After the watermark has been embedded, the zero-removing should be used to the image block in order to convert it circle area. It is necessary to point out that there is an energy loss during the zero-padding/zero-removing procedure, yet it is so small and does not affect watermark detection.

After zero-padding, the PHT of the square image blocks 
                        
                           
                              
                                 B
                              
                              
                                 k
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           -
                           1
                           )
                        
                      are computed (see Section 5).


                     Step 6: Robust PHT Coefficients Selection

Simulation results show that, in calculating PHT, some minor calculation errors always exist when the digital image is attacked by some common image processing operations, such as filtering, noise adding, and JPEG compression. So, we must select reasonably robust PHT coefficients for embedding watermark.

According to the characteristics analysis and experiments on some common image processing operations, we give the following PHT coefficients selection rule: (1) The PHTs with repetitions 
                        
                           l
                           =
                           4
                           m
                           ,
                           m
                           ∈
                           Z
                        
                     , are reduced because they are not accurate; (2) For the conjugated pairs, only the PHT coefficients with positive order or repetition is used. As a result, the final PHT coefficients set and the number of independent PHT coefficients used for watermark embedding in the proposed scheme are as follows
                        
                           
                              
                                 
                                    
                                    
                                       
                                          S
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         n
                                                         ,
                                                         l
                                                      
                                                   
                                                   ,
                                                   n
                                                   ⩾
                                                   0
                                                   ,
                                                   l
                                                   
                                                   ≠
                                                   
                                                   4
                                                   m
                                                   ,
                                                   m
                                                   ∈
                                                   Z
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  3
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  3
                                                                  K
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            ,
                                                            
                                                            K
                                                            =
                                                            4
                                                            m
                                                            
                                                            or
                                                            
                                                            K
                                                            =
                                                            4
                                                            m
                                                            +
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  3
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  3
                                                                  K
                                                                  -
                                                                  2
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            ,
                                                            
                                                            K
                                                            =
                                                            4
                                                            m
                                                            +
                                                            1
                                                            
                                                            or
                                                            
                                                            K
                                                            =
                                                            4
                                                            m
                                                            +
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where K is a constant and it is equal to the highest order, n and l are order and repetition of quaternion exponent moments respectively.

For the sake of security, we use a secret key 
                        
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                        
                      to pseudorandomly choose L PHT coefficients from S to form a PHT coefficients vector 
                        
                           M
                           =
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      for embedding watermark. Let the magnitude of the selected robust PHT coefficients be 
                        
                           A
                           =
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                m
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     .


                     Step 7: Digital Watermark Embedding

In this paper, we embed digital watermark into the magnitude of the selected robust PHT coefficients via quantization index modulation (QIM) [25], and the adopted QIM strategy is
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             -
                                             d
                                             
                                                
                                                   
                                                      w
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             Δ
                                          
                                       
                                    
                                 
                              
                              Δ
                              +
                              d
                              
                                 
                                    
                                       w
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                              (
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              L
                              -
                              1
                              )
                           
                        
                     where 
                        
                           
                              
                                 A
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ′
                              
                           
                        
                      denote the original magnitude and modified magnitude of the selected robust PHT coefficients, respectively. 
                        
                           
                              
                                 
                                    ·
                                 
                              
                           
                        
                      is the rounding operation, 
                        
                           Δ
                        
                      is the quantization step size, and 
                        
                           d
                           
                              
                                 
                                    ·
                                 
                              
                           
                        
                      is the dither function
                        
                           
                              d
                              
                                 
                                    
                                       1
                                    
                                 
                              
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              +
                              d
                              
                                 
                                    
                                       0
                                    
                                 
                              
                           
                        
                     Here, 
                        
                           d
                           
                              
                                 
                                    0
                                 
                              
                           
                           ∈
                           
                              
                                 
                                    0
                                    ,
                                    1
                                 
                              
                           
                        
                      is pseudorandomly generated with another key 
                        
                           
                              
                                 K
                              
                              
                                 3
                              
                           
                        
                     , which is used to further increase the security of the embedded signal.


                     Step 7: Obtaining the Watermarked Local Elliptical Regions

Firstly, the watermarked square image block 
                        
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                        
                      can be obtained by inverse PHT of the unchanged and modified PHT coefficients. Secondly, the watermarked local circular region can be obtained by zero-removing operation. Then, the watermarked local circular region is inverse-mapped into the watermarked local elliptical region.


                     Step 8: Obtaining the Watermarked Image

Repeat the step 4–step 7 until all local elliptical regions are performed, and we can obtain the watermarked image 
                        
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                        
                      by replacing the origin local elliptical regions with the watermarked local elliptical regions.

Similarly to watermark insertion, the first step for watermark detection is analyzing contents to find local elliptical regions. The watermark is then detected from the local elliptical regions. If the watermark is correctly detected from more than one local elliptical region, we can prove ownership successfully. Our process for watermark detection can be summarized as follows.


                     Step 1: Image Feature Points Detection

The improved SURF image feature point detector, which is based on probability density gradient, is applied to the watermarked image 
                        
                           
                              
                                 I
                              
                              
                                 ∗
                              
                           
                        
                     , and a set of feature points, denoted as 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           (
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                     , is obtained (see Section 3).


                     Step 2: Local Elliptical Regions Construction

A set of affine invariant local elliptical regions, denoted as 
                        
                           
                              
                                 O
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                     , is constructed in accordance with the variation of local probability density (see Section 4).


                     Step 3: Mapping Local Elliptical Region to Local Circular Region

The local elliptical regions 
                        
                           
                              
                                 O
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                      are adaptively and affinely mapped to the local circular regions 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                      according to the local image characteristics.


                     Step 4: Mapping Local Circular Region to Square Image Block

The local circular regions 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                      is mapped to the square image block 
                        
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           -
                           1
                           )
                        
                      by using zero-padding method.


                     Step 5: Polar Harmonic Transform

The PHT of the square image block 
                        
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                        
                      are computed (see Section 5).


                     Step 6: Robust PHT Coefficients Selection

With the same key 
                        
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                        
                      as watermark embedding, the PHT coefficients that carry the watermark information are chosen 
                        
                           
                              
                                 M
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                L
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                        
                     , and the magnitude of the selected robust PHT coefficients are
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   L
                                                   -
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   L
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Step 7: Digital Watermark Extraction

The digital watermark is extracted from the selected robust PHT coefficients.

Firstly, two dither vectors 
                        
                           d
                           
                              
                                 
                                    0
                                 
                              
                           
                           ,
                           d
                           
                              
                                 
                                    1
                                 
                              
                           
                        
                      are generated with the same key 
                        
                           
                              
                                 K
                              
                              
                                 3
                              
                           
                        
                      as in the embedder.

Then, the magnitude of the selected robust PHT coefficients 
                        
                           
                              
                                 A
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           (
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           L
                           -
                           1
                           )
                        
                      are quantized by using the same quantizer as embedding
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             d
                                             
                                                
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             Δ
                                          
                                       
                                    
                                 
                              
                              Δ
                              +
                              d
                              
                                 
                                    
                                       j
                                    
                                 
                              
                              
                              (
                              j
                              =
                              0
                              ,
                              1
                              )
                           
                        
                     where 
                        
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           L
                           -
                           1
                        
                     , and 
                        
                           
                              
                                 
                                    ·
                                 
                              
                           
                        
                      is the rounding operation.

Finally, by comparing the distances between 
                        
                           
                              
                                 A
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ∗
                              
                           
                        
                      and its two quantized versions, we obtain estimate of the bit
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ∗
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             
                                                0
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          -
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              L
                              -
                              1
                              )
                           
                        
                     which is so-called minimum distance decoder. The above formula can be decomposed into the following steps:
                        
                           
                              
                              
                                 
                                    ① The distances between 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                        and its two quantized versions are respectively define as 
                                          
                                             dis
                                             0
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           l
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                        and 
                                          
                                             dis
                                             1
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           l
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       ;
                                 
                                 
                                    ② The difference between the two distances in ① is computed, note 
                                          
                                             t
                                             =
                                             dis
                                             0
                                             -
                                             dis
                                             1
                                          
                                       ;
                                 
                                 
                                    ③ The watermark bits are decided by the results in ②
                                 
                                 
                                    
                                        if 
                                          
                                             t
                                             <
                                             0
                                          
                                        then
                                 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ∗
                                                
                                             
                                             (
                                             i
                                             )
                                             =
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                        else
                                 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ∗
                                                
                                             
                                             (
                                             i
                                             )
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The error named false alarm probability is possible in detection. To eliminate this error, a comparison between the extracted watermark and the original watermark is necessary. For an unwatermarked image, the extracted bits are assumed to be independent random variables with the same “success” probability 
                        
                           
                              
                                 P
                              
                              
                                 success
                              
                           
                        
                     . We assume the success probability 
                        
                           
                              
                                 P
                              
                              
                                 success
                              
                           
                           =
                           0.5
                        
                     . Let r be the number of “success” bits in each local elliptical region, and let L be the size of the digital watermark. Then, based on the Bernoulli trials assumption, r is an independent random variable with binomial distribution. A local elliptical region is claimed watermarked if the number of its “success” bits is greater than a threshold. The threshold for a local elliptical region is denoted as T. The false-alarm error probability of a LER is, therefore, the cumulative probability of the cases that 
                        
                           r
                           ⩾
                           T
                        
                     . That is:
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    F
                                    _
                                    LFR
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       =
                                       T
                                    
                                    
                                       L
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          0.5
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             L
                                             !
                                          
                                          
                                             r
                                             !
                                             (
                                             L
                                             -
                                             r
                                             )
                                             !
                                          
                                       
                                    
                                 
                              
                           
                        
                     Furthermore, an image is claimed watermarked if at least two local elliptical regions are detected as “success”. Under this criterion, the false-alarm probability of one image is
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    F
                                    _
                                    Image
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                F
                                                _
                                                LFR
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                P
                                             
                                             
                                                F
                                                _
                                                LFR
                                             
                                          
                                       
                                    
                                 
                                 
                                    m
                                    -
                                    i
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where M is the total number of local elliptical regions in an image. Provided the 
                        
                           
                              
                                 P
                              
                              
                                 F
                                 _
                                 Image
                              
                           
                        
                      is ascertained, the T can be computed in accordance with 
                        
                           
                              
                                 P
                              
                              
                                 F
                                 _
                                 Image
                              
                           
                        
                     .

The final detection is claimed “success” when at least two local elliptical regions are claimed watermarked; otherwise, it is “fails”.

We test the proposed watermarking scheme on ten popular test images. Ten test images from USC-SIPI image database, each of dimensions 5125128bit, are shown in Fig. 7
                     , referred to as “Lena”, “Barbara”, “Mandrill”, “Peppers”, “Couple”, “Fishing boat”, “Clock”, “Girl”, “Stream and bridge”, and “Aerial”, respectively, in the sequel. And a pseudorandom bipolar sequence of size 64-bits is used as the watermark pattern. The quantization step size is 
                        
                           Δ
                           =
                           0.9
                        
                     . Besides, the PSNR (Peak Signal-to-Noise Ratio) is used to measure the visual quality of the watermarked images. Finally, experimental results are compared with schemes in [14,16].

As shown in Fig. 8
                        a–d are the watermarked images (Lena, Barbara, Mandrill, and Peppers) obtained by using the proposed scheme. Fig. 9
                        a–d show the watermark detection results (Note: the local elliptical regions identified by “white point” denote that the watermark was detected correctly) from Fig. 8a–d. The number of local elliptical regions where the watermark was correctly retrieved (identified by using “white point”) is 11, 11, 11, and 10 in Lena, Barbara, Mandrill, and Peppers, respectively. Fig. 10
                        a–d are the absolute difference between origin image and watermarked image for our algorithm (multiplied by 20 for better display).

Simulation results, which are obtained by the proposed watermarking scheme, for common image processing operations and geometric distortions are shown in Figs. 11 and 12
                        
                         respectively. Tables 1 and 2
                        
                         show the results of comparison with schemes [14,16]. It is clear that the proposed scheme outperforms schemes [14,16] under most attacks in terms of detection rates, which is defined as the ratio between the number of correctly detected watermarked local elliptical regions and the number of original watermarked local elliptical regions. We also tested on several attacks that scheme [14,16] cannot handle, for example, the combination of geometric distortions.

From the above experimental results, we can see that the newly proposed image watermarking is not only invisible and robust against common image processing operations, but also provide resistance to geometric distortions, especially for texture image such Mandrill, and it outperforms a variety of state-of-the-art image watermarking algorithms [14,16]. This is because that (1) we extract the stable and uniform image feature points by the improved SURF detector, in which the probability density gradient is utilized, (2) we construct adaptively the affine invariant local elliptical regions according to the variation of local probability density, (3) we build the effective PHT based image watermarking scheme.

Obviously, the proposed image watermarking scheme is computationally more demanding than other state-of-the-art feature-based watermarking methods that do not consider feature points distribution, feature points and local feature region stability. The watermark embedding and detection of this proposed watermarking scheme can be done within two minutes on a 3.4-GHz Pentium 4 processor for 512×512 images, which is acceptable for most applications.

@&#CONCLUSION@&#

Geometric distortions that cause displacement between embedding and detection are usually difficult for watermark to survive. It is a challenging work to design a robust image watermarking scheme against geometric distortion, especially local geometric distortions. The localized image watermarking scheme using feature points is a promising technique to overcome such problems. However, the feature point extraction techniques adopted by current feature-based approaches are sensitive to texture region, which makes their robustness to specific attacks limited. Moreover, the watermark embedding strategies are so simple that the watermark schemes cannot effectively resist some common signals processing operations and provide high quality watermarked images. In this paper, we propose a robust image watermarking scheme using local polar harmonic transform. Firstly, the stable and uniform image feature points are extracted by using improved SURF image feature point detector, in which the probability density gradient is utilized. Then, the affine invariant local elliptical regions are built adaptively according to the variation of local probability density. Finally, the digital watermark is embedded into the local elliptical regions by modulating the PHT coefficients magnitude. The extensive experimental works have shown that the proposed image watermarking strategy has conquered those challenging geometric distortions, such as aspect ratio changing, row or column removal, projective transformations, and a combination of attacks. Also, the digital watermark can resist some common image processing operations.

Drawbacks of the proposed image watermarking scheme are related to its lesser watermark capacity. In addition, due to the computation time for the probability density gradient based image feature points detector, our scheme cannot be used effectively in real-time applications. Future work will focus on eliminating these drawbacks.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the National Natural Science Foundation of China under Grant Nos. 61472171 & 61272416, the Open Project Program of Jiangsu Key Laboratory of Image and Video Understanding for Social Safety (Nanjing University of Science and Technology) under Grant No. 30920130122006, the Open Foundation of Zhejiang Key Laboratory for Signal Processing under Grant No. ZJKL_4_SP-OP2013-01, the Open Foundation of Provincial Key Laboratory for Computer Information Processing Technology (Soochow University) under Grant No. KJS1325, the Open Project Program of the State Key Lab of CAD&CG (Grant No. A1425), Zhejiang University, and Liaoning Research Project for Institutions of Higher Education of China under Grant No. L2013407.

@&#REFERENCES@&#

