@&#MAIN-TITLE@&#Supervised locality discriminant manifold learning for head pose estimation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel supervised locality discriminant manifold learning approach.


                        
                        
                           
                           We combine the discriminant graph embedding and Laplacian regularized least square.


                        
                        
                           
                           We design an optimal supervised weight for estimating head pose more accurately.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Manifold learning

Supervised learning

Locality discriminant regularization

Head pose estimation

Graph construction

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a novel supervised manifold learning approach, supervised locality discriminant manifold learning (SLDML), for head pose estimation. Traditional manifold learning methods focus on preserving only the intra-class geometric properties of the manifold embedded in the high-dimensional ambient space, so they cannot fully utilize the underlying discriminative knowledge of the data. The proposed SLDML aims to explore both geometric structure and discriminant information of the data, and yields a smooth and discriminative low-dimensional embedding by adding the local discriminant terms in the optimization objectives of manifold learning. Moreover, for efficiently handling out-of-sample extension and learning with the local consistency, we decompose the manifold learning as a two-step approach. We incorporate the manifold learning and the regression with a learned discriminant manifold-based projection function obtained by discriminatively Laplacian regularized least squares. The SLDML provides both the low-dimensional embedding and projection function with better intra-class compactness and inter-class separability, therefore preserves the local geometric structures more effectively. Meanwhile, the SLDML is supervised by both biased distance and continuous head pose angle information when constructing the graph, embedding the graph and learning the projection function. Our experiments demonstrate the superiority of the proposed SLDML over several current state-of-art approaches for head pose estimation on the publicly available FacePix dataset.
               
            

@&#INTRODUCTION@&#

Head pose estimation is an integral component of multi-view face recognition systems, driver attention monitoring and other human-centered computing applications. It already becomes a hot research topic in computer vision applications [1]. Currently, the state-of-art methods for head pose estimation have adopted intensively the technique of manifold learning and embedding [2]. The technique is based on the idea that the dimensionality of the dataset is only artificially high, and it may be described as a function of only a few underlying parameters. This technique attempts to uncover these parameters in order to find a low-dimensional representations of the data. That is to say, the data points are actually sampled from a low-dimensional manifold that is embedded in a high-dimensional ambient space. For human head pose estimation, a fundamental assumption of using this technique is that face images with varying pose angles are data points that lies on a smooth low-dimensional manifold constrained by the head pose variations. It is always believed that the manifold models the nonlinear and continuous variations of face appearance with head pose angle, and if learned properly, new face images can then be embedded in the low-dimensional space to estimate the head poses.

The manifold learning includes nonlinear types, such as Isometric Feature Mapping (ISOMAP) [3], Laplacian Eigenmap (LE) [4] and Locally Linear Embedding (LLE) [5], and linear types, such as Locality Preserving Projection (LPP) [6] and Neighborhood Preserving Embedding (NPE) [7], etc. Typically, a quadratic objective derived from a neighborhood graph is set up and solved for its leading eigenvectors.

The nonlinear manifold learning assumes that the underlying structure of the real data is often highly nonlinear and hence cannot be accurately approximated by linear manifolds. It aims to preserve certain geometric properties among neighboring data points in the process of projecting the high-dimensional data to low-dimensional embedding. There are various different geometric properties that include the pairwise geodesic distances (Isometric Feature Mapping (ISOMAP) [3]), the local convexity (Local Linear Embedding (LLE) [5]), the local distance (Laplacian Eigenmap (LE) [4]). By incorporating prior knowledge of class labels, manifold learning methods also perform pattern classification in the feature space. Mostly, above algorithms are formulated as convex optimization problems. These models generally assume that the low-dimensional manifold is isometric to a convex subset of Euclidean space, and there may exist problems of high curvature of the manifold and out-of-sample extension for non-isometric manifold [8].

For nonlinear manifold learning a critical issue is the lack of a direct mapping from the input space to the manifold space, which limits the applicability of these methods. One solution to this issue was presented in [9], where the distance matrix was viewed as a kernel and some new points were embedded by using the Nystrom approximation. Unfortunately, it is a rather complex process, and time-consuming does not have a clear interpretation for the LLE [5] case. More recent linear manifold learning approaches (these can be thought as the subspace learning [10]), such as LPP [6] and NPE [7], try to overcome the out-of-sample extension problem by performing a linear approximation of the underlying manifold. The fundamental idea behind these methods is that, using a linear map manifolds can be approximated reasonably well within a local neighborhood, even though they are nonlinear structures. The benefits of linear approximations are some savings in computational time.

The disadvantage of the nonlinear manifold learning makes the out-of-sample extension tricky, while that of linearized approaches can offer only an approximation of the underlying manifold structure. Hence, we propose a novel manifold learning approach to overcome the two issues. We decompose the manifold learning as a two-step approach: graph embedding [11] for the underlying manifold learning and the regression for the learned manifold-based projective function learning. The regression can construct the direct map obtained by using discriminatively Laplacian regularized least square to project the training data and new data. By using the regression as a process of building the projection function rather than direct linear transformation from the input space to the low-dimensional embedding, different kinds of regularizers can be naturally incorporated.

In particular, Locality Sensitive Discriminant Analysis (LSDA) [12] has been proposed recently to exploit both geometric and discriminant information simultaneously in manifold learning. LSDA [12] incorporates discriminant information based on the graph Laplacian and demonstrated better performance than some other manifold learning methods. It constructs intra-class graph and inter-class graph to model the local neighborhood relationship of the data according to their labels. By making the margin maximal among data points of different classes in each local neighborhood, it can perform the discriminative ability for classification in the reduced subspace. Intuitively, we incorporate the discriminant knowledge as the supplement into the objective functions of manifold learning in order to find the optimal low-dimensional embedding for estimating head poses accurately.

Furthermore, in the regression stage of the proposed two-step approach, we develop discriminatively Laplacian regularized least square, and this is partly inspired by discriminatively regularized least square [13]. We directly embed the discriminative information as well as the local geometry of the data based on the graph Laplacian in the regularization term such that it can explore as much underlying knowledge as possible.

Meanwhile, some head pose estimation methods are proposed based on manifold learning. Raytchev applied ISOMAP-based manifold learning technique for user-independent pose estimation [14]. Fu and Huang presented an appearance-based strategy for head pose estimation using supervised Graph Embedding (GE) analysis [15]. To incorporate the pose labels that are usually available during the training phase, Balasubramanian proposed the Biased Manifold Embedding framework (BME) [16] for head pose estimation, which uses biased distance measurement to determine k nearest neighbors such that the head pose angle information can be incorporated as the prior knowledge for estimating head pose more accurately. BME [16] uses a Generalized Regression Neural Network (GRNN) to learn the nonlinear mapping for dealing with out-of-sample data points, and applies linear multivariate regression to estimate the pose. In [17], by incorporating prior knowledge of head pose angle, BenAbdelkader proposed Supervised Manifold Learning (SML) framework for head pose estimation, and uses nonlinear mapping, cubic smooth splines and support vector regression, to estimate head pose angle from embedded face images. SML [17] performs better than other head pose estimation methods by incorporating continuous head pose angle information in the process of graph construction and graph embedding. They all demonstrated their effectiveness for head pose estimation. However, their methods fail to efficiently handle out-of-sample extension data points. In addition, they use a nonlinear mapping (e.g. GRNN and cubic smooth splines) to estimate the head poses.

Instead, we propose a novel manifold learning approach, supervised locality discriminant manifold learning (SLDML), which decomposes the manifold learning as a two-step approach: the graph embedding stage and the regression stage. Firstly, we construct an intra-class graph 
                        
                           
                              
                                 G
                              
                              
                                 w
                              
                           
                        
                      and an inter-class graph 
                        
                           
                              
                                 G
                              
                              
                                 b
                              
                           
                        
                      according to their head pose labels. In this way, the geometric structures and discriminant knowledge of the data can be accurately characterized by the two graphs. Based on the graph Laplacian, we then add the local discriminant term constructed by minimizing the margin of data points from 
                        
                           
                              
                                 G
                              
                              
                                 w
                              
                           
                        
                      and maximizing the margin of data points from 
                        
                           
                              
                                 G
                              
                              
                                 b
                              
                           
                        
                      in the optimization objective of manifold learning. Secondly, we develop discriminatively Laplacian regularized least squares which map the data to the low-dimensional reduced space for directly out-of-sample extension more effectively. Moreover, we incorporate continuous head pose angle information into all stages of the manifold learning. Meanwhile, for a new face image, we first embed it in the low-dimensional space where we determine its k nearest neighbors, and then estimate the head pose angles.

The rest of this paper is organized as follows. Section 2 describes our supervised locality discriminant manifold learning process. Experiments on public dataset are presented to show the robustness and superiority of our method over other state-of-the-art methods in Section 3. Finally, Section 4 concludes our work with a summary and introduces the future work.

@&#PROPOSED METHOD@&#

In this section, we introduce supervised locality discriminant manifold learning approach. Specifically, for a given data set of n points in D-dimensional space, we denote 
                        
                           X
                           =
                           [
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 1
                              
                           
                           )
                           ,
                           (
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 n
                              
                           
                           )
                           ]
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 D
                              
                           
                        
                     , where 
                        
                           
                              
                                 z
                              
                              
                                 i
                              
                           
                        
                      is label (i.e. head pose angle) of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                     . We wish to reduce the dimensionality of this data, and assume only that the data lies on a d-dimensional manifold embedded into 
                        
                           
                              
                                 R
                              
                              
                                 D
                              
                           
                        
                     , where 
                        
                           d
                           <
                           D
                        
                     . Moreover, we assume that the manifold is given by a single coordinate chart f. We can now describe the problem formally: given data points 
                        
                           X
                           =
                           [
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           ]
                           ∈
                           
                              
                                 R
                              
                              
                                 D
                              
                           
                        
                      that lie on a d-dimensional manifold M that can be described by a single coordinate chart 
                        
                           f
                           :
                           M
                           
                           ↦
                           
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        
                     , find 
                        
                           Y
                           =
                           [
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 n
                              
                           
                           ]
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        
                     , where 
                        
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           =
                           f
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Note that 
                        
                           y
                           =
                           [
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 n
                              
                           
                           ]
                           ∈
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        
                     . Solving this problem is referred to as manifold learning, since we are trying to “learn” a manifold from a set of points. Currently, manifold learning can be cast in terms of graph construction and graph embedding based on the specific intrinsic graph that encodes certain geometric properties of the data [11].

Graph construction is mostly predefined artificially, and k nearest neighbors criterion is a common way to construct the graph for efficiency. We adopt this because the computation efficiency is an important issue to practice. For human head pose estimation, the “true” pose neighborhood structure is always corrupted by various factors, such as identity, illumination, and facial expression, and only 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         distance measurement may generate “fake” neighbors. In [16], the biased distance based on reciprocal increasing positive function was proposed to capture the true neighborhood structures of the data in order for reducing the deviation brought from 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         norm. It is very robust to the noise, identity, illumination, and facial expression in face images. The biased distance is defined as follows:
                           
                              (1)
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∼
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 d
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 f
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                        where 
                           
                              d
                              (
                              i
                              ,
                              j
                              )
                              =
                              ∥
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                           
                         is the Euclidean distance, 
                           
                              f
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    pose
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    +
                                    ε
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          ij
                                       
                                    
                                    pose
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    -
                                    pose
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    +
                                    ε
                                 
                              
                           
                         is the reciprocal increasing positive function, and 
                           
                              pose
                              (
                              i
                              ,
                              j
                              )
                              =
                              β
                              ·
                              ∣
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              ∣
                           
                         is the head pose distance, where 
                           
                              β
                           
                         is a scalar parameters and 
                           
                              ε
                           
                         is the label noise. The choice of a reciprocal function seems appropriate because it ensures that the penalty increases at a faster rate at larger head pose angle values of 
                           
                              ∣
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              ∣
                           
                        . Using of 
                           
                              
                                 
                                    d
                                 
                                 
                                    ∼
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                           
                         to determine k nearest neighbors set 
                           
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         of point 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         is more robust. We use the Gaussian heat kernel to construct the biased neighborhood graph G, whose adjacent weight between nearby nodes is defined as:
                           
                              (2)
                              
                                 
                                    
                                       S
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ∼
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        (
                                                                        i
                                                                        ,
                                                                        j
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∨
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              σ
                           
                         is a design parameter (the Gaussian kernel width). The graph G and a matrix of edge weights S define the similarity of face images, which ensures that dissimilar head poses are kept apart and similar head poses are close to each other, by using the biased distance measurement.

Graph embedding [13] is to represent each vertex of the graph as a low-dimensional vector that preserves similarities between the vertex pairs, where similarity is measured by the edge weight. The graph G characterize certain statistical or geometrical properties of the data. The Laplacian embedding [4] is the basis of our approach. Suppose that we map the graph G to a real line (and, of course, we can map the high-dimensional data to d-dimensional embedding) and the optimization criterion of LE [4] is
                           
                              (3)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          n
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 Ly
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 Dy
                                 =
                                 1
                              
                           
                        
                     

The graph Laplacian of edge weight matrix 
                           
                              S
                           
                         is defined as 
                           
                              L
                              =
                              D
                              -
                              S
                           
                        , where 
                           
                              D
                           
                         is the diagonal matrix with elements 
                           
                              
                                 
                                    D
                                 
                                 
                                    ii
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    ij
                                 
                              
                           
                        . We avoid this trivial solution by enforcing the constraint 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              Dy
                              =
                              1
                           
                         which efficiently removes an arbitrary scaling factor in the embedding, i.e., fixing a scale. We could achieve the same result with the constraint 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              y
                              =
                              1
                           
                        , but 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              Dy
                              =
                              1
                           
                         is preferable because it leads to a closed-form eigenvalue solution. Using Lagrange multipliers, we solve this problem via the generalized eigenvalue problem 
                           
                              Ly
                              =
                              λ
                              Dy
                           
                        . We need the bottom d eigenvalues are non-zero.

By incorporating continuous head pose angle information, supervised LE from SML [17] was proposed to perform pattern classification for estimating head pose more accurately:
                           
                              (4)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       LE
                                    
                                 
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 φ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        where 
                           
                              φ
                           
                         is a scalar constant, and Eq. (4) can be derived to the form 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              (
                              L
                              +
                              φ
                              
                                 
                                    L
                                 
                                 
                                    Λ
                                 
                              
                              )
                              y
                           
                        , where 
                           
                              
                                 
                                    L
                                 
                                 
                                    Λ
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    Λ
                                 
                              
                              -
                              Λ
                              ,
                              
                                 
                                    D
                                 
                                 
                                    Λ
                                    ,
                                    ii
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                                 
                                    L
                                 
                                 
                                    ∼
                                 
                              
                              =
                              L
                              +
                              φ
                              
                                 
                                    L
                                 
                                 
                                    Λ
                                 
                              
                           
                        , and 
                           
                              Λ
                           
                         is a 
                           
                              n
                              ×
                              n
                           
                         matrix defined by
                           
                              (5)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            -
                                                            
                                                               
                                                                  ∣
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        ∣
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∨
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Clearly, 
                           
                              Λ
                           
                         represents some measurement of similarity between the z values of neighboring points (i.e. neighboring face images). The supervision term, 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ∥
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    ij
                                 
                              
                           
                        , simultaneously preserves the local geometric structure and keeps neighboring points with the more similar head pose closer. Intuitively, we design the optimal supervised weight, 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    ij
                                 
                              
                              +
                              φ
                              
                                 
                                    Λ
                                 
                                 
                                    ij
                                 
                              
                           
                        , which incorporates the prior knowledge of head pose and can more effectively measure the similarity of face images with varying head pose.

The objective function of supervised LLE from SML [17] is
                           
                              (6)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       LLE
                                    
                                 
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 φ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    W
                                 
                                 
                                    ij
                                 
                              
                           
                         is the linear reconstruction weight in LLE [6]. We can infer Eq. (6) to the form 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              My
                              +
                              φ
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    Λ
                                 
                              
                              y
                           
                        , where 
                           
                              M
                              =
                              
                                 
                                    (
                                    I
                                    -
                                    W
                                    )
                                 
                                 
                                    T
                                 
                              
                              (
                              I
                              -
                              W
                              )
                           
                        .

However, the optimization criterion of LE [4] only incorporates the condition to preserve local distances. It turns out that the solution to this optimization criterion has a remarkable property of smoothing the manifold structure. More precisely, LE [4] provides a non-linear mapping that smooths out high-curvature regions of the manifold and transforms the manifold into a smoother object. Smoothing out these regions provide a good generalization ability on manifolds, and manifold regularization [18] shows that the low-dimensional embedding simplifies the structures of the manifold. Consider a typical pattern classification task of discriminating two classes on a manifold. Due to the inherent curvy manifold structure, it is difficult to find a simple classifier that can separate the two classes. However, by mapping the data to the low-dimensional space via LE [4], one can find a simple classifier that can separate the classes well. Fig. 1
                         shows the example of smoothing the manifold structures.

Hence, based on some advantages of LE [4] and inspired by the Locality Sensitive Discriminant Analysis (LSDA) [12], we add a local discriminant term in the objective functions for estimating head pose accurately. Firstly, we construct two graphs: the intra-class graph 
                           
                              
                                 
                                    G
                                 
                                 
                                    w
                                 
                              
                           
                         and the inter-class graph 
                           
                              
                                 
                                    G
                                 
                                 
                                    b
                                 
                              
                           
                        . If define 
                           
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              ⩽
                              j
                              ⩽
                              k
                              }
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    b
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              
                              ≠
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              ⩽
                              j
                              ⩽
                              k
                              }
                           
                         based on the biased k-nearest neighbors criterion, 
                           
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ∩
                              
                                 
                                    N
                                 
                                 
                                    b
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              ø
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ∪
                              
                                 
                                    N
                                 
                                 
                                    b
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . Let 
                           
                              
                                 
                                    W
                                 
                                 
                                    w
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    b
                                 
                              
                           
                         be the adjacent weight matrices of 
                           
                              
                                 
                                    G
                                 
                                 
                                    w
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    b
                                 
                              
                           
                        , respectively, and then we have the following definitions:
                           
                              (7)
                              
                                 
                                    
                                       W
                                    
                                    
                                       w
                                       ,
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∨
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       W
                                    
                                    
                                       b
                                       ,
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∨
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We introduce the local discriminant term constructed by minimizing the Laplacian embedding of 
                           
                              
                                 
                                    G
                                 
                                 
                                    w
                                 
                              
                           
                         and at the same time maximizing the Laplacian embedding of 
                           
                              
                                 
                                    G
                                 
                                 
                                    b
                                 
                              
                           
                        , it can be regarded as an additional term in the objective functions of manifold learning. The discriminant optimization objectives is defined as:
                           
                              (9)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       w
                                       ,
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       w
                                    
                                 
                                 -
                                 
                                    
                                       W
                                    
                                    
                                       w
                                    
                                 
                                 )
                                 y
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                                 y
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       b
                                       ,
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       b
                                    
                                 
                                 -
                                 
                                    
                                       W
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 y
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                                 y
                              
                           
                        
                     

Imposing a constraint 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    b
                                 
                              
                              y
                              =
                              1
                           
                        , Eq. (10) can be rewritten as:
                           
                              (11)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                b
                                             
                                          
                                          y
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       b
                                    
                                 
                                 y
                              
                           
                        
                     

Now, for LLE [5], we define the optimization objective with the local discriminant term and the supervision term based on the optimal supervised weight 
                           
                              
                                 
                                    W
                                 
                                 
                                    ∼
                                 
                              
                           
                        :
                           
                              (12)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          η
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          ∥
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                w
                                                ,
                                                ij
                                             
                                          
                                          -
                                          (
                                          1
                                          -
                                          η
                                          )
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          ∥
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                b
                                                ,
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        
                     

But here we enforce the constraint 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    b
                                 
                              
                              y
                              =
                              1
                           
                         to avoid the trivial solution. Note that the terms, 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ∥
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                           
                        , are constructed based on the intra-class graph 
                           
                              
                                 
                                    G
                                 
                                 
                                    w
                                 
                              
                           
                        , and 
                           
                              η
                           
                         is a suitable constant, 
                           
                              0
                              ⩽
                              η
                              ⩽
                              1
                           
                        . Eq. (12) can be rewritten as:
                           
                              (13)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                b
                                             
                                          
                                          y
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 My
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 η
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 (
                                 1
                                 -
                                 η
                                 )
                                 
                                    
                                       W
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 y
                                 +
                                 α
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       ∼
                                    
                                 
                                 y
                              
                           
                        
                     

The optimal embedding is then given by using eigenvectors associated with the smallest eigenvalues of the matrix 
                           
                              (
                              M
                              +
                              η
                              
                                 
                                    L
                                 
                                 
                                    w
                                 
                              
                              +
                              (
                              1
                              -
                              η
                              )
                              
                                 
                                    W
                                 
                                 
                                    b
                                 
                              
                              +
                              α
                              
                                 
                                    L
                                 
                                 
                                    ∼
                                 
                              
                              )
                           
                        . The local discriminant term, 
                           
                              
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              (
                              η
                              
                                 
                                    L
                                 
                                 
                                    w
                                 
                              
                              +
                              (
                              1
                              -
                              η
                              )
                              
                                 
                                    W
                                 
                                 
                                    b
                                 
                              
                              )
                              y
                           
                        , can efficiently explore both the discriminant knowledge and geometric structure of the data manifold. The solutions of Eq. (13) provides a smoother and a discriminative embedding of the manifold, especially, the points of the different class can be separated and those of the same class can be clustered effectively.

The discriminant graph embedding yields a map which is defined only on the training points. For head pose estimation, we need to have an explicit mapping function (i.e. projection function) which is defined everywhere. Consider a linear map, it handles out-of-sample extension data points by 
                           
                              y
                              =
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    T
                                 
                              
                              x
                           
                         or 
                           
                              y
                              =
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              x
                           
                         to get an explicit mapping 
                           
                              a
                           
                         or 
                           
                              A
                           
                        , which is always used for the linear manifold learning, such as LPP [6] and NPE [7]. However, in fact, such 
                           
                              a
                           
                         or 
                           
                              A
                           
                         may not exist. The possible way is to find 
                           
                              a
                           
                         which can best fit the equation in the least square sense along with imposing Tikhonov regularizer [19]:
                           
                              (14)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          a
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 γ
                                 ∥
                                 a
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

However, such y is the 1-dimensional embedding of the manifold, instead of the class label. So naturally, such map 
                           
                              f
                              :
                              
                                 
                                    R
                                 
                                 
                                    D
                                 
                              
                              
                              ↦
                              
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , i.e., 
                           
                              f
                              :
                              M
                              
                              ↦
                              
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , defined on the manifold M, should fully utilize the geometric information of the manifold M to handle out-of-sample extension well. For the linear manifold learning, the map f obtained by linear transformation, 
                           
                              y
                              =
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    T
                                 
                              
                              x
                           
                        , is just only a linear subspace approximation of the manifold M. This is a very efficient way for large-scale learning and we highlight the process of getting the map f. We use the sense of Manifold Regularization (MR) [18] to handle out-of-sample extension. MR [18] exploits the geometry of the probability distribution and incorporates it as a regularization term, and there are three distinct concepts are brought together in the MR framework: regularization in reproducing Kernel Hilbert spaces, the technology of spectral graph theory and the geometric viewpoint of manifold learning algorithms:
                           
                              (15)
                              
                                 
                                    
                                       f
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          f
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          l
                                       
                                    
                                 
                                 V
                                 (
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       A
                                    
                                 
                                 ∥
                                 f
                                 
                                    
                                       ∥
                                    
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       I
                                    
                                 
                                 ∥
                                 f
                                 
                                    
                                       ∥
                                    
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where V is the loss function and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    A
                                 
                              
                           
                         is the weight of the norm of the function in the RHKS (or ambient norm) which enforces a smoothness condition on the possible solutions. 
                           
                              ∥
                              f
                              
                                 
                                    ∥
                                 
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                           
                         controls the complexity of the solution in the ambient space, i.e., the regularization term controls the complexity of the classifier. 
                           
                              
                                 
                                    γ
                                 
                                 
                                    I
                                 
                              
                           
                         is the weight of the norm of the function in the low dimensional manifold (or intrinsic norm) which enforces the smoothness along the manifold M. 
                           
                              ∥
                              f
                              
                                 
                                    ∥
                                 
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         controls the complexity of the solution in the intrinsic geometry of M, i.e., the regularization term controls the complexity measured by the manifold geometry of the data distribution. Specifically, the Laplacian regularized least squares is used to characterize the model of MR [18]. By using a new supervised weight, we utilize it in supervised learning to learn the map f:
                           
                              (16)
                              
                                 
                                    
                                       f
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          f
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       A
                                    
                                 
                                 ∥
                                 f
                                 
                                    
                                       ∥
                                    
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          n
                                       
                                    
                                 
                                 ∥
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        
                     

Basically, Laplacian embedding of the graph models the data that has the properties of local consistency, that is, the properties of the data points are consistent in a local neighborhood and neighboring data points have similar properties (e.g. labels). The LE [4] can smooth the complex structures of the manifold. However, the map f does not have a discriminative ability for out-of-sample extension. It does not utilize the underlying discriminative knowledge of the data. Recently, discriminatively regularized least square [13] was proposed by embedding the underlying discriminative information in the regularization term. The regularizer performs better for classification:
                           
                              (17)
                              
                                 
                                    
                                       f
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          f
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       disreg
                                    
                                 
                                 (
                                 f
                                 ,
                                 η
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    R
                                 
                                 
                                    disreg
                                 
                              
                              (
                              f
                              ,
                              η
                              )
                           
                         is the discriminative regularization term, 
                           
                              
                                 
                                    R
                                 
                                 
                                    disreg
                                 
                              
                              (
                              f
                              ,
                              η
                              )
                              =
                              η
                              A
                              (
                              f
                              )
                              -
                              (
                              1
                              -
                              η
                              )
                              B
                              (
                              f
                              )
                           
                        , which measures the intra-class compactness and inter-class separability of the outputs. So the 
                           
                              
                                 
                                    R
                                 
                                 
                                    disreg
                                 
                              
                              (
                              f
                              ,
                              η
                              )
                           
                         is utilized to construct discriminative regression or classification models for handling out-of-sample extension data points:
                           
                              (18)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          f
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          η
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          ∥
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                w
                                                ,
                                                ij
                                             
                                          
                                          -
                                          (
                                          1
                                          -
                                          η
                                          )
                                          ∥
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                b
                                                ,
                                                ij
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The map f defined on a manifold M can be approximated by the discrete counterparts on the corresponding graph constructed from the data. Moreover, we develop discriminatively Laplacian regularized least squares which adds an additional Laplacian embedding term based on the optimal supervised weight, 
                           
                              
                                 
                                    W
                                 
                                 
                                    ∼
                                 
                              
                           
                        , and continuous head pose angle information. The map f obtained by using the discriminatively Laplacian regularized least squares has the generative ability of effectively learning with local consistency and then directly performing out-of-sample extension. We set 
                           
                              y
                              =
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    T
                                 
                              
                              x
                           
                        , which can efficiently embed the data in the low-dimensional space with the benefit of the linear manifold learning. It is described as follows:
                           
                              (19)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          f
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 γ
                                 ∥
                                 f
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          η
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          ∥
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                w
                                                ,
                                                ij
                                             
                                          
                                          -
                                          (
                                          1
                                          -
                                          η
                                          )
                                          ∥
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          f
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                b
                                                ,
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 ∥
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        
                     

The solution of Eq. (19) is 
                           
                              a
                              =
                              
                                 
                                    (
                                    
                                       
                                          XX
                                       
                                       
                                          T
                                       
                                    
                                    +
                                    X
                                    (
                                    η
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    -
                                    (
                                    1
                                    -
                                    η
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          b
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          L
                                       
                                       
                                          ∼
                                       
                                    
                                    )
                                    
                                       
                                          X
                                       
                                       
                                          T
                                       
                                    
                                    +
                                    γ
                                    I
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              Xy
                           
                        , where 
                           
                              y
                           
                         consists of 1D embedding of n training samples. As long as we get the mapping vector 
                           
                              a
                           
                        , we could obtain the 1D embedding of training and testing samples. If we map the high-dimensional data to d-dimensional embedding, we need to get the mapping matrix 
                           
                              A
                           
                         which consists of the solution vector 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           
                        , …, 
                           
                              
                                 
                                    a
                                 
                                 
                                    d
                                 
                              
                           
                        , where d is the dimensionality of embedding.

With the discriminant graph embedding and projection function f, the low-dimensional embedding of the data is more appropriate for classification, regression and clustering tasks. Hence, the kNN classifier can work well. To estimate pose of a new face image, we first embed the new image in the low-dimensional space where we find its k nearest neighbors. Then, the pose angle of new face image is estimated by averaging the head poses of its k nearest neighbors in the low-dimensional space.

In this section, we investigate the use of our proposed SLDML approach for head pose estimation, and we compare SLDML with the current state-of-art methods, Biased Manifold Embedding (BME) [16], and Supervised Manifold Learning (SML) [16].

To demonstrate the efficiency of our approach, comprehensive experiments are conducted on FacePix data set which is a famous publicly available database. The FacePix data set is provided by CUbiC (the Center for Cognitive Ubiquitous Computing) and consists of three sets of face images: one set with pose angle variations, and two sets with illumination angle variations. Each of these sets is composed of a set of 181 face images (representing angles from −90° to +90° in yaw at 1° interval increment). Our experiments use 15 subjects with pose orientations varying from −90° to +90° with the interval increments of [2°, 3°, 4°, 5°, 6°] in this work. Yet we remove the samples of 0° pose in yaw for each subject, and now each subject just includes 180 images, and then the number of our used samples is [90 60 45 36 30] for each subject, respectively. The resolution of image is 128×128 pixels. Part of samples of the FacePix data set are shown in Fig. 2
                     .

In the test stage, the Mean Absolute Error (MAE) is used to evaluate the performance of our algorithms by averaging the absolute difference between the estimated pose angle and the ground truth (i.e. the true pose angle) of test face images. We estimate the pose angles of test images by using the average of the pose angles of k-nearest training samples in the low-dimensional space, and the kNN estimator is set to 
                        
                           k
                           =
                           1
                        
                      and 
                        
                           k
                           =
                           4
                        
                     . We use leave-one-out validation in the validation model (whereby images of 14 subjects are used for training and the images of the remaining 1 subject are used for testing). Each face images are down-scaled to 32×32, and we do not preprocess the face images, i.e., the comparisons of our approach against other methods are all operated in the gray scale pixel feature space.

In order to validate the superiority and effectiveness of the discriminant manifold embedding and discriminatively Laplacian regularized least squares, we visualize the 2-dimensional and 3-dimensional manifold structures by comparing with LE [4], LSDA [12] and some other manifold learning approaches which are incorporated different additional regression terms as the second stage. They are listed in Table 1
                     . Note that SML (with LLE) [16] is the composition of Eq. (6) plus GRNN (Generalized Regression Neural Network), and BME (with LLE) [16] is the composition of LLE [5]) (with biased distance measurement) plus GRNN (Generalized Regression Neural Network).

To check whether the SLDML can preserve the local geometric structure of the data or not, we evaluate the manifold embedding performance of discriminant Laplacian LLE (DisLapLLE) against with LE [4] and LSDA [12]. We also show the manifold by comparing proposed SLDML with LE [4] and LSDA [12] plus Tikhonov regularized least squares (RLS) [19]. The manifold visualization data include 15 subjects with pose variation between [−90°, +90°] at 4° interval increments.


                        Fig. 3
                         shows 2-dimensional and 3-dimensional results of the nonlinear manifold embedding. These approaches can discover an apparent trend of head pose angles and yield an obvious 1D manifold. The manifold generated by proposed DisLapLLE is more discriminability and smoothness. Fig. 4
                         presents the manifold embedding of the two-step manifold learning. Obviously, SLDML can generate smooth and compact manifold, because the map f learned with the local consistency by DisLapRLS can map the data more effective in the low-dimensional space, while the manifolds generated by other methods are more sparse and scattered.

To validate the robustness of the proposed approach under different pose angle sampling interval, we use 15 subjects varying from −90° to +90° (removed the 0° samples) in yaw and sample the data with different angle increments [2°, 3°, 4°, 5°, 6°]. The quantitative estimation results are presented in Table 2
                        . With increasing sampling pose angle interval, our method is more stable and does not have an apparent performance decrease. As the sampling interval grows, the disparities of samples with different head poses become large. Obviously, our approach is very robust to the growing sampling interval and outperforms other state-of-art methods for head pose estimation.


                        Tables 3 and 4
                        
                         show the MAE results by comparing our proposed discriminatively Laplacian regularized least squares (DisLapRLS) with discriminatively regularized least squares (DisRLS) [13], Laplacian regularized least squares (LapRLS) [18] and Tikhonov regularized least squares (RLS) [19]. Fig. 5
                         presents the MAE comparisons of different mapping f incorporated into the second stage of manifold learning under different embedded dimensions. It indicates that our proposed method provides better discriminability in the embedding space for head pose estimation.

We compare our approach with other head pose estimation methods: Biased Manifold Embedding framework (BME) [16] and Supervised Manifold Learning framework (SML) [17] in different low-dimensional dimensionalities and head pose sampling strategies.


                        Fig. 6
                         is a line chart which shows that the SLDML has the stability of head pose estimation in different dimensionality of embedding. It is concluded that our approach significantly improves the head pose estimation performance compared to the Biased Manifold Embedding framework (BME) [16] and the Supervised Manifold Learning framework (SML) [17], and the MAE of pose estimation is more superior and stable.


                        Fig. 7
                         shows the comprehensive estimation results and can demonstrate the robustness of our approach for head pose estimation under different embedded dimensions and head pose sampling intervals. In general, the estimation result of 2-degree interval is very stable, and the larger the degree of the sampling interval is, the better the MAE of head pose estimation is, this is because that this interval is more appropriate to construct the discriminant models and the pose biased graph (e.g. intra-class 
                           
                              
                                 
                                    G
                                 
                                 
                                    w
                                 
                              
                           
                         and inter-class 
                           
                              
                                 
                                    G
                                 
                                 
                                    b
                                 
                              
                           
                        ) without over-fitting and under-fitting of the head pose data. Fig. 8
                         presents the distribution of the average error in each of the head pose views at 2° interval (and with 50-dimensional embedding). For the most part in Fig. 8, our approach performs well in the frontal and intermediate poses, but not for the views between [−90°, −30°]. This may be caused by the noise in these face images with [−90°, −30°] views.

In this paper, we propose a novel supervised locality discriminant manifold learning (SLDML) approach for the head pose estimation. The main contribution of our work is that we decompose the manifold learning as a two-step approach which incorporates both the nonlinear manifold learning in the graph embedding (the first step) and projection function learning in the regression stages (the second step). Moreover, we construct the local discriminant term in the optimization objectives to find the discriminant low-dimensional embedding. The manifold visualization shows that the result has intra-class compactness and inter-class separability. Similarly, we add the same local discriminant term in the least squares, which is called discriminatively Laplacian regularized least square, to handle the out-of-sample extension more efficiently. The insight of learning with the local consistency is achieved partly by adding the same additional terms in the proposed two-step SLDML. Furthermore, based on the biased distance and incorporated continuous head pose angle information, we design the optimal supervised weight to determine the contribution of each neighboring pair, and especially define a new or additional manifold structure preservation properties in the discriminant graph embedding and the regression for estimating head poses more accurately. Experimental results on the FacePix dataset show that our proposed approach outperforms the other related work significantly. In the future work, we will explore new manifold embedding and regression scenarios for head pose estimation.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the National Natural Science Foundation of China (Grant No. 61001143), by the Key Project Funds from the Province Office of Sci. & Tech. of Fujian in China (Grant No. 2012H6024) and by the Natural Science Foundation of Fujian Province (Grant No. 2012J01286).

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.knosys.2014.04.028.


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  


                     
                        
                           Supplementary data
                           
                        
                     
                  

@&#REFERENCES@&#

