@&#MAIN-TITLE@&#Upper and lower bounds for the sales force deployment problem with explicit contiguity constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New mathematical formulation for the sales force deployment problem.


                        
                        
                           
                           Semi-infinite programm considering an accurate selling time allocation.


                        
                        
                           
                           Exact and explicit contiguity constraints for sales territory alignment.


                        
                        
                           
                           Branch-and-Price algorithm, column generation.


                        
                        
                           
                           Efficient formulation in order to provide an excellent initial lower bound.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Large scale optimization

Sales force deployment

Semi-infinite programming

Column generation

Branch-and-Price

Contiguity

@&#ABSTRACT@&#


               
               
                  The sales force deployment problem arises in many selling organizations. This complex planning problem involves the concurrent resolution of four interrelated subproblems: sizing of the sales force, sales representatives locations, sales territory alignment, and sales resource allocation. The objective is to maximize the total profit. For this, a well-known and accepted concave sales response function is used. Unfortunately, literature is lacking approaches that provide valid upper bounds. Therefore, we propose a model formulation with an infinite number of binary variables. The linear relaxation is solved by column generation where the variables with maximum reduced costs are obtained analytically. For the optimal objective function value of the linear relaxation an upper bound is provided. To obtain a very tight gap for the objective function value of the optimal integer solution we introduce a Branch-and-Price approach. Moreover, we propose explicit contiguity constraints based on flow variables. In a series of computational studies we consider instances which may occur in the pharmaceutical industry. The largest instance comprises 50 potential locations and more than 500 sales coverage units. We are able to solve this instance in 1273seconds with a gap of less than 0.01%. A comparison with Drexl and Haase (1999) shows that we are able to halve the solution gap due to tight upper bounds provided by the column generation procedure.
               
            

@&#INTRODUCTION@&#

In many selling organizations, sales force deployment is an important tool by which sales management improves profit remarkably (Cravens & LaForge, 1983; Lodish, Curtis, Ness, & Simpson, 1988; Capron & Hulland, 1999 & Zoltners & Lorimer, 2000). It involves the concurrent resolution of four interrelated subproblems:
                        
                           •
                           sizing of the sales force,

locations of the sales representatives,

sales territory alignment, and

sales resource allocation.

All these subproblems have to be solved simultaneously so that the total profit contribution will be maximized (Drexl & Haase, 1999). The subproblems can be briefly described as follows: Consider a large geographical market area that is partitioned into a set of so-called sales coverage units (SCUs). Sizing of the sales force implies selecting the appropriate number of sales representatives required to penetrate the market area. A sales territory and a location are unequivocally assigned to each sales representative. Thus, by sales force sizing we also decide on the number of sales territories and locations. The salesperson location aspect of the problem involves determining a SCU for a sales representative to be located in. Sales territory alignment may be viewed as the partitioning problem of grouping the SCUs around the locations of the sales representatives into larger geographic areas called “sales territories”. Sales resource allocation refers to the problem of allocating a sales representative’s time to the assigned SCUs. Note, sales force deployment is an aggregate planning problem. The usual planning horizon is one year. So, decisions as how often (e.g., every week, once a month), which days and at what time a customer is to be visited (and the sequence of customers) are the subject of subsequent planning stages (Golalikhani & Karwan, 2013).

Comprehensive reviews of related contributions are given by Drexl and Haase (1999) and Howick and Pidd (1990). Although there is a long tradition of sales force deployment modeling (particularly sales territory alignment) as shown by Lodish (1975), Zoltners (1976), Rangaswamy, Sinah, and Zoltners (1990) and Albers (1996) for example, we see that this field of research is still very popular (Segura-Ramiro, Ríos-Mercado, Álvarez Socarrás, & de Alba Romenus, 2007; Mantrala et al., 2010 & Lee & Yang, 2013) – especially if we consider the practical implementation of approaches (Zolterns & Sinah, 2005). To our novel approach the following work is of particular interest and is therefore discussed in more detail. Skiera and Albers (1998) formulate a model that addresses both the sales territory alignment and the sales resource allocation problems. They propose sales response functions of any given concave form at the level of SCUs. Sales are modeled as a function of selling time, that includes calling time as well as travel time, assuming a constant ratio of travel time to calling time. They consider a resource allocation model and a territory alignment model simultaneously. For the solution a so-called backward deletion procedure is considered. If desired, contiguous sales territories can be constructed by the heuristic. However, explicit contiguity constraints – that is, the constraints used in the model guarantee contiguous sales territories – are not considered. In Drexl and Haase (1999) all four subproblems are covered in order to maximize profit. For the solution of the model they present approximation methods capable of solving large-scale, real-world instances. The methods that provide lower bounds for the optimal objective function value are compared to upper bounds. On average the solution gap, i.e., the difference between upper and lower bounds with respect to the upper bound, is about 3%. Furthermore, they show how the methods can be used to analyze various problem settings of practical relevance.

We present a novel approach to compute tight upper and lower bounds for the sales force deployment problem based on an innovative mathematical program that explicitly accounts for contiguous sales territories. Although contiguous sales territories are compulsory in applications, explicit contiguity constraints are rare so far. Zoltners and Sinah (1983) propose a mixed integer formulation to account for contiguous sales territories. However, this approach is not explicit in terms of contiguity and as a consequence contiguity is not guaranteed (Shirabe, 2005). The contiguity constraints in Drexl and Haase (1999) grow exponentially with the number of spatial units (King, Jacobson, Sewell, & Cho, 2012). In contrast, our approach explicitly accounts for contiguity due to a set of contiguity constraints based on continuous flow variables. By this, we are able to significantly reduce the number of constraints. Further, our model is characterized by an infinite number of binary variables where each variable is related to a point of selling time in a time interval (selling time variables). For its solution we propose a Branch-and-Price approach, i.e., at each node of a Branch-and-Bound tree we solve a master problem by column generation. The corresponding restricted master problem consists of the linear relaxation of an integer formulation with a reduced number of variables. Analytical solutions are introduced for the subproblem. We derive an upper bound for the optimal objective function value of the linear relaxation using dual information. Branching is done on two categories of binary variables. At first, we branch on the variables indicating where locations for sales representatives should be setup. Afterward, we consider assignment variables indicating to which location a sales coverage unit should be assigned. Moreover, we present an intelligible approach to determine an initial lower bound.

Managers might use mathematical sales force deployment approaches to generate good initial solutions and then “fine-tune” the solution by individual expertise (Zolterns & Sinah, 2005). Usually, “what-if” scenarios are employed to improve overall sales performance. Therefore, fast and valid solutions of the mathematical model are needed in order to perform such a “management-heuristic” efficiently (Pinals, 2001). Our computational studies show that especially for large practical instances the new approach provides an outstanding solution quality in reasonable time.

The organization of this paper is as follows: Section 2 describes the problem setting. In particular, we define important terms and explain assumptions that are implicitly involved in these definitions. Section 3 introduces a new mathematical model for sales force deployment. Section 4 provides a Branch-and-Price approach to this formulation to derive tight lower and upper bounds. Section 5 covers the results of computational studies. To stress the practical relevance, we consider a large application-oriented example within the health care and pharmaceutical industry in Germany. The summary and conclusions are provided in Section 6.

Subsequently, we explain and discuss terms that are important for understanding the addressed problem. Additionally, we provide a problem statement.
                        
                           •
                           
                              Account: A customer (company, self-employed persons, etc.) who is expected to buy products of the company that employs the sales representative.


                              Sales Coverage Unit (SCU): A sales coverage unit is considered here to be a relatively small geographical area. The choice and thus the size of the SCUs depend upon the specific application and on whether the required data can be obtained (at a reasonable cost). Counties, zip codes, and company trading areas are some examples of SCUs (see for instance Zoltners & Sinah (1983) and Churchill, Ford, & Walker (1993)). A SCU might contain several accounts.


                              Sales territory: A sales territory is a geographic area that consists of a set of SCUs with a responsible sales representative. To be responsible means that the sales representative has to provide service for all (potential) accounts located in the corresponding sales territory (Darmon, 2002). For example, a sales representative who is working for a company that provides materials concerning dental surgery will be responsible for all dentists practicing in her sales territory. She is only allowed to sell products in SCUs that belong to her sales territory. Contiguity – that is, the SCUs of a sales territory are connected (Church & Murray, 2009) – is usually demanded by the management of a company for some organizational reasons.


                              Travel time, calling time, selling time: In order to sell a product a sales representative has to do some time consuming activities. The time required to travel from a location to an account, from an account to another account, and back to the location is called travel time. Although travel time might be considered as routing time, we neglect this fact here and assume travel time is only affected by the distance between SCU and the location of the sales representative. This is reasonable, because sales force deployment is a strategic management issue while routing is more related to operational management. Presenting a product and performing contract negotiations are examples of calling activities. The associated time is denoted as calling time. Now, selling time is defined as the sum of calling time and travel time. We have no specific information about the number of calls to individual accounts because our sales response functions are based on the SCU level.
                                 1
                                 It is easy to consider sales response function on the account level by generating a (artificial) SCU for each account.
                              
                              
                                 1
                               Thus, we assume that the sales response function represents sales with selling time optimally allocated across accounts. For each sales representative the total selling time is restricted. We assume that the calling time is a constant fraction of the selling time. At a first glance, this appears to be a more or less rough average consideration. However, Skiera and Albers (1998) show that this assumption holds if mild conditions are given. For further details see Skiera and Albers (2008).


                              Sales: The (expected) sales in a specific SCU depend on the calling time a sales representative allocates to the SCU. Now, as the calling time is a constant fraction of the selling time and a restriction is defined on the selling time, we are going to consider the relationship between sales and selling time instead of sales and calling time. The relation between selling time and sales can be described by a sales response function (Skiera & Albers, 1998). In applications such a function should be specified by an econometric analysis. Examples are provided in Haase, Lange, and Missong (1999).


                              Fixed location costs, travel costs: Fixed costs incur for each potential location. These costs arise due to the fixed salary of a sales representative, the rent of an office, car insurance, and so on. Some of these fixed costs may depend on the SCU of the realized location. This may be due to different rents or site costs across SCUs. We assume that travel costs are proportional to travel time.


                              Profit contribution, objective: Each unit of sales provides a certain amount of profit contribution. The profit contribution obtained by one sales representative is the sum of the profit contributions resulting from the realized sales across the SCUs of the respective sales territory minus the incurred costs. Generally, we consider travel costs and fixed location costs. The sum of profit contributions obtained by the sales force has to be maximized. It may be noteworthy to mention that, as in applications the realized sales are stochastic so the expected profit contribution will be maximized. Typically, in order to describe the relation between selling time and sales, a concave sales response function is considered (Hruschka, 2006). Due to the concave sales response function, more selling time is necessary for the last sold product unit than for the first one. Now, more selling time indicates more travel time and thus more travel costs. So the travel costs incurred for the last sold product are larger than that incurred for the first one. Thus, in general the average profit contribution per sales unit in which travel costs are taken into account decreases as the number of sold products increases. Therefore, to accurately maximize the profit contribution obtained by a sales representative a (travel) cost function has to be taken explicitly into account. Note, in the applications of Drexl and Haase (1999) and Skiera and Albers (1998) travel costs are not significant.


                              Problem statement: Determine the appropriate sales force size and respective sales representative locations, construct a contiguous sales territory for each sales representative, and allocate the total available selling time of each sales representative over her sales territory so that the sum of profit contributions obtained by the sales representatives is maximized.

First, we formalize the profit contribution function in order to calculate the objective function coefficients (Skiera & Albers, 2008). Then we present a new and innovative mathematical model for the sales force deployment problem.

Let be
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                          
                                       
                                       per unit profit contribution of sales, and
                                    
                                    
                                       
                                          
                                             
                                                t
                                                ∈
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                          
                                       
                                       selling time the sales representative located in SCU i allocates to SCU j. With 
                                             
                                                T
                                             
                                           as the total available selling time of a sales representative per period.
                                    
                                 
                              
                           
                        
                     

Then the profit contribution obtained by the sales representative is derived from the profit contribution function
                           
                              (1)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 α
                                 ·
                                 
                                    
                                       s
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 -
                                 
                                    
                                       k
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                              
                           
                        where
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       is the sales response function and
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       is the selling costs function
                                    
                                 
                              
                           
                        of the sales representative, respectively. In the literature solely concave sales response functions are considered (see Skiera & Albers, 1998 & Mesak & Ellis, 2009).


                        Exemplary function type. To formulate an exemplary profit contribution function we introduce some more symbols:
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          b
                                       
                                       calling time elasticity (
                                             
                                                0
                                                <
                                                b
                                                <
                                                1
                                             
                                          )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       indicator for the “calling time profitability” of SCU j (e.g. number of (potential) accounts in SCU j)
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       travel time fraction of the selling time allocated to SCU j by the sales representative located in SCU i (
                                             
                                                0
                                                <
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                <
                                                1
                                             
                                          )
                                    
                                    
                                       
                                          
                                             
                                                μ
                                             
                                          
                                       
                                       scaling parameter (
                                             
                                                μ
                                                >
                                                0
                                             
                                          )
                                    
                                    
                                       
                                          h
                                       
                                       cost per travel time unit (
                                             
                                                h
                                                ⩾
                                                0
                                             
                                          )
                                    
                                 
                              
                           
                        
                     

Now, by
                           
                              (2)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 μ
                                 ·
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       (
                                       (
                                       1
                                       -
                                       
                                          
                                             β
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       t
                                       )
                                    
                                    
                                       b
                                    
                                 
                              
                           
                        we define a sales response function and by
                           
                              (3)
                              
                                 
                                    
                                       k
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 h
                                 ·
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 t
                              
                           
                        a cost function and then we derive the profit contribution function
                           
                              (4)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 
                                    
                                       t
                                    
                                    
                                       b
                                    
                                 
                                 -
                                 
                                    
                                       o
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 t
                              
                           
                        where 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              =
                              α
                              ·
                              μ
                              ·
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    (
                                    1
                                    -
                                    
                                       
                                          β
                                       
                                       
                                          ij
                                       
                                    
                                    )
                                 
                                 
                                    b
                                 
                              
                           
                         and 
                           
                              
                                 
                                    o
                                 
                                 
                                    ij
                                 
                              
                              =
                              h
                              ·
                              
                                 
                                    β
                                 
                                 
                                    ij
                                 
                              
                           
                        .

As stated before and to be shown explicitly in the two empirical examples below the profit contribution function is assumed to be concave and selling costs are neglected (see Fig. 1
                        ). It should be noted here, that the solution approach of Section 4 is also suited for considering a calling time elasticity, say 
                           
                              
                                 
                                    b
                                 
                                 
                                    ij
                                 
                              
                           
                        , depending both on a sales representative i and the SCU j. This might be indicated, for example, if we observe a heterogeneous spatial distribution of the customer demand as reported in Müller, Wilhelm, and Haase (2013).
                           Example 1
                           
                              Sales Territory Alignment. In Skiera and Albers (1998) the results of an application to a mid-sized German company are presented. The company had hired 10 sales representatives and adopted the 95 two-digit postal areas of Germany as SCUs. They consider the following sales response function corresponding to (2):
                                 
                                    (5)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       1350
                                       
                                          
                                             POT
                                          
                                          
                                             j
                                          
                                          
                                             0.625
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             -
                                             0.375
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0.375
                                          
                                       
                                    
                                 
                              where
                                 
                                    
                                       
                                       
                                       
                                          
                                             POT
                                                   j
                                                
                                             
                                             is the number of potential accounts in SCU j and
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                             is the ratio of travel time to calling time regarding sales representative i in SCU j.
                                          
                                       
                                    
                                 
                              
                           

Now, defining
                                 
                                    (6)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       1350
                                       
                                          
                                             POT
                                          
                                          
                                             j
                                          
                                          
                                             0.625
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             -
                                             0.375
                                          
                                       
                                    
                                 
                              we derive
                                 
                                    (7)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                       ·
                                       
                                          
                                             t
                                          
                                          
                                             0.375
                                          
                                       
                                    
                                 
                              The total available selling time is 
                                 
                                    T
                                    =
                                    1350
                                 
                               time units for each sales representative. Fixed costs have not to be taken into account as the sales representatives are already located. Moreover, as no crucial travel costs are considered, 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    0
                                 
                              .


                              Sales Force Deployment. The following sales response function is considered by Drexl and Haase (1999):
                                 
                                    (8)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       0.205
                                       
                                          
                                             H
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             (
                                             4.6
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             -
                                             0.285
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0.285
                                          
                                       
                                    
                                 
                              where
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             is the number of residents of SCU j and
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                             is the time to drive from SCU i to SCU j.
                                          
                                       
                                    
                                 
                              
                           

Setting 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    0.205
                                    
                                       
                                          H
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          (
                                          4.6
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          0.285
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          o
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    0
                                 
                              , again, we obtain the profit function as defined in (4).

We define additionally the sets and parameters
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          J
                                       
                                       set of SCUs, indexed by j and v,
                                    
                                    
                                       
                                          I
                                       
                                       set of SCUs (
                                             
                                                I
                                                ⊆
                                                J
                                             
                                          ) that can be used to locate a sales representative, indexed by i,
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       set of SCUs that can be assigned to a sales representative located in SCU i (
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊆
                                                J
                                             
                                          ),
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       set of SCUs adjacent to SCU j, and
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       fixed costs per period for locating a sales representative in SCU i (
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⩾
                                                0
                                             
                                          ).
                                    
                                 
                              
                           
                        
                     

Now we consider the decision variables
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       =1, if a location is setup in SCU i (
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise), and
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ijt
                                                   
                                                
                                             
                                          
                                       
                                       =1, if a sales representative located in SCU i is allocating a selling time of t to SCU j (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ijt
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise),
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       =1, if SCU j is assigned to sales representative location i (
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise),
                                    
                                 
                              
                           
                        and the artificial variable
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ivj
                                                   
                                                
                                             
                                          
                                       
                                       quantity of flow from v to j with origin in location i,
                                    
                                 
                              
                           
                        and then formulate an optimization model for sales force sizing, location of the sales representative, sales territory alignment, and sales resource allocation as follows:
                           
                              (9)
                              
                                 Maximize
                                 
                                 F
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          [
                                          0
                                          ,
                                          T
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       ijt
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 subject
                                 
                                 to
                                 
                                 T
                                 ·
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          [
                                          0
                                          ,
                                          T
                                          ]
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       ijt
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ijt
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                          |
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ⩽
                                 1
                                 
                                 j
                                 ∈
                                 J
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          ∩
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ijv
                                             
                                          
                                          -
                                          
                                             
                                                q
                                             
                                             
                                                ivj
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                             
                                             
                                                i
                                                =
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       iv
                                    
                                 
                                 =
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          ∩
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ivj
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ijt
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       q
                                    
                                    
                                       ijv
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 v
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 i
                                 ∈
                                 I
                              
                           
                        Recall that 
                           
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                           
                         is the selling time the sales representative located in SCU i allocates to SCU j. The objective (9) maximizes the total profit contribution of all sales representatives. By (10) selling time of a sales representative is allocated to the assigned SCUs. (11) derive the assignment variables 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                        . (12) are cuts to force the location variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         towards integer. Since the profit contribution function 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              (
                              t
                              )
                           
                         is strictly concave in t as outlined in Section 3.1 the variables 
                           
                              
                                 
                                    x
                                 
                                 
                                    ijt
                                 
                              
                           
                         are forced to take integer values (i.e., 0 or 1) due to (11) and the maximization of (9). Eq. (13) assign each SCU to one (or none) sales representative. (14) and (15) are the contiguity constraints: flow constraints (14) ensure a contiguous path from a location i to each assigned SCU j. (15) guarantee that there is no flow outside the sales territory of i which is originated from i. (16)–(19) define the domains of the variables.
                           Remarks
                           
                              
                                 
                                    (a)
                                    By definition of the binary assignment variables 
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ij
                                                
                                             
                                             ∈
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       , accounts (SCUs) are exclusively assigned to one individual sales representative. This is an assumption in marketing science and marketing management (Lodish, 1976 & Zoltners et al., Zoltners, Sinah, & Lorimer, 2009).

The problem formulation contains an infinite number of variables. If we relax the integrality conditions an upper bound for the optimal objective function value of (9) can be computed by column generation. Therefore, we replace the interval 
                                          
                                             [
                                             0
                                             ,
                                             T
                                             ]
                                          
                                        by a countable set, denoted by 
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       . That is, for each sales representative located in SCU i we use a definite set of selling times to be allocated to SCU j.

The contiguity constraints (14) and (15) are in the fashion of Shirabe (2009). Hence, our model regards an explicit contiguity formulation. In contrast to the model presented by Drexl and Haase (1999), here the use of continuous flow variables avoids an exponential increase of the number of constraints in the number of SCUs (King et al., 2012). In conjunction with the objective function (9) we expect the sales territories to be fairly compact as well.

In certain companies accounts may be managed by a team of sales representatives. In order to keep the fashion of our model formulation (9)–(19) we might define 
                                          
                                             i
                                             ∈
                                             I
                                          
                                        as the potential location for teams of sales representatives. To account for sales team characteristics (size, makeup etc.) we consider a set M and define 
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   im
                                                
                                             
                                          
                                        with 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   im
                                                
                                             
                                             =
                                             1
                                             
                                             ∀
                                             
                                             i
                                             ∈
                                             I
                                          
                                       . Further, we consider 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       . Of course, the model formulation (9)–(19) and the solution process (Section 4) have to be adapted accordingly.

In the following we introduce a Branch-and-Price approach for solving our original problem (9)–(19) of Section 3. At first, we define the master problem and the subproblem of the column generation procedure. Then, we describe how upper bounds for the linear relaxation can be obtained. This is followed by the description of an approach that determines an initial lower bound for the integer problem. Finally, branching and bounding strategies are described.


                        Master problem. The master problem (MP) is the linear relaxation of (9)–(19), i.e. (18) and (19) are replaced by
                           
                              (20)
                              
                                 0
                                 ⩽
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ⩽
                                 1
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 and
                              
                           
                        
                        
                           
                              (21)
                              
                                 0
                                 ⩽
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 1
                                 
                                 i
                                 ∈
                                 I
                              
                           
                        respectively. That is, we obtain a linear program (LP) from our original program (9)–(19). The corresponding objective function value is named 
                           
                              
                                 
                                    F
                                 
                                 
                                    LP
                                 
                              
                           
                        .


                        Restricted master problem. Let 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                              ⊂
                              {
                              t
                              |
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                              }
                           
                        , then the restricted master problem (RMP) is given by MP using 
                           
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                           
                         instead of 
                           
                              t
                              ∈
                              
                                 
                                    
                                       0
                                       ,
                                       T
                                    
                                 
                              
                           
                         as outlined in remark (b) in Section 3.2. The corresponding objective function value is denoted by z.

When applying column generation for a maximization problem we have to identify variables with (maximum) positive reduced cost. In our application the reduced cost of a variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    ijt
                                 
                              
                           
                         is calculated by a function.


                        Reduced cost function. Let
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       be the dual variable associated with (10) of the RMP, and
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       be the dual variable associated with (11) of the RMP for i and j with 
                                             
                                                i
                                                
                                                ≠
                                                
                                                j
                                             
                                          .
                                    
                                 
                              
                           
                        
                     

Then the reduced cost function 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              t
                              )
                           
                         associated with the sales representative located in SCU i who allocates selling time t to SCU 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         is defined by
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 t
                                 ·
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        The reduced cost function 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              t
                              )
                           
                         computes the reduced cost of the variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    ijt
                                 
                              
                           
                        .


                        Subproblem. A solution of the RMP provides an upper bound for (9)–(19), if
                           
                              (23)
                              
                                 ∀
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 :
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 ⩽
                                 0
                              
                           
                        is satisfied. Checking this condition is denoted as the subproblem.


                        Solution of the subproblem. Recall that 
                           
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                           
                         is the selling time the sales representative located in SCU i allocates to SCU j. Let 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           
                         be the selling time that maximizes 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              t
                              )
                           
                        . Consider 
                           
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                           
                        . Since 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                 
                              
                           
                         is assumed to be strictly concave (see Section 3.1) we are able to determine the optimal feasible selling time by
                           
                              (24)
                              
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ⩽
                                                   T
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   >
                                                   T
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Now, if
                           
                              (25)
                              
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 ⩽
                                 0
                              
                           
                        then (23) is satisfied.


                        Example: Consider the profit contribution function (4) with the sales response function (2) and the cost function (3). Then we have to maximize
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 
                                    
                                       t
                                    
                                    
                                       b
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 t
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        for all 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                        . Differentiating (26) with respect to t and setting the derivative equal to zero leads to:
                           
                              (27)
                              
                                 b
                                 ·
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 
                                    
                                       t
                                    
                                    
                                       b
                                       -
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       o
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                           
                        Rearranging and applying (24) for given 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         leads to:
                           
                              (28)
                              
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    o
                                                                                 
                                                                                 
                                                                                    ij
                                                                                 
                                                                              
                                                                              -
                                                                              
                                                                                 
                                                                                    σ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              b
                                                                              ·
                                                                              
                                                                                 
                                                                                    c
                                                                                 
                                                                                 
                                                                                    ij
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        (
                                                                        b
                                                                        -
                                                                        1
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                            T
                                                         
                                                      
                                                   
                                                
                                                
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   >
                                                   0
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Thus, to check whether a basic solution of the RMP provides an upper bound for the original problem (9)–(19) we have to compute (28) and then 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         for each combination of 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                        . Now, if for at least one combination 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              :
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                              >
                              0
                           
                         then we might improve the actual solution of the RMP if we take into account variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          ijt
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                        .

The objective function of the RMP provides a lower bound 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    LP
                                 
                              
                              =
                              z
                           
                         for the linear relaxation of (9)–(19) as long as (25) is not satisfied; that is, not all variables are priced out (i.e., the reduced cost of all variables is less than or equal zero). Usually, the lower bound 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    LP
                                 
                              
                           
                         is very close to the optimal objective function value of the corresponding linear relaxation after a relatively small number of column generation iterations, but many additional iterations may be required to show optimality (du Merle, Villeneuve, Desrosiers, & Hansen, 1999; Lübbecke & Desrosiers, 2005 & Desaulniers et al., Desaulniers, Desrosiers, & Solomon, 2005). To save computational time we terminate the column generation procedure after a certain number of iterations or alternatively when we can show that the current objective function value is very close to the optimal objective function value of the linear relaxation of (9)–(19). To evaluate a feasible integer solution we need a valid upper bound. Now, the maximum improvement of the objective function value by assigning SCU j to location i is indicated by 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        . We take into account that the feasible maximum value of 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          ijt
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                         is one. Due to (13) of the MP for each SCU j the improvement 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         can be realized at most for one location i. Thus
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 {
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 |
                                 i
                                 ∈
                                 I
                                 )
                                 ,
                                 0
                                 }
                              
                           
                        indicates an upper bound for the improvement of the objective function value by (re-)assigning SCU j to a location i (with a modified selling time).Since z (
                           
                              
                                 
                                    z
                                 
                                 
                                    ∗
                                 
                              
                           
                        ) is the (optimal) objective function value of the RMP we know that 
                           
                              
                                 
                                    F
                                 
                                 
                                    ‾
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                           
                         is the desired upper bound for the linear relaxation of (9)–(19); also known as the Danzig–Wolfe bound (Lasdon, 2002, p. 163f).As stated in Section 4.2 the linear relaxation of (9)–(19) provides an upper bound on (9)–(19) and hence 
                           
                              
                                 
                                    F
                                 
                                 
                                    ‾
                                 
                              
                           
                         is an upper bound on (9)–(19) as well.

We expect enormous computational effort due to the consideration of the contiguity constraints (14) and (15). Therefore, we propose an approach to find a (very good) initial lower bound 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                         for the original problem (9)–(19). In order to obtain 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                         we initialize the set of available selling time 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                           
                         with sufficient elements. “Sufficient” has to be interpreted in terms of the cardinality of 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                           
                         as well as the coverage of the time interval 
                           
                              
                                 
                                    
                                       0
                                       ,
                                       T
                                    
                                 
                              
                           
                        . Given 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                           
                         we solve (9)–(19). Based on the respective solution - that is 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                           
                         - we derive the optimal time values for each 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         as
                           
                              (30)
                              
                                 
                                    
                                       t
                                    
                                    
                                       ij
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                   -
                                                   b
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             w
                                          
                                          
                                             ij
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             iv
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                   -
                                                   b
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             w
                                          
                                          
                                             iv
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ·
                                 T
                                 .
                              
                           
                        The properties and the derivation of (30) are shown by Beckmann and Golob (1972). Since 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                              ⊂
                              
                                 
                                    
                                       0
                                       ,
                                       T
                                    
                                 
                              
                           
                         we are able to determine the initial lower bound as
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ij
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       b
                                    
                                 
                                 ·
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 .
                              
                           
                        We call this procedure an initial MIP-LB.

The column generation approach to compute an upper bound 
                           
                              
                                 
                                    F
                                 
                                 
                                    ‾
                                 
                              
                           
                         of the addressed problem (9)–(19) is outlined in Table 1
                        . In step 1 and step 2 the allowed solution gap 
                           
                              ∊
                           
                         for the optimal objective function value of the linear relaxation and 
                           
                              η
                           
                        , the allowed gap for the integral solution, have to be set by the user. The same has to be done regarding the maximum number of column generation iterations G to solve an LP (cf. step 3). Steps 4 to 6 are the initialization of the column generation process: We have to guarantee, that at the start of the column generation process the set 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                           
                         contains elements so that for each selected (or rather located) sales representative the base (or home) SCU can be assigned. By step 7 we update the iteration counter g. In step 8 we solve the current RMP (by the simplex algorithm). From the optimal basic solution we derive the associated dual variables in step 9. Computing (24) we derive the optimal selling times in step 10. In step 13 we extend the RMP only by variables that have positive reduced cost (multiple pricing). That is, we consider only those 
                           
                              
                                 
                                    x
                                 
                                 
                                    ijt
                                 
                              
                           
                         for which 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ij
                                 
                                 
                                    ∗
                                 
                              
                              )
                              >
                              0
                           
                        . In step 14 we compute the upper bound 
                           
                              
                                 
                                    F
                                 
                                 
                                    ‾
                                 
                              
                           
                        . Having at hand the upper and lower bound we are able to evaluate the actual solution. This process is repeated as long as the condition in step 15 is fulfilled. For a finite set of variables the convergence properties of column generation are well known (Desaulniers et al., 2005). In presence of an infinite number of variables the convergence towards the optimal solution has been shown by Charnsethikul (2011). Note, 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         denotes the best known integral lower bound, where 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                              =
                              0
                           
                         is always a feasible lower bound.

To derive an integer solution we define a standard Branch-and-Bound algorithm based on the location variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         and the assignment variable 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                        . In each Branch-and-Bound node we solve the linear relaxation of (9)–(19) using the column generation procedure outlined in Section 4.5. Note, we have to consider the fixed variables of the preceding nodes. We branch at first on the location variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        . If all location variables are integer then we branch on 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                        .


                        Branching on location variables 
                        
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        
                        . Now, let 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         be the non-integer variable with the smallest deviation to the next integer value. If 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                              <
                              0.5
                           
                         then we remove l from the set of potential locations I. Otherwise, we set the lower bound of 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         to be one.


                        Branching on assignment variables 
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                        
                        . If no non-integer variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         exists, we branch on 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                           
                         with 
                           
                              u
                              ∈
                              I
                           
                         and 
                           
                              v
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    u
                                 
                              
                           
                        . We consider three strategies:
                           
                              1.
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             uv
                                          
                                       
                                    
                                  is the non-integer assignment variable for which
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   ∈
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                          ·
                                          
                                             
                                                x
                                             
                                             
                                                uvt
                                             
                                             
                                                ∗
                                             
                                          
                                          ⩾
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   ∈
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                          ·
                                          
                                             
                                                x
                                             
                                             
                                                ijt
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                          ∀
                                          i
                                          ∈
                                          I
                                          ,
                                          
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         
                                                            0
                                                            ,
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 Where 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ijt
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  are the optimal values for 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ijt
                                          
                                       
                                    
                                  obtained from step 8 of the column generation procedure described in Section 4.5. That is, we branch on the non-integer assignment variable with the highest selling time. Note, this corresponds to branch preferentially on variables with a high objective function coefficient.


                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             uv
                                          
                                       
                                    
                                  is the smallest non-integer assignment variable


                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             uv
                                          
                                       
                                    
                                  is the largest non-integer assignment variable

If 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                              <
                              0.5
                           
                         then we remove v from 
                           
                              
                                 
                                    J
                                 
                                 
                                    u
                                 
                              
                           
                        . Otherwise, we remove v from all 
                           
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         with 
                           
                              i
                              
                              ≠
                              
                              u
                           
                        . Thus, in the next LP-solution derived by our column generation procedure 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                        , respectively, 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                           
                         are forced to be integer.


                        Lower bound on integral solution. A lower bound, denoted 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                        , is derived when no non-integer variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                           
                         exist (integral solution). Obviously, 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                         for all 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                              =
                              0
                           
                         for all 
                           
                              i
                              ∈
                              I
                           
                         and 
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         leads to 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                              =
                              0
                           
                        . As stated in Section 4.4 we may initialize 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                        . We store the largest lower bound value and the corresponding solution.


                        Upper bound. Usually, the first node of a Branch-and-Bound tree takes the number zero. Therefore, by 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                         we denote the smallest upper bound computed by our column generation procedure in the first node of the Branch-and-Bound tree.


                        Back tracking. Each node in our Branch-and-Bound tree will be considered at most two times. For example, let us assume that we branch at a node on 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         with 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                              =
                              0
                           
                        . Then, if we consider the node again, we branch on 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                           
                         with 
                           
                              
                                 
                                    y
                                 
                                 
                                    l
                                 
                              
                              =
                              1
                           
                        . Of course, this will be done for 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                           
                         as well where we branch at first towards 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                              =
                              0
                           
                         or towards 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                              =
                              1
                           
                         and then, at second, towards 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                              =
                              1
                           
                         or towards 
                           
                              
                                 
                                    w
                                 
                                 
                                    uv
                                 
                              
                              =
                              0
                           
                        , respectively. In fact, we generate two child nodes for any non-integer variable. Back tracking is done when
                           
                              (a)
                              a first or an improved lower bound 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ̲
                                          
                                       
                                    
                                  has been obtained and/or

the upper bound 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                  at a node in our Branch-and-Bound tree is smaller or equal 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ̲
                                          
                                       
                                       ·
                                       (
                                       1
                                       +
                                       η
                                       )
                                    
                                  and/or

a node has been considered two times.


                        Termination. The Branch-and-Price approach terminates when
                           
                              (a)
                              all nodes are fathomed and/or

a maximum computation time has been reached. The maximum computation time has to be defined by the user.

First, we discuss some general issues concerning our computational studies. Then we analyze the branching strategies and the MIP-LB (initial lower bound) with respect to the solution gap and the performance of our approach. The performance is measured mainly by the computational effort – 
                        
                           h
                        
                      as CPU-time in seconds – and the realized solution gap
                        
                           
                              ε
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    -
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ·
                              100
                           
                        
                     Moreover, we consider the total number of column generation iterations (CG) and the total number of Branch-and-Bound iterations (BB) and whether a complete implicit enumeration could be achieved (St
                     =1). From this we continue with a study on the coherence of the problem size and the computational effort. The third study examines the influence of the calling time elasticity b on the performance of our proposed approach. In order to check whether our approach is stable towards parameter variation we randomize the calling time profitability 
                        
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                        
                     . Then, we discuss the solution of a selected instance in terms of contiguous sales territory design. Finally, we show how our proposed approach can be employed in the decision making process and we discuss some managerial insights.

If not stated otherwise, we implement the approach in the algebraic modeling language GAMS
                           2
                           General Algebraic Modeling System: http://www.gams.com.
                        
                        
                           2
                         23.5.2 and solve all problems with Cplex 12.2 on a 64-bit Windows Server 2008 (VMWare) with Intel Xeon with 2.13gigahertz processor and 8gigabytes RAM. As sales coverage units we use the 532 NUTS-3 statistical regions of Germany. The maximum distance from the north of Germany to the south of Germany is roughly 1000kilometers. From east to west the maximum distance is 800kilometers (nearly 360,000square kilometer). As an application we imagine a company that is selling medical and pharmaceutical products to practicing resident physicians and medical practices.


                        Specification of 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              (
                              t
                              )
                           
                        . For each region j the number of medical doctors 
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                        , is taken from the INFAS Geodaten KGS22, 2009, Firmenzähler data set.
                           3
                           
                              http://www.infas-geodaten.de.
                        
                        
                           3
                         Denoting by 
                           
                              
                                 
                                    e
                                 
                                 
                                    ij
                                 
                              
                           
                         the euclidean distance in kilometers between the centroids of the regions i and j then the fraction of travel time is computed as follows:
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0.1
                                 +
                                 
                                    min
                                 
                                 {
                                 0.9
                                 ,
                                 2
                                 ·
                                 
                                    
                                       e
                                    
                                    
                                       ij
                                    
                                 
                                 /
                                 800
                                 }
                                 .
                              
                           
                        That is, we assume travel time is proportional to distance. Of course, we might use street network distances. This would enhance the accuracy. However, in order to show the suitability of our new approach we are convinced the crow-fly distances are suitable. We assume an average speed of 100kilometer per hour by car in order to make the computation of the corresponding parameters easily comprehensible. Obviously, if we assume 8hours of work a day, there is a maximum of 800kilometer a sales representative could travel. Thus, if 
                           
                              i
                              =
                              j
                           
                         then 90% of the selling time is calling time. Moreover, if the SCU j is 360kilometer or more away from the location in SCU i there is no calling time left. We arbitrarily choose 
                           
                              α
                              ·
                              μ
                              =
                              10
                           
                        . Travel costs are ignored (
                           
                              
                                 
                                    o
                                 
                                 
                                    ij
                                 
                              
                              =
                              0
                           
                        ).

The total available selling time 
                           
                              T
                           
                         is assumed to be 1600hours per year (based on the assumption of 250 work days a year with 50days have to be spent in the office). Moreover, we define a radius R (proportional to the limited travel-times) that is crucial in order to generate the set 
                           
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                         of SCUs assignable to a sales representative in SCU i:
                           
                              
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ij
                                             
                                          
                                          ⩽
                                          R
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Cuts and unstable column generation. Pre-tests have shown that for the original MP the column generation procedure is unstable for certain instances in terms of pricing out. If we remove (12) from the MP than this problem does not occur. We assume that there are many restrictions due to (12) that are not tight. These might cause the instabilities. Therefore, we remove (12) from the model.

@&#RESULTS@&#


                        Branching strategy and initial lower bound. The main concern of this study is to analyze the branching strategy (BS) and the MIP-LB to determine an initial lower bound. We are interested in the effect on the performance of our approach. The parameter settings and results are shown in Table 2
                        . For 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              16
                           
                         the elements of 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                           
                         are 
                           
                              
                                 
                                    
                                       100
                                       ,
                                       200
                                       ,
                                       …
                                       ,
                                       1600
                                    
                                 
                              
                           
                         and for 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              160
                           
                         the elements of 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                           
                         are 
                           
                              
                                 
                                    
                                       10
                                       ,
                                       20
                                       ,
                                       …
                                       ,
                                       1600
                                    
                                 
                              
                           
                        . Obviously, if we employ the initial MIP-LB we are able to determine a solution very quickly - particularly if the cardinality of 
                           
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                              
                           
                         is large (i.e., 160): We see that 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                         satisfies tolerances (here 
                           
                              η
                           
                         = 0.1%) if 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              160
                           
                        . This is not true, if 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              16
                           
                        . Therefore, the number of CG and BB is smaller for 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              160
                           
                         and hence the total computing time 
                           
                              h
                           
                         is smaller as well. However, the solution quality (in terms of 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         and 
                           
                              ε
                           
                        ) is better if we do not apply the MIP-LB. That is, because of the first lower bound (1st LB) found by the approach without MIP-LB (i) satisfies the quality tolerance and (ii) is larger than 1st LB found by using the MIP-LB. This finding corresponds to the result that 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         is larger for 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              16
                           
                         than for 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              160
                           
                        : The Branch-and-Price procedure improves the initial lower bound found by the MIP-LB if 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              =
                              16
                           
                        . Concerning the branching strategy (cf. Section 4.6) we observe that BS = 1 seems to be most promising.


                        Problem size and solution quality. In this study we analyze the influence of the problem size – measured by R and 
                           
                              
                                 
                                    
                                       I
                                    
                                 
                              
                           
                         – and the solution quality tolerance 
                           
                              η
                           
                         (cf. Section 4.6) on the performance of our approach. Here we measure the performance by 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                              ,
                              h
                              ,
                              ε
                           
                         and St. Based on the results of the first study (cf. Table 2) we choose branching strategy BS = 1 and our MIP-LB in order to determine an initial lower bound 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                        . Parameter settings and results can be found in Table 3
                        . Obviously, 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         grows with increasing R and 
                           
                              
                                 
                                    
                                       I
                                    
                                 
                              
                           
                        . Generally, we can say the larger the problem, the higher is the computational effort (
                           
                              h
                           
                        ). However, for 
                           
                              
                                 
                                    
                                       I
                                    
                                 
                              
                              =
                              25
                           
                         we observe difficulties to achieve complete implicit enumeration (St = 1). We assume, that the contiguity constraints (14) and (15) might cause these problems. Note that if complete implicit enumeration is achieved (St = 1), the realized gap is the minimum of 
                           
                              η
                           
                         and 
                           
                              ε
                           
                        . For example consider the last three instances of Table 3. The first gap is 0.606 while the second and the third gap is 0.1 and 0.01 respectively. However, if we do not manage to achieve St = 1 within the maximum allowed time, than the gap to be considered is 
                           
                              ε
                           
                         (cf. Section 4). Only for two instances the decline in 
                           
                              η
                           
                         yields an improved lower bound 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                        .


                        Comparison with 
                        Drexl and Haase (1999). In order to compare our approach with the approach presented in Drexl and Haase (1999) we use the data generating process outlined in Drexl and Haase (1999). We consider problem sets of different size, i.e. 
                           
                              |
                              J
                              |
                              ∈
                              
                                 
                                    
                                       100
                                       ,
                                       250
                                       ,
                                       500
                                    
                                 
                              
                           
                         and 
                           
                              |
                              I
                              |
                              ∈
                              
                                 
                                    
                                       10
                                       ,
                                       25
                                       ,
                                       50
                                    
                                 
                              
                           
                        . Further, we consider 
                           
                              b
                              =
                              0.3
                              ,
                              
                              T
                              =
                              1300
                              ,
                              
                              ∊
                              =
                              0.01
                           
                         %, 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    
                                       750
                                       ,
                                       1250
                                    
                                 
                              
                           
                        , and 
                           
                              η
                              =
                              0.1
                              %
                           
                        . For each problem set we consider ten randomly generated instances. The maximum computation time is set to two hours. The Branch-and-Bound procedure is implemented in GAMS/CPLEX while the heuristic procedure of Drexl and Haase (1999) is implemented in the programming language C. We use an iMac with 3.4gigahertz Intel Core i7 and 16gigabytes RAM with Mac OS X. The results are given in Table 4
                        . As expected, our approach generally performs better than the heuristic by Drexl and Haase (1999). However, we find that the heuristic approach performs quite good: the deviation from the best lower bound is at most 6%. Actually, it seems that for problem sets with many SCUs (i.e., large 
                           
                              
                                 
                                    
                                       J
                                    
                                 
                              
                           
                        ) the heuristic approach is advantageous as long as we do not consider many potential locations (i.e. large 
                           
                              |
                              I
                              |
                           
                        ). The comparison with Drexl and Haase (1999) illuminates another compelling argument for our approach: the procedure outlined in Section 4 yields tight upper bounds 
                           
                              (
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . On average, the solution gap 
                           
                              ε
                           
                         achieved by the procedure of Drexl and Haase (1999) in Table 4 is 1.6% (next to the last column). In contrast, Drexl and Haase (1999) report a gap of 3%. The improvement of the gap is due to better upper bounds provided by our procedure. The tight upper bounds arise from the column generation procedure and the explicit consideration of contiguity constraints (both, not considered in the approximation methods by Drexl & Haase (1999)). The solution gap for our approach is 0.66% in the average (see column GAP in Table 4).


                        Randomized 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                         
                        and varying 
                        b
                        . Since the parameters of the profit contribution function (4) are empirically obtained, a company might be uncertain about the reliability of the values. The most crucial parameters are the calling time profitability 
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                         and the calling time elasticity b. In order to reflect uncertainty about 
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                        , here we employ a randomized calling time profitability 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                1
                                                -
                                                ω
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                1
                                                +
                                                ω
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . We analyze selected performance measures with varying b and 
                           
                              ω
                           
                        . Because we assume that information about potential customers are relatively reliable, we consider 
                           
                              ω
                              =
                              0.1
                           
                         and 
                           
                              ω
                              =
                              0.2
                           
                        . In terms of calling time elasticity b we consider values within the range of empirical observed values (cf. Skiera & Albers, 2008; Drexl & Haase, 1999 and see Fig. 1). For each value of b we compute 30 instances with random 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           
                        . The parameter settings and the results are shown in Fig. 2
                        . Most eye-catching is the dramatic increase in computational effort for 
                           
                              b
                              =
                              0.4
                           
                        . However, the solution gap remains stable – although the variance increases with b. As expected the lower bound increases. This is important from a managerial point of view: The variance of 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         is quite small for all b. We witness no remarkable difference in the results for 
                           
                              ω
                              =
                              0.1
                           
                         and 
                           
                              ω
                              =
                              0.2
                           
                        .


                        Sales territory design and contiguity property. Now, we are interested in the results concerning the sales territory alignment, particularly the effect of the contiguity constraints (14) and (15). Therefore, we choose a relatively large instance (
                           
                              R
                              =
                              300
                           
                         and 
                           
                              
                                 
                                    
                                       I
                                    
                                 
                              
                              =
                              25
                           
                        ). To solve this problem we again employ the initial MIP-LB and branching strategy BS = 1. We solve the same problem two times: (i) with contiguity constraints (14) and (15) and (ii) without these constraints. All parameter settings and the results can be found in Fig. 3
                        . Concerning the computational effort the differences are dramatic. Without contiguity constraints we are able to solve the problem in 50seconds with complete implicit enumeration. In contrast, with contiguity constraints we do not achieve complete implicit enumeration within the maximum allowed computational time of 21,600seconds. Of course, 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         is larger for the “non-contiguous model”. However, the relative difference is only 0.11%. If we consider the maps in Fig. 3 the effect of the contiguity constraints become apparent: The sales territories of 74, 143, 206, 226, 232, 281, 298, 460 are not contiguous. Most evidently, this is the case for location 74. The price for contiguous sales territories in this example are at least 10,288.39Euro per year. In contrast to our expectations, we see that some sales territories are far from being compact (340 and 460 for example).


                        Computational study with some relaxations and larger problem sets. In some applications the number of sales representatives might be fixed. Further, contiguous sales territories might not be compulsory. In order to account for such an application we consider our model (9)–(19) without (14) and (15). We further introduce
                           
                              (32)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 S
                              
                           
                        with 
                           
                              S
                           
                         as the sales force size, i.e. the number of sales representatives. Moreover, managers might be satisfied with an approximation of the selling time and the expected profit. Therefore, we employ the procedure to obtain an initial lower bound as outlined in Section 4.4. Finally, the number of potential accounts or SCUs may be larger than in our case example. Therefore, we artificially enlarge the set of SCUs of the case example and accordingly generate the distances and the demand based on the case example outlined in Section 5.1. The results are given in Table 5
                        .


                        Sales territories and profit contribution. Finally, we are interested in detailed information about selling times per SCU, expected sales per SCU and expected profit contribution of each sales person. Therefore, we consider two scenarios: we assume fixed locational costs 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                         of (i) 100,000Euro and (ii) 150,000Euro. Of course, these parameter values are arbitrary. However, these settings provide insights on how a managerial study using our approach could be designed. Parameter settings and summary results are given in Table 6
                        . Maps displaying sales territories, selling times and expected profit contribution as well as expected sales are shown in Fig. 4
                        . Of course profit declines if 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                         increases. Here, 
                           
                              
                                 
                                    F
                                 
                                 
                                    ̲
                                 
                              
                           
                         declines by more than 1.4million Euro if 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                         increases by 50,000Euro. At the same time the number of established locations (i.e., sales force size) increases if 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                         declines. The increase in sales force size results in a more cluttered sales territory design (see Fig. 4). Particularly in the western part of Germany the sales territories are cluttered. As expected the metropolitan areas as Berlin (129), Hamburg (74) and Munich (498) are the locations with the largest profit contribution. These locations are single SCU sales territories. Since the number of medical practices is positively related to the population, we witness highest selling times and expected sales in the most populated areas of Germany.

We propose a novel and innovative approach for solving the sales force deployment problem. The four interrelated subproblems sales force sizing, sales representatives location, sales territory alignment, and sales resource allocation are solved simultaneously so that the total profit contribution is maximized. As common in literature, the profit contribution is measured by a separable objective function, i.e., by a sum of strictly concave sales response functions each depending on the continuous measured selling time a sales representative is allocating to a specific sales coverage unit. An important key element of the new approach is that each sales response function is exactly “approximated” by a piecewise linear function where each line segment has the length of zero. This results in a mathematical formulation with an infinite number of binary variables (basis points). As a second new insight to the sales force deployment problem, our approach provides tight upper and lower bounds. These are computed by solving the linear relaxation using column generation. The subproblems are solved analytically. In order to obtain an integral solution we use a Branch-and-Price approach. The third important contribution is that we incorporate explicit contiguity constraints in our model. This results in contiguous sales territories as demanded by sales companies. We evaluate our proposed approach in a series of computational studies. Therefore, we employ a large application-oriented example within the health care and pharmaceutical industry in Germany. The studies show that our approach generates a high-quality solution within reasonable time. The results are stable against parameter variation and we can show the effect of the contiguity constraints. A comparison with Drexl and Haase (1999) shows that we are able to reduce the solution gap from 3% reported in Drexl and Haase (1999) to 1.6% in the average if we use our upper bounds and the approximation method proposed by Drexl and Haase (1999) to compute a lower bound. If we employ our approach we achieve a solution gap of 0.66% in the average using the same artificial data.

@&#ACKNOWLEDGMENTS@&#

We thank 5 anonymous reviewers for their helpful comments to improve the paper.

@&#REFERENCES@&#

