@&#MAIN-TITLE@&#Finite element mesh deformation with the skeleton-section template

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The skeleton-section template is designed to parameterize the input FE mesh hierarchically.


                        
                        
                           
                           FE meshes can be deformed globally with the skeleton and locally with the cross-sections.


                        
                        
                           
                           Local mesh deformations along prescribed directions are realized by anisotropic metric in the embedding space.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Mesh deformation

Parameterization

Radial Basis Functions

Finite element modeling

Simulation-driven design

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Simulation-driven design optimization has become a trend in computational engineering analyses and is a promising paradigm for product development  [1]. Design optimization requires iterative evaluations of groups of models, either to compute the sensitivity or the gradient, or to perform stochastic evolutionary optimizations. Current parametric modeling techniques are inflexible to unexpected changes during design exploration, especially at the stage where the definitions of features, constraints and sizes (or dimensions) are vague. Also, requirements of expertise for modeling and model transfer between Computer-Aided Design (CAD) and Computer-Aided Engineering (CAE) systems may slow down the overall development process. Therefore, a method that is native to CAE environment for rapid mesh model adaptation is necessary for optimization of the design concept.

Our overarching goal is to develop a fast finite element (FE) mesh deformation method, for the design optimization loop as well as for human interactive modeling, which does not depend on the mesh types of the models (e.g. triangular meshes or quadrilateral meshes) or the modeling techniques (e.g. feature modeling, parametric modeling or direct modeling). In this way, even legacy FE meshes without prior parameterizations can be adapted and reused in the design optimization process. However, it would be too ambitious to include all kinds of FE meshes, thus we narrow our scope to thin-walled beam structures, a class of primitive building blocks for complex engineering systems such as aircraft and vehicle structures. As thin-walled structures are often modeled as surface meshes (in the CAE content, shell element meshes), our discussion is limited to surface meshes.

We proposed a radial basis functions (RBF) deformation method based on the skeleton-section template, in order to adapt the FE meshes of the thin-walled beams (see Fig. 1
                     ). The RBF method is adopted in this paper as it can handle arbitrary polygon meshes, directly manipulate the mesh vertices, and preserve the mesh structure (i.e. the number of the mesh vertices and the mesh connectivity) as much as possible before inevitable remeshing.

The skeleton-section template is designed to represent the global shape of the mesh with the skeleton and the local geometry with the cross-sections. It is constructed automatically given the input mesh. With the template parameterizing the input mesh, the proposed method enables both local and global deformations of the complex curved mesh model.

For the local deformation, the input mesh is embedded in the skeleton frame field with a directionally scaled distance metric. The deformation field of some specified local region of the mesh model is computed in the embedding space and mapped back to the original space. Then the deformed mesh is obtained by adding the deformation field to the corresponding mesh vertices. With the directionally scaled distance metric, we can achieve local deformations aligned with prescribed directions by manipulating only a few cross-sections.

At the global level, the skeleton deformation made by the user is first transferred to the associated cross-sections. The cross-sections are rigidly moved accordingly, and it is by taking the changes of all cross-sections as input that the global deformation is computed.

During both global and local deformations, form features can be preserved as follows. Firstly, we estimate the target positions of form features during the initial deformation with prescribed boundary conditions. Then, we iteratively minimize the residuals to the target positions of the features in the subsequent deformations.

The global deformations using the skeleton and the local deformations using the selected cross-sections as driving handles are necessary for designing thin-walled beam structures, since mechanical properties of the beam structures mainly depend on the global and sectional geometries. In particular, adding strip-like features amounts to introducing the reinforcements to the component in the engineering content. This can further extend the design space and lead to diverse results in both design optimization and interactive modeling.

In summary, our method enables hierarchical and flexible modifications of FE meshes of thin-walled beams using the skeleton-section template as a parameterization of input meshes. With the embedding space and the associated directionally scaled distance metric, various local deformations of the complex curved surface mesh can be achieved by using only a few cross-sections. Meanwhile, intuitive global deformations are obtained with the resulting rigid motions of all cross-sections induced by the skeleton modification. Therefore, the proposed method can adapt legacy FE models of thin-walled beam structures to new design variants at both local and global levels.

The remainder of the paper is organized as follows. The related work is reviewed in Section  2. In Section  3, the framework of the proposed method is introduced. The construction of the skeleton-section template is presented in Section  4. In Section  5, the local and global deformations are described in detail, along with the RBF method as preliminary and the feature preservation method as complementary. The numerical experiments are demonstrated in Section  6. Finally the conclusion is drawn in Section  7.

@&#RELATED WORK@&#

Generic templates are useful in geometric modeling and design as they bridge models used in different fields  [2], abstract and cluster of models into same classes  [3], or synthesize and generate new models from databases  [4–6]. The generic template is summarized as an inherent structure that represents the relations among its constitutional parts via parameters  [7].

Skeletons and cross-sections have long been used as effective tools for analyzing, designing and modeling mechanical components with slender geometries. The reduced-beam model, resembling the skeleton of the thin-walled structure, is used to construct the simplified FE model for analyzing structural behavior of the vehicle body  [8,9]. Cross-sections are of significance for the bending resistance of a beam structure and are optimized for better mechanical properties, see  [9,10] for instance. They are also employed in redesign of the CAD models  [11] and mesh models  [12].

The inspiration of our study comes from  [13] in which a case study with a hierarchical template for automobile structural design is presented. This template is structured with nodes, lines, sections and planes to represent the joints, beams, cross-sections and panels, respectively, in the vehicle body. However, the strict requirements placed on the modeling environment make it not applicable to FE meshes directly. This is the major drawback of the CAD-centric model adaptation method.

Thus we focus exclusively on related studies developed for mesh models in the following as our goal is to develop a model adaptation method native to the CAE environment.


                     Curve-based model editing. Curves skeletons and medial axes  [14] of mesh models have been used in interactive modeling  [15,16] and mesh generation  [17].

Jacobson and his colleagues  [16] reviewed the state-of-the-art skinning methods for animation character modeling. Xu and his colleagues  [18] proposed a curve-pair deformation scheme for 3D model editing. Skinning and curve-based methods mainly deal with pose deformation of the model, which is accomplished by rigging the model with the curve skeleton. However, local deformations of the mesh models are, in general, out of the scopes.

Modeling methods for sweep geometries were introduced in  [19,20], where a sweep-based Free-Form deformation (FFD) and a Laplacian-based surface deformation were adopted in respective studies. In both studies, the local controls are achieved by simply scaling the cross-sections. However, scaling only changes the size of the cross-section proportionally but fails to achieve flexible local deformations. Should local modifications other than scaling be available, they will still require much effort; for FFD methods, more complicated control lattices need to be manually constructed, while for surface deformations more constraints or the material-aware method  [21] need to be applied.


                     Mesh deformation. Spatial deformations (e.g. FFD methods) and mesh-based deformations (e.g. surface deformations) are studied intensively in the geometric modeling community (see  [22–24] for some recent surveys) and applied widely in engineering design and simulation (see  [25–27]).

Spatial deformations, in general, suffer from the tedious process of constructing the control lattices as the explicit space embedding, and most of the methods are not able to directly edit the mesh vertices. While mesh-based deformations are widely used in mesh editing, they require the mesh to be manifold in most cases and need to be custom-tailored to different mesh types (e.g. surface meshes or volumetric meshes). The mesh-based nature of these methods hinders their applications to large-scale model deformations. Several commercial software packages offer mesh deformation/morphing modules as well. To the authors’ best knowledge they are mainly developed based on the two major methods discussed previously, so they have similar characteristics with the two methods.

A recent study  [28] summarized and compared the spatial deformation methods. It is reported that Radial Basis Functions (RBF) method proposed in  [28] outperforms the other spatial deformation methods evaluated in  [24] in terms of mesh quality. Also, the RBF method, as a spatial deformation, can cope with non-manifold meshes. In addition, the RBF method can handle various types of polygon meshes and directly manipulate the mesh vertices. Therefore, it is competitive compared with mesh-based deformation methods.

Rendall and his colleagues  [29] employed the anisotropic RBF method to adapt Computational Fluid Dynamics and FE models in multi-disciplinary simulations. Instead of uniform sample points from the mesh model, cross-sections of the flight wing are used as the deformation handles. Intuitive deformations are achieved with non-uniformly distributed RBF centers through a norm biasing technique which is referred as axially scaled distance metric in our paper. This axially scaled distance metric can be seen as an orthotropic metric for RBF methods (see  [30,31]). However, for complex curved shapes, this method is not valid in general. To tackle this problem and obtain more flexible local deformations, a linear embedding space associated with a directionally scaled distance metric is proposed to facilitate the RBF deformation.

@&#OVERVIEW@&#

In this paper, we propose a skeleton-section template to parameterize FE models of thin-walled beam structures hierarchically, i.e. at the global level and the local level. With this template serving as driving handles, the RBF method is adopted to deform the FE meshes. Flexible local deformations are achieved with the anisotropic metric in the skeleton frame field, while intuitive global deformations are obtained by transferring the skeleton deformation to the cross-sections. The form features can be rigidly preserved as well. The framework of the proposed method is shown in Fig. 2
                     .

Given a surface FE mesh regardless of the mesh types or modeling techniques, firstly the system constructs the skeleton-section template of the model in an automatic manner. The skeleton and cross-sections in the template are designed to represent the global configuration and the local geometry of the FE mesh, respectively. A major step in the construction of the template is to find the 3D curve skeleton of the surface mesh. Here we devise a simple yet effective construction algorithm based on the fact that the input mesh is a single slender object. This algorithm iteratively computes a point sequence in the middle of the thin mesh segments by Voronoi decomposition and approximates the skeleton by fitting a set of cubic Bézier curves to the point sequence. On the basis of the constructed skeleton, the cross-sections are extracted from the mesh. Finally, the skeleton and the cross-sections are coupled via mappings stored in the data structure of the template.

Then we perform RBF mesh deformation with the skeleton-section template. By modifying the profiles of the selected cross-sections or the shape of the skeleton, the user can achieve the local or global deformations of the surface FE meshes. This hierarchical strategy is of importance for designing the thin-walled beams as the global shape and the sectional geometry are major factors that define the mechanical performance of a thin-walled structure. In this paper, we refer to the driving handles as those that are used for representing the design variables, since their changes drive the mesh deformation, and we name the RBF centers as the deformation handles. Thus, the skeleton is the driving handle and all the cross-sections are the deformation handle in the global deformation; while the selected cross-sections are both the driving handle and the deformation handle in the local deformation.

To attain more flexible local deformations with only a few cross-sections, we replace the axially scaled distance metric in  [29] with a directionally scaled distance metric. This enables local deformations along user-prescribed directions and creations of strip-like features. We then extend the anisotropic RBF deformation method to curved mesh models by embedding the mesh model into its skeleton frame field. The deformation field in the embedding space computed by the RBF method is mapped back to the original space and added to the corresponding vertices, which leads to the final deformed mesh.

To achieve the global deformation, the skeleton no longer acts as a rig to the mesh. Instead, the skeletal deformation leads to rigid motions of all cross-sections in the space. It is based on these rigid motions of the cross-sections that the global deformation of the mesh is obtained via the RBF method. In addition, the form features can be rigidly preserved during both global and local deformations. The target positions of form features are estimated, in the initial deformation, as rigid motions with respect to their centers. Then the residuals to the target positions of the form features are minimized in an iterative manner.

The proposed skeleton-section template is designed to hierarchically parameterize the model. Here we describe a simple yet effective method to automatically formulate the template. The skeleton is computed by leveraging the fact that the mesh is a single slender object. The skeleton construction is a key component in the formulation of the template as later the cross-sections are extracted on the basis of the skeleton. We first introduce the geometric intuition and the process of the skeleton construction based on Voronoi decomposition. Then we present the extraction of the cross-sections and the formulation of the template along with its data structure.

Given an input surface mesh model 
                           M
                         that may contain open cross-sections, we desire to compute a curve skeleton with the following properties: 
                           
                              (1)
                              It can represent the global shape of the input mesh; and

It should go through the centroids of the cross-sections (that are likely off the surface).

These properties in turn specifies a curve skeleton that mimics the fundamental notion of the Neutral Axis of a beam in structural mechanics which is the basis of the reduced-beam model  [8]. To obtain a curve skeleton that satisfies the listed properties, a simple idea is proposed. A point sequence 
                           Q
                           =
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         is iteratively computed to approximate the input mesh by centering each point 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         at a local region 
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                        . In this way, the point sequence 
                           Q
                         can represent the global geometry of the mesh given proper segmentation 
                           
                              {
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        , as required by the property 1. If the local regions 
                           
                              {
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         should be thin segments and perpendicular to the skeleton, these points 
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         meet the property 2.

An example is described as follows. Given a surface mesh 
                           M
                           =
                           
                              (
                              X
                              ,
                              F
                              )
                           
                         shown in Fig. 3
                        (a), the point sequence 
                           
                              
                                 Q
                              
                              
                                 0
                              
                           
                         is initialized with two points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                              
                                 0
                              
                           
                         at each end of the mesh (see Fig. 3(c)). The subscript indicates the order of the point in the sequence and the superscript indexes the number of the iteration which is omitted for simplicity when the iteration round is clearly stated.

Suppose we have a point sequence 
                           
                              
                                 Q
                              
                              
                                 r
                              
                           
                         at the 
                           r
                        th round. The 
                           k
                        -nearest neighbor (
                           k
                        -NN) searches are performed with points 
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         as the centers. This amounts to performing Voronoi decomposition by considering 
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         as Voronoi sites (see Fig. 4
                        (a)). Consequently, the mesh model in the 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         space is segmented (Fig. 3(d) and (e)). The segments 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         are described by the equation, 
                           
                              (1)
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    X
                                    ∣
                                    
                                       
                                          
                                             ‖
                                             
                                                x
                                             
                                             −
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≤
                                    
                                       
                                          
                                             ‖
                                             
                                                x
                                             
                                             −
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ≠
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    ∈
                                    
                                       
                                          Q
                                       
                                       
                                          r
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Provided that the distance between two adjacent points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         are larger than a prescribed value 
                           T
                        , we find the interface 
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                         between segments 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         which are centered at the two points, respectively. The interface 
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                         is a thin local region perpendicular to the line segment connecting the two Voronoi sites 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        . As the point sequence grows, the interfaces are able to approximate the cross-sections, see Fig. 4(a). Interfaces 
                           
                              {
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are identified as the vertices in the faces that contain vertices in both segments 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        . We compute the centroids 
                           
                              {
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         of the interfaces 
                           
                              {
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         and insert each of them between the corresponding Voronoi sites 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         forming an updated sequence 
                           
                              
                                 Q
                              
                              
                                 r
                                 +
                                 1
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    N
                                 
                              
                              }
                           
                        . This step is shown in Fig. 3(d) and (e) where only centers of the interfaces that satisfy the distance condition are computed.

The sequence 
                           Q
                         is updated repeatedly until all the distances between adjacent points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         are smaller than 
                           T
                        . The intuition behind this termination value 
                           T
                         is to prevent the adjacent points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         from getting too close, and thus prevent undesired intersections of interfaces in the next computation (shown in Fig. 3(f)). Finally, the output point sequence is fitted by a set of cubic Bézier curves with 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         continuity. The skeleton defined as these Bézier curves is shown in Fig. 3(b).

After the skeleton in the cubic Bézier form is obtained, the cross-sections are extracted from the mesh model based on the skeleton. We perform the 
                           k
                        -NN algorithm with dense sample points on the curve skeleton to segment the mesh into thin pieces according to Eq. (1) (see Fig. 4(b)). As the distances between all pairs of adjacent samples get smaller, the segments 
                           
                              {
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         tend to be thinner and perpendicular to the curve skeleton and therefore approximate the cross-sections.

We use a sampling distance that equals to the mesh size of the input FE model to obtain the thin segments. On the one hand, we extract the cross-sections as a subset of the thin segments 
                           
                              {
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         that are able to represent the complete sectional geometries of the model and that are intersection-free. On the other hand, the dense sampling thus assigns every vertex in the mesh a footpoint that will be used in the 
                           
                              embedding
                           
                         process. Finally, the skeleton-section template is obtained and shown in Fig. 4(c).

The skeleton-section template serves as a meaningful parameterization for the thin-walled beam structures as it takes the global and sectional geometries of the model into consideration; the prior parameterization in CAD system is no longer necessary. The template is formulated by coupling the skeleton and the cross-sections of the mesh via two mappings which are stored in the template data structure. In the data structure shown in Table 1
                        , there are four fields, namely 
                           
                              Skeleton
                           
                        , 
                           
                              FootPoint
                           
                        , 
                           
                              MeshVertexMap
                           
                         and 
                           
                              CrossSectionMap
                           
                        .

In the field 
                           
                              Skeleton
                           
                         stored are the Bézier control points 
                           
                              {
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         and the indices of their corresponding curves 
                           
                              {
                              
                                 
                                    
                                       idCurve
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        ; while in 
                           
                              FootPoint
                           
                         stored are the natural coordinates 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              }
                           
                         of the sample points on the skeleton and the indices of their corresponding curves 
                           
                              {
                              
                                 
                                    
                                       idCurve
                                    
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        . The 
                           
                              MeshVertexMap
                           
                         maps mesh vertices 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    m
                                 
                              
                              }
                           
                         
                        onto the footpoints 
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        , and the 
                           
                              CrossSectionMap
                           
                         relates every cross-section 
                           
                              
                                 
                                    CS
                                 
                              
                              
                                 n
                              
                           
                         to its footpoint 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                        . The mesh vertices in each cross-section are thus derived with the 
                           
                              CrossSectionMap
                           
                         and the (inverse) 
                           
                              MeshVertexMap
                           
                        .

In this section, the mesh deformation method with the skeleton-section template is introduced in detail. To make this paper self-contained, the Radial Basis Functions (RBF) deformation method is briefly introduced at the beginning. Then, the template-based local deformation is presented. In the local deformation, we first describe the axially scaled distance metric (ASDM) for handling straight models with only a few selected cross-sections proposed in  [29]. We then extend this method by replacing the ASDM with a directionally scaled distance metric (DSDM) to achieve more flexible local deformation results, such as adding strip-like features aligned with prescribed directions on a surface mesh. To handle curved mesh models, we perform the RBF method in an embedding space which is the skeleton frame field associated with the DSDM. Next to the local deformation, we introduce the global deformation method based on the hierarchy of the template. The cross-sections are rigidly moved according to the skeleton deformation and then serve as the deformation handles to derive the deformed mesh. Lastly, the technique for form feature preservation is presented.

The RBF method is employed to deform the existing mesh in our study, as it has several advantages such as interpolation at design constraints, flexibility and smoothness by choosing different basis functions, and the ability to handle arbitrary polygon meshes (including non-manifold meshes). Applications of the RBF method in mesh deformation can be seen in  [28], and its computational aspects are discussed in depth in  [32]. We refer interested readers to these articles for more technical details.

The RBF method computes a function that interpolates the prescribed function values at the given RBF centers. In the case of mesh deformation, the RBF centers are a set of mesh vertices 
                           H
                           =
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        ; the prescribed function values are deformation vectors at these vertices 
                           
                              {
                              
                                 f
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              }
                           
                        ; and the function to be interpolated is the spatial deformation vector field 
                           
                              f
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         over the mesh model. Thus, the deformed mesh is obtained by adding the corresponding deformation vector to each mesh vertex, 
                           
                              (2)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    x
                                 
                                 +
                                 
                                    f
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

The RBF interpolant 
                           
                              f
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         is represented as a linear combination of the chosen basis functions 
                           ϕ
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    D
                                 
                              
                              )
                           
                         which depend on the distance between the point of interest 
                           
                              x
                           
                         and the RBF center 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           H
                        , 
                           
                              (3)
                              
                                 
                                    f
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             
                                                x
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         where 
                           N
                         is the number of RBF centers, 
                           D
                         is the distance metric usually taking the form of 
                           L
                           2
                         norm, 
                           
                              c
                           
                           =
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              }
                           
                         and 
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                         is the coefficient for basis functions centered at 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                        . Throughout the paper, we choose 
                           
                              triharmonic
                           
                         basis function (a.k.a. thin-plate spline basis function) 
                           ϕ
                           
                              (
                              d
                              )
                           
                           =
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                         introduced in  [28] for the RBF interpolant. In order to deal with possible rigid transformations between the original and deformed models, polynomials up to first order are added to the interpolant. Thus the interpolant is further written as 
                           
                              (4)
                              
                                 
                                    f
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             
                                                x
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    (
                                    
                                       
                                          π
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          π
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          π
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          π
                                       
                                       
                                          4
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    1
                                    )
                                 
                              
                              
                                 T
                              
                           
                        , and 
                           
                              p
                           
                           =
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         is the corresponding coefficient vector. The computation of the coefficients 
                           
                              c
                           
                         in Eq. (4) is known as 
                           
                              fitting
                           
                         (due to the polynomial term). A side constraint on the polynomial term at every RBF center 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           H
                         is given as 
                           
                              (5)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        Combining Eqs. (4) and (5) at every RBF center 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                        , a linear system is formulated, 
                           
                              (6)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                          
                                          
                                             
                                                P
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             
                                                O
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ⋅
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              Φ
                           
                           =
                           
                              {
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    j
                                 
                              
                              }
                           
                           =
                           
                              {
                              ϕ
                              
                                 (
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       D
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              ∈
                              H
                              }
                           
                        , 
                           
                              P
                           
                           =
                           
                              {
                              
                                 
                                    π
                                 
                                 
                                    i
                                    k
                                 
                              
                              }
                           
                           =
                           
                              {
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              H
                              }
                           
                        , 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        . By solving Eq. (6), the augmented coefficients 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 ∗
                              
                           
                         and therefore 
                           
                              c
                           
                         are obtained, 
                           
                              (7)
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      O
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 .
                              
                           
                         With the coefficients 
                           
                              c
                           
                         and 
                           
                              p
                           
                        , one can compute the deformation vector 
                           
                              f
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         at any point 
                           
                              x
                           
                         in the space with Eq. (4), which is known as 
                           
                              evaluation
                           
                        . Therefore, by evaluating the deformation vector at each mesh vertex 
                           
                              x
                           
                         and then adding this deformation vector to the vertex 
                           
                              x
                           
                        , the deformed mesh model is finally obtained with Eq. (2).

Here we introduce the local deformation method using only a few cross-sections in the template as driving handles. With the proposed method, flexible local deformations can be achieved by modifying the profiles of the selected cross-sections.

At local level, we assume that the global geometry of the mesh remains unchanged. For a simple local deformation, a region of interest (ROI) to be deformed is specified with four cross-sections as the driving handle (see Fig. 11(a)). The profiles of the cross-sections at both ends of the ROI are modified to obtain the deformation field of the ROI. The deformation field gradually fades away outside the ROI by setting the other two cross-sections as fixed handles. More complicated deformation can be obtained by combining several simple local deformations.

In the following paragraphs, we first introduce how to obtain local deformations for a straight model with sparse cross-sections as driving handles, which is similar to  [29] based on an 
                           
                              axially
                           
                         scaled distance metric (ASDM). To achieve local deformations along arbitrary directions in the ROI, we present a modified method by replacing the ASDM with a 
                           
                              directionally
                           
                         scaled distance metric (DSDM). Strip-like features can be introduced on the surface mesh with the use of the DSDM by setting a narrow modified area on the cross-sections (see a simple example in Fig. 6(a)). Finally, in order to handle curved mesh models, we extend the proposed method in an embedding space which is the skeleton frame field of the FE model. The three operations share a common idea that is to evaluate the deformation vector field with the RBF method in a space which is designed suitably for certain purposes. By mapping the deformation vector field back to the original 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         space and then adding the deformation field to the mesh model, we obtain the updated model.

For a mesh model with straight geometry, the key component for the success of local deformations with sparse cross-sections is the ASDM, which weights the axial component much smaller than the other two components in the distance computation. The ASDM therefore results in a deformation field that propagates farther along the axial direction of the straight model. For convenience, we assume that the axial direction of the straight model is aligned with the 
                           x
                         direction of the global frame without losing generality. This method is adopted in  [29] to deform a flight wing model for fluid–solid interaction problem.

As can be seen in Eq. (4), the RBF interpolant relies on the spatial distance measure. Therefore, in the standard Euclidean space, the deformation field computed around a cluster of RBF centers is radially symmetric, see Fig. 5
                        (b). In order to counter the effect of radial symmetry and obtain a deformation field insensitive to the change of 
                           x
                         coordinate, the distance between two points 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         is weighted with a small coefficient on the 
                           x
                         component (that is 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        ) 
                           
                              (8)
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                k
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                k
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                         is much smaller than 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                        . This is equivalent to applying a scaling transformation 
                           
                              S
                           
                         to the distance computation, 
                           
                              (9)
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Thus, the distance between the two points 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         with the metric 
                           A
                           =
                           
                              
                                 
                                    S
                                 
                              
                              
                                 2
                              
                           
                         is written as 
                           
                              (10)
                              
                                 d
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       A
                                    
                                 
                                 .
                              
                           
                         Based on the transformed coordinates of the points, the distance can be written as 
                           
                              (11)
                              
                                 d
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    y
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              S
                           
                           ⋅
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . In practice, we set 
                           
                              S
                           
                         as 
                           
                              diag
                           
                           
                              (
                              0.1
                              ,
                              1
                              ,
                              1
                              )
                           
                         for 3D meshes throughout the paper in consideration of the condition of the linear system formed by the transformed data set. Due to the applied distance metric, the resultant deformation field in the original 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         space is no longer radially symmetric; instead it is a hyper-ecliptic shape with the longer axis along the 
                           x
                         direction (see Fig. 5(c)). Thus, the deformation of a small area leads to a deformation field along the 
                           x
                         direction.

Although the aforementioned method can yield anisotropic deformation fields along the axial direction, it cannot obtain intuitive results when the desired deformation path is off the axial direction. An example is shown in Fig. 6
                         where the direction connecting the modified areas on both edges of the plate is not aligned with the axial direction. A discontinuity is observed in the deformation field obtained with ASDM (see Fig. 6(c)).

In order to attain intuitive local deformations along directions other than the axial direction, we apply a 
                           
                              directionally
                           
                         scaled distance metric (DSDM, shown in Fig. 6(d)). This distance metric not only scales the three components in the distance computation, but also rotates the frame system to align the axial direction in the ROI with the prescribed direction.

We apply a rotational transformation 
                           
                              R
                           
                         to the distance computation besides the scaling transformation 
                           
                              S
                           
                        , which yields 
                           
                              (12)
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    R
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           T
                           =
                           
                              
                                 
                                    R
                                 
                              
                              
                                 T
                              
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 2
                              
                           
                           
                              R
                           
                        . This is equivalent to the distance between their transformed versions 
                           
                              
                                 
                                    z
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 
                                    SRx
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , 
                           
                              (13)
                              
                                 d
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   SRx
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   SRx
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   z
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   z
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

The transformation 
                           
                              R
                           
                         rotates the axial direction to be aligned with the prescribed direction 
                           
                              l
                           
                        , so that the deformation field propagates farther along this prescribed direction 
                           
                              l
                           
                        . 
                           
                              R
                           
                         is computed with Givens transformations. Givens transformations in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         are stated as 
                           
                              (14)
                              
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       z
                                    
                                 
                                 
                                    l
                                 
                                 =
                                 
                                    
                                       
                                          e
                                       
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 z
                              
                           
                         together rotate the unit vector 
                           
                              l
                           
                         to be aligned with unit vector along the axial direction 
                           
                              
                                 
                                    e
                                 
                              
                              
                                 x
                              
                           
                        . Therefore, the rotational transformation 
                           
                              R
                           
                         is exactly the inversion of the Givens transformations, 
                           
                              (15)
                              
                                 
                                    R
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   G
                                                
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                
                                                   G
                                                
                                             
                                             
                                                z
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       z
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

The prescribed direction in our paper is defined as a unit vector 
                           
                              l
                           
                         pointing from the center of the modified vertices of one cross-sectional profile to that of the other (as only a pair of adjacent cross-sections are involved each time). When one of the two cross-sections has no changes, we set the rotational transformation as the identity transformation, 
                           
                              R
                           
                           =
                           
                              I
                           
                        , which means that the prescribed direction is assumed to be the axial direction.

With the DSDM, the modified areas at both edges of the plate is connected by the deformation field, as it is desired, shown in Fig. 6(d). In this way, we can attain deformation fields aligned with prescribed directions and create strip-like features on a surface mesh.

However, the method with the anisotropic metric described above can work only on the assumption that the shape is straight. When the mesh model is curved, the 
                           x
                         direction of the global frame is no longer constantly aligned with the axial direction of the model; a special treatment is required. We extend the previous method by embedding the curved model in its skeleton frame field. With the embedding operation the model is straightened referring to the skeleton and the previous method can be applied to the ‘straight’ model (see Fig. 7
                        ). The embedding process is described as follows.

The local frames 
                           
                              {
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         of all the sample points 
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         (or footpoints) on the skeleton are computed during the formulation of the skeleton-section template. These local frames form a frame field (shown in Fig. 7(d)) in which a sample point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         has a coordinate 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                              
                              
                                 T
                              
                           
                        , where 
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                         is the accumulated arc-length from the starting point of the curve skeleton to 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                        .

According to the mapping 
                           
                              MeshVertexMap
                           
                         stored in the template data structure, any mesh vertices can be related to a sample point. For a vertex 
                           
                              x
                           
                         with its corresponding sample point 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        , the local coordinate 
                           
                              u
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         in the local frame 
                           
                              L
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         at 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         is computed, 
                           
                              (16)
                              
                                 
                                    u
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    L
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       p
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              L
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         is approximated by the Rotational Minimizing Frame (RMF) with a efficient computational method proposed in  [33]. Then the coordinate of this mesh vertex 
                           
                              x
                           
                         in the embedding space is computed as the sum of two parts, the embedded coordinate 
                           
                              a
                           
                           
                              (
                              
                                 p
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              )
                           
                         of 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         plus the local coordinate 
                           
                              u
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         of 
                           
                              x
                           
                        , 
                           
                              (17)
                              
                                 
                                    v
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    u
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 +
                                 
                                    a
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    L
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       p
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                                 +
                                 
                                    a
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                              
                           
                         where 
                           
                              a
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≡
                           
                              a
                           
                           
                              (
                              
                                 p
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              )
                           
                        .

Since the RBF method is performed in the embedding space, the input known function values need to be embedded in the skeleton frame field as well. The known function values, in our cases, the deformation vectors 
                           
                              f
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         at RBF centers 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           H
                        , can be viewed as the difference between the original position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                              
                                 o
                              
                           
                         of the vertex 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         and its updated position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                              
                                 ′
                              
                           
                        . Based on Eq. (17), the embedded deformation vector at a RBF center 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         are written as 
                           
                              (18)
                              
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       L
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       −
                                       
                                          p
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    +
                                    
                                       a
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 −
                                 
                                    [
                                    
                                       L
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                          
                                             o
                                          
                                       
                                       −
                                       
                                          p
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    +
                                    
                                       a
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    ]
                                 
                              
                           
                         which is further simplified as, 
                           
                              (19)
                              
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    L
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The sample point 
                           
                              p
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         of 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         and its coordinate in the embedding space are invariant as the global geometry remains unchanged.

With the RBF centers and the corresponding deformation vectors in the embedding space, the RBF interpolant with the DSDM has the form of 
                           
                              (20)
                              
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (x)
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             
                                                w
                                             
                                             −
                                             
                                                
                                                   
                                                      w
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              w
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              SRv
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              SR
                           
                           
                              (
                              
                                 L
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                                 (
                                 
                                    x
                                 
                                 −
                                 
                                    p
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 )
                              
                              +
                              
                                 a
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              )
                           
                        , obtained by applying the DSDM to the embedded coordinate 
                           
                              v
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        . The RBF interpolant is solved with Eq. (7). Then the deformation vector field in the embedding space is obtained by evaluating deformation at the transformed coordinate 
                           
                              w
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         of every mesh vertex with Eq. (20). Finally, the deformation vector field in the embedding space is mapped back to the original space according to 
                           
                              (21)
                              
                                 
                                    f
                                 
                                 
                                    (x)
                                 
                                 =
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (x)
                                 
                                 ⋅
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (x)
                                 
                                 .
                              
                           
                        Adding these deformation vectors to their corresponding mesh vertices (see Eq. (2)) yields the deformed mesh model.

For global deformations of the meshes, the skeleton is used as the driving handle since it represents the global geometry of the mesh model. However, the deformation handle are the vertices representing the cross-sections. It is thus necessary to build an inter-level mapping to transfer the deformation of the driving handle to the deformation handle, see Fig. 8
                        .

The deformation transfer from the skeleton to the cross-sections is realized by preserving the local relationship between the vertices in the cross-sections and the skeleton. As the cross-sections 
                           
                              {
                              
                                 
                                    
                                       CS
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are related to the footpoints 
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         on the curve skeleton via 
                           
                              CrossSectionMap
                           
                         stored in the template, we encode the concerned vertices 
                           
                              
                                 
                                    {
                                    X
                                    }
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 
                                    CS
                                 
                              
                              
                                 i
                              
                           
                         into the local frame 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 i
                              
                           
                         of the skeleton at the corresponding footpoint 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                        . The encoding process is similar to the embedding process in the local deformation; however computed are only the local coordinates of the concerned vertices with respect to their corresponding footpoints. By preserving these local relationships between the concerned vertices and the footpoints, the vertices can be recovered based on the same footpoints (in terms of their natural coordinates) and their transformed local frames on the deformed skeleton.

Given a set of vertices 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                         and a curve with footpoints 
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         on it, the deformation transfer from the curve to the set of vertices is illustrated with a simple 2D example in Fig. 9
                        . Every vertex 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 k
                              
                           
                         in the set is encoded into the local frame 
                           
                              L
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         at its corresponding footpoint 
                           
                              p
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         and has a local coordinate 
                           
                              u
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         according to Eq. (16). Given that the natural coordinate of the footpoint 
                           
                              p
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is 
                           t
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         from the field 
                           
                              FootPoint
                           
                         stored in the template, its position after deformation is computed with 
                           
                              (22)
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    t
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 b
                              
                              
                                 ′
                              
                           
                         is the deformed cubic Bézier curve on which 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         locates.

After the curve deformation, the global coordinates of the vertices are changed while their local coordinates are preserved. The coordinates of the deformed vertices are computed with 
                           
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       L
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       −
                                       
                                          p
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                 
                              
                              
                                 (24)
                                 
                                    =
                                    
                                       Tx
                                    
                                    −
                                    
                                       (
                                       
                                          Tp
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         and 
                           
                              L
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         are the local frames at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         and 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        , respectively, and 
                           
                              T
                           
                           =
                           
                              
                                 
                                    L
                                 
                              
                              
                                 ′
                              
                           
                           
                              
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              L
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        . Suppose the 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         in Fig. 9 are the vertices in some cross-section, then this can be viewed as applying a rigid transformation to the cross-section, which is composed of a rotation 
                           
                              T
                           
                         of the local frame of 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         and a translational term (the term in the parentheses in Eq. (24)) related to the displacement of footpoint 
                           
                              p
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        .

Therefore, at the global level, we first compute the rigid transformations according to the skeleton deformation and transfer them to the corresponding cross-sections. Then the deformation vector field over the mesh is computed through the RBF method, with the vertices in all cross-sections as the input RBF centers and their displacements from the original positions as the known function value. Finally, the mesh is updated again with Eq. (2).

In both global and local deformations, features on the surface mesh are smoothly deformed. However, features need to be preserved when they are important for engineering purposes such as assembly or manufacturing. In this part, we discuss the method adopted in this paper for form feature preservation during both deformation levels.

We consider a form feature is preserved when the distance between each pair of the vertices in the feature remains unchanged after deformation. According to this definition, we first estimate the rigid motion of the feature based on the global/local deformation described previously. We factor out the rotation 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 f
                              
                           
                         and the translation 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 f
                              
                           
                         as follows. The former is computed as the rotation from the principal components of the feature vertices 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    f
                                 
                              
                              }
                           
                         in the original state to that in the deformed state 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    f
                                 
                                 
                                    d
                                 
                              
                              }
                           
                         obtained via the deformation. The latter takes the form of 
                           
                              (25)
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 C
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       f
                                    
                                 
                                 C
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          f
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           C
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         denotes the center of vertices 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        . By applying the rotation 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 f
                              
                           
                         and translation 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 f
                              
                           
                         to the vertices in the feature, we estimate the target positions of the vertices 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         with 
                           
                              (26)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       f
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       f
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       f
                                    
                                 
                                 +
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       f
                                    
                                 
                                 .
                              
                           
                         Then we compute the residual 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 f
                              
                           
                         between the current deformation state 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    f
                                 
                                 
                                    d
                                 
                              
                              }
                           
                         and the target state 
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                              }
                           
                        . Also, the residual 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 H
                              
                           
                         at vertices in the deformation handle are computed. The residual deformation vector field is evaluated in Eq. (3) with vertices in both the feature and the handle as RBF centers and the residuals 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 f
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 H
                              
                           
                         as known function values. By incrementally minimizing the residual deformation field, satisfactory result is obtained. Form feature preservation in the global deformation uses the same technique. But the incremental minimization of the residual is solved as a local deformation problem to accelerate the computation.

@&#RESULTS AND DISCUSSION@&#

Numerical examples are demonstrated and discussed in this section. Our prototype program is coded in MATLAB R2013a. All the examples are obtained on a laptop with 2.50 GHz CPU (Intel Core i7) and 8 GB RAM, under Windows 64-bit system. Two FE models, the front rail and the B-pillar, used in this paper are components extracted from FE models of vehicle body structures for crashworthiness design. The original front rail is converted to a dense triangular mesh with mesh size of 5 mm, containing 17610 vertices and 34218 elements (faces). The B-pillar is quad-dominant mesh with mesh size of 15 mm, containing 2811 vertices and 2719 elements (faces). Local and global deformation results derived based on these two models are presented.

In the local deformation, we demonstrate two examples. The first example (FR-Local) is obtained by modifying a narrow portion of each of the two cross-sectional profiles to create a strip-like feature in the ROI on the surface (see Fig. 10
                     ). The curved region in the mesh model are specified as the ROI to demonstrate the ability of the proposed method in dealing with curved mesh models. The ROI is specified by defining its both ends as the two deforming handles. The deformation fields in the original and the embedding spaces are presented, in which the deformation vectors with larger magnitude (ranging from 0 to 10) have darker color. The deformation field varies smoothly over the ROI (see Fig. 10(c)) and aligns well with the prescribed direction in the green dashed line in the embedding space (see Fig. 10(d)).

The second example (BP-Local) along with its deformation vector field is illustrated in Fig. 11
                     . This example is derived by modifying the whole profiles of the selected cross-sections of the mesh model. In both examples, the deformation fields between fixed (in green) and deforming (in blue and red) cross-sections are illustrated; They vary smoothly and fade away at cross-sections of the fixed cross-sections.

The deformed meshes are illustrated in Fig. 12
                     . Both examples demonstrate the ability to achieve smooth and intuitive local deformations on the given surface meshes. In the engineering context, the first example amounts to introducing a reinforcement to the thin-walled component for enhancing the resistance to local buckling, while the second may be applicable when the cross-sectional profile needs to be heightened to increase the moment of inertia.

Deformed meshes of the FR-Local example derived with different distance metrics are compared in Fig. 13
                     . The deformation fields demonstrated match the simple case of the rectangular plate shown in Fig. 6. The proposed method using the DSDM in the embedding space leads to an intuitive local deformation result; see Fig. 13(a) and also Fig. 6(d). However, the local deformation derived in the embedding space associated with the ASDM bifurcates in the midway of the ROI; see Fig. 13(b) and Fig. 6(c). Neither the isotropic distance metric in the embedding space (see Fig. 13(c)) nor that in the standard 
                        
                           
                              E
                           
                           
                              3
                           
                        
                      space (see Fig. 13(d)) yields intuitive results; the deformation in each setting peaks at very limited areas around the modified cross-sections which can be observed in Fig. 6(b) as well.

Given that the skeleton deformation and the resulted changes of the cross-sections are shown in Fig. 8, the global deformation result is demonstrated in Fig. 14
                     , where the fore part of the model front rail is lowered. It can be seen that the mesh model is smoothly deformed through visual inspection. Also, the curvature change between the original and the deformed meshes is computed to support this claim. We show only the curvature change in the deformed region where vertices have displacements larger than 0.01 (which contains nearly 7500 vertices). Among these vertices, only 1.3% of them have absolute curvature change larger than 0.01 and the maximum curvature change is 0.079. The distribution of the absolute curvature changes in 
                        l
                        g
                      scale (the logarithm to base of 10) with respect to the 
                        x
                     -axis and the histogram of the relative change of the curvature are illustrated in Fig. 15
                     . This example of the global deformation may be expected in circumstances of changing the crushing load path or modifying the position of the component in assembly.

Features preservation is important for engineering components as they are designed for certain engineering purposes. We also demonstrate the effectiveness of the adopted feature preservation method with the BP-Local example in Fig. 16
                     . Mesh vertices enclosed in the dashed square composes the form feature. The residual minimization is performed only once in this example. According to the definition of the feature preservation given in Section  5.4, we measure the error 
                        
                           
                              ϵ
                           
                           
                              f
                           
                        
                      of the feature from its deformed states with and without feature preservation (fp), respectively. We compute the pairwise distances 
                        
                           
                              d
                           
                           
                              i
                              j
                           
                           
                              k
                           
                        
                      between all vertices in the feature for both deformed meshes (
                        k
                        =
                        1
                     , if with fp; 
                        k
                        =
                        2
                     , if w/o fp), and that in the original mesh (
                        k
                        =
                        0
                     ). Then the error of each pairwise distance is defined as 
                        
                           
                              ϵ
                           
                           
                              i
                              j
                           
                           
                              k
                           
                        
                        =
                        
                           |
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 0
                              
                           
                           −
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 k
                              
                           
                           |
                        
                     . The error 
                        
                           
                              ϵ
                           
                           
                              f
                           
                           
                              k
                           
                        
                      is computed as the sum of 
                        
                           
                              ϵ
                           
                           
                              i
                              j
                           
                           
                              k
                           
                        
                     . The statistics are listed in Table 2
                     .

The quality of each deformed mesh model is investigated with respect to four quality criteria. The percentages of elements that are not ‘good’ and those of the failed elements (in the parentheses) are listed in Table 3
                     . The worst case values are given as well. The failed elements may affect the accuracy of the simulation results. Moreover, large values of worst cases may cease the computation abruptly. The thresholds for ‘good’ and ‘fail’ values are given in the table. The result shown in Table 3 indicates that the proposed the deformed results obtained by the proposed method keep the mesh quality at the same level with that of the original mesh model. However, the warpage of the elements is influenced much compared with the other three criteria, because the RBF method treats the mesh vertices as scattered points. This problem can be further resolved by enforcing planar constraints on the deformed mesh [34].

The computational efficiency is evaluated in terms of the time spent for each deformation. Recalling the Eqs. (7) and (4), there are two major computational costs for the RBF method. One is the process of solving the linear system (or fitting, see Eq. (7)) which depends on the number of RBF centers involved in computation. The other relates to the evaluation process where distances between each mesh vertex and the RBF centers are computed. The computational expense is shown in Table 4
                     . For the global deformation of front rail (FR-Global), the process of evaluating the basis functions 
                        ϕ
                        
                           (
                           
                              
                                 
                                    ‖
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ‖
                                 
                              
                              
                                 D
                              
                           
                           )
                        
                        
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           H
                           )
                        
                      requires pairwise distance computations and takes nearly 25% of time in fitting but almost 99% of time (3.22 s) in evaluation (in which 17k vertices are involved). As can be seen, local deformations only involves a small amount of RBF centers and mesh vertices which can be controlled by the user, thus they are computationally inexpensive. For the global deformation, the evaluation of the basis functions at mesh vertices can be pre-computed, stored and reused during mesh adaptation to different design variants. A single round of feature preservation requires computational time similar to that of solving a local deformation. Therefore, the prototype program is also competitive in terms of its efficiency.

@&#CONCLUSIONS@&#

In this paper, we propose a RBF method with the skeleton-section template for rapid deformation of FE meshes of thin-walled structures. The hierarchical and flexible deformation abilities provided by the proposed template-based deformation method enable fast FE mesh adaptation for design optimization as well as human interactive modeling.

Leveraging the fact that the mesh model is a single component with slender geometry, we devise a simple yet effective algorithm to construct the skeleton using Voronoi decomposition. Then we extract the cross-sections from the mesh model based on the skeleton and associate the cross-sections with the skeleton via mappings stored in the template data structure.

The constructed template is then used as a parameterization for mesh deformations. We adopt the RBF method to deform the mesh both at both global and local levels. The global deformation is realized by transferring the skeleton deformation to the cross-sections as their rigid motions. Flexible local deformations along user-prescribed directions on a surface mesh, such as creating strip-like features, are achieved by embedding the mesh into its skeleton frame field with an anisotropic distance metric. Form features can be preserved at both levels as well. Numerical examples have demonstrated the effectiveness of the proposed method.

In the future work, we plan to incorporate constraints in the proposed framework to take care of the quality of the deformed mesh. Besides, we would like to extend the proposed method to solid models and models with multiple components. Further application of the proposed method to update CAE and CAD models simultaneously is also a challenging task.

@&#ACKNOWLEDGMENTS@&#

The authors would like to extend their sincere gratitude to anonymous reviewers for their valuable comments that much improved the work. This work is supported by NSFC (11472073, 11272075, 11272077, 61173102, 61370143) and 973 National Basic Research Project of China (No. 2010CB832700).

@&#REFERENCES@&#

