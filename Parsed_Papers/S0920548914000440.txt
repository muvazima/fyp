@&#MAIN-TITLE@&#Histogram based perceptual quality assessment method for color images

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Common methods cannot distinguish those effects of low distortions on color images.


                        
                        
                           
                           Image histogram and Human Vision System based method are proposed.


                        
                        
                           
                           Color images should be measured taking into account Human Vision System.


                        
                        
                           
                           Frequency domain processes are more effective for image quality assessment.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image quality assessment

Histogram

Perceptual image quality

Fourier transform

@&#ABSTRACT@&#


               
               
                  
                     A histogram based perceptual quality assessment (HPQA) method for color images is presented in this paper. Basically, the HPQA combines two quality assessment approaches (color image quality assessment and histogram based image quality assessment) and it uses the fourier transform. Its range is between 0 and 1. 1 represents the best quality result, 0 represents the worst quality result for the HPQA. The HPQA results are more suitable than its counterparts in terms of the HVS and they can be obtained faster than the other methods' results. In addition, it can easily differentiate effects of low distortions on color images.
               
            

@&#INTRODUCTION@&#

After digital images are acquired, they are subjected to many processing or manipulations for various reasons (compression, data hiding, acquisition, coding, etc.). Image quality assessment (IQA) methods play a very essential role in almost all aspects of multimedia signal processing operations. An image can be used for visual browsing, for medical diagnosis or for extracting information via machine learning methods. The amount of measured distortion in an image may have rather different interpretations with respect to different applications and determines whether the given image has the required amount of quality to be useful for the application at hand. Therefore, it is important to develop application specific IQA methods [1–5]. An important issue in evaluation of digital image processing algorithms is to define reliable IQA methods to estimate quality.

A diagnostic image quality assessment method measures the quality of the image for the purpose of medical diagnosis. Likewise, remote sensing imagery is used to estimate some of the relevant parameters for the analysis of its content. Unbounded errors in pixel values due to compression may lead to unacceptable estimation errors in subsequent analysis. A measure used successfully in an application may provide rather poor results in a different application. Therefore, the design of an application specific IQA method is rather important.

A fundamental task in many image processing applications is the visual evaluation of a distorted image. There are many measures for examining image quality, such as Mean Square Error (MSE), Peak Signal to Noise Ratio (PSNR), PSNR-HVS-Modified [1], Structural SIMilarity (SSIM) [2], MultiScale-Structural SIMilarity (MS-SSIM) [3], Universal Quality Index (UQI) [4], and so on. The simplest and the most widely used full-reference IQA method is the MSE. It is computed by averaging the squared intensity differences of distorted and original image pixels, along with the related quantity of the PSNR. Although the PSNR is mostly used in the literature, it is not very well matched with the perceived visual quality [5].

The PSNR-HVS-M had been designed to improve the performance of the PSNR and the MSE. It divides the image into 8×8pixels non-overlapping blocks. Then, the Discrete Cosine Transform (DCT) based δ(i, j) is calculated. After that δ(i, j) difference between the original and the distorted blocks is weighed for every 8×8 block by the coefficients of the Contrast Sensitivity Function (CSF) [1]. The SSIM has followed a strategy of modifying the MSE measure so that errors are penalized in accordance with their visibility. It compares local patterns of pixel intensities that have been normalized for luminance and contrast [2]. The MS-SSIM is layered on the SSIM. The algorithm calculates multiple SSIM values at multiple image scales (resolutions). By running the algorithm at different scales, the quality of the image is evaluated for different viewing distances. MS-SSIM also puts less emphasis on the luminance component compared to the contrast and structure components. In total, MS-SSIM has been shown to increase the correlation between the MS-SSIM index and subjective quality tests. However, the trade-off is that the MS-SSIM takes longer to run than the straight SSIM algorithm [3]. The UQI has been designed by modeling any image distortion as a combination of three factors: loss of correlation, luminance distortion, and contrast distortion [4]. It is not based on Human Vision System (HVS).

In addition to the IQA methods presented above, much attempt has gone into the development of IQA methods that take advantage of well-known characteristics of the HVS in the last decade [6]. Sparking from these facts, the proposed histogram based perceptual quality assessment (HPQA) method offers a new strategy for qualifying of the color images. The HPQA combines two image quality measurement approaches. The first one is HVS based color image quality measure approach [7] and the second one is histogram based image quality measurement approach [8]. In contrast to these approaches' classical view, the processes are realized on the Fourier Transform (FT) domain because it is seen that magnitude values of the FT coefficients present more suitable results for the HVS.

The rest of the paper is organized as follows. In Section 2, YUV transformation, the Fourier Transform (FT) and image histogram are briefly introduced. The proposed method's details are explained in Section 3. Section 4 presents experimental results and comparisons with the previous works. The paper is concluded in Section 5.

A classical digital color image is represented with a 3-dimensional array composed of M rows, N columns and 3 channels (R, G and B). Row and column indexes are shown as r and c. Each element of that serial is called a picture element (pixel) (Fig. 1
                        ).

In general, each color image pixel is identified using 24 bits, i.e. 8 bits for each color channel of red, green, and blue. Color images are also classified into 2 categories, as compressed and uncompressed. Color transformation is usually used as a preprocess before the intracomponent coding in RGB color image compression [9]. A commonly preferred color transformation is from RGB (Fig. 2a) to YUV (Fig. 2b, c, and d).

YUV was originally adopted from the JPEG and JPEG 2000 standards [10]. The forward transformation and its inverse formulas (ITU-R BT.601) are given in Eqs. (1) and (2), respectively. YUV transformation not only decorrelates the original color components, but also discards some information to get lower entropy. The discarded information cannot be recovered, and thus the transformation is lossy [11–13]. This means that it is an irreversible component transform (ICT).
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             Y
                                             =
                                             0.257
                                             R
                                             +
                                             0.504
                                             G
                                             +
                                             0.098
                                             B
                                             +
                                             16
                                          
                                       
                                       
                                          
                                             U
                                             =
                                             ‐
                                             0.148
                                             R
                                             ‐
                                             0.291
                                             G
                                             +
                                             0.439
                                             B
                                             +
                                             128
                                          
                                       
                                       
                                          
                                             V
                                             =
                                             0.439
                                             R
                                             ‐
                                             0.368
                                             G
                                             ‐
                                             0.071
                                             B
                                             +
                                             128
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                                =
                                                1.1644
                                                
                                                   
                                                      Y
                                                      ‐
                                                      16
                                                   
                                                
                                                +
                                                1.596
                                                
                                                   
                                                      V
                                                      ‐
                                                      128
                                                   
                                                
                                             
                                          
                                          
                                             
                                                G
                                                =
                                                1.164
                                                
                                                   
                                                      Y
                                                      ‐
                                                      16
                                                   
                                                
                                                ‐
                                                0.813
                                                
                                                   
                                                      V
                                                      ‐
                                                      128
                                                   
                                                
                                                ‐
                                                0.391
                                                
                                                   
                                                      U
                                                      ‐
                                                      128
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                                =
                                                1.164
                                                
                                                   
                                                      Y
                                                      ‐
                                                      16
                                                   
                                                
                                                +
                                                2.018
                                                
                                                   
                                                      U
                                                      ‐
                                                      128
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

An approximated Reversible Component Transformation that originates from the JPEG 2000 standard and is called the RCT in the present work is given in Eq. (3) 
                        [14,15]. The proposed HPQA method preferably utilizes the RCT rather than the classical YUV, as its goal is not focused on digital image compression. Therefore, data loss never occurs when the RGB to YUV(RCT) (where the Y channel refers to the luminance, while U and V refer to the color information in an image) transformation is realized in the presented method. An important feature of the HVS is its different response to the luminance and color components directly related to the natural features of the eye [7], which are utilized and reflected into the proposed method with different ratios, as detailed in the following section.
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             Y
                                             =
                                             
                                                
                                                   R
                                                   +
                                                   2
                                                   G
                                                   +
                                                   B
                                                
                                             
                                             /
                                             4
                                          
                                       
                                       
                                          
                                             U
                                             =
                                             R
                                             ‐
                                             G
                                          
                                       
                                       
                                          
                                             V
                                             =
                                             B
                                             ‐
                                             G
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   G
                                                   =
                                                   Y
                                                   ‐
                                                   
                                                      
                                                         U
                                                         +
                                                         V
                                                      
                                                   
                                                   /
                                                   4
                                                
                                             
                                             
                                                
                                                   R
                                                   =
                                                   U
                                                   +
                                                   G
                                                
                                             
                                             
                                                
                                                   B
                                                   =
                                                   V
                                                   +
                                                   G
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The FT basis consists of sinusoids of varying frequency and phase. Specifically, it is sought to express a periodic signal as a weighted sum of the sinusoids:
                           
                              (4)
                              
                                 
                                    f
                                    
                                       x
                                    
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             c
                                             k
                                          
                                          cos
                                          
                                             
                                                
                                                   
                                                      2
                                                      πk
                                                   
                                                   N
                                                
                                                x
                                                +
                                                
                                                   ϕ
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the frequency of the sinusoid is ω
                        
                           k
                        
                        =2πk/N, the phase is ϕk
                        , and the weighting (or amplitude) of the sinusoid is ck
                        . The sinusoids form a basis for the set of periodic signals. That is, any periodic signal can be written as a linear combination of the sinusoids. This expression is referred to as the Fourier series [16].

In two dimensions, an M×N image can be expressed with respect to two-dimensional sinusoids:
                           
                              (5)
                              
                                 
                                    f
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       1
                                       
                                          M
                                          ×
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   c
                                                   kl
                                                
                                             
                                          
                                          cos
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                x
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                y
                                                +
                                                
                                                   ϕ
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with:
                           
                              (6)
                              
                                 
                                    
                                       c
                                       kl
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             p
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                f
                                                
                                                   p
                                                   r
                                                
                                             
                                          
                                          cos
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                p
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                r
                                                +
                                                
                                                   ϕ
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Examples of the 2-D FT basis are shown in Fig. 3
                        . From left to right are bases with increasing frequency, and from top to bottom are bases with varying orientation (i.e., relative contributions of horizontal ωk
                         and vertical ωl
                         frequencies) [16].

The 2-D FT basis can be expressed with respect to a fixed basis as:
                           
                              (7)
                              
                                 
                                    f
                                    
                                       x
                                       y
                                    
                                    =
                                    
                                       1
                                       
                                          M
                                          ×
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   a
                                                   kl
                                                
                                             
                                          
                                          cos
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                x
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                y
                                             
                                          
                                          +
                                          
                                             b
                                             kl
                                          
                                          sin
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                x
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where,
                           
                              (8)
                              
                                 
                                    
                                       a
                                       kl
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             p
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                f
                                                
                                                   p
                                                   r
                                                
                                             
                                          
                                          cos
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                p
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                r
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       b
                                       kl
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             p
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                f
                                                
                                                   p
                                                   r
                                                
                                             
                                          
                                          sin
                                          
                                             
                                                
                                                   ω
                                                   k
                                                
                                                p
                                                +
                                                
                                                   ω
                                                   l
                                                
                                                r
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The FT coefficients are complex valued. These complex valued coefficients can be analyzed in terms of their real and imaginary components, corresponding to the cosine and sine terms. This can be helpful when exploring the symmetry of the underlying signal f(x), as the cosine terms are symmetric about the origin and the sine terms are asymmetric about the origin. These complex valued coefficients can also be analyzed in terms of their magnitude and phase. Considering the complex value as a vector in the real-complex space, the magnitude and the phase angle are defined as [16,17]:
                           
                              (10)
                              
                                 
                                    
                                       
                                          c
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             a
                                             k
                                             2
                                          
                                          +
                                          
                                             b
                                             k
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (11)
                              
                                 
                                    θ
                                    =
                                    
                                       tan
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             b
                                             k
                                          
                                          
                                             a
                                             k
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The magnitude describes the overall contribution of a frequency in constructing a signal, and the phase describes the relative position of each frequency.

In statistics, a histogram is a graphical representation showing a visual impression of the distribution of data and it is used to show the frequency distribution of a set of measurements. In digital imaging, a histogram consists of tabular frequencies, shown as neighboring rectangles, raised over discrete intervals, with an area equal to the frequency of the observations in the interval. The height of a rectangle is also equal to the frequency density of the interval, i.e., the frequency divided by the width of the interval [18]. In general, histograms are the basis for numerous spatial domain processing techniques but histograms are created using FT magnitude values of each channel in this work. This approach is a major difference from the other IQA methods.

It can be seen that FT magnitude values based R, G and B histograms of the Lena images (Fig. 5) given in Fig. 4
                        . The sub-figures have been drawn as 3-D using the Matlab® mesh() function.

Although, it is believed to be that the quality of images are equal considering the PSNR values (i.e., 27.67dB), it can be seen that this is not true considering the image histograms drawn after the FT. Differences between an original image histogram and its distorted version's histogram can clearly be seen in Fig. 5
                        . From this point of view, the HPQA method has been developed and presented in this paper.

In this section, the proposed HPQA method, with the details of its four fundamental parts, i.e. the reversible YUV transformation, the FT based Histograms calculation for each YUV channel and their histograms' based quality assessment (HQA), and weighting of the HQAs considering the HVS are presented. The general structure of the HPQA method is depicted in Fig. 6
                     .

The proposed HPQA method's result is obtained in four steps as shown in Fig. 5. Each step is detailed following paragraphs.
                           
                              Step 1
                              Because an important feature of the HVS is its different response to the luminance and color components directly related to the natural features of the eye, an approximated RCT given in Eq. (3) is applied on RGB image [12,13]. The RCT is usually used when RGB to YUV transformation where Y channel refers to luminance while U and V refer to the color information in an image. YUV channels' information is utilized and reflected into the proposed method with different ratios as detailed in the following steps.

A histogram is a graphical representation showing a visual impression of the distribution of data and it is used to show the frequency distribution of a set of measurements. In digital imaging, a histogram consists of tabular frequencies, shown as neighboring rectangles, raised over discrete intervals, with an area equal to the frequency of the observations in the interval. The height of a rectangle is also equal to the frequency density of the interval, i.e., the frequency divided by the width of the interval [18,8]. It can be easily said that when some extraordinary situations can't be detected on the spatial domain, they can easily be detected on a frequency domain (i.e., FT domain). From this point of view, each YUV channel's FT coefficients are calculated at this step's first phase. Thus, the domain is changed from the time domain to FT frequency domain. At the second phase of this step, histograms are achieved for each YUV channel notated as H(YFT), H(UFT), H(VFT) for original image and, 
                                    
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                       ,
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             U
                                             FT
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             V
                                             FT
                                          
                                       
                                    
                                  for distorted image as seen in Fig. 6.

At this step, the histogram quality results (Y
                                    HQA
                                 , U
                                    HQA
                                 , V
                                    HQA
                                 ) for each channel are achieved. While this process is applied on the spatial domain histograms in [8], it is applied on the FT magnitude values' histograms in the presented work. The HQA is defined as:
                                    
                                       (12)
                                       
                                          
                                             HQA
                                             =
                                             
                                                Δ
                                                TC
                                             
                                             Factor
                                             ×
                                             HD
                                             .
                                          
                                       
                                    
                                 
                              

The first component of the HQA is ΔTCFactor (interhistogram difference factor). Histograms (H) are obtained from the original YUV image's channel (i.e., H(YFT
                                 )) and the distorted YUV image's channel (i.e., 
                                    
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                    
                                 ) is applied to the extraction process as seen below.
                                    
                                       (13)
                                       
                                          
                                             Δ
                                             =
                                             
                                                
                                                   H
                                                   
                                                      
                                                         Y
                                                         FT
                                                      
                                                   
                                                   −
                                                   
                                                      H
                                                      •
                                                   
                                                   
                                                      
                                                         Y
                                                         FT
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The Δ is a difference vector between the original and the distorted image histograms. Total change (ΔTC) between the original and the distorted image histograms can be calculated by summation of all indices of the Δ (Eq. (14)) and 0≤Δ≤2×M×N [8].
                                    
                                       (14)
                                       
                                          
                                             
                                                Δ
                                                TC
                                             
                                             =
                                             
                                                
                                                   ∑
                                                   n
                                                
                                                
                                                   
                                                      Δ
                                                      n
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Then, ΔTCFactor varying between 0 (worst) and 1 (best) is calculated using ΔTC as seen below:
                                    
                                       (15)
                                       
                                          
                                             
                                                Δ
                                                TC
                                             
                                             Factor
                                             =
                                             1
                                             −
                                             
                                                
                                                   
                                                      Δ
                                                      TC
                                                   
                                                   
                                                      Δ
                                                      
                                                         TC
                                                         max
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       Δ
                                       
                                          TC
                                          max
                                       
                                    
                                  expression means that the upper limit on the amount of histogram change is (2×M×N). The range of ΔTCFactor is [0, 1]. The best value 1 is achieved if and only if 
                                    
                                       H
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                       =
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                    
                                 .

The second component of the HQA (Eq. (12)) is the HD (Histogram Distortion) and it refers to the correlation quality between H(YFT) and 
                                    
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                    
                                 . It is calculated by the classical correlation formula as seen below:
                                    
                                       (16)
                                       
                                          
                                             HD
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            H
                                                            
                                                               
                                                                  
                                                                     Y
                                                                     FT
                                                                  
                                                               
                                                               j
                                                            
                                                            ×
                                                            
                                                               H
                                                               •
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                     FT
                                                                  
                                                               
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  
                                                                     
                                                                        Y
                                                                        FT
                                                                     
                                                                  
                                                                  j
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Like the ΔTCFactor, the best HD value is also 1, which is obtained when 
                                    
                                       H
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                       =
                                       
                                          H
                                          •
                                       
                                       
                                          
                                             Y
                                             FT
                                          
                                       
                                    
                                 . The explanations above show that the best HQA value is 1, which results when ΔTCFactor and HD values are equal to 1. The worst value of the HQA is 0, which occurs when ΔTC
                                 =
                                 
                                    
                                       Δ
                                       
                                          TC
                                          max
                                       
                                    
                                  
                                 [8]. These operations given above are sequentially applied to the other histograms (i.e., H (UFT
                                 ) and H (VFT
                                 )) and then Y
                                    HQA
                                 , U
                                    HQA
                                 , and V
                                    HQA
                                  are obtained.

This step is the last process of the HPQA method. The HQA results (Y
                                    HQA
                                 , U
                                    HQA
                                 , and V
                                    HQA
                                 ) which obtained for Y, U and V channels are weighed by considering the color image quality assessment considering the HVS specifications. These specifications are very important for perceptual property of the proposed HPQA method.

There are two types of photo-receptors in the human retina, named as rods and cones. The rods are responsible for vision at especially low light levels. They do not provide color vision and have almost no effect on spatial perception [7,19,20]. Unlike the rods, the cones are active at higher light levels, responsible for color vision and spatial perception. The fovea part of the human eye hosts the cones and rods. There are approximately 7million cones and 120million rods in the fovea [7,21–23]. The rods are extremely sensitive to light. On the other hand, the cones supply the eye's color sensitivity [7,24–26]. From these main information views, the weights on the human perception of these cone and rod sensors (i.e., CW
                         and RW
                        ) are calculated as seen below [7]:
                           
                              (17)
                              
                                 
                                    
                                       C
                                       W
                                    
                                    =
                                    7
                                    ,
                                    000
                                    ,
                                    000
                                    /
                                    
                                       
                                          120
                                          ,
                                          000
                                          ,
                                          000
                                          +
                                          7
                                          ,
                                          000
                                          ,
                                          000
                                       
                                    
                                    =
                                    0.0551
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       R
                                       W
                                    
                                    =
                                    120
                                    ,
                                    000
                                    ,
                                    000
                                    /
                                    
                                       
                                          120
                                          ,
                                          000
                                          ,
                                          000
                                          +
                                          7
                                          ,
                                          000
                                          ,
                                          000
                                       
                                    
                                    =
                                    0.9449
                                    .
                                 
                              
                           
                        
                     

The first term CW
                         as seen in Eq. (17) is the weight on the human perception of the cones. And the second term RW
                         as seen in Eq. (18) is the weight on the human perception of the rods [7].

Finally, the HPQA result can be easily obtained using Eq. (19) detailed below:
                           
                              (19)
                              
                                 
                                    HPQA
                                    =
                                    
                                       
                                          
                                             Y
                                             HQA
                                          
                                          ×
                                          
                                             R
                                             W
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                U
                                                HQA
                                             
                                             +
                                             
                                                V
                                                HQA
                                             
                                          
                                          2
                                       
                                    
                                    ×
                                    
                                       C
                                       W
                                    
                                    .
                                 
                              
                           
                        
                     

Inclusion of this new weighted approach, considering the human eye's different response to the luminance and color, leads to the superiority of the proposed HPQA method measure over the classical IQA methods.

@&#EXPERIMENTAL RESULTS@&#

An original Lena image and its sample distorted versions depicted in Fig. 6 are used for a detailed experimental study. They are tuned with all well-known distortions (i.e., sharpen, median, salt & pepper, jpeg compression, gaussian noise and blurring) to yield the same PSNR values relative to the original image. The HPQA and the classical PSNR results for all of the figures are given in Fig. 7
                     . The PSNR results for Fig. 7b, c, d, e, f and g are the same (i.e., 27.67dB), meaning that the imposed different distortions have the same effect on the test image contrary to the fact based on at least basic perceptual evaluation. This implies that the PSNR parameter solely does not enable distinguishing for all probable cases between the original image and the distorted images [7]. Therefore, it exhibits a very poor performance for a kind of numeric IQA. In addition to these, using the proposed HPQA method it can be statistically distinguished that not only the quality of the distorted image given in Fig. 7
                     g is 0.5011 and much worse than the ones in Fig. 7b, c, d, e and f but also all of them have returned differentiating values that well match with perceptual results.


                     Fig. 8
                      presents the obtained survey results to sort of the distorted images (Fig. 7b, c, d, e, f, g) in terms of HVS compatibility. In this work, the presented survey was performed over 200 undergraduate students by the author. Students were requested a question which is graded using a six-point scale (excellent=6, very good=5, good=4, fair=3, poor=2, very poor=1) similar to Likert scale. The request was “Please provide quality value for each image considering your perceptual feelings”. At the end of the survey, Fig. 7b was graded as the best image by 56 students. The other images' survey results are similar with the HPQA method's results (Fig. 8).

There are several perceptual measures such as PSNR, PSNR-HVS-Modified [1], MS-SSIM [2], SSIM [3] and UQI [4] in order to evaluate the proposed HPQA method (Table 1
                     ). Considering the other IQA methods, it can be stated that these methods also produce differentiating results, like the proposed HPQA method, with respect to the PSNR. However, the PSNR-HVS-M results prove to be false, as they indicate that the image quality for Fig. 7d is better than that of Fig. 7b, and Fig. 7f is better than those of Fig. 7c and e, as opposed to a straightforward visual analysis of all the figures. MS-SSIM produces different quality results but they are too close to each other. This means that MS-SSIM cannot differentiate enough quality differences. Similarly, the SSIM and the UQI results prove to be false, as they indicate that the image quality for Fig. 7g is better than that of Fig. 7c. These results are not consistent with the HVS, too.

An original Peppers image and its sample five distorted versions (under speckle noise (mean 0 and variance (σ
                     2)) are used for the other experimental study (Fig. 9
                     ).


                     Fig. 10a shows the classical PSNR and the PSNR-HVS-M results. In addition to these, the MS-SSIM, the SSIM, the UQI and the HPQA results are depicted in Fig. 10b. The figures show that while the other IQA methods' result characteristics are seen as exponential distribution, the HPQA method's results are seen as linear distribution in parallel of variance increase. This situation is one of the main characteristics of the HPQA method.

The assessment speed is also an important criterion in some practical situations, such as the IQA while working on image database system. The tests were performed on Intel® Core i7 Q720 CPU running at 1.60GHz with 6GB RAM, and the proposed scheme was implemented in Matlab® R2009b. As shown in Table 2
                     , the proposed method is about 31 times faster than the PSNR-HVS-M and better than the SSIM, the UQI, and the MS-SSIM. That's why the proposed HPQA method can greatly be used on the IQA.

In addition to the valuable results presented above, 24 test images (downloaded from Stanford Center for Image Systems Engineering) [27] shown in Fig. 11
                      have been used for additional experimental study in order to evaluate the proposed HPQA method. All test images have been coded by Least Significant Bit (LSB) data hiding method (all images have same hidden data (1.5bits per pixel)) because the LSB method affects less than the other distortions to images [28]. Thus, sensitivity of IQA methods has been tested against small distortions.

It can be easily seen that the PSNR results on Table 3
                      are the same (i.e., 51.14dB). Similarly, the MS-SSIM results are the same (i.e., 0.999) except the result of k05. In addition, the PSNR-HVS-M, the SSIM and the UQI methods provide repeatable and very close results. This implies that low distortions on images cannot be differentiated by commonly used IQA methods. On the contrary, the proposed HPQA method can easily differentiate the visual effects of low distortions on images. It can be seen that the HPQA results are between 0.407 and 0.943.

The experimental results presented in this section are based on the well-known images under different distortions. These images and an easy MATLAB® implementation of the proposed HPQA method are made available online: http://www.turgutozal.edu.tr/yyalman/contents/yyalman/files/HPQA.zip.

@&#CONCLUSIONS@&#

After digital images are acquired, they are subjected to many processing or manipulations for various reasons. IQA methods presented in the literature play a very important role in almost all aspects of multimedia signal processing operations. The histogram based full-reference perceptual quality assessment (HPQA) method is presented for color images in this paper. Some of the quality aspects cannot be measured in time domain, but this situation can be opposite in the frequency domain. From this point of view, the HPQA combines the color image quality approach and the histogram based image quality approach with the help of the Fourier transform.

Quality results' ranges are between 0 and 1 in most IQA methods. 1 represents the best quality result, 0 represents the worst quality result for the HPQA. Experimental studies about the applicability of the HPQA on a well-known test image under 6 different distortions (median, jpeg, blurring, speckle, etc.), both perceivable by the HVS and with the same PSNR value (i.e. 27.67dB), are presented. The HPQA results are more suitable than its counterparts in terms of the HVS and they can be obtained faster than the other IQA methods' results. In addition, the HPQA can easily differentiate the effects of low distortions on color images.

@&#ACKNOWLEDGMENTS@&#

The author would like to thank the anonymous reviewers and the Editor for their valuable comments and suggestions as well as Prof. Dr. Ismail Erturk for his encouragement and guidance in this presented research work.

@&#REFERENCES@&#

