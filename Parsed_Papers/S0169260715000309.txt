@&#MAIN-TITLE@&#
               AnaSP: A software suite for automatic image analysis of multicellular spheroids

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a new software suite to analyze brightfield images of spheroids.


                        
                        
                           
                           
                              AnaSP estimates several morphological parameters in a very limited time.


                        
                        
                           
                           We proved the high accuracy of the segmentation method proposed.


                        
                        
                           
                           Both AnaSP source code and a standalone executable version are freely available.


                        
                        
                           
                           The GUI developed makes AnaSP effective even without expertise in computer vision.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

High-content screening

Widefield microscopy

Cancer 3D model

Multi-cellular aggregates

Pre-clinical oncology

Image processing

@&#ABSTRACT@&#


               
               
                  Today, more and more biological laboratories use 3D cell cultures and tissues grown in vitro as a 3D model of in vivo tumours and metastases. In the last decades, it has been extensively established that multicellular spheroids represent an efficient model to validate effects of drugs and treatments for human care applications. However, a lack of methods for quantitative analysis limits the usage of spheroids as models for routine experiments. Several methods have been proposed in literature to perform high throughput experiments employing spheroids by automatically computing different morphological parameters, such as diameter, volume and sphericity. Nevertheless, these systems are typically grounded on expensive automated technologies, that make the suggested solutions affordable only for a limited subset of laboratories, frequently performing high content screening analysis. In this work we propose AnaSP, an open source software suitable for automatically estimating several morphological parameters of spheroids, by simply analyzing brightfield images acquired with a standard widefield microscope, also not endowed with a motorized stage. The experiments performed proved sensitivity and precision of the segmentation method proposed, and excellent reliability of AnaSP to compute several morphological parameters of spheroids imaged in different conditions. AnaSP is distributed as an open source software tool. Its modular architecture and graphical user interface make it attractive also for researchers who do not work in areas of computer vision and suitable for both high content screenings and occasional spheroid-based experiments.
               
            

@&#INTRODUCTION@&#

Nowadays, it has been extensively established that monolayer cultures are a deficient model to validate the effects of drugs and treatments for different human care applications [1]. In particular, numerous cell types have been shown to behave differently when cultured in 3D conditions [2]. In this scenario, animal models are extensively used to perform in vivo experiments [3]. Nevertheless, the use of animals is highly controversial due to ethical and scientific reasons. For instance, interspecies’ differences in drug metabolism and toxicity between human and animal cells can jeopardize the assessment of the efficacy of the treatments [4]. Consequently, more and more biological laboratories produce and use 3D cell cultures and tissues grown in vitro as models of in vivo tumours [5] and metastases [6]. Mimicking the in vivo tumour microenvironment more closely than traditional monolayer cultures [7], they span the gap between standard 2D cultures and whole-animal models [8]. In particular, multicellular spheroids, cell aggregates of “large” dimensions (i.e., up to 2mm of diameter [9]), are routinely employed as 3D in vitro models for testing drug dosages [10], radiotherapy treatments [11], and in general to define new care protocols for different tumours types [12]. Furthermore, they are also exploited as a tool for creating complex tissues [13].

The spheroids were originally proposed as a useful 3D model to study cancer in vitro by Sutherland et al. in the second half of the Twentieth century [14], and over time several different systems have been proposed to build spheroids and promote a wider usage in pre-clinical research and pharmaceutical development [15]. In particular, Kelm and Fussenegger [16] listed numerous cell lines able to form multicellular aggregated, and Achilli et al. [17] presented an extensive overview of systems available to build spheroids (e.g., antigravity bioreactors [18] and hanging drop plates [19]). Once built, to proceed with high-content screening experiments [20], the spheroids are then typically manually transferred (by using a pipette) in multi-well plates (one spheroid for well), typically a 384 [21] or a 96-well plate [22]. The morpho-biological organization of the cells composing the spheroids largely depends on the spheroids’ size [12,23,24]. In particular, the gradient of oxygen and glucose from the outer cell layers determines a stratification of cells characterized by different proliferation ratios [25]. Moreover, beyond a critical size of about 500μm, central necrosis develops in most of the spheroids built from permanent cell lines [26]. Consequently, the spheroids’ core results similar to the avascular hypoxic regions of tumours [27]. In practice, the spheroids are considered a useful in vitro tumour model for a very wide range of applications [24].

Already in 2008 Lin and Chang [28] reported that more than 500 scientific articles describing multicellular spheroids as a tumour model used in drug and radiotherapy had been published. And the number of studies based on spheroids is quickly soaring. In these studies, many different biological, and morphological, parameters are typically monitored. For instance, diameters [25], perimeter [29], area [30], volume [31], and sphericity [32]. However, a lack of quantitative analysis’ methods limits the usage of spheroids as a reliable model and routine assessment of emerging therapies [33].

In this work we proposed AnaSP, a software suitable for analyzing spheroids and automatic computation of different morphological parameters, then correlated to the effect of drug dosages and treatments. AnaSP can be used in high throughput experiments, even high content screening based on spheroids. Four main reasons make AnaSP particularly attractive: First of all, AnaSP has been designed for experiments performed not necessarily using an automated microscope (i.e., endowed with a motorized stage). In practice, the images of the spheroids, typically placed in a multi-well plate (a single spheroid for each well) can be acquired manually, one at a time, by simply using a standard widefield microscope. Starting from the acquired images, AnaSP automatically computes the binary mask of the spheroid (i.e., black and white mask with value 1 assigned to the pixels belonging to the spheroid) and several morphological parameters, such as minor and major axis, equivalent diameter, perimeter, area, volume and sphericity. The only assumption we made is that the spheroids are characterized by a local spherical symmetry, and the only condition required is that every image to be analyzed contains a single spheroid of interest. In case of more spheroids present in the image, AnaSP by default analyses the biggest one, although a working modality considering more spheroids of similar size can be selected. Second, AnaSP was designed by using a modular architecture, allowing the user to choose which morphological parameters to compute automatically for each spheroid analyzed, also with the possibility of adding new parameters to be computed. Third, AnaSP is endowed with a Graphical User Interface (GUI) designed according to requirements provided by biologists that have no programming skills, and following their suggestions. Accordingly, it results particularly user friendly also for users not familiar with computer vision. Only the design of new functions, related to new morphological parameters to be estimated, requires some programming skills, but the template we provided with the source code of AnaSP strongly reduces the difficulties that could be met. Finally, AnaSP is distributed as an open source software tool written in MATLAB (©, The MathWorks, Inc., Natick, MA, USA), and both the source code and a standalone executable version (i.e., not requiring MATLAB being installed) are freely available at: http://sourceforge.net/p/anasp, together with sample images that can be downloaded as well. This allows a wide distribution of the software, also helping to increase the number of laboratories involved in performing spheroid-based high throughput experiments.

The experiments performed by using real-world images of spheroids, of different cell lines, and acquired under different setup conditions, proved the high sensitivity and precision of the segmentation method proposed, and the effectiveness of AnaSP to accurately estimate several morphological parameters of the spheroids in a very limited amount of time. Concluding, we proved that AnaSP can be used to perform quantitative spheroid-based high throughput experiments, and also occasional experiments with a limited number of spheroids, without requiring any expensive instrumentation (e.g., automated microscopes, cytometer, plate readers) and computer vision skills.

The next sections are organized as follows: Section 2 presents a short overview of the approaches available to automatically compute morphological parameters in spheroid-based experiments, Section 3 provides a detailed description of the proposed approach, Section 4 describes the material used in the experiments performed to validate the segmentation method proposed, while the results are presented and discussed in Section 5. Section 6 reports important notes to extend the use of AnaSP also to researchers not familiar with Information Technology. Finally, Section 7 summarizes the main findings of the work.

In the last years, several methods have been proposed in literature to perform high throughput experiments by using spheroids, automatically computing different morphological parameters. For instance, five years ago (i.e., 2009), Friedrich et al. [34] in a very interesting article, described most of the typical problems of a spheroid-based drug screen, and proposed a standardized setup for reproducible routine analysis of multicellular spheroids. In particular, in collaboration with Zeiss (Oberkochen, Germany), they established a semi-automated measurement protocol to determine diameters and volumes of spheroids from phase-contrast images through image-processing algorithms built-in in the Zeiss AxioVision 4.5 software. Nevertheless, the detailed description of the methods used was not provided.

Three years later (i.e., 2012), Waschow et al. [30] presented the commercial Operetta® High Content Imaging System (PerkinElmer, Hamburg, Germany), an automated microscope capable of acquiring fluorescence and bright-field images from samples contained in microplates or on slides. The system was equipped with a spinning-disk confocal scanner that suits confocal imaging of 3D spheroids. Image acquisition, as well as image analysis, was performed by using the Harmony® High Content Imaging and Analysis Software. In the same year, Vinci et al. [22] developed another complete automated suite for in vitro spheroid-based assays. They demonstrated that combining the use of ultra-low attachment round-bottom plates, containing a single spheroid for each well, with a fully automated high quality technology imaging system, it is possible to utilize the spheroids efficiently for high throughput experiments. In particular, for imaging and analysis they exploited a Celigo™ cytometer (Cyntellect Inc., San Diego, CA, USA), which is a benchtop in situ automated image analysis system providing high quality images of wells using brightfield or fluorescent illumination, and the Cell Counting Confluence application to segment the spheroids. Similarly, Celli et al. [33] introduced one year later (i.e., 2013) a new image-based platform, called qVISTA, for quantitative in situ treatment assessment in 3D tumour models. The multicellular aggregates were carried in glass-bottom multi-well plates and each well was automatically imaged by using a scanning stage. The images were then segmented by using a built-in MATLAB routine, based on Otsu thresholding segmentation [35], and major and minor axis, equivalent diameter, volume and other morphological parameters of each segmented object were calculated. Nevertheless, the systems proposed by Waschow, Vinci, and Celli, based respectively on a spinning-disk microscope, a cytometer and an automated scanning stage, are affordable only by a subset of laboratories, often the ones that perform large high content screens.

Contrarily, for a drug toxicity screen, Timm et al. [36] proposed a custom image analysis code, still written in MATLAB, to measure morphological parameters of multicellular aggregates without requiring any expensive instrumentation. In particular, they proposed an approach based on images acquired by using a mobile device. Nevertheless, the proposed image processing method was not validated and only the algorithm's pseudocode was provided, this limiting testing possibility. Similarly, Rodday et al. [20] proposed an interesting approach to monitor the size of spheroids that requires as equipment only entry-level and common hardware and software (i.e., Adobe Photoshop, Microsoft Excel). Nevertheless, accuracy and precision of the method were tested using only industrial precision steel beads, which are trivial to be segmented and not representative of the wide variety of spheroid segmentation problems [34]. Furthermore, the approach proposed required the operator to set different parameters, this making the reliability of the data obtained highly operator-dependent.

Recently, Soubiès et al. [37], Reid et al. [38], and Härmä et al. [39] proposed methods useful to analyze spheroids imaged by using fluorescent microscopes. In particular, Soubiès et al. proposed a method to segment cell nuclei present in the field of view by fitting regular ellipsoidal shapes. The method seems to be attractive, but its applicability to accurately segment spheroids is strongly limited because irregular shapes (e.g., spheroids with protuberances) are not contemplated. Reid et al. described an algorithm to automatically compute both fluorescent intensity and area of a 2D projection of spheroids. The algorithm could be extended also to work in brightfield or phase-contrast. Nevertheless, the accuracy of the proposed segmentation method is unknown, and no software is provided. Contrarily, Härmä et al. distributed a standalone program to compute several morphological parameters by analyzing z-stacks of confocal images of spheroids. The software can be applied also to phase-contrast images but, differently from what we propose, it was not conceived to work with user-defined parameters (for instance, major and minor axis length and volume currently cannot be computed).

Finally, specifically to segment phase-contrast and brightfield images of spheroids, Bayramoglu et al. [40] proposed in 2014 a simple linear iterative cluster-based segmentation. The software code was not provided, this limiting testing possibility and, above all, the method was not validated with any ground truth. Contrarily, Chen et al. [41] freely provided a user-friendly software application implemented in MATLAB with the main purpose of helping researchers to perform size measures of spheroids acquired in brightfield. However, it requires a MATLAB licence (comprising also some additional toolboxes) and a standalone version of the application is not provided. In addition, it was devised to analyze only single-spheroid images, placed in the centre of the field of view, requiring that the background of the image is “clean”, that is free of debris, impurities, or smaller cell aggregates. In addition, although the user can select among several parameters, adding one's own formula it is not easy and requires programming skills. For instance, the volume is currently computed by using the formula of the ellipsoid that was proven to be incorrect for most of cases [42].


                     AnaSP was designed to perform spheroid-based high throughput experiments by automatically extracting morphological parameters from brightfield images of spheroids. Fig. 1
                      outlines the main stages of the approach conceived.

One of the main features of AnaSP is that it does not require any prior information either expensive technologies. It was designed to work with brightfield images that can be simply manually acquired by using a common widefield microscope. The spheroids must be well contrasted on the background (typically, they are visualized as a black mass floating in a bright-coloured culture medium) and the border of the spheroids must be in-focus. In particular, to be sure of acquiring an image with the spheroids’ border well in-focus, a z-stack of images can be acquired and an open-source algorithm can be exploited to reconstruct a single image completely in-focus [43]. In addition, every image to be analyzed must contain one spheroid only. Nevertheless, whereas the input images contain more spheroids, for each image AnaSP automatically analyses the biggest spheroid present. However, allocating the spheroids in a multi-well plate (still with one spheroid for each well) is suggested and, because of the size of the spheroids used in the experiments (typically having diameters from 0.25mm to 2mm), a good choice may be using a low attachment 96-well round-bottom plate together with a 4× magnification lens. If the size of spheroids prevents them from being completely visualized, then mosaicing techniques [44–46] can be exploited to reconstruct one large image (namely, a mosaic), representing the entire spheroid. It is worth noting that a widefield microscope provides only a visualization from the top (or the bottom, in the case of an inverted microscope), which results in a single projection of a cross-section of the spheroid. However, due to gravity, spheroids lie on the bottom of the plate, typically in a stable equilibrium position. Accordingly, it is reasonable assuming that whereas the border of the spheroid is focused, the image acquired depicts the widest cross-section of the spheroid, and this must be taken into consideration to correctly estimate parameters, such as its volume.

In the approach proposed, the images acquired are first automatically converted in grey levels. Whereas the images are characterized by an evident uneven illumination field, correcting for vignetting [47] is suggested to visualize the spheroids as a homogeneous dark mass, well contrasted on the background. To cope with the main systems used to maintain the spheroids during an experiment (e.g., flat-bottom and round-bottom multi-well plates), we implemented an algorithm to check automatically if the spheroid is contained in a conic well (e.g., GravityTRAP™, InSphero, Schlieren, Switzerland), typically visualized in brightfield as a dark tube (Fig. 2
                        ). Briefly, the image is binarized through the Otsu's method and all the pixels at the border of the binary image obtained are checked to assess that they are black. In this case, the hole at the bottom of the cone is automatically detected in the binary image by fitting the border of the white inner circle (i.e., the background). Finally, the hole of the cone represents the Region Of Interest (ROI) for the subsequent stage, the spheroid's segmentation.

The simple, but yet effective, method designed to automatically segment the spheroids is the core of AnaSP. Once the input image has been converted in grey levels, and the ROI to be analyzed has been automatically defined, the spheroid is segmented by following a coarse-to-fine approach, based on the analysis of the intensity histogram, similarly to the approach proposed in [45]. Fig. 3
                         depicts the main steps of the approach proposed. First of all, the intensity histogram is analyzed through the automatic triangle segmentation method [48] to find out a coarse threshold value to segment the dark objects in the image. Then, morphological operations (i.e., closing followed by hole filling) are used to reconstruct the border of the spheroid, usually brighter than the central part. Finally, a size area filtering is performed to delete small objects representing, for instance, dust or smaller aggregates, that can be present in the image. These simple steps, reported in the validation paragraph of the experimental results section, lead us to obtain a fine segmentation of the spheroids in a short time.

However, also to cope with cases where the automatic segmentation fails, two additional modules, a semi-automatic and a manual one, were implemented in AnaSP to provide the user with a complete suite allowing to segment all the images acquired. In practice, sometimes the automatic segmentation of the spheroids may fail (for instance, in presence of a non-homogeneous background errors in the analysis of the intensity histogram can be introduced). When it occurs, AnaSP asks the user to define a small ROI surrounding the spheroid, through selecting its upper-left and lower-right corners. The ROI is then analyzed by following the steps previously reported and this leads to segment successfully most of the images. For the cases in which also the semi-automatic method fails, an interactive module inspired by the “ROI manager” plug-in of ImageJ 
                        [49] (an open source image processing software widely used in microscopy for different purposes) was implemented to allow the user to manually segment the spheroid by simply drawing a line following the spheroid's border. In this way, AnaSP provides a solution to effectively segment all the images acquired.

The modular architecture of AnaSP allows the user to select which morphological parameters to compute automatically for each spheroid to be analyzed. Furthermore, we provided a template function, useful for designing their own functions to estimate more morphological parameters (e.g., number of protuberances per spheroid, degree of indentation of the spheroid's border). The definition of the parameters to be computed is trivial: all the functions stored in the folder “DATAtoBeExtracted”, in the installation directory, are automatically computed. By default, the following parameters are automatically estimated:
                           
                              -
                              major and minor axes, computed as the length in pixels of the maximum and minimum straight lines passing thought the centre of mass of the spheroid;

diameter of the equivalent circle, computed as the diameter of the circle having the same area as the area of the cross-section of the spheroid analyzed;

perimeter (P), that is the number in pixels of the outer border of the spheroid;

area (A), meant as the amount of pixels belonging to the foreground mask of the cross-section of the spheroid analyzed;

volume (V), according to the method proposed in [42], obtained by reconstructing the 3D morphology of the spheroid, stemming from the 2D cross-section analyzed by supposing a local spherical symmetry around the maximum axis, and finally computed as the number of voxels inner to the 3D surface obtained;

sphericity (S), according to Eq. (1), proposed in [32]:

The values of the parameters estimated are stored in a table format (Fig. 4
                        ) reporting for each row the name of the original image (identifying each spheroid), and in columns the values of the parameters estimated. The values can also be exported as a Microsoft Excel table or a MATLAB file.

To validate the segmentation algorithm implemented, we used several images of spheroids for different high content screenings. In particular, we used three sets of 50 images each, for a total amount of 150 spheroids that were segmented and analyzed.

The first set (Set01) was composed of spheroids of A549 cells, a commercial cell line derived from a primary lung cancer (American Type Culture Collection, ATCC, Rockville, MD, USA). The spheroids were built by using a RCCS-8DQ bioreactor (Synthecon, Inc., Houston, TX, USA) [18], a common commercial system to grow multicellular aggregates. A detailed description regarding cell preparation and the protocol used to create the spheroids can be found in [17]. Once created, the spheroids were grown in F12K medium (ATCC) supplemented with 10% fetal bovine serum (FBS, EuroClone, Milan, Italy), and maintained in a low-attachment flat-bottom plastic 96-well plate.


                     Set02 was composed of 50 images of spheroids, still built with the RCCS-8DQ bioreactor, but using a cell line obtained from a skin recurrence of a 68-year-old man who underwent thoracotomy for a moderately differentiated squamous cell carcinoma of the lung with bone involvement. These cells were named CAEP, starting from the initial letters of the words “epidermoid carcinoma” [50]. These spheroids were then maintained in a plastic low-attachment flat-bottom 96-well plate, containing a mixture of equal parts of Dulbecco's modified Eagle's medium (DMEM) and Ham's media, supplemented with 10% fetal calf serum (FCS), 1% l-glutamine, and 1% insulin.

The last set (Set03) composed of 50 spheroids of A549 cells, was built by using a GravityPLUS™ hanging-drop plate [19] (InSphero, Schlieren, Switzerland) following the standard protocol provided by the manufacturer. These spheroids were maintained in a 96-well GravityTRAP™ plate (InSphero), with the wells specifically designed with a conic shape to improve the spheroid maintenance and the culture medium exchange.

An inverted Olympus IX51 microscope equipped with a Nikon Digital Sight DS-Vi1 camera (CCD vision sensor, square pixels of 4.4μm side length, 1600×1200 pixel resolution, 3-channel images, 8-bit grey level) was used to acquire the images of the spheroids. In particular, all the images were acquired in brightfield using an Olympus UPlanFl 4×/0.13na as a standard objective lens. Fig. 5
                      reports few images of the three sets used in the experiments. At first sight, it is evident that the illumination conditions strongly changed during the acquisition of the different images, also within the same set. This mainly because the images were acquired in different days, for different high content screenings where the segmentation was always manually performed. Thus, keeping the illumination conditions constant was not necessary. It is worth noting that in order to have fewer impurities (e.g., debris, smaller aggregates), all the images were acquired after changing the culture medium.

@&#EXPERIMENTAL RESULTS@&#

In order to assess the reliability of the segmentation approach, two different sets of experiments were carried out by comparing the segmentation masks automatically obtained with ground truth, after evaluating the computational performance of the algorithm implemented. In particular, in the first experiment we computed the absolute error of the different parameters estimated (e.g., area, perimeter, etc.). In the second one, we estimated precision and sensitivity of the binary masks automatically obtained for the different spheroids.

The tests of the experiments were performed using an entry-level PC (Intel Core i5, CPU 2.27GHz, 4 GB RAM), processing 1600×1200 8-bit RGB images stored on the hard disk. The ground truth segmentations of the spheroids were created using the “ROI manager” plug-in of ImageJ and a professional digital drawing tablet (Intuos Pro, Wacom, Vancouver, WA, USA). The time elapsed to manually segment the 150 images of Set01, Set02 and Set03 was measured, and the average computational time was of about 160sec per image. With AnaSP, it took 15sec per image, and the most relevant computational burden was due to the automatic detection of the hole of the cone necessary in case of spheroids contained in conic-shaped wells, such as the ones of GravityTRAP™ plates. If the spheroids are contained in standard multi-well plates (e.g., low-attachment flat-bottom 96-well plate) the average computational time for automatically segmenting the spheroids shrank to about 3sec per image. Furthermore, it is worth noting that so far the algorithm is implemented in a research prototype and no parts of the algorithm have been specifically optimized.

Finally, it is worth pointing out that AnaSP automatically segmented 145 out of 150 images used in the experiments. In particular, 143 images where automatically segmented, 2 images were segmented according to the assisted procedure, while the remaining 5 images (not considered in the further experiments) were manually segmented through the AnaSP built-in module.

In order to assess the reliability of the estimation of the parameters of the approach proposed, the absolute percentage error (E%) was computed according to Eq. (2):
                           
                              (2)
                              
                                 
                                    E
                                    %
                                    =
                                    
                                       
                                          
                                             
                                                G
                                                T
                                                −
                                                v
                                             
                                             
                                                G
                                                T
                                             
                                          
                                       
                                    
                                    ×
                                    100
                                    ,
                                 
                              
                           
                        where GT is the ground truth value estimated for each parameter by using the ground truth mask manually segmented, and v is the value estimated by using the spheroid's mask obtained with AnaSP. The morphological parameters considered were major and minor axis, equivalent diameter, perimeter, area, volume and sphericity. Table 1
                         reports mean (μ) and standard deviation (σ) of E% values estimated for the different parameters. The results are reported separately considering Set01, Set02 and Set03, and also considering all the images automatically segmented. For each parameter, the error value achieved for the spheroids belonging to Set01 was always the best, followed by the value of Set02 and finally by Set03. One reason could be that it is easier to achieve accurate ground truth segmentation masks in Set01 than in Set02 or Set03. As far as the latter is concerned, the manual process is complicated by the fact that many spheroids are attached to the hole's border of the conic well of the plate (e.g., Fig. 5g). As regards Set02, the fact that CAEP cells spheroids are full of numerous protuberances and protrusions (see, for instance, Fig. 5d–f), prevents the manual segmentation from being accurate. Considering all the parameters, it is interesting noting that the worst values are the ones that refer to perimeter. However all the error values were lower than 5% (except for the values related to perimeter referring to Set03 and to all images).

For each image, sensitivity (also called true positive rate, TPR) and precision (also called positive predictive value, PPV) were computed according to Eq. (1)
                        
                           
                              (3)
                              
                                 
                                    T
                                    P
                                    R
                                    =
                                    
                                       
                                          T
                                          P
                                       
                                       
                                          T
                                          P
                                          +
                                          F
                                          N
                                       
                                    
                                    ,
                                 
                              
                           
                        and Eq. (4):
                           
                              (4)
                              
                                 
                                    P
                                    P
                                    V
                                    =
                                    
                                       
                                          T
                                          P
                                       
                                       
                                          T
                                          P
                                          +
                                          F
                                          P
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

True positive (TP) are the ground-truth pixels correctly detected as belonging to spheroid, false positive (FP) are the pixels erroneously assigned to spheroids, and FN (false negative) are the pixels of the spheroids that have been missed. Table 2
                         reports μ and σ of TPR and PPV computed by comparing the spheroids automatically segmented with their ground truth. The values obtained for Set01 and Set02 resulted perfectly comparable: both sensitivity and precision tends to 100%. For Set03 the error values are slightly higher; however, this worsening can be scarcely noticed at first sight. Nonetheless, sensitivity was higher than 96%, and precision higher than 97%. The same assessment can be made for TPR and PPV obtained by considering the three sets together.


                     AnaSP is written in MATLAB and it is freely distributed as an open source software tool. In particular, the source code and a standalone executable version can be found at: http://sourceforge.net/p/anasp, and all the images used in the experiments are available on demand. AnaSP is endowed with a simple GUI (Fig. 6
                     ), subdivided into two separate sections: the first addresses the segmentation stage of the spheroids, and the second is specific for the data estimation. As regards the segmentation stage, the only parameters required are: (a) the input/output folders, that are the locations where the original images of the spheroids to be segmented are stored and where the output binary masks must be saved and (b) the name of the image to be analyzed (in case of a single image). Furthermore, through a drop down menu it is also possible to define the segmentation mode, choosing between: fully automatic, semi-automatic (where the manual segmentation is automatically enabled when the automatic segmentation fails), and fully manual. Furthermore, the user can also choose a working modality (i.e., “Multiple objects segmentation”) where all the spheroids present in the image are segmented and analyzed, except for objects with area lower than 10% with respect to the largest spheroid. In the second section, related to the data extraction stage, the only input parameter required is the folder where the binary masks to be analyzed are stored. Whereas more spheroids have been segmented, for each spheroid the output table reports a row summarizing the values of the different parameters estimated and the row are listed starting from the largest spheroid analyzed. In practice, AnaSP represents a complete suite to segment and analyze all the spheroid images acquired without requiring any other software tool. It is worth noting that AnaSP automatically checks if input path contains subfolders and in that case it automatically browses all the subdirectories to separately analyze all the images contained. This can happen for instance, for different treatments in follow-up studies, for drug response analyses, when data of spheroids are stored under different subfolders. The output of the segmentation stage is a folder tree, with same structure as the input folders, containing the binary masks computed. Similarly, the output of the parameter estimation stage is a different table, summarizing the values of the parameters estimated, for each input folder analyzed. Finally, the trend curves for the different parameters estimated can be either plotted directly in MATLAB, or with one's preferred tool after exporting the different tables as Microsoft Excel files.

This work presented a new approach designed for automatic morphological image analyses of spheroids cultures. In particular, we described AnaSP, an open source image-based software tool, specific for estimating a number of morphological parameters of spheroids by simply analyzing brightfield images manually acquired with a standard widefield microscope. In the last years, several approaches have been proposed to estimate diameters, area, volume, etc., of spheroids in order to evaluate the effects of drug dosages and radiobiological treatments. Nevertheless, these methods rely on dedicated equipments or prior information, and typically the segmentation methods proposed have not been validated. In AnaSP, a standard widefield microscope is used to acquire, one at a time, the images of the spheroids to be analyzed, and not any particular requirement or equipment is needed.

After proving that AnaSP is able to effectively analyze a high number of images in a very limited time, and that it works appropriately for images of spheroids acquired under very different conditions, two sets of experiments were performed to validate the approach proposed. In the first one, the value of several morphological parameters automatically estimated with AnaSP was compared with the related ground truth. In the second one, sensitivity and precision of the segmentation method were estimated. The results obtained proved the excellent capability of AnaSP to automatically analyze spheroids. Moreover, the modular architecture and the GUI developed make the use of AnaSP effective even without requiring any expertise in computer vision. Furthermore, the open source nature and the very limited processing time make AnaSP appealing for a wide variety of plate readers specific to analyze culture of spheroids (e.g., Dainippon SCREEN Cell3iMager, InSphero, and ImageXpress® Micro Widefield High Content Imaging System, Molecular Devices).

Several improvements may be considered, in particular as regards the estimation of the ROI to be analyzed in case of spheroids contained in plates with conic-shaped wells. Actually, the implemented method resulted accurate, but not optimized from a computational point of view. Reducing the computational cost of the method would make it suitable also for real-time applications addressed to spheroids monitoring and analysis. Furthermore, AnaSP has a modular architecture to support the implementation of new functions to estimate different morphological parameters. It would be interesting to organize in modules also the segmentation stage to allow the user to implement, or choose, different segmentation methods.

The author declares that he has no conflict of interest.

@&#ACKNOWLEDGEMENTS@&#

The author wishes to thank Alessandro Bevilacqua (Computer Vision Group, University of Bologna) for numerous helpful suggestions and comments on the manuscript; InSphero (Schlieren, Switzerland) to supply the hanging-drop plates used to build the spheroids; Anna Tesei (Biosciences Laboratory, IRCCS—Istituto Scientifico Romagnolo per lo Studio e la Cura dei Tumori, Meldola, FC, Italy) for her practical contribution to build and maintain the cell cultures used in this work; Panagiota Dimopoulou (Imola, Italy) for editorial assistance and English revision.

@&#REFERENCES@&#

