@&#MAIN-TITLE@&#Sustainable trade credit and replenishment decisions with credit-linked demand under carbon emission constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider sustainability issues on the joint trade credit and inventory decisions.


                        
                        
                           
                           We analyze the models under various environmental regulations.


                        
                        
                           
                           The effects of carbon emission parameters are performed in rigorous discussions.


                        
                        
                           
                           The influence of environmental costs on the problem is significant.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Environmental regulation

Inventory

Trade credit

Default risk

Carbon emissions

@&#ABSTRACT@&#


               
               
                  In this paper, we consider issues of sustainability in the context of joint trade credit and inventory management in which the demand depends on the length of the credit period offered by the retailer to its customers. We quantify the impacts of the credit period and environmental regulations on the inventory model. Starting with some mild assumptions, we first analyze the model with generalized demand and default risk rates under the Carbon Cap-and-Trade policy, and then we make some extensions to the model with the Carbon Offset policy. We further analytically examine the effects of carbon emission parameters on the retailer’s trade credit and replenishment strategies. Finally, a couple of numerical examples and sensitivity analysis are given to illustrate the features of the proposed model, which is followed by concluding remarks.
               
            

@&#INTRODUCTION@&#

Trade credit is a common phenomenon in the current business environment. In today’s competitive business environment, many businesses have no pricing power. To avoid lasting price competition, businesses use credit as part of the pricing strategy and provide credit terms to their customers to gain a competitive edge. We can observe that businesses often provide credit terms to allow their customers to make purchases today and pay for them at a later date without any additional charges. Since trade credit can reduce the customer’s inventory holding cost, lengthening the credit period may create reputation among potential customers and consequently gain increased market share. In recent years, a large amount of attention has been devoted to the models for inventory replenishment policies involving trade credit policy. The analysis of the effect of trade credit policy on the economic order quantity (EOQ) model began with Goyal (1985), who studied an EOQ model under the condition of permissible delay in payments. Since the deterioration of inventory items is a common phenomenon in daily life because of poor storage and preservation quality, Aggarwal and Jaggi (1995) and Hwang and Shinn (1997) extended the model of Goyal (1985) to consider the deterministic inventory model with a constant deterioration rate. Later on, Jamal, Sarker, and Wang (1997) extended Aggarwal and Jaggi’s model (1995) to allow for shortages. Since Jamal et al. (1997) did not provide a procedure to find the global minimum, Hsieh, Dye, and Ouyang (2008) complemented the shortcomings of Jamal et al. (1997) and showed that the optimal solution for each case not only exists but is unique under specific circumstances. Chang and Dye (2001) then extended this issue to the inventory model with time-varying deterioration rate and time-dependent partial backlogging. In addition, Teng (2002) amended Goyal’s (1985) model by considering the difference between unit price and unit cost, and found that it makes economic sense for the retailer to order less quantity to take advantage of the payment delay more frequently. Huang (2003) developed an EOQ model in which a supplier offers a retailer the permissible delay period M, and the retailer in turn provides the trade credit period N (with N ≤ M) to its customers. Chang, Ouyang, and Teng (2003) presented an inventory model for the items with constant demand and deterioration rates under supplier credits linked to ordering quantity. Chang and Dye (2005) investigated the effects of time-varying demand and deterioration rates in the inventory model when the credit period depends on the retailer’s ordering quantity. Recently, to accommodate more practical features of the real inventory systems, there are also many research efforts that consider trade credit in deteriorating inventory models. Sana and Chaudhuri (2008), Tsao and Sheen (2008), Tsao (2010), Geetha and Uthayakumar (2010), Ho (2011), Sarkar (2012), Chen, Teng, and Skouri (2013), Lou and Wang (2013), Tsao (2013), Chern, Chan, Teng, and Goyal (2014), and Chen and Teng (2014) are such studies.

However, the above-mentioned papers mainly take the buyer’s perspective of finding the optimal ordering policies under a given credit period, but little is known about how to determine the optimal length of the credit period for the retailer. For agreement with the practical inventory situation, Jaggi, Goyal, and Goel (2008) established an inventory model to analyze the impact of credit-linked demand on retailer’s replenishment behavior. Although sales can be stimulated by trade credit, longer credit period ties up the business capital in receivables, and this affects cash flow directly and increases the probability of a customer default. Therefore, trade credit management needs to balance the trade-off between increased sales and default risk of granting credit. Recently, Teng and Lou (2012) incorporated the credit-linked demand and default risk to establish an EOQ model for the retailer in a supply chain with up-stream and down-stream trade credits. Meanwhile, Lou and Wang (2012) extended the classical EOQ model by introducing the credit-linked demand and default risks. Based on the results of Teng and Lou (2012) and Lou and Wang (2012), numerous research works, such as Wu and Chan (2014), Wang, Teng, and Lou (2014), Wu, Ouyang, Cárdenas-Barrón, and Goyal (2014) and Teng, Lou, and Wang (2013), constructed and analyzed inventory models for deteriorating items with expiration dates under different environmental scenarios and focused on how to determine the optimal credit period for the retailer. Chern, Pan, Teng, Chan, and Chen (2013) and Chern et al. (2014) discussed the vendor–buyer inventory-production models with trade credit risk in a supply chain. However, the rates of demand and default risk in the above-mentioned studies are all assumed to be specific functions of the credit period.

In recent years, the greenhouse effect and global warming have gained much attention due to stronger and more frequent extreme weather events. To slow down the greenhouse effect and global warming, the so-called Kyoto Protocol was signed in 1997 as a result of the United Nations Framework Convention on Climate Change (UNFCCC). The purpose of the Kyoto Protocol was to reduce greenhouse gas emissions from industrial countries to 5.2 percent below levels in 1990 between 2008 and 2012. The protocol also introduced three flexible mechanisms—International Emissions Trading, Joint Implementation, and the Clean Development Mechanism. One of the most effective market-based mechanisms in Kyoto Protocol is Emissions Trading (also known as Cap-and-Trade) which has been broadly adopted by the United Nations system. This mechanism puts a mandatory limit on emissions to all the firms, and allows firms to buy or sell rights to emit carbon dioxide within the cap. To meet targets for the carbon emissions reduction set by the Kyoto Protocol, many countries or regions have made either voluntary or regulatory efforts to reduce their carbon emissions, e.g. the World Bank’s BioCarbon Fund, the EU Emissions Trading System, the US Chicago Climate Exchange and the Midwestern Regional Greenhouse Gas Reduction Accord etc. Since carbon is the basic element in fossil energy, cutting carbon equals to cost savings and operational efficiency. Recently, the impact of carbon emissions on operations management has drawn more academic attention. Benjaafar, Li, and Daskin (2010) first presented a series of model formulations that illustrate how carbon emission considerations can be incorporated into operational decision-making with regard to procurement, production and inventory managements. Bonney and Jaber (2011) examined some possible environmental consequences of common inventory activities and suggested that all functions within the product life cycle should be looked at from an environmental point of view. They also provided a simplified inventory model with some environmental costs to illustrate how the business could determine inventory parameters in an environmental context. Arslan and Turkay (2010), Hua, Cheng, and Wang (2011), Bouchery, Ghaffari, Jemai, and Dallery (2012) and Chen, Benjaafar, and Elomri (2013) considered single product replenishment problems with carbon emission considerations and analytically examined the impacts of carbon regulatory mechanisms on ordering decisions. Meanwhile, Song and Leng (2012) investigated the classical newsvendor problem under various carbon emissions policies. Hua, Qiao, and Jian (2011) extended the same issue to the price-sensitive demand under the Carbon Cap-and-Trade policy. Since transportation is a main source of carbon emission, Absi, Dauzère-Pérès, Kedad-Sidhoum, Penz, and Rapine (2013) analyzed multi-sourcing lot-sizing problem with various carbon emission constraints: Periodic, Cumulative, Rolling and Global carbon emission constraints. They also showed that the first case is solvable in polynomial time, while the three others are NP-hard. Zhang and Xu (2013) extended the multi-item newsvendor problem to the multi-item production-planning problem with finite capacity under the Carbon Cap-and-Trade policy. Bozorgi, Pazour, and Nazzal (2014) examined an inventory model for cold items in which the emission and costs associated with transportation are represented in the non-linear objective function. They also analyzed the trade-off between the cost function and emission function, and observed that the emission function is more sensitive to deviation from optimality than the cost function. For a detailed survey on the literature of inventory models considering carbon emissions, we refer the readers to Benjaafar et al. (2010) and the references therein for more details on the subject. However, the above mentioned papers do not take into account the effect of the deterioration on the inventory model, which plays an important role in settling a replenishment strategy.

Customers prefer longer credit periods as lengthening payment period will stimulate sales growth. However, this ties up with retailer’s capital and will increase the risk of default. Furthermore, a higher demand leads to greater carbon emissions. Sustainable development is the main policy of economic development nowadays. In order to achieve the sustainable development, many countries are implementing environmental regulations to restrict the carbon emissions for public or private sectors. Since the environmental regulations will impact business decisions at any time, the joint trade credit and inventory replenishment strategies for a deteriorating product need to take into account the effect of environmental issues. The inventory system for deteriorating items with trade credit policy has been an object of study for a long time, but little is known about the effects of trade credit risk and environmental issues. In this paper, to obtain robust and general results, we extend previous knowledge of inventory control and trade credit policy by incorporating environmental considerations and exploring the impacts on the retailer’s inventory replenishment and trade credit strategies. The objective of this study is to determine the following joint decisions: (1) how long the credit period should be made and (2) inventory replenishment policy. We contribute to two streams of literature: (1) the inventory model with credit risk, and (2) the inventory model subject to environmental considerations. While the first stream of literature always assumes the demand and default risk rates to be specific functions of credit period, the second stream of literature typically ignores the deterioration of product.

The remainder of this paper is organized as follows. In Section 2, we first present the deteriorating inventory model with trade credit policy under the Carbon Cap-and-Trade policy with generalized demand and default risk rates, and then rigorously analyze the effects of carbon emission parameters on the retailer’s inventory replenishment and trade credit strategies. Using the obtained theoretical results, we make further extensions to the deteriorating inventory model under the Carbon Offset policy. In Section 3, a couple of numerical examples and sensitivity analysis are given to illustrate the features of the proposed model. Finally, the conclusions and suggestions for future research are given in Section 4. All the proofs are delegated to Appendix A.

This paper studies the following optimal inventory replenishment model under various carbon emissions policies. A single product is considered sold and backorders are allowed. In addition, the goods under consideration are perishable. Let the inventory cycle represent the time interval between two consecutive orders, we assume that the demand in each inventory cycle is known with certainty and depends on the retailer’s credit period offered to the customers. The credit period means the length of time after the delivery date before a customer has to pay for the goods. The objective is to maximize the total profit after the default risk. At the beginning of each inventory cycle, there are two major decisions the retailer needs to determine simultaneously: (1) an available credit period before the start of inventory cycle; and (2) an optimal replenishment strategy to satisfy demands in each inventory cycle. Let n be the credit period offered by the retailer to its customers, the demand is given by a demand function D(n), which is assumed to be nonnegative, continuous and twice differentiable. Because credit trade allows customers to enjoy the benefits of delayed payments, lengthening the period will stimulate sales. The longer the credit period is, the higher is the demand. Hence, demand strictly increases in the credit period, that is D′(n) > 0. Meanwhile, since a longer credit period may tie up the retailer’s capital and then increase the risk of default, the rate of default risk giving the credit period n is assumed to be F(n), where F′(n) > 0.

Let t
                     1 and T respectively denote the time at which the inventory level reaches zero and length of the inventory cycle, where 0 < t
                     1 < T. During the in-stock period, (0, t
                     1), the product deteriorates at a time-varying rate of deterioration θ(t), 0 < θ(t) < 1, and there is no repair or replacement of deteriorated units during the inventory cycle. During the stockout period, (t
                     1, T), customers will be informed of a waiting time; some stockouts are backlogged, whereas others become lost sales. We suppose here that the backorder rate is variable and is dependent on the length of the waiting time for the next replenishment. Therefore, the fraction of shortages backordered, denoted by β( · ), is a decreasing function of the length of waiting time, and 0 < β( · ) < 1 with β(0) = 1. For convenience, and without loss of generality, we also assume that the delivery lead-time is zero, and thus orders are delivered immediately. Given the assumptions and notation above, the behavior of the inventory system during the replenishment period [0, T) can be exhibited in Fig. 1
                     .

For notational convenience we introduce the notation to be used throughout this paper. Let K be the ordering cost per order, c be the unit purchasing cost, p (p > c) be the selling price per unit, h be the holding cost per unit per unit time, s be the backorder cost per unit per unit time. π is the goodwill cost of lost sales per unit and r is the discount rate. Furthermore, since we consider the deteriorating inventory model under different carbon emissions policies, we introduce the carbon emission parameters as follows to account for carbon emissions. Let E be the carbon price per unit emission of carbon, ϖ be the carbon cap, 
                        
                           K
                           ^
                        
                      be the amount of fixed carbon emissions per order, 
                        
                           c
                           ^
                        
                      be the amount of carbon emissions associated per unit purchased or produced and 
                        
                           h
                           ^
                        
                      be the amount of carbon emissions per unit of inventory held per unit time.

From Fig. 1, we can see that the depletion of the inventory occurs due to the combined effects of the demand and deterioration in the interval (0, t
                     1) and the demand backordered in the interval (t
                     1, T), respectively. Hence, the variation of the inventory level, denoted by I(t), with respect to time can be described by the following differential equation:

                        
                           (1)
                           
                              
                                 
                                    
                                       d
                                       I
                                       (
                                       t
                                       )
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                −
                                                D
                                                (
                                                n
                                                )
                                                −
                                                θ
                                                (
                                                t
                                                )
                                                I
                                                (
                                                t
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                                <
                                                t
                                                <
                                                
                                                   t
                                                   1
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                D
                                                (
                                                n
                                                )
                                                β
                                                (
                                                T
                                                −
                                                t
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                   1
                                                
                                                <
                                                t
                                                <
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     with the boundary condition I(t
                     1) = 0. Solving the differential equation, we get the inventory level as follows:

                        
                           (2)
                           
                              
                                 I
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      ∫
                                                      
                                                         t
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   
                                                      e
                                                      
                                                         g
                                                         (
                                                         u
                                                         )
                                                         −
                                                         g
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   d
                                                   u
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ≤
                                                t
                                                <
                                                
                                                   t
                                                   1
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   −
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      ∫
                                                      
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      t
                                                   
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      u
                                                      )
                                                   
                                                   d
                                                   u
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                   1
                                                
                                                ≤
                                                t
                                                <
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           g
                           
                              (
                              z
                              )
                           
                           =
                           
                              ∫
                              
                                 0
                              
                              z
                           
                           θ
                           
                              (
                              u
                              )
                           
                           d
                           u
                        
                     . Hence, the ordering quantity per inventory cycle, denoted by Q, can be determined as

                        
                           (3)
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       =
                                    
                                    
                                       
                                          initial
                                          
                                          inventory
                                          
                                          on
                                          
                                          hand
                                          +
                                          number
                                          
                                          of
                                          
                                          backorders
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          I
                                          (
                                          0
                                          )
                                          −
                                          I
                                          (
                                          T
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             [
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                e
                                                
                                                   g
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             d
                                             t
                                             +
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             d
                                             t
                                             ]
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Then the total profit without considering carbon emissions and the amount of carbon emissions per inventory cycle can be respectively calculated as follows:

                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          TP
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      discounted
                                                      
                                                      sales
                                                      
                                                      revenue
                                                      
                                                      after
                                                      
                                                      default
                                                      
                                                      risk
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      ordering
                                                      
                                                      cost
                                                      −
                                                      purchase
                                                      
                                                      cost
                                                      −
                                                      holding
                                                      
                                                      cost
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      backorder
                                                      
                                                      cost
                                                      −
                                                      opportunity
                                                      
                                                      cost
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          p
                                          
                                             e
                                             
                                                −
                                                r
                                                
                                                n
                                             
                                          
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             [
                                             1
                                             −
                                             F
                                             
                                                (
                                                n
                                                )
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                t
                                                1
                                             
                                             +
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             d
                                             t
                                             ]
                                          
                                          −
                                          K
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          c
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             [
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                e
                                                
                                                   g
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             d
                                             t
                                             +
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             d
                                             t
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          h
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             ∫
                                             
                                                0
                                             
                                             
                                                t
                                                1
                                             
                                          
                                          
                                             ∫
                                             
                                                t
                                             
                                             
                                                t
                                                1
                                             
                                          
                                          
                                             e
                                             
                                                g
                                                (
                                                u
                                                )
                                                −
                                                g
                                                (
                                                t
                                                )
                                             
                                          
                                          d
                                          u
                                          d
                                          t
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          s
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             ∫
                                             
                                                
                                                   t
                                                   1
                                                
                                             
                                             T
                                          
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          β
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          d
                                          t
                                          −
                                          π
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             ]
                                          
                                          d
                                          t
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             K
                                             ^
                                          
                                          +
                                          
                                             c
                                             ^
                                          
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             [
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                e
                                                
                                                   g
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             d
                                             t
                                             +
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             d
                                             t
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             h
                                             ^
                                          
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             ∫
                                             
                                                0
                                             
                                             
                                                t
                                                1
                                             
                                          
                                          
                                             ∫
                                             
                                                t
                                             
                                             
                                                t
                                                1
                                             
                                          
                                          
                                             e
                                             
                                                g
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                −
                                                g
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          d
                                          u
                                          d
                                          t
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this section, we first begin with the analysis of the deteriorating inventory system under the Carbon Cap-and-Trade policy, under which, the retailer is given an initial cap for carbon emissions and allowed to buy or sell rights to emit within the cap. If the retailer’s amount of carbon emissions exceeds its carbon cap ϖ, it has to acquire additional carbon allowances on the compliance carbon trading market to cover the excess between its actual emissions and the cap. However, if the retailer’s amount of carbon emissions is lower than its carbon cap, it will be able to sell its surplus carbon allowances to other businesses on the compliance carbon trading market. The total profit per inventory cycle, denoted by f(t
                        1, T, n), is therefore given by

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             TP
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             −
                                             E
                                             ×
                                             
                                                {
                                                CE
                                                
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                −
                                                ϖ
                                                T
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                {
                                                p
                                                
                                                   e
                                                   
                                                      −
                                                      r
                                                      
                                                      n
                                                   
                                                
                                                
                                                   [
                                                   1
                                                   −
                                                   F
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   ]
                                                
                                                −
                                                
                                                   (
                                                   c
                                                   +
                                                   E
                                                   
                                                      c
                                                      ^
                                                   
                                                   )
                                                
                                                +
                                                π
                                                }
                                             
                                             D
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                                [
                                                
                                                   t
                                                   1
                                                
                                                +
                                                
                                                   ∫
                                                   
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   T
                                                
                                                β
                                                
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                                d
                                                t
                                                ]
                                             
                                             −
                                             
                                                (
                                                K
                                                +
                                                E
                                                
                                                   K
                                                   ^
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                (
                                                c
                                                +
                                                E
                                                
                                                   c
                                                   ^
                                                
                                                )
                                             
                                             D
                                             
                                                (
                                                n
                                                )
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                [
                                                
                                                   e
                                                   
                                                      g
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                −
                                                1
                                                ]
                                             
                                             d
                                             t
                                             −
                                             
                                                (
                                                h
                                                +
                                                E
                                                
                                                   h
                                                   ^
                                                
                                                )
                                             
                                             D
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                ∫
                                                
                                                   t
                                                
                                                
                                                   t
                                                   1
                                                
                                             
                                             
                                                e
                                                
                                                   g
                                                   (
                                                   u
                                                   )
                                                   −
                                                   g
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             d
                                             u
                                             d
                                             t
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             s
                                             D
                                             
                                                (
                                                n
                                                )
                                             
                                             
                                                ∫
                                                
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                T
                                             
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             β
                                             
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                             d
                                             t
                                             −
                                             
                                                [
                                                π
                                                D
                                                (
                                                n
                                                )
                                                −
                                                E
                                                ϖ
                                                ]
                                             
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Now our problem is to determine optimal credit period (i.e. n) and replenishment strategy (i.e. t
                        1 and T) which maximize the retailer’s total profit per unit time. Let 
                           
                              Π
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 ,
                                 T
                                 ,
                                 n
                                 )
                              
                              ≡
                              
                                 
                                    f
                                    (
                                    
                                       t
                                       1
                                    
                                    ,
                                    T
                                    ,
                                    n
                                    )
                                 
                                 T
                              
                           
                         denote the retailer’s total profit per unit time under the Carbon Cap-and-Trade policy, the optimization problem can then be represented formally as:

                           
                              
                                 
                                    
                                       max
                                       
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                       
                                    
                                    
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       ,
                                       T
                                       ,
                                       n
                                       )
                                    
                                    ,
                                    
                                    
                                    s.t.
                                    
                                    0
                                    <
                                    
                                       t
                                       1
                                    
                                    <
                                    T
                                    
                                    
                                    and
                                    
                                    
                                    n
                                    ≥
                                    0.
                                 
                              
                           
                        
                     

As we can note from (6) that if the retailer closes the system ( i.e. t
                        1 = 0, n = 0 and T → ∞), the cost of losing all sales per unit time is πD(0). Since the retailer can sell its carbon allowances to the carbon trading market under the Carbon Cap-and-Trade policy, the earning on the carbon trading market is ϖE. Once πD(0) ≤ ϖE, it represents that continually losing sales is more beneficial than operating an inventory system, which is not realistically feasible. Furthermore, because the inventory system should not be operated if the total profit is negative, we restrict ourselves to the case in which the retailer has finite positive total profit per unit time. More specifically, without loss of generality, we make the following assumptions on the carbon price and total profit per unit time:

                           Assumption 1
                           The cost of losing all sales per unit time is greater than the earning from selling its carbon allowances to the carbon trading market, i.e. πD(0) > ϖE.

For any given feasible credit period n, 
                                 Ω
                               = {(t
                              1, T): 0 < t
                              1 < T, f(t
                              1, T, n) ≥ 0} is a nonempty set.

We now begin to analyze the model, and our first step is to show that a unique maximizer for Π(t
                        1, T, n) exists on 
                           Ω
                         for any given feasible credit period n. The first-order conditions for an interior solution to the problem are presented in Appendix A. For the convenience of discussion, we divide 
                           Ω
                         into two parts,

                           
                              
                                 
                                    
                                       
                                          Ω
                                       
                                       1
                                    
                                    :
                                    =
                                    
                                       Ω
                                    
                                    ∩
                                    
                                       {
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          )
                                       
                                       :
                                       
                                       p
                                       
                                          e
                                          
                                             −
                                             r
                                             
                                             n
                                          
                                       
                                       
                                          [
                                          1
                                          −
                                          F
                                          
                                             (
                                             n
                                             )
                                          
                                          ]
                                       
                                       −
                                       
                                          (
                                          c
                                          +
                                          E
                                          
                                             c
                                             ^
                                          
                                          )
                                       
                                       +
                                       π
                                       −
                                       s
                                       
                                          (
                                          T
                                          −
                                          
                                             t
                                             1
                                          
                                          )
                                       
                                       ≤
                                       0
                                       }
                                    
                                 
                              
                           
                        and 
                           
                              
                                 
                                    Ω
                                 
                                 2
                              
                              :
                              =
                              
                                 Ω
                              
                              ∖
                              
                                 
                                    Ω
                                 
                                 1
                              
                           
                        . We first study the behavior of Π(t
                        1, T, n) in region 
                           Ω
                        
                        1. The following two lemmas show that the optimal solution occurs at the boundary of the feasible set, and that it not only exists but is unique.

                           Lemma 1
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, the optimal solution of Π(t
                              1, T, n) on 
                              
                                 Ω
                              
                              1 
                              occurs at the boundary of the feasible set.
                           

Next we prove that the maximum for Π(t
                        1, T, n) in the region 
                           Ω
                        
                        1 is unique by showing that 
                           
                              Π
                              (
                              
                                 t
                                 1
                              
                              ,
                              
                                 t
                                 1
                              
                              +
                              
                                 
                                    p
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                    −
                                    
                                       (
                                       c
                                       +
                                       E
                                       
                                          c
                                          ^
                                       
                                       )
                                    
                                    +
                                    π
                                 
                                 s
                              
                              ,
                              n
                              )
                           
                         is strictly pseudoconcave in t
                        1.

                           Lemma 2
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, the optimal solution of Π(t
                              1, T, n) on 
                              
                                 Ω
                              
                              1 
                              not only exists, but is also unique.
                           

As opposed to Lemma 1 the optimal solution in the region 
                           Ω
                        
                        1 occurs at its boundary, we now show that there is a unique maximizer within the interior of 
                           Ω
                        
                        2.

                           Lemma 3
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, there is a unique interior maximizer of Π(t
                              1, T, n) on 
                              
                                 Ω
                              
                              2.

Combining the above lemmas, we then summarize the main result and give a formal description of the total profit per unit time in the following theorem.

                           Theorem 1
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, there is a unique interior maximizer for Π(t
                              1, T, n) on 
                                 Ω
                              .

From the analysis carried out so far, it follows that we have a unique interior optimal replenishment strategy for any given feasible credit period n, and thus Eqs. (A.1) and (A.2) implicitly define t
                        1 and T as functions of n. Let Π*(t
                        1(n), T(n), n) denote the maximum value function of Π for a given feasible n, the problem then becomes max 
                           n ≥ 0
                        Π*(t
                        1(n), T(n), n). Furthermore, we can observe from (6) that

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                d
                                                {
                                                p
                                                
                                                   e
                                                   
                                                      −
                                                      r
                                                      
                                                      n
                                                   
                                                
                                                
                                                   [
                                                   1
                                                   −
                                                   F
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   ]
                                                
                                                −
                                                
                                                   (
                                                   c
                                                   +
                                                   E
                                                   
                                                      c
                                                      ^
                                                   
                                                   )
                                                
                                                +
                                                π
                                                }
                                             
                                             
                                                d
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             −
                                             p
                                             
                                                e
                                                
                                                   −
                                                   r
                                                   
                                                   n
                                                
                                             
                                             
                                                {
                                                r
                                                
                                                   [
                                                   1
                                                   −
                                                   F
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   F
                                                   ′
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                }
                                             
                                             <
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        so that there is a unique n, say 
                           
                              
                                 n
                                 ¯
                              
                              ,
                           
                         such that 
                           
                              p
                              
                                 e
                                 
                                    −
                                    r
                                    
                                    n
                                 
                              
                              
                                 [
                                 1
                                 −
                                 F
                                 
                                    (
                                    n
                                    )
                                 
                                 ]
                              
                              −
                              
                                 (
                                 c
                                 +
                                 E
                                 
                                    c
                                    ^
                                 
                                 )
                              
                              +
                              π
                              =
                              0
                           
                        . It is obvious to see that Π(t
                        1, T, n) is always negative if 
                           
                              n
                              ≥
                              
                                 n
                                 ¯
                              
                              ,
                           
                         and hence 
                           
                              n
                              ¯
                           
                         is the upper bound for n. Therefore, we can reduce our problem as follows: 
                           
                              
                                 max
                                 
                                    0
                                    ≤
                                    n
                                    ≤
                                    
                                       n
                                       ¯
                                    
                                 
                              
                              
                                 Π
                                 *
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 ,
                                 T
                                 
                                    (
                                    n
                                    )
                                 
                                 ,
                                 n
                                 )
                              
                           
                        . By Berge’s Maximum Theorem, since the maximum value function Π*(t
                        1(n), T(n), n) is continuous in the closed and bounded interval 
                           
                              [
                              0
                              ,
                              
                                 n
                                 ¯
                              
                              ]
                              ,
                           
                         the Weierstrass Theorem guarantees the existence of a global maximum in the interval 
                           
                              [
                              0
                              ,
                              
                                 n
                                 ¯
                              
                              ]
                           
                        . Further, if there exists an interior solution to this problem, by Envelope Theorem, the first-order condition for optimality of n* is 
                           
                              
                                 
                                    d
                                    
                                       Π
                                       *
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       T
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       n
                                       )
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              =
                              
                                 
                                    ∂
                                    Π
                                    (
                                    
                                       t
                                       1
                                    
                                    ,
                                    T
                                    ,
                                    n
                                    )
                                 
                                 
                                    ∂
                                    n
                                 
                              
                              =
                              0
                           
                        . Moreover, if Π*(t
                        1(0), T(0), 0) > 0 and 
                           
                              
                                 
                                    d
                                    
                                       Π
                                       *
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       T
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       n
                                       )
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              
                                 |
                              
                              
                                 
                                 
                                    n
                                    =
                                    0
                                 
                              
                              >
                              0
                              ,
                           
                         at least one 
                           
                              n
                              ∈
                              (
                              0
                              ,
                              
                                 n
                                 ¯
                              
                              )
                           
                         exists such that 
                           
                              
                                 
                                    d
                                    
                                       Π
                                       *
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       T
                                       
                                          (
                                          n
                                          )
                                       
                                       ,
                                       n
                                       )
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              =
                              0
                           
                        .

However, it is not easy to determine the closed-form expressions for t
                        1, T and n due to the structure of the nonlinear system. In order to solve the problem numerically using a fairly iterative search algorithm, we prove the uniqueness of optimal credit period n to Π(t
                        1, T, n) for any given feasible (t
                        1, T) under somewhat weaker conditions. To prove this result, we need the following lemma.

                           Lemma 4
                           
                              If D(n) and 1 − F(n) are both log-concave in n, then e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is either a strictly monotone function or a constant function of n.


                              For any given feasible (t
                              1, T) with 0 < t
                              1 < T, if D(n) and 1 − F(n) are both log-concave in n,

                                 
                                    (1)
                                    
                                       if
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                             >
                                             0
                                             ,
                                          
                                        
                                       then there exists a unique optimal
                                       
                                          
                                             n
                                             ∈
                                             [
                                             0
                                             ,
                                             
                                                n
                                                ¯
                                             
                                             ]
                                          
                                        
                                       such that Π(t
                                       1, T, n) is maximum.
                                    


                                       if
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                        
                                       then the optimal value of n is 0.


                        Theorem 2 indicates that, for any given feasible (t
                        1, T), there exists a unique value of 
                           
                              n
                              ∈
                              [
                              0
                              ,
                              
                                 n
                                 ¯
                              
                              )
                           
                         which maximizes Π(t
                        1, T, n). Once 
                           
                              
                                 
                                    d
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    D
                                    
                                       (
                                       n
                                       )
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    n
                                    =
                                    0
                                 
                              
                              ≤
                              0
                              ,
                           
                         since e
                        −r 
                           n
                        
                        D(n)[1 − F(n)] is either a strictly monotone function or a constant function of n, it represents that 
                           
                              
                                 
                                    d
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    D
                                    
                                       (
                                       n
                                       )
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              ≤
                              0
                           
                         and the discounted marginal revenue after default risk is less than or equal to zero. Clearly, under this circumstance, there is no benefit for the retailer to offer the customer a credit period. And thus, the retailer should shorten its credit period as much as possible. Furthermore, the following remark is trivial from Theorems 1 and 2.

                           Remark 1
                           If 
                                 
                                    
                                       
                                          d
                                          
                                             e
                                             
                                                −
                                                r
                                                
                                                n
                                             
                                          
                                          D
                                          
                                             (
                                             n
                                             )
                                          
                                          
                                             [
                                             1
                                             −
                                             F
                                             
                                                (
                                                n
                                                )
                                             
                                             ]
                                          
                                       
                                       
                                          d
                                          n
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          n
                                          =
                                          0
                                       
                                    
                                    ≤
                                    0
                                    ,
                                 
                               from Theorem 2, the optimal value of n for any given feasible (t
                              1, T) is 0. Hence, the uniqueness of global maximizer for the problem, 
                                 
                                    
                                       max
                                       
                                          0
                                          <
                                          
                                             t
                                             1
                                          
                                          <
                                          T
                                       
                                    
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       ,
                                       T
                                       ,
                                       0
                                       )
                                    
                                    ,
                                 
                               follows immediately from Theorem 1.

Combining the observations proven in the aforementioned lemmas and theorems, we then give a fairly iterative search algorithm, which guarantees convergence to a stationary point (if it exists), to find the global maximum for the inventory problem under the Carbon Cap-and-Trade policy.

                           Algorithm 1
                           
                              
                                 
                                    
                                       Step 1
                                    
                                    Compute 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                          
                                       . If 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                        then go to Step 2; otherwise go to Step 3.

Set n* = 0 and find the optimal values of t
                                       1 and T, denoted by 
                                          
                                             t
                                             
                                                1
                                             
                                             *
                                          
                                        and T*, from Eqs. (A.1) and (A.2); and then go to Step 7.

Start with k = 0 and choose the initial trial value n
                                       0, where 
                                          
                                             0
                                             ≤
                                             
                                                n
                                                0
                                             
                                             ≤
                                             
                                                n
                                                ¯
                                             
                                          
                                       .

For a given credit period nk
                                       , find the optimal values of t
                                       1 and T, denoted by t
                                       1, k
                                        and Tk
                                       , from Eqs. (A.1) and (A.2).

Use the results gained from Step 2 to determine the optimal value of n, denoted by n
                                       
                                          k + 1, from (A.3).

If the difference between n
                                       
                                          k + 1 and nk
                                        is sufficiently small (e.g., |n
                                       
                                          k + 1 − nk
                                       | < 0.00005), set n* = nk
                                       , then 
                                          
                                             (
                                             
                                                t
                                                
                                                   1
                                                   ,
                                                   k
                                                
                                                *
                                             
                                             ,
                                             
                                                T
                                                k
                                                *
                                             
                                             ,
                                             
                                                n
                                                
                                                   k
                                                
                                                *
                                             
                                             )
                                          
                                        is the optimal solution and go to Step 7. Otherwise, set k = k + 1 and return to Step 4.

Stop.

To begin the search, we first determine whether 
                           
                              
                                 d
                                 
                                    e
                                    
                                       −
                                       r
                                       
                                       n
                                    
                                 
                                 D
                                 
                                    (
                                    n
                                    )
                                 
                                 
                                    [
                                    1
                                    −
                                    F
                                    
                                       (
                                       n
                                       )
                                    
                                    ]
                                 
                              
                              
                                 d
                                 n
                              
                           
                         is positive or not in Step 1. In Step 2, since the total profit per unit time is non-increasing in credit period, we have n* = 0. Then the uniqueness of interior global maximizer for Π(t
                        1, T, 0) is guaranteed from Theorem 2 and Remark 1. Next, to begin the search for the case 
                           
                              
                                 
                                    d
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    D
                                    
                                       (
                                       n
                                       )
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    d
                                    n
                                 
                              
                              >
                              0
                              ,
                           
                         we might choose 
                           
                              
                                 n
                                 0
                              
                              =
                              
                                 
                                    n
                                    ¯
                                 
                                 2
                              
                           
                         for our initial guess in Step 3. In Step 4 where Theorem 1 is applied, there is a unique local maximum solution (t
                        1, k
                        , Tk
                        ) of Π(t
                        1, T, nk
                        ) for current nk
                        . Then the value of Π(t
                        1, k
                        , Tk, n
                        
                           k + 1) is improving in Step 5 where Theorem 2 is applied. Further, by using the results in Theorems 1 and 2, it is not difficult to see that Π(t
                        1, k
                        , Tk, n
                        
                           k + 1) > Π(t
                        1, k
                        , Tk, nk
                        ) and Π(t
                        1, k
                        , Tk, nk
                        ) > Π(t
                        1, k − 1, T
                        
                           k − 1, nk
                        ), and hence Π(t
                        1, k
                        , Tk, nk
                        ) = Π*(t
                        1(nk
                        ), T(nk
                        ), nk
                        ) is a monotone increasing sequence. Since Π*(t
                        1(n), T(n), n) is continuous on a closed bounded interval 
                           
                              [
                              0
                              ,
                              
                                 n
                                 ¯
                              
                              
                              ]
                              ,
                           
                         
                        Π*(t
                        1(n), T(n), n) is bounded. By Monotone Convergence Theorem, the procedure repeating Steps 4 and 5 would converge to a local maximum (if it exists) of Π(t
                        1, T, n). Therefore, by using several starting values of n, the algorithm can be repeated to identify the global maximum solution.

After establishing the optimality of the deteriorating inventory problem under the Carbon Cap-and-Trade policy, we explore some important properties related to the optimal credit period, carbon emissions and total profit per unit time. Recall that Theorem 1 indicates that the optimal values of t
                        1 and T are implicit functions of the credit period n. In addition, since the optimal values of t
                        1 and T always occur in the interior of 
                           Ω
                        
                        2, so 
                           Ω
                        
                        1 can be excluded from further discussion. Consequently, from now on in this section, we shall always assume that t
                        1 and T are functions of n and 
                           
                              p
                              
                                 e
                                 
                                    −
                                    r
                                    
                                    n
                                 
                              
                              
                                 [
                                 1
                                 −
                                 F
                                 
                                    (
                                    n
                                    )
                                 
                                 ]
                              
                              −
                              
                                 (
                                 c
                                 +
                                 E
                                 
                                    c
                                    ^
                                 
                                 )
                              
                              +
                              π
                              −
                              s
                              
                                 (
                                 T
                                 −
                                 
                                    t
                                    1
                                 
                                 )
                              
                              >
                              0
                           
                        . The following proposition establishes the monotone relationship between the optimal credit period and carbon price.

                           Proposition 1
                           
                              For any given feasible (t
                              1, T) and ϖ with 0 < t
                              1 < T and πD(0) > ϖE, if the conditions in 
                              Theorem 2 
                              are met and if f(t
                              1, T, 0) > 0 and
                              
                                 
                                    
                                       
                                          d
                                          f
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                       
                                          d
                                          n
                                       
                                    
                                    
                                       |
                                    
                                    
                                       
                                       
                                          n
                                          =
                                          0
                                       
                                    
                                    >
                                    0
                                    ,
                                 
                               
                              then the optimal credit period is strictly decreasing in the carbon price.
                           

Further, Proposition 2 states the relationships among the optimal carbon emissions per unit time, total profit per unit time and carbon price.

                           Proposition 2
                           
                              For any given feasible n and ϖ such that 
                              
                                 Ω
                               
                              is a nonempty set and πD(0) > ϖE,

                                 
                                    (1)
                                    
                                       The optimal carbon emissions per unit time is strictly decreasing in the carbon price.
                                    


                                       The optimal total profit per unit time is strictly pseudoconvex in the carbon price.
                                    

The intuition behind the propositions above is simple. Since a higher carbon price causes a greater inventory operating cost, providing a shorter credit period would actually accelerate cash flow and reduce the risk of granting credit. Hence, the retailer should tighten its credit period to maximize profit as the carbon price increases. Meanwhile, because a lower demand will be induced when the retailer tightens its credit period offered to the customers, this causes directly a decrease in total profit and the carbon emissions. However, when the carbon price is high enough, since the retailer can sell its surplus allowances to earn more profit on the carbon trading market, the optimal total profit increases strictly as the carbon price increases.

Finally, the following proposition characterizes the effect of carbon cap on the optimal carbon emissions and total profit per unit time.

                           Proposition 3
                           
                              For any given feasible n and E such that 
                              
                                 Ω
                               
                              is a nonempty set and πD(0) > ϖE,

                                 
                                    (1)
                                    
                                       The optimal carbon emissions per unit time remains constant as carbon cap increases.
                                    


                                       The optimal total profit per unit time is linearly increasing in carbon cap.
                                    


                        Proposition 3 implies that the optimal replenishment strategy is not affected by carbon cap under Carbon Cap-and-Trade policy, and so that the optimal carbon emissions per unit time remains constant as the carbon cap increases. Furthermore, because the retailer can sell its surplus allowances to earn more profit on the carbon trading market, the optimal total profit per unit time increases linearly as the carbon cap increases.

In this subsection, we extend the above results to analyze the model with the Carbon Offset policy. The Carbon Offset policy allows individuals and businesses to compensate for their carbon emissions by funding a project or activity around the world that reduces or stores greenhouse gases. The project might involve rolling out clean energy technologies or soaking up CO2 directly from the air through the planting of trees. Unlike the Carbon Cap-and-Trade policy is a regulatory market-based mechanism for carbon emissions control, the carbon offsets are typically voluntary. Hence, the Carbon Offset policy can be referred to as project-based mechanisms (i.e. Clean Development Mechanism and Joint Implementation) under the Kyoto Protocol. Based on above brief description, we know that the retailer needs to pay for carbon emissions reductions occurring elsewhere with unit price E in order to offset its excess emissions under the Carbon Offset policy. Therefore, the retailer’s total profit per unit time, denoted by Π
                        CO(t
                        1, T, n), can be then represented as

                           
                              (7)
                              
                                 
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       ,
                                       T
                                       ,
                                       n
                                       )
                                    
                                    =
                                    
                                       
                                          TP
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                       T
                                    
                                    −
                                    E
                                    ×
                                    max
                                    
                                       {
                                       
                                          
                                             CE
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                          T
                                       
                                       −
                                       ϖ
                                       ,
                                       0
                                       }
                                    
                                    .
                                 
                              
                           
                        One can easily observe that the model with Carbon Offset policy is similar to the model with Carbon Cap-and-Trade policy except for the selling of surplus carbon allowances is allowed in the cap and trade system. To analyze the problem clearly, for any given feasible n, we divide the problem into two sub-problems:

                           Case 1
                           
                              
                                 
                                    
                                       
                                          max
                                          
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                          
                                       
                                       
                                       
                                       
                                          
                                             TP
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                          T
                                       
                                       ,
                                       
                                       
                                       
                                       s.t.
                                       
                                       
                                          
                                             CE
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                          T
                                       
                                       −
                                       ϖ
                                       ≤
                                       0
                                       
                                       
                                       and
                                       
                                       
                                       T
                                       >
                                       
                                          t
                                          1
                                       
                                       >
                                       0
                                    
                                 
                              
                           

and

                           Case 2
                           
                              
                                 
                                    
                                       
                                          max
                                          
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                          
                                       
                                       
                                       
                                       
                                          
                                             TP
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                          T
                                       
                                       −
                                       E
                                       
                                          [
                                          
                                             
                                                CE
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             T
                                          
                                          −
                                          ϖ
                                          ]
                                       
                                       ,
                                       
                                       s.t.
                                       
                                       
                                          
                                             CE
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       −
                                       
                                       ϖ
                                       >
                                       0
                                       
                                       and
                                       
                                       T
                                       >
                                       
                                          t
                                          1
                                       
                                       >
                                       0
                                    
                                 
                              .

In Case 1, the amount of retailer’s carbon emissions is constrained to be less than or equal to the mandatory carbon emission capacity ϖ, whereas in Case 2, the retailer should pay for its exceed emissions with unit price E. Then the optimal total profit per unit time for the model under the Carbon Offset policy is to select the maximum between Case 1 and Case 2. Let ϖWC denote the corresponding optimal carbon emissions per unit time in the model without carbon constrain and ϖCT denote the corresponding optimal carbon emissions per unit time in the model with Carbon Cap-and-Trade policy for a given carbon price E. We next study the effects of carbon parameters on the optimal carbon emissions and total profit per unit time for each case, the following two propositions state and prove these results formally.

                           Proposition 4
                           
                              In 
                              Case 1, for any given feasible n and ϖ such that 
                              
                                 Ω
                               
                              is a nonempty set and πD(0) > ϖE,

                                 
                                    (1)
                                    
                                       There exists a unique global maximum for the retailer’s total profit per unit time.
                                    


                                       The optimal carbon emissions per unit time first increases strictly, and then remains constant as the carbon cap increases.
                                    


                                       The optimal total profit per unit time first increases strictly, and then remains constant as the carbon cap increases.
                                    


                              In 
                              Case 2, for any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set,

                                 
                                    (1)
                                    
                                       There exists a unique global maximum for the retailer’s total profit per unit time.
                                    


                                       The optimal carbon emissions per unit time first decreases strictly, and then remains constant as the carbon price increases.
                                    


                                       The optimal carbon emissions per unit time first remains constant, and then increases linearly as the carbon cap increases.
                                    


                                       The optimal total profit per unit time first decreases strictly, and then remains constant as the carbon price increases.
                                    


                                       The optimal total profit per unit time first increases strictly, and then decreases strictly as the carbon cap increases.
                                    

Based on the above theoretical results, we provide a criterion to determine which case shall be accepted in the following proposition.

                           Proposition 6
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, if ϖ > ϖCT, then the optimal replenishment strategy is 
                              Case 1; otherwise the optimal replenishment strategy is 
                              Case 2.

Furthermore, the following remark is trivial consequences of Propositions 4–6.

                           Remark 2
                           If ϖ = 0, from (7), since 
                                 
                                    
                                       CE
                                       (
                                       
                                          t
                                          1
                                       
                                       ,
                                       T
                                       ,
                                       n
                                       )
                                    
                                    T
                                 
                               must be positive, the carbon price per unit emission of carbon E becomes a levy charged as a penalty for carbon emissions caused by operating the inventory system. The model with the Carbon Offset policy reduces to the model with the Carbon Tax policy, which imposes a penalty on the retailer’s carbon emission in attempt to slow down the greenhouse effect and global warming. However, if E is sufficiently large, this would send a strong signal for retailer to cut its excess carbon emissions. Hence, under this circumstance, the model with the Carbon Offset policy reduces to the model with Mandatory Carbon Emissions Capacity policy (i.e. Case 1), which prohibits the amount of retailer’s carbon emissions in excess of the mandatory carbon emission capacity ϖ.


                        Proposition 7 , as outlined below, characterizes the effects of carbon parameters on the optimal carbon emissions and total profit per unit time under the Carbon Offset policy without proof as it follows immediately from Propositions 2–6.

                           Proposition 7
                           
                              For any given feasible n such that 
                              
                                 Ω
                               
                              is a nonempty set, under the Carbon Offset policy, then:
                              
                                 
                                    (1)
                                    
                                       There exists a unique global maximum for the retailer’s total profit per unit time.
                                    


                                       The optimal carbon emissions per unit time first remains constant, and then increases strictly and finally remains constant as the carbon cap increases.
                                    


                                       The optimal total profit per unit time first increases strictly, and then remains constant as the carbon cap increases.
                                    


                                       If ϖ > ϖWC, then the optimal carbon emissions per unit time remains constant as the carbon price increases; otherwise the optimal carbon emissions per unit time first decreases strictly, and then remains constant as the carbon price increases.
                                    


                                       If ϖ > ϖWC, then the optimal total profit per unit time remains constant as the carbon price increases; otherwise the optimal total profit per unit time first decreases strictly, and then remains constant as the carbon price increases.
                                    

Moreover, because the Carbon Cap-and-Trade policy allows the selling of surplus carbon allowance while the Carbon Offset policy does not, the total profit under the Carbon Cap-and-Trade policy is obviously higher after accounting for the money earned from selling the extra carbon allowance. Therefore, we have the following trivial remark.

                           Remark 3
                           For any given feasible n, the optimal total profit per unit time for the Carbon Cap-and-Trade policy is greater than or equal to the optimal total profit per unit time for the Carbon Offset policy.

To illustrate the proposed model, two types of demand and default rates are considered. In Example 1, we adopt the exponential demand and default rates used in Teng and Lou (2012), Lou and Wang (2012), Teng et al. (2013), Chern et al. (2013), Wu and Chan (2014), Wang et al. (2014) and Chern et al. (2014). Example 2 presents a linear demand rate and a truncated logistic default rate. The algorithm is implemented on a personal computer with Intel Core i5 under Mac OS X 10.9.2 operating system using Mathematica version 9.

                           Example 1
                           Consider an inventory situation where D(n) = 1000e
                              0.2n
                              , F(n) = 1 − e
                              −0.05n
                              , K = 100, r = 0.025, p = 15, c = 8, h = 1, s = 2, π = 2, 
                                 
                                    
                                       K
                                       ^
                                    
                                    =
                                    250
                                    ,
                                 
                              
                              
                                 
                                    
                                       c
                                       ^
                                    
                                    =
                                    5
                                    ,
                                 
                              
                              
                                 
                                    
                                       h
                                       ^
                                    
                                    =
                                    2.5
                                    ,
                                 
                               
                              E = 0.1, ϖ = 6500, β(x) = e
                              −x
                               and θ(t) = 0.2 + 0.1t. By applying Algorithm 1 with starting initial 
                                 
                                    
                                       n
                                       0
                                    
                                    =
                                    
                                       
                                          n
                                          ¯
                                       
                                       2
                                    
                                    =
                                    5.5750
                                 
                               yields 
                                 
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    Π
                                    
                                       (
                                       0.2235
                                       ,
                                       0.2997
                                       ,
                                       0.8513
                                       )
                                    
                                    =
                                    6430.36
                                 
                               after 7 iterations, and so that the corresponding optimal carbon emissions per unit time is 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7061.23
                                 
                              . In addition, based on Proposition 6, since ϖ = 6500 < 7061.23 = ϖCT, the optimal replenishment strategy for the Carbon Offset policy is the same as the Carbon Cap-and-Trade policy. We can then obtain the optimal total profit per unit time and corresponding carbon emissions per unit time for the model under the Carbon Offset policy as 
                                 
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    Π
                                    
                                       (
                                       0.2235
                                       ,
                                       0.2997
                                       ,
                                       0.8513
                                       )
                                    
                                    =
                                    6430.36
                                 
                               and 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7061.23
                                 
                              .

However, if we set ϖ = 7500, since the optimal replenishment strategy and carbon emissions per unit time remain constant under the Carbon Cap-and-Trade policy, we obtain 
                                 
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    Π
                                    
                                       (
                                       0.2235
                                       ,
                                       0.2997
                                       ,
                                       0.8513
                                       )
                                    
                                    =
                                    6530.36
                                 
                               and 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7061.23
                                 
                              . Further based on Proposition 6, since ϖ = 7500 > 7061.23 = ϖCT, the optimal replenishment strategy for the Carbon Offset policy is the same as the Mandatory Carbon Emissions Capacity policy. Therefore, the optimal total profit per unit time and corresponding carbon emissions per unit time for the model under the Carbon Offset policy are respectively 
                                 
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       0.2143
                                       ,
                                       0.2850
                                       ,
                                       1.1648
                                       )
                                    
                                    =
                                    6430.36
                                 
                               and 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7500
                                 
                              .

In this example, the same data as in Example 1 are used except putting D(n) = 1000 + 250n and 
                                 
                                    F
                                    
                                       (
                                       n
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       2
                                       
                                          1
                                          +
                                          
                                             e
                                             
                                                n
                                                /
                                                10
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             e
                                             
                                                n
                                                /
                                                10
                                             
                                          
                                          −
                                          1
                                       
                                       
                                          1
                                          +
                                          
                                             e
                                             
                                                n
                                                /
                                                10
                                             
                                          
                                       
                                    
                                 
                              . By applying Algorithm 1 with starting initial 
                                 
                                    
                                       n
                                       0
                                    
                                    =
                                    
                                       
                                          n
                                          ¯
                                       
                                       2
                                    
                                    =
                                    4.8268
                                    ,
                                 
                               we obtain that 
                                 
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    Π
                                    
                                       (
                                       0.2209
                                       ,
                                       0.2963
                                       ,
                                       0.8550
                                       )
                                    
                                    =
                                    6557.36
                                 
                               and 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7214.82
                                    ,
                                 
                               respectively. Meanwhile, using the result from Proposition 6, since ϖ = 6500 < 7214.82 = ϖCT, the optimal replenishment strategy for the Carbon Offset policy is the same as the Carbon Cap-and-Trade policy. Therefore, we get 
                                 
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       0.2209
                                       ,
                                       0.2963
                                       ,
                                       0.8550
                                       )
                                    
                                    =
                                    6557.36
                                 
                               and 
                                 
                                    
                                       
                                          CE
                                          (
                                          
                                             t
                                             1
                                             *
                                          
                                          ,
                                          
                                             T
                                             *
                                          
                                          ,
                                          
                                             n
                                             *
                                          
                                          )
                                       
                                       
                                          T
                                          *
                                       
                                    
                                    =
                                    7214.82
                                 
                              .

Using the same arguments as in Example 1, if we set ϖ = 7500, we can obtain the optimal total profit per unit time for the model with the Carbon Cap-and-Trade policy and the Carbon Offset police are 
                                 
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    Π
                                    
                                       (
                                       0.2209
                                       ,
                                       0.2963
                                       ,
                                       0.8550
                                       )
                                    
                                    =
                                    6657.36
                                 
                               and 
                                 
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                          *
                                       
                                       ,
                                       
                                          T
                                          *
                                       
                                       ,
                                       
                                          n
                                          *
                                       
                                       )
                                    
                                    =
                                    
                                       Π
                                       CO
                                    
                                    
                                       (
                                       0.2136
                                       ,
                                       0.2799
                                       ,
                                       1.0299
                                       )
                                    
                                    =
                                    6648.55
                                    ,
                                 
                               respectively.

Further, to ascertain whether the solutions for both models are the global maximum or not, we run the numerical results for Examples 1 and 2 with distinct starting values of 
                           
                              
                                 n
                                 0
                              
                              =
                              0
                              ,
                              
                                 
                                    n
                                    ¯
                                 
                                 40
                              
                              ,
                              
                                 
                                    2
                                    
                                       n
                                       ¯
                                    
                                 
                                 40
                              
                              ,
                              ⋯
                              ,
                              
                                 n
                                 ¯
                              
                              ,
                           
                         which are summarized in the graphical presentation. Figs. 2
                        (a) and 3(a) reveal that the total profit per unit time for both policies are, respectively, unimodal in the credit period. Thus, the local maximum obtained here from the proposed algorithm is indeed the global maximum. Moreover, we also observe from Figs. 2
                        (b) and 3(b) that increasing the value of the credit period results in an increase in the carbon emissions per unit time. The result is intuitive because a longer credit period makes the demand and ordering quantity increase higher, and this causes directly the retailer to emit more carbon into the atmosphere. Hence the amount of carbon emissions per unit time increases strictly in the credit period.

We next perform a sensitivity analysis with respect to the carbon price and cap to observe the effects on the optimal solutions for both carbon emissions policies. In the first study, we examine the effects of carbon price on the optimal credit period, carbon emissions and total profit per unit time for both carbon emissions policies; and the computed results are shown in Figs. 4
                         and 5. Note that E
                        L is the value of E such that 
                           
                              
                                 
                                    CE
                                    (
                                    
                                       t
                                       1
                                    
                                    ,
                                    T
                                    ,
                                    n
                                    )
                                 
                                 T
                              
                              =
                              ϖ
                           
                        . From Figs. 4
                        (a) and 5(a), we observe that the optimal credit period first decreases strictly, and then remains constant as the carbon price increases for the model with the Carbon Cap-and-Trade policy. This happens because a higher carbon price increases the unit inventory purchasing and holding costs; thus, providing a shorter credit period would actually accelerate cash flow and bring financial benefits. Therefore, the optimal credit period first decreases strictly as the carbon price increases. However, if the carbon price is large, since the marginal revenue increase is less than the marginal cost increase, there is no benefit for the retailer to offer the customer a credit period. Hence, the optimal credit period is zero. Moreover, because the optimal credit period decreases as the carbon price increases, this implies that the demand per unit time decreases as carbon price increases. Hence we can find from Figs. 4(b) and 5(b) that the carbon emissions per unit time decreases strictly as the carbon price increases. Finally, from Figs. 4(c) and 5(c), since the retailer can sell its surplus allowances to earn more profit from the carbon trading market, the optimal total profit per unit time first decreases strictly (i.e. E < E
                        L), and then increases strictly (i.e. E > E
                        L) as the carbon price increases.

For the model with the Carbon Offset policy, since the shadow price is always greater than or equal to E
                        L and it is worthwhile buying extra emission allowances until ϖ, the inventory system with the Carbon Offset policy reduces to that of the Carbon Cap-and-Trade policy when E ≤ E
                        L. Therefore, the optimal credit period, carbon emissions and total profit per unit time decrease strictly as the carbon price increases. Conversely, when E > E
                        L, since the shadow price is less than E
                        L and the retailer is not willing to pay for an extra allowance, the inventory system under the Carbon Offset policy reduces to that of the Mandatory Carbon Emissions Capacity policy. Under this circumstance, because the model is independent of carbon price, the optimal credit period, carbon emissions and total profit per unit time remain constant as the carbon price increases.

In the second study, we investigate the effects of the carbon cap on the optimal credit period, carbon emissions and total profit per unit time. Note that ϖCT and ϖWC respectively represent the amount of optimal carbon emissions for the model under the Carbon Cap-and-Trade policy and the model without carbon consideration. We first observe from Figs. 6
                         and 7
                         that the optimal credit period and carbon emissions per unit time remain constant as the carbon cap increases. This occurs because the carbon cap under the Carbon Cap-and-Trade policy does not affect the optimal replenishment strategy. However since the retailer can sell its surplus allowances to earn more profit from the carbon trading market, the optimal total profit per unit time increases strictly as the carbon cap increases.

For the model with the Carbon Offset policy, since the carbon emissions constraint is non-binding when ϖ ≥ ϖWC, the optimal values of the credit period, carbon emissions per unit time and total profit per unit time remain constant. On the other hand, when ϖ ≤ ϖCT, since the shadow price is always greater than or equal to E = 0.1 and it is worthwhile buying extra emission allowances until ϖ = ϖCT. Hence, the model with the Carbon Offset policy reduces to match the model under the Carbon Cap-and-Trade policy. Therefore, the optimal credit period and carbon emissions per unit time remain constant; and the optimal total profit per unit time increases strictly as the carbon cap increases. Finally, when ϖCT < ϖ < ϖWC, since the increasing of the carbon cap reduces the pressure on restricted carbon emissions, and the optimal values of the credit period, carbon emissions per unit time and total profit per unit time increase strictly as the carbon cap increases.

In this paper, we study a deteriorating inventory system under various carbon emissions policies, as well as considering the impact of trade credit risk. We demonstrate how environmental regulations can be incorporated into a joint trade credit and inventory replenishment decision making problem for a deteriorating item. The key decisions are to determine the optimal credit period and inventory replenishment strategies to maximize the total profit per unit time for the retailer. Structural properties are proved about the proposed model, and several conclusions are gathered from the numerical examples and sensitivity analysis. Our work is closely related to the growing research streams on coordinated trade credit financing and inventory management subject to environmental constraints. Compare with previous works such as Teng and Lou (2012), Lou and Wang (2012), Wu and Chan (2014), Wang et al. (2014), Wu et al. (2014) and Teng et al. (2013), Chern et al. (2013) and Chern et al. (2014), we show the model can be further extended to the case with generalized demand and default risk rates, and allow for partial backlogging. Hence, the present model helps managers to take the carbon emissions constrains into consideration to make better trade credit and inventory replenishment decisions.

Following our analysis we observe that the retailer can benefit from the trade credit policy. Our theoretical and experimental results further show that the retailer will tighten its credit period offered to the customer and reduce its carbon emission as the carbon price increases under both carbon emission regulatory policies. This is because a higher carbon price increases the retailer’s overall inventory operation cost, providing a smaller credit period would actually accelerate cash flow and decrease the risk of granting credit. Meanwhile, this also implies that the value of carbon price and its role in reducing carbon emissions are much more significant. Moreover, we find that the effect of the carbon cap on reducing carbon emissions is limited. For the model with Carbon Cap-and-Trade policy, since the retailer can buy or sell carbon allowances with a fixed carbon price on the compliance carbon trading market, varying the carbon cap does not have an impact on both the optimal trade credit and inventory replenishment strategies. And hence, the optimal carbon emission remains constant. On the other hand, for the model with Carbon Offset policy, since the retailer can buy additional carbon allowances from the voluntary carbon market to cover the excess between its actual emissions and the carbon cap, the optimal amount of carbon emissions is fixed at the level obtained in the model with Carbon Cap-and-Trade policy when the carbon cap is relatively low.

There are several interesting extensions to this work. First, we can extend the model with a stochastic demand. Second, since carbon is the basic element in fossil energy, cutting carbon equals to cost savings and operational efficiency. Hence it is worthwhile extending the model with effective investment in low-carbon technologies to cut emissions and operating costs. Finally, the aim of the Kyoto Protocol is to reduce emissions and promote renewable energy, global carbon regulations must make carbon scarce, and thereby raise the marginal cost of using carbon. Hence it is a challenge to analyze the model with a floating price and cap on carbon level allowances.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the editor and anonymous reviewers for their valuable and constructive comments, which have led to a significant improvement in the manuscript. This research was partially supported by the Ministry of Science and Technology of Taiwan, Republic of China under grant no. MOST-103-2221-E-366-003 and MOST-103-2221-E-231-007.

If an interior solution exists, it can be characterized by the following first-order conditions:

                                 
                                    (A.1)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      Π
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         D
                                                         (
                                                         n
                                                         )
                                                      
                                                      T
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            r
                                                            
                                                            n
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      +
                                                      π
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      {
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            r
                                                            
                                                            n
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      +
                                                      π
                                                      −
                                                      s
                                                      
                                                         (
                                                         T
                                                         −
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      
                                                         [
                                                         
                                                            e
                                                            
                                                               g
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                         
                                                         −
                                                         1
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         h
                                                         +
                                                         E
                                                         
                                                            h
                                                            ^
                                                         
                                                         )
                                                      
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            g
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      d
                                                      t
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (A.2)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      Π
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   
                                                      ∂
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         D
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         
                                                            {
                                                            p
                                                            
                                                               e
                                                               
                                                                  −
                                                                  r
                                                                  
                                                                  n
                                                               
                                                            
                                                            
                                                               [
                                                               1
                                                               −
                                                               F
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               ]
                                                            
                                                            −
                                                            
                                                               (
                                                               c
                                                               +
                                                               E
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               )
                                                            
                                                            +
                                                            π
                                                            −
                                                            s
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            }
                                                         
                                                         β
                                                         
                                                            (
                                                            T
                                                            −
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                      
                                                         π
                                                         D
                                                         (
                                                         n
                                                         )
                                                         −
                                                         E
                                                         ϖ
                                                      
                                                      T
                                                   
                                                   −
                                                   
                                                      
                                                         Π
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              and

                                 
                                    (A.3)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      Π
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   
                                                      ∂
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      1
                                                      T
                                                   
                                                   
                                                      
                                                         ∂
                                                         f
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                      
                                                         ∂
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      1
                                                      T
                                                   
                                                   
                                                   
                                                      {
                                                      
                                                      
                                                         {
                                                         −
                                                         r
                                                         p
                                                         
                                                            e
                                                            
                                                               −
                                                               r
                                                               
                                                               n
                                                            
                                                         
                                                         
                                                            [
                                                            1
                                                            −
                                                            F
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            ]
                                                         
                                                         −
                                                         p
                                                         
                                                            e
                                                            
                                                               −
                                                               r
                                                               
                                                               n
                                                            
                                                         
                                                         
                                                            F
                                                            ′
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         }
                                                      
                                                      D
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      
                                                      
                                                         [
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                         +
                                                         
                                                            ∫
                                                            
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            T
                                                         
                                                         β
                                                         
                                                            (
                                                            T
                                                            −
                                                            t
                                                            )
                                                         
                                                         d
                                                         t
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                      {
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            r
                                                            
                                                            n
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      +
                                                      π
                                                      }
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                   
                                                      [
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                      +
                                                      
                                                         ∫
                                                         
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         T
                                                      
                                                      β
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                      d
                                                      t
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      ∫
                                                      
                                                         0
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         e
                                                         
                                                            g
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      −
                                                      1
                                                      ]
                                                   
                                                   d
                                                   t
                                                   −
                                                   
                                                      (
                                                      h
                                                      +
                                                      E
                                                      
                                                         h
                                                         ^
                                                      
                                                      )
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ×
                                                   
                                                      ∫
                                                      
                                                         0
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   
                                                      ∫
                                                      
                                                         t
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   
                                                      e
                                                      
                                                         g
                                                         (
                                                         u
                                                         )
                                                         −
                                                         g
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   d
                                                   u
                                                   d
                                                   t
                                                   −
                                                   s
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                      ×
                                                      
                                                         ∫
                                                         
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         T
                                                      
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                      β
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                      d
                                                      t
                                                      −
                                                      π
                                                      
                                                         D
                                                         ′
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      T
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Rearranging Eqs. (A.1) and (A.2) leads to

                                 
                                    (A.4)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   
                                                      +
                                                      π
                                                      −
                                                      {
                                                      p
                                                   
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   π
                                                   −
                                                   s
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      }
                                                      β
                                                   
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   
                                                      [
                                                      
                                                         e
                                                         
                                                            g
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      −
                                                      1
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      h
                                                      +
                                                      E
                                                      
                                                         h
                                                         ^
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ×
                                                   
                                                      ∫
                                                      
                                                         0
                                                      
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                   
                                                      e
                                                      
                                                         g
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                         −
                                                         g
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                   
                                                   d
                                                   t
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              and

                                 
                                    (A.5)
                                    
                                       
                                          
                                             
                                                
                                                   Π
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   {
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   +
                                                   π
                                                   −
                                                   s
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   ×
                                                   
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      [
                                                      π
                                                      D
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      −
                                                      E
                                                      ϖ
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The Karush–Kuhn–Tucker conditions for the optimization problem are

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         Π
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                      
                                                         ∂
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                   
                                                   +
                                                   λ
                                                   s
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         Π
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                      
                                                         ∂
                                                         T
                                                      
                                                   
                                                   −
                                                   λ
                                                   s
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   +
                                                   π
                                                   −
                                                   s
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   ≤
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   λ
                                                   {
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   +
                                                   π
                                                   −
                                                   s
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   }
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   λ
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              By Assumption 1, we have πD(n) − ϖE > 0 due to D′(n) > 0. Further, because Π(t
                              1, T, n) is positive on 
                                 Ω
                              
                              1, it is straightforward to see that 
                                 
                                    
                                       
                                          ∂
                                          Π
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             ,
                                             T
                                             ,
                                             n
                                             )
                                          
                                       
                                       
                                          ∂
                                          T
                                       
                                    
                                    <
                                    0
                                 
                               from (A.2). Therefore, we get λ > 0, and then 
                                 
                                    p
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                    −
                                    
                                       (
                                       c
                                       +
                                       E
                                       
                                          c
                                          ^
                                       
                                       )
                                    
                                    +
                                    π
                                    −
                                    s
                                    
                                       (
                                       T
                                       −
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               follows directly from complementary slackness condition. So the optimal solution of Π(t
                              1, T, n) occurs at the boundary of 
                                 Ω
                              
                              1, i.e. 
                                 
                                    T
                                    =
                                    
                                       t
                                       1
                                    
                                    +
                                    
                                       
                                          p
                                          
                                             e
                                             
                                                −
                                                r
                                                
                                                n
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             F
                                             
                                                (
                                                n
                                                )
                                             
                                             ]
                                          
                                          −
                                          
                                             (
                                             c
                                             +
                                             E
                                             
                                                c
                                                ^
                                             
                                             )
                                          
                                          +
                                          π
                                       
                                       s
                                    
                                 
                              . This completes the proof of Lemma 1.   □

Substituting 
                                 
                                    T
                                    =
                                    
                                       t
                                       1
                                    
                                    +
                                    
                                       
                                          p
                                          
                                             e
                                             
                                                −
                                                r
                                                
                                                n
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             F
                                             
                                                (
                                                n
                                                )
                                             
                                             ]
                                          
                                          −
                                          
                                             (
                                             c
                                             +
                                             E
                                             
                                                c
                                                ^
                                             
                                             )
                                          
                                          +
                                          π
                                       
                                       s
                                    
                                 
                               into f(t
                              1, T, n), and then taking the first and second derivatives of f(t
                              1, T, n) with respect to t
                              1 yields

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      f
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   
                                                      d
                                                      
                                                         t
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            n
                                                            r
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      
                                                         [
                                                         1
                                                         +
                                                         
                                                            e
                                                            
                                                               −
                                                               1
                                                               +
                                                               g
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                   −
                                                   
                                                      
                                                         (
                                                         h
                                                         +
                                                         E
                                                         
                                                            h
                                                            ^
                                                         
                                                         )
                                                      
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            g
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      d
                                                      t
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                         2
                                                      
                                                      f
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         t
                                                         1
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   −
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               [
                                                               1
                                                               +
                                                               
                                                                  ∫
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        )
                                                                     
                                                                     −
                                                                     g
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                               θ
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               d
                                                               t
                                                               ]
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      θ
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         (
                                                         h
                                                         +
                                                         E
                                                         
                                                            h
                                                            ^
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   
                                                      ×
                                                      
                                                         [
                                                         1
                                                         +
                                                         
                                                            ∫
                                                            
                                                               0
                                                            
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         
                                                            e
                                                            
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               −
                                                               g
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                         
                                                         θ
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                         d
                                                         t
                                                         ]
                                                      
                                                      }
                                                   
                                                   <
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              respectively. It is straightforward to see that f(t
                              1, T, n) is strictly concave in t
                              1. Because 
                                 
                                    T
                                    =
                                    
                                       t
                                       1
                                    
                                    +
                                    
                                       
                                          p
                                          
                                             e
                                             
                                                −
                                                r
                                                
                                                n
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             F
                                             (
                                             n
                                             )
                                             ]
                                          
                                          −
                                          
                                             (
                                             c
                                             +
                                             E
                                             
                                                c
                                                ^
                                             
                                             )
                                          
                                          +
                                          π
                                       
                                       s
                                    
                                 
                               is affine, Π(t
                              1, T, n) is strictly pseudoconcave in t
                              1, which also implies that Π(t
                              1, T, n) attains a unique global maximum at the boundary of 
                                 Ω
                              
                              1. This completes the proof of Lemma 2.   □

By taking second-order partial derivatives of f(t
                              1, T, n) with respect to t
                              1 and T, and then simplifying leads to

                                 
                                    (A.6)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      f
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         T
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   {
                                                   
                                                      {
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            r
                                                            
                                                            n
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      +
                                                      π
                                                      −
                                                      s
                                                      
                                                         (
                                                         T
                                                         −
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ×
                                                   
                                                   
                                                      β
                                                      ′
                                                   
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   s
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      }
                                                      <
                                                      0
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (A.7)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      f
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         t
                                                         1
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   {
                                                   {
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   +
                                                   π
                                                   −
                                                   s
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   ×
                                                   
                                                   
                                                      β
                                                      ′
                                                   
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   s
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   θ
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      e
                                                      
                                                         g
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   
                                                   
                                                      (
                                                      h
                                                      +
                                                      E
                                                      
                                                         h
                                                         ^
                                                      
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      +
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      θ
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            g
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      d
                                                      t
                                                      ]
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   −
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   {
                                                   
                                                      (
                                                      c
                                                      +
                                                      E
                                                      
                                                         c
                                                         ^
                                                      
                                                      )
                                                   
                                                   θ
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      e
                                                      
                                                         g
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      h
                                                      +
                                                      E
                                                      
                                                         h
                                                         ^
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   ×
                                                   
                                                      [
                                                      1
                                                      +
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      θ
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            g
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      d
                                                      t
                                                      ]
                                                   
                                                   }
                                                   +
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            ,
                                                            n
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            T
                                                            2
                                                         
                                                      
                                                   
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              and

                                 
                                    (A.8)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      f
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         t
                                                         1
                                                      
                                                      ∂
                                                      T
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   −
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   {
                                                   
                                                      {
                                                      p
                                                      
                                                         e
                                                         
                                                            −
                                                            r
                                                            
                                                            n
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         (
                                                         c
                                                         +
                                                         E
                                                         
                                                            c
                                                            ^
                                                         
                                                         )
                                                      
                                                      +
                                                      π
                                                      −
                                                      s
                                                      
                                                         (
                                                         T
                                                         −
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   ×
                                                   
                                                   
                                                      β
                                                      ′
                                                   
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   s
                                                   β
                                                   
                                                      (
                                                      T
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      }
                                                      =
                                                      −
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            ,
                                                            n
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            T
                                                            2
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              One can easily observe that the determinant of Hessian matrix is positive, and therefore f(t
                              1, T, n) is strictly concave in t
                              1 and T on 
                                 Ω
                              
                              2. In addition, since T is affine, 
                                 
                                    Π
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       ,
                                       T
                                       ,
                                       n
                                       )
                                    
                                    =
                                    
                                       
                                          f
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                       T
                                    
                                 
                               is strictly pseudoconcave in t
                              1 and T. Because t
                              1 − T and 
                                 
                                    p
                                    
                                       e
                                       
                                          −
                                          r
                                          
                                          n
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       F
                                       
                                          (
                                          n
                                          )
                                       
                                       ]
                                    
                                    −
                                    
                                       (
                                       c
                                       +
                                       E
                                       
                                          c
                                          ^
                                       
                                       )
                                    
                                    +
                                    π
                                    −
                                    s
                                    
                                       (
                                       T
                                       −
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                               are linear and − f(t
                              1, T, n) is strictly convex, this implies that 
                                 Ω
                              
                              2 is a convex set. Hence, by concave fractional programming, there exists a unique solution such that Π(t
                              1, T, n) is maximum on 
                                 Ω
                              
                              2.

Moreover, for any given t
                              1, it is easy to see that (A.1) holds if and only if T > t
                              1, and hence Π(t
                              1, T, n) attains an interior local maximum on 
                                 Ω
                              
                              2, which is the unique global maximum due to the strict pseudoconcavity of Π(t
                              1, T, n). This completes the proof of Lemma 3.   □

For convenience, let Π
                              1(t
                              1, T, n) and Π
                              2(t
                              1, T, n) denote the total profit per unit time in the corresponding respectively feasible regions 
                                 Ω
                              
                              1 and 
                                 Ω
                              
                              2. Since Π(t
                              1, T, n) is continuous on 
                                 Ω
                              , it is straightforward to verify that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            )
                                                         
                                                         ∈
                                                         
                                                            
                                                               Ω
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      Π
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                             
                                             
                                                >
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         
                                                            t
                                                            1
                                                         
                                                         ∈
                                                         
                                                            (
                                                            0
                                                            ,
                                                            ∞
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      lim
                                                      
                                                         T
                                                         →
                                                         
                                                            t
                                                            1
                                                         
                                                         +
                                                         
                                                            {
                                                            p
                                                            
                                                               e
                                                               
                                                                  −
                                                                  r
                                                                  
                                                                  n
                                                               
                                                            
                                                            
                                                               [
                                                               1
                                                               −
                                                               F
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               ]
                                                            
                                                            −
                                                            
                                                               (
                                                               c
                                                               +
                                                               E
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               )
                                                            
                                                            +
                                                            π
                                                            }
                                                         
                                                         /
                                                         s
                                                      
                                                   
                                                   
                                                      Π
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         
                                                            t
                                                            1
                                                         
                                                         ∈
                                                         
                                                            (
                                                            0
                                                            ,
                                                            ∞
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      lim
                                                      
                                                         T
                                                         →
                                                         
                                                            t
                                                            1
                                                         
                                                         +
                                                         
                                                            {
                                                            p
                                                            
                                                               e
                                                               
                                                                  −
                                                                  r
                                                                  
                                                                  n
                                                               
                                                            
                                                            
                                                               [
                                                               1
                                                               −
                                                               F
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               ]
                                                            
                                                            −
                                                            
                                                               (
                                                               c
                                                               +
                                                               E
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               )
                                                            
                                                            +
                                                            π
                                                            }
                                                         
                                                         /
                                                         s
                                                      
                                                   
                                                   
                                                      Π
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            )
                                                         
                                                         ∈
                                                         
                                                            
                                                               Ω
                                                            
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      Π
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Hence, Π(t
                              1, T, n) has a unique interior maximizer on 
                                 Ω
                               and the optimal values of t
                              1 and T can be uniquely determined by these first-order conditions, Eqs. (A.1) and (A.2). This completes the proof of Theorem 1.   □

If D(n) and 1 − F(n) are both log-concave in n, because e
                              −r 
                                 n
                               is also a log-concave function, e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is pseudoconcave in n. Since a pseudoconcave function can be either unimodal or monotone, we next show that e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is unimodal if and only if it is a constant function. Assume e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is unimodal in n, then there exists an n such that e
                              −r 
                                 n
                              { − rD(n)[1 − F(n)] + D′(n)[1 − F(n)] − D(n)F′(n)} = 0, which implies that D′(n)[1 − F(n)] − D(n)F′(n) = rD(n)[1 − F(n)]. Let R(n) = D(n)[1 − F(n)], it is easy to see that R′(n) = rR(n). Solving the ordinary differential equation with condition R(0) = D(0), we get R(n) = e
                              
                                 r 
                                 n
                              
                              D(0), which implies that e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is a constant function. Therefore, e
                              −r 
                                 n
                              
                              D(n)[1 − F(n)] is either a strictly monotone function or a constant function of n. This completes the proof.   □


                              
                                 
                                    (1)
                                    Differentiating f(t
                                       1, T, n) with respect to n yields

                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                         f
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   
                                                      v
                                                      1
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   
                                                      v
                                                      2
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       where

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                            1
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               {
                                                               p
                                                               
                                                                  e
                                                                  
                                                                     −
                                                                     r
                                                                     
                                                                     n
                                                                  
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               −
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               +
                                                               π
                                                               }
                                                            
                                                            
                                                               [
                                                               
                                                                  t
                                                                  1
                                                               
                                                               +
                                                               
                                                                  ∫
                                                                  
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  T
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  t
                                                                  )
                                                               
                                                               d
                                                               t
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                            
                                                               (
                                                               c
                                                               +
                                                               E
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               )
                                                            
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     t
                                                                     )
                                                                  
                                                               
                                                               −
                                                               1
                                                               ]
                                                            
                                                            d
                                                            t
                                                            −
                                                            
                                                               (
                                                               h
                                                               +
                                                               E
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            
                                                               ∫
                                                               
                                                                  t
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            
                                                               e
                                                               
                                                                  g
                                                                  (
                                                                  u
                                                                  )
                                                                  −
                                                                  g
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                            d
                                                            u
                                                            d
                                                            t
                                                            −
                                                            s
                                                            
                                                               ∫
                                                               
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               T
                                                            
                                                            
                                                               (
                                                               T
                                                               −
                                                               t
                                                               )
                                                            
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               t
                                                               )
                                                            
                                                            d
                                                            t
                                                            −
                                                            π
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       and

                                          
                                             
                                                
                                                   
                                                      v
                                                      2
                                                   
                                                   =
                                                   −
                                                   p
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      {
                                                      r
                                                      
                                                         [
                                                         1
                                                         −
                                                         F
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         ]
                                                      
                                                      +
                                                      
                                                         F
                                                         ′
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      }
                                                   
                                                   
                                                      [
                                                      
                                                         t
                                                         1
                                                      
                                                      +
                                                      
                                                         ∫
                                                         
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         T
                                                      
                                                      β
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                      d
                                                      t
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       Therefore, the second derivative of f(t
                                       1, T, n) with respect to n becomes

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  2
                                                               
                                                               f
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  n
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               
                                                                  ′
                                                                  ′
                                                               
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            +
                                                            2
                                                            
                                                               v
                                                               2
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            p
                                                            
                                                               e
                                                               
                                                                  −
                                                                  r
                                                                  
                                                                  n
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  t
                                                                  1
                                                               
                                                               +
                                                               
                                                                  ∫
                                                                  
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  T
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  t
                                                                  )
                                                               
                                                               d
                                                               t
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                            {
                                                            
                                                               r
                                                               2
                                                            
                                                            
                                                               [
                                                               1
                                                               −
                                                               F
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               ]
                                                            
                                                            +
                                                            2
                                                            r
                                                            F
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            −
                                                            
                                                               F
                                                               
                                                                  ′
                                                                  ′
                                                               
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            }
                                                            D
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       If 
                                          
                                             
                                                
                                                   d
                                                   f
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                        then 
                                          
                                             
                                                v
                                                2
                                             
                                             =
                                             −
                                             
                                                
                                                   
                                                      v
                                                      1
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   D
                                                   (
                                                   n
                                                   )
                                                
                                             
                                          
                                        or 
                                          
                                             D
                                             
                                                (
                                                n
                                                )
                                             
                                             =
                                             −
                                             
                                                
                                                   
                                                      v
                                                      1
                                                   
                                                   
                                                      D
                                                      ′
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   v
                                                   2
                                                
                                             
                                          
                                       . Since F′(n) > 0 and 0 < t
                                       1 < T, we first observe that v
                                       2 < 0. Hence 
                                          
                                             
                                                
                                                   d
                                                   f
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             =
                                             0
                                          
                                        holds if and only if v
                                       1 > 0. Further, if D(n) and 1 − F(n) are both log-concave, we get D(n)D′′(n) − [D′(n)]2 ≤ 0 and − [F′(n)]2 − [1 − F(n)]F′′(n) ≤ 0. Using the above findings, we then obtain

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  2
                                                               
                                                               f
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  n
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               {
                                                               
                                                                  D
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               −
                                                               
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           [
                                                                           
                                                                              D
                                                                              ′
                                                                           
                                                                           
                                                                              (
                                                                              n
                                                                              )
                                                                           
                                                                           ]
                                                                        
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  v
                                                                  1
                                                               
                                                               
                                                                  v
                                                                  2
                                                               
                                                            
                                                            p
                                                            
                                                               e
                                                               
                                                                  −
                                                                  r
                                                                  
                                                                  n
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  t
                                                                  1
                                                               
                                                               +
                                                               
                                                                  ∫
                                                                  
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  T
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  t
                                                                  )
                                                               
                                                               d
                                                               t
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                               {
                                                               
                                                                  r
                                                                  2
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               
                                                               +
                                                               
                                                               2
                                                               r
                                                               
                                                               
                                                                  F
                                                                  ′
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               −
                                                               
                                                                  F
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               }
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               {
                                                               
                                                                  D
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               −
                                                               
                                                                  
                                                                     2
                                                                     
                                                                        
                                                                           [
                                                                           
                                                                              D
                                                                              ′
                                                                           
                                                                           
                                                                              (
                                                                              n
                                                                              )
                                                                           
                                                                           ]
                                                                        
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               
                                                                  {
                                                                  
                                                                     r
                                                                     2
                                                                  
                                                                  
                                                                     [
                                                                     1
                                                                     −
                                                                     F
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                     ]
                                                                  
                                                                  +
                                                                  r
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  r
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     F
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  }
                                                               
                                                               
                                                                  {
                                                                  r
                                                                  
                                                                     [
                                                                     1
                                                                     −
                                                                     F
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                     ]
                                                                  
                                                                  +
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  }
                                                               
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               
                                                                  D
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        [
                                                                        
                                                                           D
                                                                           ′
                                                                        
                                                                        
                                                                           (
                                                                           n
                                                                           )
                                                                        
                                                                        ]
                                                                     
                                                                     2
                                                                  
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        D
                                                                        ′
                                                                     
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               −
                                                               r
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               
                                                                  r
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     F
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               
                                                                  r
                                                                  
                                                                     [
                                                                     1
                                                                     −
                                                                     F
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                     ]
                                                                  
                                                                  +
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         ≤
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               
                                                                  D
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        [
                                                                        
                                                                           D
                                                                           ′
                                                                        
                                                                        
                                                                           (
                                                                           n
                                                                           )
                                                                        
                                                                        ]
                                                                     
                                                                     2
                                                                  
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        D
                                                                        ′
                                                                     
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               −
                                                               r
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               
                                                                  r
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        
                                                                           [
                                                                           
                                                                              F
                                                                              ′
                                                                           
                                                                           
                                                                              (
                                                                              n
                                                                              )
                                                                           
                                                                           ]
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        1
                                                                        −
                                                                        F
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  r
                                                                  
                                                                     [
                                                                     1
                                                                     −
                                                                     F
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                     ]
                                                                  
                                                                  +
                                                                  
                                                                     F
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               
                                                                  D
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        [
                                                                        
                                                                           D
                                                                           ′
                                                                        
                                                                        
                                                                           (
                                                                           n
                                                                           )
                                                                        
                                                                        ]
                                                                     
                                                                     2
                                                                  
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        D
                                                                        ′
                                                                     
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               −
                                                               r
                                                               −
                                                               
                                                                  
                                                                     
                                                                        F
                                                                        ′
                                                                     
                                                                     
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     −
                                                                     F
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               
                                                                  D
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        [
                                                                        
                                                                           D
                                                                           ′
                                                                        
                                                                        
                                                                           (
                                                                           n
                                                                           )
                                                                        
                                                                        ]
                                                                     
                                                                     2
                                                                  
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                            
                                                               v
                                                               1
                                                            
                                                            
                                                               D
                                                               ′
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            
                                                               
                                                                  d
                                                                  log
                                                                  
                                                                     e
                                                                     
                                                                        −
                                                                        r
                                                                        
                                                                        n
                                                                     
                                                                  
                                                                  D
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     [
                                                                     1
                                                                     −
                                                                     F
                                                                     (
                                                                     n
                                                                     )
                                                                     ]
                                                                  
                                                               
                                                               
                                                                  d
                                                                  n
                                                               
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

From Lemma 4, we know that e
                                       −r 
                                          n
                                       
                                       D(n)[1 − F(n)] is either a strictly monotone function or a constant function of n. If 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                             >
                                             0
                                             ,
                                          
                                        then e
                                       −r 
                                          n
                                       
                                       D(n)[1 − F(n)] is a strictly increasing function of n, which also implies that 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             >
                                             0
                                          
                                       . Hence, we obtain that 
                                          
                                             
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   f
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   d
                                                   
                                                      n
                                                      2
                                                   
                                                
                                             
                                             <
                                             0
                                          
                                       . According to Theorem 3.4.7 in Cambini and Martein (2009), since 
                                          
                                             
                                                
                                                   d
                                                   f
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             =
                                             0
                                          
                                        implies 
                                          
                                             
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   f
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   d
                                                   
                                                      n
                                                      2
                                                   
                                                
                                             
                                             <
                                             0
                                             ,
                                          
                                        
                                       f(t
                                       1, T, n) is strictly pseudoconcave in n, which also implies that 
                                          
                                             Π
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             =
                                             
                                                
                                                   f
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                          
                                        is strictly pseudoconcave in n. And therefore, for any given feasible (t
                                       1, T), there is a unique global maximizer 
                                          
                                             n
                                             ∈
                                             [
                                             0
                                             ,
                                             
                                                n
                                                ¯
                                             
                                             ]
                                          
                                        due to the strict pseudoconcavity of Π(t
                                       1, T, n).

If 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                        then e
                                       −r 
                                          n
                                       
                                       D(n)[1 − F(n)] is non-increasing in n, and thus 
                                          
                                             
                                                
                                                   d
                                                   
                                                      e
                                                      
                                                         −
                                                         r
                                                         
                                                         n
                                                      
                                                   
                                                   D
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   
                                                      [
                                                      1
                                                      −
                                                      F
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             ≤
                                             0
                                          
                                       . It is not difficult to see from (6) that 
                                          
                                             
                                                
                                                   d
                                                   f
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                             
                                             <
                                             0
                                             ,
                                          
                                        which also implies that Π(t
                                       1, T, n) decreases strictly as n increases. Therefore, for any given feasible (t
                                       1, T), the global maximizer is n* = 0. Combining the arguments above together, we finish the proof of Theorem 2.

If f(t
                              1, T, 0) > 0 and 
                                 
                                    
                                       
                                          d
                                          f
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                       
                                          d
                                          n
                                       
                                    
                                    
                                       |
                                    
                                    
                                       
                                       
                                          n
                                          =
                                          0
                                       
                                    
                                    >
                                    0
                                    ,
                                 
                               since 
                                 
                                    f
                                    (
                                    
                                       t
                                       1
                                    
                                    ,
                                    T
                                    ,
                                    
                                       n
                                       ¯
                                    
                                    )
                                    <
                                    0
                                 
                               and f(t
                              1, T, n) is strictly pseudoconcave in n, there exists a unique interior maximum point. Further, because

                                 
                                    (A.9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      Π
                                                      
                                                         (
                                                         
                                                            t
                                                            1
                                                         
                                                         ,
                                                         T
                                                         ,
                                                         n
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      n
                                                      ∂
                                                      E
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            D
                                                            ′
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      T
                                                   
                                                   
                                                      {
                                                      
                                                         c
                                                         ^
                                                      
                                                      
                                                         [
                                                         
                                                            ∫
                                                            
                                                               0
                                                            
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         
                                                            e
                                                            
                                                               g
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         d
                                                         t
                                                         +
                                                         
                                                            ∫
                                                            
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            T
                                                         
                                                         β
                                                         
                                                            (
                                                            T
                                                            −
                                                            t
                                                            )
                                                         
                                                         d
                                                         t
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                         ^
                                                      
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         ∫
                                                         
                                                            t
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            (
                                                            u
                                                            )
                                                            −
                                                            g
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      d
                                                      u
                                                      d
                                                      t
                                                      }
                                                   
                                                   <
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              by Strict Monotonicity Theorem, the optimal credit period is strictly decreasing in the carbon price. This completes the proof of Proposition 1.   □


                              
                                 
                                    (1)
                                    Taking the implicit derivative of both sides of Eqs. (A.4) and (A.5) with respect to E yields

                                          
                                             (A.10)
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            −
                                                            
                                                               {
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               θ
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                               
                                                                  (
                                                                  h
                                                                  +
                                                                  E
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  +
                                                                  θ
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     ∫
                                                                     
                                                                        0
                                                                     
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     e
                                                                     
                                                                        g
                                                                        
                                                                           (
                                                                           
                                                                              t
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                        −
                                                                        g
                                                                        
                                                                           (
                                                                           t
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  d
                                                                  t
                                                                  ]
                                                               
                                                               }
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            =
                                                            {
                                                            
                                                               {
                                                               p
                                                               
                                                                  e
                                                                  
                                                                     −
                                                                     r
                                                                     
                                                                     n
                                                                  
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               −
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               +
                                                               π
                                                               −
                                                               s
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                            
                                                               β
                                                               ′
                                                            
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            s
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            ×
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               c
                                                               ^
                                                            
                                                            
                                                               [
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                               −
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               ]
                                                            
                                                            +
                                                            
                                                               h
                                                               ^
                                                            
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            
                                                               e
                                                               
                                                                  g
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                                  −
                                                                  g
                                                                  
                                                                     (
                                                                     t
                                                                     )
                                                                  
                                                               
                                                            
                                                            d
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       and

                                          
                                             (A.11)
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                               ^
                                                            
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            {
                                                            
                                                               {
                                                               p
                                                               
                                                                  e
                                                                  
                                                                     −
                                                                     r
                                                                     
                                                                     n
                                                                  
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               −
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               +
                                                               π
                                                               −
                                                               s
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            ×
                                                            
                                                            
                                                               β
                                                               ′
                                                            
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            s
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               }
                                                               ×
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Substituting (A.11) into (A.10) yields

                                          
                                             (A.12)
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                                  T
                                                               
                                                            
                                                            −
                                                            
                                                               c
                                                               ^
                                                            
                                                            
                                                               e
                                                               
                                                                  g
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               h
                                                               ^
                                                            
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  t
                                                                  1
                                                               
                                                            
                                                            
                                                               e
                                                               
                                                                  g
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                                  −
                                                                  g
                                                                  
                                                                     (
                                                                     t
                                                                     )
                                                                  
                                                               
                                                            
                                                            d
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            
                                                               {
                                                               
                                                                  
                                                                     
                                                                        [
                                                                        1
                                                                        +
                                                                        θ
                                                                        
                                                                           (
                                                                           
                                                                              t
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           ∫
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              t
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           e
                                                                           
                                                                              g
                                                                              
                                                                                 (
                                                                                 
                                                                                    t
                                                                                    1
                                                                                 
                                                                                 )
                                                                              
                                                                              −
                                                                              g
                                                                              
                                                                                 (
                                                                                 t
                                                                                 )
                                                                              
                                                                           
                                                                        
                                                                        d
                                                                        t
                                                                        ]
                                                                     
                                                                  
                                                               
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               θ
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                               
                                                                  (
                                                                  h
                                                                  +
                                                                  E
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            
                                                               ×
                                                               
                                                                  [
                                                                  1
                                                                  +
                                                                  θ
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     ∫
                                                                     
                                                                        0
                                                                     
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     e
                                                                     
                                                                        g
                                                                        
                                                                           (
                                                                           
                                                                              t
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                        −
                                                                        g
                                                                        
                                                                           (
                                                                           t
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  d
                                                                  t
                                                                  ]
                                                               
                                                               }
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       which implies that

                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            CE
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            ,
                                                            n
                                                            )
                                                         
                                                         
                                                            D
                                                            (
                                                            n
                                                            )
                                                            T
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         ^
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         h
                                                         ^
                                                      
                                                      
                                                         ∫
                                                         
                                                            0
                                                         
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         e
                                                         
                                                            g
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            g
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      d
                                                      t
                                                      ]
                                                   
                                                   
                                                      
                                                         d
                                                         
                                                            t
                                                            1
                                                         
                                                      
                                                      
                                                         d
                                                         E
                                                      
                                                   
                                                   >
                                                   0
                                                
                                             
                                          
                                       and

                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         c
                                                         ^
                                                      
                                                      β
                                                      
                                                         (
                                                         T
                                                         −
                                                         
                                                            t
                                                            1
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            CE
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            ,
                                                            T
                                                            ,
                                                            n
                                                            )
                                                         
                                                         
                                                            D
                                                            (
                                                            n
                                                            )
                                                            T
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            d
                                                            T
                                                         
                                                         
                                                            d
                                                            E
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            d
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                            E
                                                         
                                                      
                                                      )
                                                   
                                                   <
                                                   0
                                                   .
                                                
                                             
                                          
                                       Using above findings, we then have

                                          
                                             (A.13)
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               {
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               +
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               
                                                                  ∫
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        )
                                                                     
                                                                     −
                                                                     g
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                               d
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            
                                                               +
                                                               
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               −
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               }
                                                            
                                                            −
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  T
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               [
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               
                                                                  ∫
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        )
                                                                     
                                                                     −
                                                                     g
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                               d
                                                               t
                                                               −
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                     T
                                                                  
                                                               
                                                               ]
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            +
                                                            
                                                            
                                                               
                                                                  D
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               [
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               β
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               −
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  
                                                                     D
                                                                     (
                                                                     n
                                                                     )
                                                                     T
                                                                  
                                                               
                                                               ]
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     E
                                                                  
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       And therefore, the optimal carbon emissions per unit time is strictly decreasing in the carbon price, which also completes the proof of the first part of Proposition 2.

By implicit differentiation, we find that

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                               Π
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               ,
                                                               T
                                                               ,
                                                               n
                                                               )
                                                            
                                                            
                                                               d
                                                               E
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  E
                                                               
                                                            
                                                            =
                                                            ϖ
                                                            −
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Since 
                                          
                                             
                                                CE
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             T
                                          
                                        decreases strictly in E, there exists a unique E such that 
                                          
                                             ϖ
                                             −
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             0
                                             ,
                                          
                                        say E
                                       L. Obviously, Π(t
                                       1, T, n) is strictly decreasing for E < E
                                       L and is strictly increasing for E > E
                                       L. Thus, Π(t
                                       1, T, n) is unimodal in E, which completes the proof of the second part of Proposition 2.   □


                              
                                 
                                    (1)
                                    Taking the implicit derivative of both sides of Eqs. (A.4) and (A.5) with respect to ϖ yields

                                          
                                             (A.14)
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               {
                                                               p
                                                               
                                                                  e
                                                                  
                                                                     −
                                                                     r
                                                                     
                                                                     n
                                                                  
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               −
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               +
                                                               π
                                                               −
                                                               s
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                            
                                                               β
                                                               ′
                                                            
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            s
                                                            D
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                            
                                                               (
                                                               c
                                                               +
                                                               E
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               )
                                                            
                                                            θ
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  g
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                            
                                                               (
                                                               h
                                                               +
                                                               E
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               )
                                                            
                                                            
                                                               [
                                                               1
                                                               +
                                                               
                                                                  ∫
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               θ
                                                               
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     g
                                                                     
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        )
                                                                     
                                                                     −
                                                                     g
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                               d
                                                               t
                                                               ]
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       and

                                          
                                             (A.15)
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            D
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            {
                                                            
                                                               {
                                                               p
                                                               
                                                                  e
                                                                  
                                                                     −
                                                                     r
                                                                     
                                                                     n
                                                                  
                                                               
                                                               
                                                                  [
                                                                  1
                                                                  −
                                                                  F
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               −
                                                               
                                                                  (
                                                                  c
                                                                  +
                                                                  E
                                                                  
                                                                     c
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               +
                                                               π
                                                               −
                                                               s
                                                               
                                                                  (
                                                                  T
                                                                  −
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                            
                                                               β
                                                               ′
                                                            
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            s
                                                            β
                                                            
                                                               (
                                                               T
                                                               −
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               }
                                                               ×
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Since 
                                          
                                             p
                                             
                                                e
                                                
                                                   −
                                                   r
                                                   
                                                   n
                                                
                                             
                                             
                                                [
                                                1
                                                −
                                                F
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                ]
                                             
                                             −
                                             
                                                (
                                                c
                                                +
                                                E
                                                
                                                   c
                                                   ^
                                                
                                                )
                                             
                                             +
                                             π
                                             −
                                             s
                                             
                                                (
                                                T
                                                −
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             >
                                             0
                                          
                                        and β′(T − t
                                       1) < 0, (A.15) holds if and only if 
                                          
                                             
                                                
                                                   d
                                                   T
                                                
                                                
                                                   d
                                                   ϖ
                                                
                                             
                                             −
                                             
                                                
                                                   d
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   ϖ
                                                
                                             
                                             =
                                             0
                                          
                                       . Substituting this result into (A.14) yields 
                                          
                                             
                                                
                                                   d
                                                   
                                                      t
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   ϖ
                                                
                                             
                                             =
                                             
                                                
                                                   d
                                                   T
                                                
                                                
                                                   d
                                                   ϖ
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                        which implies that the optimal carbon emissions per unit time remains constant as the carbon cap increases.

By implicit differentiation, we get

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                               Π
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               ,
                                                               T
                                                               ,
                                                               n
                                                               )
                                                            
                                                            
                                                               d
                                                               ϖ
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            +
                                                            
                                                            
                                                               
                                                                  ∂
                                                                  Π
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               
                                                                  ∂
                                                                  ϖ
                                                               
                                                            
                                                            =
                                                            E
                                                            >
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Therefore, it is straightforward to see that the optimal total profit per unit time is linearly increasing in the carbon cap.   □


                              
                                 
                                    (1)
                                    The Karush–Kuhn–Tucker conditions for the maximization problem of Case 1 is given by

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            −
                                                            
                                                               λ
                                                               1
                                                            
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            −
                                                            
                                                               λ
                                                               1
                                                            
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               −
                                                               ϖ
                                                               ≤
                                                               0
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                               1
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        CE
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        ,
                                                                        T
                                                                        ,
                                                                        n
                                                                        )
                                                                     
                                                                     T
                                                                  
                                                                  −
                                                                  ϖ
                                                               
                                                               ]
                                                            
                                                            
                                                               =
                                                               0
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                               1
                                                            
                                                            ≥
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       If λ
                                       1 = 0, then the constraint 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             ≤
                                             0
                                          
                                        is non-binding. By setting E = 0, the uniqueness of the optimal pair (t
                                       1, T) follows immediately from Theorem 1. On the other hand, if λ
                                       1 > 0, by Complementary Slackness Theorem, the optimal solution occurs at the boundary of the feasible region, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             =
                                             0
                                          
                                       . Under this circumstance, we can use analogous arguments in Proposition 2 to show that 
                                          
                                             
                                                CE
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             T
                                          
                                        is strictly decreasing in λ
                                       1. Therefore, there is a unique λ
                                       1 such that 
                                          
                                             
                                                
                                                   
                                                      CE
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   T
                                                
                                                −
                                                ϖ
                                                =
                                                0
                                             
                                             ,
                                          
                                        which also implies that the optimal pair (t
                                       1, T) can be uniquely determined.

If ϖ ≥ ϖWC, then the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             ≤
                                             0
                                          
                                        is non-binding. Therefore, the optimal carbon emissions per unit time remains constant as carbon cap increases. On the other hand, if ϖ < ϖWC, the optimal solution occurs at the boundary. Therefore, it is straightforward to see that the optimal carbon emissions per unit time is increasing linearly in the carbon cap.

Since Lagrange multiplier λ
                                       1 measures the marginal effect of a relaxation in the constraint on the retailer’s objective function. If ϖ ≥ ϖWC, since the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             ≤
                                             0
                                          
                                        is non-binding, the optimal total profit per unit time remains constant as the carbon cap increases. On the other hand, if ϖ < ϖWC, the optimal solution occurs at the boundary and λ
                                       1 > 0. Therefore the optimal total profit per unit time is increasing strictly in the carbon cap.   □


                              
                                 
                                    (1)
                                    The Karush–Kuhn–Tucker conditions for Case 2 are given as follows:

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            −
                                                            
                                                               (
                                                               E
                                                               −
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               )
                                                            
                                                            ×
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               T
                                                            
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            −
                                                            
                                                               (
                                                               E
                                                               −
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               )
                                                            
                                                            ×
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                               
                                                               T
                                                            
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            −
                                                            ϖ
                                                            >
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                               2
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               −
                                                               ϖ
                                                               ]
                                                            
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                               2
                                                            
                                                            ≥
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       where λ
                                       2 is Lagrange multiplier. If λ
                                       2 = 0, since the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             >
                                             0
                                          
                                        is non-binding, the uniqueness of global maximizer for the case follows immediately from Theorem 1. On the other hand, if λ
                                       2 > 0, then the problem attains its maximum at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . Under this circumstance, we can use analogous arguments in Proposition 2 to show that 
                                          
                                             
                                                CE
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             T
                                          
                                        is strictly decreasing in E − λ
                                       2. Therefore, there is a unique E − λ
                                       2 such that 
                                          
                                             
                                                
                                                   
                                                      CE
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      ,
                                                      T
                                                      ,
                                                      n
                                                      )
                                                   
                                                   T
                                                
                                                −
                                                ϖ
                                                =
                                                0
                                             
                                             ,
                                          
                                        which implies that the optimal pair (t
                                       1, T) can be uniquely determined.

If ϖ ≤ ϖCT, since the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             >
                                             0
                                          
                                        is non-binding, the result that the optimal carbon emissions per unit time decreases strictly as the carbon price increases follows immediately from Proposition 2. Furthermore, since 
                                          
                                             
                                                CE
                                                (
                                                
                                                   t
                                                   1
                                                
                                                ,
                                                T
                                                ,
                                                n
                                                )
                                             
                                             T
                                          
                                        is strictly decreasing in E, there exists a unique E such that 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                             ,
                                          
                                        say E
                                       L. If E > E
                                       L, then 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             <
                                             ϖ
                                             ,
                                          
                                        this contradicts the condition 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             >
                                             ϖ
                                          
                                       . Therefore, if E > E
                                       L, the optimal solution occurs at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . Substituting this result into the objective, we can find that the objective function is independent of E. Hence the optimal carbon emissions per unit time remains constant as the carbon price increases. On the other hand, if ϖ > ϖCT, since the optimal solution occurs at the boundary, the optimal carbon emissions per unit time remains constant as the carbon price increases.

If ϖ ≤ ϖCT, since the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             >
                                             0
                                          
                                        is non-binding, the result that the optimal carbon emissions per unit time remains constant follows immediately from Proposition 3. On the other hand, if ϖ > ϖCT, the optimal solution occurs at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . It is clear to see that 
                                          
                                             
                                                d
                                                
                                                   d
                                                   ϖ
                                                
                                             
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             1
                                             ,
                                          
                                        as it implies that the optimal carbon emissions per unit time is increasing linearly in the carbon cap. Therefore, the optimal carbon emissions per unit time first remains constant, and then increases linearly as the carbon cap increases.

If ϖ ≤ ϖCT, it is trivial to see that the optimal carbon emissions per unit time is ϖCT. From Proposition 2, we obtain that

                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                               
                                                                  d
                                                                  E
                                                               
                                                            
                                                            
                                                            
                                                               {
                                                               
                                                               
                                                                  
                                                                     TP
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               −
                                                               E
                                                               
                                                                  [
                                                                  
                                                                  
                                                                     
                                                                        CE
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        ,
                                                                        T
                                                                        ,
                                                                        n
                                                                        )
                                                                     
                                                                     T
                                                                  
                                                                  −
                                                                  ϖ
                                                                  
                                                                  ]
                                                               
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            ϖ
                                                            −
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         =
                                                      
                                                      
                                                         
                                                            ϖ
                                                            −
                                                            
                                                               ϖ
                                                               CT
                                                            
                                                            <
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Thus, the optimal total profit per unit time decreases strictly as the carbon price increases. However, if E > E
                                       L, the optimal solution occurs at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . By using the same arguments as in (2), the optimal carbon emissions per unit time remains constant as the carbon price increases. On the other hand, if ϖ > ϖCT, the optimal solution occurs at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . Therefore the optimal carbon emissions per unit time remains constant as the carbon price increases.

If ϖ ≤ ϖCT, since the constrain 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             −
                                             ϖ
                                             >
                                             0
                                          
                                        is non-binding, the result that the optimal total profit per unit time increases linearly as the carbon cap increases follows immediately from Proposition 3. On the other hand, if ϖ > ϖCT, the optimal solution occurs at the boundary, that is 
                                          
                                             
                                                
                                                   CE
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                                T
                                             
                                             =
                                             ϖ
                                          
                                       . We then have

                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            
                                                               {
                                                               
                                                                  
                                                                     TP
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               −
                                                               E
                                                               
                                                                  [
                                                                  
                                                                     
                                                                        CE
                                                                        (
                                                                        
                                                                           t
                                                                           1
                                                                        
                                                                        ,
                                                                        T
                                                                        ,
                                                                        n
                                                                        )
                                                                     
                                                                     T
                                                                  
                                                                  −
                                                                  ϖ
                                                                  ]
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               
                                                                  d
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            −
                                                            E
                                                            ×
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            +
                                                            
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  TP
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            −
                                                            E
                                                            ×
                                                            
                                                               ∂
                                                               
                                                                  ∂
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  CE
                                                                  (
                                                                  
                                                                     t
                                                                     1
                                                                  
                                                                  ,
                                                                  T
                                                                  ,
                                                                  n
                                                                  )
                                                               
                                                               T
                                                            
                                                            
                                                               
                                                                  d
                                                                  T
                                                               
                                                               
                                                                  d
                                                                  ϖ
                                                               
                                                            
                                                            +
                                                            E
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            −
                                                            
                                                               λ
                                                               2
                                                            
                                                            
                                                               {
                                                               
                                                                  ∂
                                                                  
                                                                     ∂
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     d
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∂
                                                                  
                                                                     ∂
                                                                     T
                                                                  
                                                               
                                                               
                                                                  
                                                                     CE
                                                                     (
                                                                     
                                                                        t
                                                                        1
                                                                     
                                                                     ,
                                                                     T
                                                                     ,
                                                                     n
                                                                     )
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     d
                                                                     T
                                                                  
                                                                  
                                                                     d
                                                                     ϖ
                                                                  
                                                               
                                                               }
                                                            
                                                            +
                                                            E
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                      
                                                         
                                                            
                                                            =
                                                            E
                                                            −
                                                            
                                                               λ
                                                               2
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Further, because 
                                          
                                             
                                                CE
                                                
                                                   (
                                                   
                                                      t
                                                      1
                                                   
                                                   ,
                                                   T
                                                   ,
                                                   n
                                                   )
                                                
                                             
                                             T
                                          
                                        is strictly decreasing in E − λ
                                       2, λ
                                       2 is strictly increasing in ϖ. Denote 
                                          
                                             
                                                λ
                                                
                                                   2
                                                
                                                *
                                             
                                             
                                                (
                                                ϖ
                                                )
                                             
                                          
                                        as the corresponding optimal λ
                                       2 with a given carbon cap ϖ. Then, there exists a unique ϖ such that λ
                                       2(ϖ) = E, say ϖ
                                          E
                                       . When ϖCE < ϖ ≤ ϖ
                                          E
                                       , it implies that 
                                          
                                             0
                                             <
                                             
                                                λ
                                                
                                                   2
                                                
                                                *
                                             
                                             
                                                (
                                                ϖ
                                                )
                                             
                                             ≤
                                             E
                                          
                                       . Since 
                                          
                                             E
                                             −
                                             
                                                λ
                                                
                                                   2
                                                
                                                *
                                             
                                             
                                                (
                                                ϖ
                                                )
                                             
                                             >
                                             0
                                             ,
                                          
                                        the optimal total profit per unit time increases strictly as the carbon cap increases. However, when ϖ > ϖE, because 
                                          
                                             
                                                λ
                                                
                                                   2
                                                
                                                *
                                             
                                             
                                                (
                                                ϖ
                                                )
                                             
                                             >
                                             E
                                             ,
                                          
                                        it is obvious to see that the optimal total profit per unit time decreases strictly as the carbon cap increases.   □

From the discussion on Proposition 4, since 
                                 
                                    
                                       CE
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          ,
                                          T
                                          ,
                                          n
                                          )
                                       
                                    
                                    T
                                 
                               is decreasing strictly in λ
                              1 when ϖ < ϖWC, λ
                              1 is strictly decreasing in ϖ. Therefore, λ
                              1 can be written as a function of ϖ. Denote 
                                 
                                    
                                       λ
                                       
                                          1
                                       
                                       *
                                    
                                    
                                       (
                                       ϖ
                                       )
                                    
                                 
                               as the corresponding optimal λ
                              1 with a given carbon cap ϖ. Hence, we have 
                                 
                                    
                                       λ
                                       
                                          1
                                       
                                       *
                                    
                                    
                                       (
                                       
                                          ϖ
                                          WC
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    
                                       λ
                                       
                                          1
                                       
                                       *
                                    
                                    
                                       (
                                       
                                          ϖ
                                          CT
                                       
                                       )
                                    
                                    =
                                    E
                                 
                              . Moreover, because λ
                              1 is decreasing strictly in ϖ, it straightforward to see that ϖCT < ϖWC.

First, when ϖ ≤ ϖCT, because 
                                 
                                    
                                       λ
                                       
                                          1
                                       
                                       *
                                    
                                    
                                       (
                                       ϖ
                                       )
                                    
                                    ≥
                                    E
                                    ,
                                 
                               the shadow price in Case 1 is always greater than or equal to its unit carbon cost and it is worthwhile buying extra emission rights until ϖ = ϖCT. Therefore, when ϖ ≤ ϖCT, the optimal replenishment strategy is Case 2. Next, when ϖCT < ϖ ≤ ϖ
                                 E
                              , since the optimal solution for Cases 1 and 2 both occur at the boundary, it is straightforward to see that Cases 1 and 2 are the same. Finally, when ϖ > ϖ
                                 E
                              , since the optimal total profit per unit time for Case 2 is decreasing strictly, but the total profit per unit time for Case 1 increases as the carbon cap increases, the optimal replenishment strategy is Case 1. This completes the proof of Proposition 6.   □

@&#REFERENCES@&#

