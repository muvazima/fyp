@&#MAIN-TITLE@&#Solving the initial value problem of discrete geodesics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Shortest geodesic is not able to solve the initial value problem of discrete geodesic.


                        
                        
                           
                           Geodesic equation are second-order ODEs.


                        
                        
                           
                           We solve the initial value problem on triangle meshes by solving a first-order ODE


                        
                        
                           
                           The computed discrete geodesic path converges to the one on the smooth surface.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete geodesics

Initial value problem

Geodesic polar coordinates

@&#ABSTRACT@&#


               
               
                  Computing geodesic paths and distances is a common operation in computer graphics and computer-aided geometric design. The existing discrete geodesic algorithms are mainly designed to solve the boundary value problem, i.e., to find the shortest path between two given points. In this paper, we focus on the initial value problem, i.e., finding a uniquely determined geodesic path from a given point in any direction. Since the shortest paths do not provide the unique solution on triangle meshes, we solve the initial value problem in an indirect manner: given a fixed point and an initial tangent direction on a triangle mesh 
                        M
                     , we first compute a geodesic curve 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                      on a piecewise smooth surface 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                     , which well approximates the input mesh 
                        M
                      and can be constructed at little cost. Then, we solve a first-order ODE of the tangent vector using the fourth-order Runge–Kutta method, and parallel transport it along 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                     . When the geodesic curve reaches the boundary of the current patch, its tangent can be directly transported to the neighboring patch, thanks to the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuity along the common boundary of two adjacent patches. Finally, once the geodesic curve 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                      is available, we project it onto the underlying mesh 
                        M
                     , producing the discrete geodesic path 
                        γ
                     , which is guaranteed to be unique on 
                        M
                     . It is worth noting that our method is different from the conventional methods of directly solving the geodesic equation (i.e., a second-order ODE of the position) on piecewise smooth surfaces, which are difficult to implement due to the complicated representation of the geodesic equation involving Christoffel symbols. The proposed method, based on the first-order ODE of the tangent vector, is intuitive and easy for implementation. Our method is particularly useful for computing geodesic paths on low-resolution meshes which may have large and/or skinny triangles, since the conventional straightest geodesic paths are usually far from the ground truth.
               
            

@&#INTRODUCTION@&#

Computing geodesic distances and geodesic paths plays an important role in many fields, such as CAD/CAM  [1], path planning  [2], shape analysis  [3], parameterization  [4,5], segmentation  [6], and medial axis  [7]. Geodesics on smooth surfaces are well understood in classic differential geometry. However, the discrete geodesic problem, i.e., computing geodesic distances and paths on discrete domains such as polygonal meshes, is fundamentally different from its smooth counterpart, due to the difference between smooth and discrete domains. For example, geodesics is both straightest and locally shortest on smooth surfaces, but such a nice property does not hold on polygonal meshes. The discrete shortest geodesic is not equivalent to the discrete straightest geodesic, which bisects the vertex angles, since the former is a metric but the latter is not.

As a fundamental problem in computational geometry and geometric modeling, the discrete geodesic problem has been studied extensively in the past three decades. To date, many elegant algorithms have been proposed. Representative works include the exact
                     
                        1
                     
                     
                        1
                        If the numerical computation is exact, the computed geodesic distance is also exact.
                      algorithms (e.g., the Mitchell–Mount–Papadimitriou (MMP) algorithm  [8] and the Chen–Han (CH) algorithm  [9]), the PDE methods (e.g., the fast marching method  [10] and the heat method [11,12]), and the graph-theoretic methods (e.g., the saddle vertex graph method  [13]). These algorithms, however, are mainly designed to solve the boundary value problem, that is, to find the shortest path between two fixed endpoints.

Mitchell et al.  [8] proved that the general form of a shortest geodesic path 
                        γ
                      was an alternating sequence of vertices and (possibly empty) edges. The unfolded image of the path along any edge sequence is a straight line segment, and the curve angle of any vertex which 
                        γ
                      passes through is greater than or equal to 
                        π
                     . As Fig. 1
                      shows, when a shortest geodesic path 
                        γ
                      passes through a saddle vertex (whose curve angle is more than 
                        2
                        π
                     ), 
                        γ
                      splits into multiple outgoing geodesic paths. Therefore, the shortest geodesic paths, although well defined, are not able to solve the initial value problem of discrete geodesics, which aims at finding the unique geodesic path from a fixed point and in a given tangent direction.

In this paper, we present a method for solving the initial value problem on triangle meshes. To ensure a unique solution, we adopt an indirect strategy. Given a fixed point and an initial tangent direction on a triangle mesh 
                        M
                     , we first compute a geodesic curve 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                      on a piecewise smooth surface 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                     , which well approximates the input mesh 
                        M
                      and can be constructed at little cost. Then, we solve a first-order ODE of the tangent vector by the fourth-order Runge–Kutta method, and parallel transport it along 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                     . When the geodesic curve reaches the boundary of the current patch, its tangent vector can be directly transported to the neighboring patch, thanks to the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuity along the common boundary of two adjacent patches. Finally, once the geodesic curve 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                      is available, we project it onto the underlying mesh 
                        M
                     , producing the discrete geodesic path 
                        γ
                     , which is guaranteed to be unique on the triangle mesh 
                        M
                     . See Fig. 2
                     .

It is worth noting that our method is different from the conventional methods of directly solving the geodesic equation (i.e., a second-order ODE of the position) on the piecewise smooth surface, which are tedious and difficult to implement, due to the complicated representation of the geodesic equation involving Christoffel symbols. Based on the first-order ODE of the tangent vector, the proposed method is intuitive and easy to implement. We observe that our method is particularly useful for computing geodesic paths on low-resolution meshes with large and/or skinny triangles, where the conventional straightest geodesic paths are usually far from the ground truth. In addition, our method can be easily adapted to work on non-orientable surfaces.

@&#RELATED WORK@&#

This section presents the related work on computing geodesic paths on discrete domains and discrete differential geometry. As mentioned above, discrete geodesic paths are fundamentally different from geodesics on smooth surfaces, since the shortest geodesics and the straightest geodesics are not equivalent to each other any longer.

Shortest geodesics have been extensively studied and also widely used in computer graphics community. Existing methods for computing exact shortest geodesic paths on polyhedral surfaces can be generally grouped into two categories, namely, the MMP algorithm and the CH algorithm. Both methods are developed based on the continuous Dijkstra’s algorithm, that iteratively propagates the discrete wavefront from the source to the destination. They differ in the wavefront organization and propagation scheme. The MMP algorithm has an 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           log
                           n
                           )
                        
                      time complexity and an 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           )
                        
                      space complexity for a mesh with 
                        n
                      vertices. The CH algorithm runs in 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           )
                        
                      time and takes 
                        O
                        
                           (
                           n
                           )
                        
                      space. Different extensions on the two algorithms have been developed, which aim at parallelization  [14], performance improvement  [15–18] and robustness  [19], computing geodesic offsets  [20,21], geodesic loops  [22], and all-pairs geodesics  [23].

Straightest geodesics receives relatively less attention than shortest geodesics. Polthier and Schmies  [24] introduced the discrete geodesic curvature and defined the straightest geodesic on polyhedral surface as a path that has equal curve angle on both sides at each point. Then, they proposed the geodesic Euler method and the geodesic Runge–Kutta method for integrating a given vector field on a surface. Polthier and Schmies also developed the geodesic flow method  [25] to compute the evolution of the front of a point wave on a polyhedral surface. At each time step, the front is a topological circle on the surface  [26], where each point moves a constant distance in orthogonal direction to the curve by the straightest geodesic path. Kumar et al.  [27] observed that the straightest geodesic obtained by tracing the path with equal left and right curve angles was far from the correct geodesic curve on the smooth surface. Therefore, they proposed a sectional plane method, which takes into account the variation of the tessellation normal along the geodesic path. Kumar et al.’s method can be considered as an extrinsic Euler method, which solves the geodesic equation with the first-order approximation. Therefore, their method tends to suffer from serious numerical issue and may deviate from the true geodesic curve after only a few iterations. Based on the fast marching method and the straightest geodesic  [24], Martinez et al.  [28] proposed an iterative algorithm for computing the shortest path between two fixed points.

Convergence of discrete differential operators and quantities has also been studied in the past years. Under the assumption of convergence of surfaces in Hausdorff distance, Hildebrandt et al.  [29] proved that convergence of the following properties were equivalent: surface normals, surface area, metric tensors, and ​Laplace–Beltrami operators. Dai et al.  [30] derived the explicit formulae to the bounds of Hausdorff distance, normal distance, and Riemannian metric distortion between the smooth surface and the triangle mesh. They proved that the meshes induced from Delaunay triangulations of dense samples on a smooth surface were convergent to the smooth surface under both Hausdorff distance and normal fields. Moreover, the Riemannian metrics and the Laplace–Beltrami operators defined on Delaunay triangulations can also converge to those on smooth surfaces. Lieutier and Thibert  [31] proved that the convergence of shortest geodesics requires additional assumptions. The assumptions are concerning the rate of convergence of the normals and of the lengths of the edges of the triangulations. They pointed out that the edge lengths cannot converge faster to zero than the angles between the normals.

Computing geodesics on parametric surfaces, such as Bézier, B-splines, and NURBS, has also been well studied. Beck et al.  [32] computed geodesics on 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuous surfaces by solving four first-order ODEs. These equations were also used in  [27] for computing geodesics on NURBS surfaces. Patrikalakis and Bardis  [33] computed geodesic offsets of curves on rational B-splines using the initial-value integration. Maekawa  [34] computed the geodesic path between a point and a curve on a parametric surface. See  [35] for a detailed discussion. Chen et al.  [36] solved the geodesic equation on rational Bézier surfaces with at least 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuity, so that the Christoffel symbols were continuous across adjacent Bézier patches.

This section presents the background to differential geometry  [37,38], which will be used in Section  4.

Let 
                           p
                           ,
                           q
                           ∈
                           S
                         be two points on 
                           S
                        , and 
                           g
                         be the metric tensor of 
                           S
                        . The geodesic 
                           γ
                           
                              (
                              p
                              ,
                              q
                              )
                           
                         between 
                           p
                         and 
                           q
                         is the locally distance minimizer, which can be obtained by minimizing the following functional 
                           
                              
                                 E
                                 
                                    (
                                    γ
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ∫
                                 
                                    
                                       g
                                    
                                    
                                       γ
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 d
                                 t
                                 .
                              
                           
                         The Euler–Lagrange equation yields the geodesic equation 
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    
                                       d
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           
                              (
                              t
                              )
                           
                         are the local coordinates of 
                           γ
                           
                              (
                              t
                              )
                           
                        , and 
                           
                              
                                 Γ
                              
                              
                                 i
                                 j
                              
                              
                                 k
                              
                           
                         are the Christoffel symbols of the second kind. On smooth surfaces, a geodesic is both straightest and locally shortest. Furthermore, a geodesic is fully determined by an end point and a given tangent direction. See Fig. 3
                        . 
                           Theorem
                           Existence and Uniqueness


                           
                              Given a point 
                              
                                 p
                                 ∈
                                 S
                               
                              and a vector 
                              
                                 
                                    w
                                 
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       p
                                    
                                 
                              
                              , 
                              
                                 v
                                 ≠
                                 0
                              
                              , there exists an 
                              
                                 ϵ
                                 >
                                 0
                               
                              and a unique parameterized geodesic 
                              
                                 γ
                                 :
                                 
                                    (
                                    −
                                    ϵ
                                    ,
                                    ϵ
                                    )
                                 
                                 →
                                 S
                               
                              such that 
                              
                                 γ
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 p
                              
                              , and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    w
                                 
                              
                              .
                           

Geodesics naturally generalize straight lines to curved surfaces. Let 
                           S
                         be a regular surface and 
                           γ
                           
                              (
                              s
                              )
                           
                           :
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                           →
                           S
                         be a curve on 
                           S
                         parameterized by arc-length 
                           s
                        . The curve 
                           γ
                         passes through a point 
                           p
                           ∈
                           S
                        , with tangent vector 
                           
                              T
                           
                           =
                           
                              
                                 γ
                              
                              
                                 ̇
                              
                           
                        , normal vector 
                           
                              N
                           
                        , and binormal vector 
                           
                              B
                           
                           =
                           
                              T
                           
                           ×
                           
                              N
                           
                        . The curvature vector 
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                         is perpendicular to the tangent 
                           
                              T
                           
                        , i.e., 
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                           ⊥
                           
                              
                                 γ
                              
                              
                                 ̇
                              
                           
                        . The normal curvature 
                           
                              
                                 κ
                              
                              
                                 n
                              
                           
                         at the point 
                           p
                         is the amount of the curve’s curvature in the direction of the surface normal, i.e., 
                           
                              
                                 κ
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                           ⋅
                           
                              N
                           
                        . The geodesic curvature 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                         is defined by projecting 
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                         onto the binormal vector 
                           
                              B
                           
                        , i.e., 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                           =
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                           ⋅
                           
                              B
                           
                        . See Fig. 4
                        . The curvature of the curve 
                           γ
                         is related to both 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                         and 
                           
                              
                                 κ
                              
                              
                                 n
                              
                           
                        , 
                           κ
                           =
                           
                              ‖
                              
                                 
                                    γ
                                 
                                 
                                    ̈
                                 
                              
                              ‖
                           
                           =
                           
                              
                                 
                                    
                                       κ
                                    
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       κ
                                    
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . The curve 
                           γ
                         is a geodesic, if its geodesic curvature vanishes 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                           =
                           0
                        . The geodesic curvature measures how far the curve is from being a geodesic. A geodesic has vanishing geodesic curvature, meaning that it appears to curve in the ambient space whenever the surface curves, but does not curve within the surface.

@&#OVERVIEW@&#

Let 
                           M
                           =
                           
                              (
                              V
                              ,
                              E
                              ,
                              F
                              )
                           
                         be a triangle mesh, where 
                           V
                        , 
                           E
                        , and 
                           F
                         are the set of vertices, edges, and faces, respectively. We estimate the vertex normal using the weighted-average method with 1-ring neighborhood and Voronoi area weights  [39,40]. The tangent plane of vertex 
                           v
                        , denoted by 
                           
                              
                                 T
                              
                              
                                 v
                              
                           
                        , passes through 
                           v
                         and is perpendicular to 
                           v
                        ’s normal 
                           
                              N
                           
                           
                              (
                              v
                              )
                           
                        . We assume the input mesh 
                           M
                         is sampled from a smooth surface 
                           S
                         so that it converges to 
                           S
                         when the Hausdorff distance between 
                           S
                         and 
                           M
                         is sufficiently small and the normal fields on 
                           M
                         converge to those on 
                           S
                        .

Given an arbitrary point 
                           
                              p
                           
                           ∈
                           V
                        , and a tangent direction 
                           
                              w
                           
                           ∈
                           
                              
                                 T
                              
                              
                                 
                                    p
                                 
                              
                           
                        , our goal is to find a unique geodesic path which passes through 
                           
                              p
                           
                         in the direction 
                           
                              w
                           
                        . As mentioned above, we cannot use the shortest path, which may produce multiple solutions. Since the initial value problem is guaranteed to have a unique solution on 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuous surfaces, we consider a piecewise smooth surface 
                           
                              
                                 M
                              
                              
                                 ̂
                              
                           
                        , which approximates 
                           M
                         well and can be constructed from 
                           M
                         with little cost. In our implementation, we construct for each triangle 
                           f
                           ∈
                           F
                         a curved PN-triangle  [41]
                        
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                           ∈
                           
                              
                                 M
                              
                              
                                 ̂
                              
                           
                        , which is a three-sided cubic Bézier patch corresponding to a triangle 
                           f
                           ∈
                           F
                         of the underlying mesh 
                           M
                        . The curved PN-triangle 
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                         interpolates both the position and normal of 
                           f
                        ’s three corners. See Fig. 5
                        . By using rational blending  [42], adjacent Bźier patches can be glued so that they have 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         continuity along the common edge. See Fig. 7. Note that other methods for locally construct piecewise smooth surfaces (e.g.,  [43]) can also be adopted.

Throughout this paper, if an object is defined on both the underlying triangle mesh 
                           M
                         and the piecewise smooth surface 
                           
                              
                                 M
                              
                              
                                 ̂
                              
                           
                        , we distinguish its notations by the hat symbol. For example, point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 ̂
                              
                           
                         is defined on the curved PNG1-triangle 
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                         and point 
                           
                              p
                           
                         is defined on the corresponding planar triangle 
                           f
                        . Note that the tangent vectors are always defined on the curved surface 
                           
                              
                                 M
                              
                              
                                 ̂
                              
                           
                        , thus, we simply denote them in the conventional way, i.e., using boldface font.

Let 
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                         be the curved patch containing 
                           
                              p
                           
                        . We compute a unique geodesic path 
                           
                              
                                 γ
                              
                              
                                 ̂
                              
                           
                           ∈
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                         using the fourth-order Runge–Kutta method and project 
                           
                              
                                 γ
                              
                              
                                 ̂
                              
                           
                         onto the underlying triangle face 
                           f
                        . Thanks to the 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         continuity across the boundary, we can transfer the tangent direction to the neighboring patch, when 
                           
                              
                                 γ
                              
                              
                                 ̂
                              
                           
                         crosses the boundary of 
                           
                              
                                 f
                              
                              
                                 ̂
                              
                           
                        . This allows us to extend 
                           
                              
                                 γ
                              
                              
                                 ̂
                              
                           
                         to its neighboring patch, as shown in Fig. 7. We continue the procedure until the geodesic curve reaches the boundary or its length exceeds the user-specified threshold.

To compute the geodesic curve 
                           
                              
                                 γ
                              
                              
                                 ̂
                              
                           
                         on 
                           
                              
                                 M
                              
                              
                                 ̂
                              
                           
                         numerically, our algorithm takes a step length 
                           δ
                         as input and solves the initial value problem in an iterative manner. Each iteration contains the following four steps, as illustrated in Fig. 6
                        :
                        
                           
                              (i)
                              The point 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 , the normal 
                                    
                                       
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 , and a tangent vector 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                       
                                    
                                  define a sectional plane 
                                    π
                                 . Find a point 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ∈
                                    π
                                    ∩
                                    
                                       
                                          M
                                       
                                       
                                          ̂
                                       
                                    
                                  such that 
                                    d
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    δ
                                 , as shown in Fig. 6(a).

Let 
                                    
                                       
                                          f
                                       
                                       
                                          ̂
                                       
                                    
                                  be the PNG1-triangle containing 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  and 
                                    f
                                    ∈
                                    F
                                  the underlying triangle. Project 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  onto 
                                    f
                                  along its normal direction and set 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  the foot point. If the foot point is outside 
                                    f
                                 , we simply reset 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  as the intersection of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  and the corresponding edge of 
                                    f
                                 . See Fig. 6(b).

Compute the tangent 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                  using the fourth-order Runge–Kutta method. See Section  4.3 and Fig. 6(c).

Parallel transport the tangent 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                  along 
                                    
                                       
                                          γ
                                       
                                       
                                          ̂
                                       
                                    
                                  to 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 . See Section  4.4 and Fig. 6(d).


                        
                           
                              
                           
                        
                     

Let 
                           γ
                           ∈
                           S
                         be an arc-length parameterized geodesic curve on a smooth surface 
                           S
                        . Since its geodesic curvature vanishes 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                           =
                           0
                        , the curvature vector 
                           
                              
                                 γ
                              
                              
                                 ̈
                              
                           
                         is parallel to the surface normal. Therefore, the Frenet–Serret frame of 
                           γ
                         coincides with the Darboux frame of surface 
                           S
                        , i.e.,  
                           
                              (2)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   s
                                                
                                             
                                             =
                                             
                                                
                                                   κ
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                N
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   s
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   κ
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                T
                                             
                                             +
                                             τ
                                             
                                                B
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   s
                                                
                                             
                                             =
                                             τ
                                             
                                                N
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           τ
                         is the torsion of 
                           γ
                        .

Since 
                           
                              
                                 κ
                              
                              
                                 n
                              
                           
                           =
                           −
                           
                              
                                 
                                    d
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    d
                                 
                                 s
                              
                           
                           •
                           
                              T
                           
                        , we have the following first-order ODE on tangent 
                           
                              T
                           
                        : 
                           
                              (3)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          d
                                       
                                       s
                                    
                                 
                                 =
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             d
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             d
                                          
                                          s
                                       
                                    
                                    •
                                    
                                       T
                                    
                                    )
                                 
                                 
                                    N
                                 
                                 .
                              
                           
                        
                     

Given the initial value 
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           =
                           0
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 0
                              
                           
                           =
                           
                              w
                           
                        , we solve the above ODE by employing the fourth order Runge–Kutta method, where the accumulated error is in the order of 
                           O
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        . We define function 
                           f
                           
                              (
                              s
                              ,
                              
                                 T
                              
                              )
                           
                           =
                           −
                           
                              (
                              
                                 
                                    
                                       d
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       d
                                    
                                    s
                                 
                              
                              •
                              
                                 T
                              
                              )
                           
                           
                              N
                           
                        , and compute 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                              
                           
                        , for 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                        , as follows: 
                           
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          δ
                                       
                                       
                                          6
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (5)
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    δ
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       δ
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       δ
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

We iteratively update the tangent direction using the above equations and trace the geodesic.

Note that the computed tangent 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                         is located at 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 i
                              
                           
                        . So we need to parallel transport 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                         to 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         along the geodesic curve 
                           γ
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                        .

Let 
                           α
                         be the angle between 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                              
                           
                         at 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 i
                              
                           
                        . Projecting 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       ⃗
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         onto the tangent plane 
                           
                              
                                 T
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           
                        , we obtain a reference tangent direction 
                           
                              T
                           
                        . With the normal 
                           
                              N
                           
                         at 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        , we compute the binormal 
                           
                              B
                           
                           =
                           
                              T
                           
                           ×
                           
                              N
                           
                        . Finally, we compute 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           =
                           
                              T
                           
                           +
                           cos
                           α
                           
                              B
                           
                        . Fig. 6(d) illustrates the parallel transport of tangent vector.

@&#EXPERIMENTAL RESULTS@&#

We implemented our algorithm in C++ and evaluated it on a PC with an Intel Core2 2.83 GHz CPU and 4 GB main memory. To make the results unitless, we uniformly scale all models to be bounded by a unit cube. We measured the running time of computing 60 geodesic paths, which evenly emanate from 100 randomly selected source points and have the length 
                        
                           
                              3
                           
                        
                     . Theoretically, the time complexity of solving the ODE (lines 3–9 in Algorithm 1) depends only on the maximal length 
                        L
                      and the step length 
                        δ
                     . In practice, we observe that the mesh complexity also affects the running time slightly, since the point location is triangulation dependent. See Fig. 8
                     .


                     Fig. 9
                      shows the all-direction geodesic paths on several common 3D models in graphics community. We observe that most geodesic paths on real-world models do not return to the initial point, thus, they can be arbitrarily long. Computational results show that our method is numerically stable and works well on meshes with large and skinny triangles as well as sharp features. See Figs. 2 and 12. Fig. 11 demonstrates the results of our algorithm for computing the local exponential map on triangle meshes, which naturally define polar coordinates on 3D surfaces. Our method can be also applied to non-orientable surfaces, as shown in Fig. 10
                     . 
                     
                  

Our method computes the discrete geodesic path 
                        γ
                      by projecting the unique geodesic 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                     , which is defined on the piecewise smooth surface 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                     , onto the underlying piecewise linear surface 
                        M
                     . Thus, it is natural to consider the “gap” between 
                        γ
                      and 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                     , and the length difference 
                        
                           |
                           
                              len
                           
                           
                              (
                              γ
                              )
                           
                           −
                           
                              len
                           
                           
                              (
                              
                                 
                                    γ
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                           |
                        
                      as the convergence measures. We construct five synthetic surfaces, namely, sphere, ellipsoid, paraboloid, hyperboloid, and torus, with increasing resolutions. See Fig. 13
                     . All mesh vertices are on the smooth surfaces, and we compute the vertex normals analytically. Fig. 13(a) shows that when the mesh resolution is sufficiently high, the curved PNG1-triangles converge to the smooth surfaces. For each surface, we solved the initial value problem at 10 points and assigned 60 evenly distributed tangent directions for each point. Then we computed the length difference 
                        
                           Δ
                        
                        L
                        =
                        
                           |
                           
                              len
                           
                           
                              (
                              γ
                              )
                           
                           −
                           
                              len
                           
                           
                              (
                              
                                 
                                    γ
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                           |
                        
                      and the area of the gap between 
                        γ
                      and 
                        
                           
                              γ
                           
                           
                              ̂
                           
                        
                     . As Fig. 13(b) (c) shows, both the gap area and length difference converge to zero as the average edge length 
                        h
                      decreases.

@&#DISCUSSION@&#

Computing geodesics on parametric surfaces, such as B-spline surfaces and NURBSs, has been studied in the literature [33,27,36,34]. These methods directly solve the standard geodesic equation (1), which is a second-order ODE of the position. One, of course, can borrow their approaches to the PNG1-triangles, which are cubic Bézier patches. However, due to complicated representation of the Christoffel symbols on triangular patches, the implementation would be tedious. Moreover, surfaces must be at least 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuous to ensure that the Christoffel symbols are continuous. In contrast, our method solves the first-order ODE of the tangent vector on 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         continuity patches, which is intuitive and easy to implement. Moreover, as Eq. (3) shows, the derivative of tangent depends on the change of normal, which can be computed efficiently on cubic Bézier patches.

Polthier and Schmies  [24] defined the straightest geodesic as a curve that bisects the total vertex angle. 
                           Definition
                           Straightest Geodesic


                           A curve 
                                 γ
                               on a polyhedral surface 
                                 M
                               is called a straightest geodesic if for any point 
                                 p
                                 ∈
                                 γ
                               the left and right curve angles 
                                 
                                    
                                       θ
                                    
                                    
                                       l
                                    
                                 
                               and 
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                    
                                 
                               at 
                                 p
                               are equal, that is, the geodesic curvature vanishes at 
                                 p
                              . See Fig. 14
                              (a).

A discrete geodesic 
                           γ
                         containing no surface vertex is both straightest and locally shortest. In general, the straightest geodesic is not equivalent to the shortest geodesic on polyhedral surfaces. We summarize the differences between them as follows: 
                           
                              –
                              The shortest geodesic distance is a metric, while the straightest geodesic distance is not, due to the violation of the triangle inequality. See Fig. 14(c).

The shortest geodesic path cannot pass through a spherical vertex 
                                    p
                                  with total vertex angle 
                                    θ
                                    <
                                    2
                                    π
                                 , since moving it off 
                                    p
                                  will shorten the length. On the other hand, any path through 
                                    p
                                  that bisects 
                                    θ
                                  is a straightest geodesic. See Fig. 14(b).

The shortest geodesics through a hyperbolic vertex with total vertex angle 
                                    θ
                                    >
                                    2
                                    π
                                  have geodesic curvature 
                                    
                                       
                                          κ
                                       
                                       
                                          g
                                       
                                    
                                  in the interval 
                                    
                                       [
                                       −
                                       π
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                2
                                                π
                                             
                                             
                                                θ
                                             
                                          
                                          )
                                       
                                       ,
                                       π
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                2
                                                π
                                             
                                             
                                                θ
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 . Among these shortest geodesic paths, only the one with zero geodesic curvature is the straightest geodesic.

The shortest geodesics in metric geometry solve the boundary value problem of connecting two given points on a manifold with a locally shortest curve. The straightest geodesics do not solve the boundary value problem, since there exists shadow region in the neighborhood of a hyperbolic vertex, where points cannot be joined by a straightest geodesic. Instead, the straightest geodesics solve the initial value problem with a given position and an initial tangent direction (see Fig. 15
                                 ).

The shortest geodesic distances converge to geodesic distances on smooth surfaces at a quadratic rate  [11], whereas the straightest geodesics do not converge  [31].

It is worth noting that our method is fundamentally different from the straightest geodesic: our geodesic path is a polyline inside a triangle, whereas a straightest geodesic path, when restricting to a triangle, must be straight line. We observe that straightest geodesics are too “rigid” to approximate analytic geodesics on low-resolution meshes. As Fig. 16
                         shows, the straightest geodesic is far from the ground truth on a low-resolution torus model, which has only 300 faces. Our method, in sharp contrast, is more flexible, providing a high quality approximation when the step length is sufficiently small. We also observe that our results and the straightest geodesics are similar when the input mesh has a sufficiently high resolution and fairly good triangulation. This is not a surprise, since the vertex normals for each such triangle do not vary too much. Thus, our method is particularly useful for computing geodesic paths for low-resolution meshes which may contain many large and/or skinny triangles.

Both the performance and the accuracy of our algorithm depend on the step length, i.e., the smaller the step length, the better accuracy we obtain, at the price of higher computational cost. The results reported above are based on fixed step length. In practice, adaptive step length may improve the performance without compromising the quality, Note that the normal variance within an iteration is small given a short step length 
                           δ
                        , hereby the adjustment of tangent direction is not significant. As suggested by the adaptive length in the Runge–Kutta method  [44], we adopted the following heuristic to determine the step length in our implementation. If the length of 
                           
                              d
                           
                           
                              N
                           
                         is less than a user-specified tolerance 
                           
                              tol
                           
                        , we simply computed the locally straightest geodesic for this iteration. Otherwise, we adjusted the tangent direction with an adaptive step length 
                           
                              
                                 δ
                              
                              
                                 a
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 0.9
                                 ×
                                 δ
                                 ×
                                 
                                    
                                       
                                          tol
                                       
                                    
                                    
                                       
                                          ‖
                                          
                                             d
                                          
                                          
                                             N
                                          
                                          ‖
                                       
                                    
                                 
                                 .
                              
                           
                         Empirically, we set the local error tolerance 
                           
                              tol
                           
                           =
                           
                              
                                 h
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       6
                                    
                                 
                              
                           
                        . Table 1
                         shows the performance and quality measurements of our algorithm with fixed step length and adaptive step length.

@&#CONCLUSION@&#

This paper presents a method to solve the initial value problem of discrete geodesics. Since the commonly used shortest geodesic  [8] does not produce a unique solution, we solve the problem by computing a geodesic curve on a piecewise smooth surface 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                     , which well approximates 
                        M
                      and can be constructed at little cost. Each patch in 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                      is a three-sided cubic Bézier spline, thus, it has a unique geodesic curve through the given point in any direction. We solve a first-order ODE of the tangent by the Runge–Kutta method and adopt parallel transport to move the tangent along the geodesic curve. When the geodesic curve reaches the boundary of the current patch, its tangent can be transported to the neighboring patch, thanks to the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuity along the common boundary of two adjacent patches. We project the geodesic curve from 
                        
                           
                              M
                           
                           
                              ̂
                           
                        
                      onto the underlying mesh 
                        M
                      to obtain the unique solution of the initial value problem. We define the error metric as the gap between the two geodesic curves and observe that the computed discrete geodesic converges linearly to its smooth counterpart with increasing mesh resolution. Experimental results show that our method is particularly useful for computing geodesic paths for low-resolution meshes which may contain many large and/or skinny triangles.

@&#ACKNOWLEDGMENTS@&#

This project was partially supported by the National Research Foundation, Prime Minister’s Office, Singapore under its IDM Futures Funding Initiative and administered by the Interactive and Digital Media Programme Office. P. Cheng is supported by the Ph.D. scholarship from the Institute for Media Innovation, NTU. Y.-J. Liu is partially supported by the Natural Science Foundation of China (61432003, 61322206) and the TNList Cross-discipline Foundation. C. Tu is partially supported by the Natural Science Foundation of China 61332015 and 61272242. Y. He is partially supported by RG40/12 and MOE2013-T2-2-011.

@&#REFERENCES@&#

