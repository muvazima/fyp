@&#MAIN-TITLE@&#Fast solver for some computational imaging problems: A regularized weighted least-squares approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Regularized weighted least-squares framework.


                        
                        
                           
                           Conditioning estimation and improvement.


                        
                        
                           
                           Fast solver for image interpolation, filtering and registration.


                        
                        
                           
                           Fast solver for gradient-vector flow estimation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Regularized weighted least-squares

Preconditioned conjugate gradient

Preconditioning

Condition number

@&#ABSTRACT@&#


               
               
                  In this paper we propose to solve a range of computational imaging problems under a unified perspective of a regularized weighted least-squares (RWLS) framework. These problems include data smoothing and completion, edge-preserving filtering, gradient-vector flow estimation, and image registration. Although originally very different, they are special cases of the RWLS model using different data weightings and regularization penalties. Numerically, we propose a preconditioned conjugate gradient scheme which is particularly efficient in solving RWLS problems. We provide a detailed analysis of the system conditioning justifying our choice of the preconditioner that improves the convergence. This numerical solver, which is simple, scalable and parallelizable, is found to outperform most of the existing schemes for these imaging problems in terms of convergence rate.
               
            

@&#INTRODUCTION@&#

In this paper we propose to solve some classical imaging problems with a unified quadratic optimization perspective. These topics include data smoothing and completion, edge-preserving filtering, gradient-vector flow estimation, and image registration. We are particularly interested in high-performance numerical solvers for these problems, as they are widely used as building blocks of numerous applications in many domains such as computer vision and medical imaging [1].

Concretely, we look at the framework of the regularized weighted least-squares (RWLS):
                        
                           (1)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    :
                                    
                                       
                                          R
                                       
                                       
                                          D
                                       
                                    
                                    →
                                    R
                                 
                              
                              J
                              (
                              u
                              )
                              :
                              =
                              
                                 ∫
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                              w
                              (
                              x
                              )
                              
                                 
                                    (
                                    u
                                    (
                                    x
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                              +
                              
                                 
                                    γ
                                 
                                 
                                    2
                                    α
                                 
                              
                              
                                 ∫
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          L
                                       
                                       
                                          α
                                       
                                    
                                    u
                                    (
                                    x
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                           
                        
                      Here, 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        (
                        x
                        )
                        ∈
                        R
                      represents the observed measurement at point 
                        x
                        ∈
                        
                           
                              R
                           
                           
                              D
                           
                        
                     , and 
                        u
                        (
                        x
                        )
                      the data to estimate. 
                        w
                        (
                        x
                        )
                        ⩾
                        0
                      are non-negative weights, which can be considered as confidence levels of the measurements. 
                        
                           
                              L
                           
                           
                              α
                           
                        
                        u
                        :
                        
                           
                              R
                           
                           
                              D
                           
                        
                        ↦
                        
                           
                              R
                           
                           
                              n
                           
                        
                      represents some regularization operator 
                        
                           
                              L
                           
                           
                              α
                           
                        
                      applying a penalty on u. We will restrict 
                        
                           
                              L
                           
                           
                              α
                           
                        
                      to be a linear fractional differential operator of order 
                        α
                        >
                        0
                     , such as the gradient and the Laplacian. Further, 
                        γ
                        >
                        0
                      is a trade-off parameter between the weighted data-fidelity term and the regularity-penalty term.

In this work we will focus on the discrete RWLS problem, or the discrete counterpart of Eq. (1):
                        
                           (2)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                              J
                              (
                              u
                              )
                              :
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          W
                                       
                                       
                                          
                                             1
                                             2
                                          
                                       
                                    
                                    (
                                    u
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    2
                                    α
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          L
                                       
                                       
                                          α
                                       
                                    
                                    u
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        
                      Here, 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              N
                           
                        
                      is the vector of the measurements of length N. For multi-dimensional measurements, the data are assumed to be vectorized in the lexicographical order. 
                        W
                        ∈
                        
                           
                              R
                           
                           
                              N
                              ×
                              N
                           
                        
                      stands for a diagonal weighting matrix with the weights on its diagonal 
                        
                           
                              W
                           
                           
                              i
                              ,
                              i
                           
                        
                        =
                        
                           
                              w
                           
                           
                              i
                           
                        
                        ⩾
                        0
                      for 
                        i
                        =
                        0
                        ,
                        …
                        ,
                        N
                        −
                        1
                     . 
                        
                           
                              L
                           
                           
                              α
                           
                        
                      in the discrete setting will be a matrix representing the differential operator and we keep the same notation. It will be clear (see Section 4) that each of our aforementioned imaging problems fits Eq. (2) by choosing a particular set of weights W and a particular regularization operator 
                        
                           
                              L
                           
                           
                              α
                           
                        
                     .

Our main contribution here is proposing an efficient preconditioned conjugate gradient (PCG) scheme which solves RWLS, and hence the above imaging problems. We provide a detailed analysis of the system conditioning justifying our choice of the preconditioner that improves the convergence. Surprisingly, this simple solver is found to outperform most of the state-of-the-art numerical schemes proposed for those problems. In particular, the convergence rate of PCG is spectacular, with a gain up to an order of magnitude observed in some of our experiments. Additionally, the PCG has the advantages of being easily implementable, scalable and parallelizable.

This paper is organized as follows. Section 2 describes in detail the RWLS framework, and the proposed PCG solver. Section 3 analyzes the choice of the preconditioner by showing its potential in reducing the condition number of the problem and hence improving the convergence rate. Then, Section 4 presents the different imaging problems revisited and solved by the RWLS approach. We show the superior performance of our method compared to various existing schemes. We also discuss an extension of the RWLS model in Section 5. Our conclusions are drawn in Section 6. Finally, mathematical details are deferred to the appendices.

Let us use an example in the 1-dimensional (1D) RWLS to introduce our notations and present our main results. The setting can be easily extended to multi-dimensional cases (Section 2.5).

Consider the following RWLS in the continuous setting where the regularization operator is the first derivative (i.e., 
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                           =
                           d
                           /
                           d
                           x
                         with 
                           α
                           =
                           1
                        ):
                           
                              (3)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    u
                                 
                                 J
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∫
                                    R
                                 
                                 w
                                 (
                                 x
                                 )
                                 
                                    
                                       (
                                       u
                                       (
                                       x
                                       )
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∫
                                    R
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                              
                           
                         This choice makes Eq. (3) a Dirichlet regularized regression problem. Its solution is the stationary point to the associated Euler–Lagrange equation:
                           
                              (4)
                              
                                 w
                                 (
                                 x
                                 )
                                 u
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 w
                                 (
                                 x
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 ∈
                                 R
                              
                           
                        
                     

In the discrete version, the operator 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         will be represented by a first-order finite-difference matrix. For example, let 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         be the following circulant matrix (Eq. (5)), which corresponds to a filter 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           =
                           [
                           1
                           ,
                           −
                           1
                           ]
                           /
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                         with a periodic boundary condition.
                           
                              (5)
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 :
                                 =
                                 
                                    1
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         Here 
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           >
                           0
                         represents the finite-difference spacing.

To solve Eq. (2), one sets the gradient of 
                           J
                           (
                           u
                           )
                         to zero, and obtain a linear system which is no more than the discrete counterpart of Eq. (4):
                           
                              (6)
                              
                                 A
                                 u
                                 =
                                 b
                                 ,
                                 
                                 where 
                                 A
                                 :
                                 =
                                 W
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                  and 
                                 b
                                 :
                                 =
                                 W
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         We used 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                         to denote the conjugate transpose of 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        . It follows that 
                           (
                           −
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           )
                         is a Hermitian matrix which represents a second-order differential filter [2] 
                        
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           =
                           [
                           1
                           ,
                           −
                           2
                           ,
                           1
                           ]
                           /
                           
                              
                                 h
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                        . In addition, A is Hermitian and semi-positive definite.


                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         is diagonalizable by the fast Fourier transform (FFT) matrix F and its k-th eigenvalue is 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           =
                           (
                           
                              
                                 e
                              
                              
                                 −
                                 j
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           −
                           1
                           )
                           /
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                         with 
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           :
                           =
                           2
                           π
                           k
                           /
                           N
                        :
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 Λ
                                 F
                                 ,
                                 
                                 Λ
                                 :
                                 =
                                 
                                    diag
                                 
                                 [
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 ]
                              
                           
                         Due to the orthonormality of FFT, one has 
                           
                              
                                 F
                              
                              
                                 ⁎
                              
                           
                           F
                           =
                           I
                         where I is the identity matrix. Therefore A can be rewritten as:
                           
                              
                                 A
                                 =
                                 W
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 F
                                 ,
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       Λ
                                    
                                    
                                       ⁎
                                    
                                 
                                 Λ
                              
                           
                         where 
                           
                              
                                 Λ
                              
                              
                                 ˜
                              
                           
                         is the diagonal matrix of the eigenvalues 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                           
                         of 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         which are given by 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                           
                           :
                           =
                           
                              
                                 |
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 |
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 [
                                 
                                    2
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                                 sin
                                 (
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 /
                                 2
                                 )
                                 ]
                              
                              
                                 2
                              
                           
                        .

The FFT choice above is clearly due to the assumed periodic boundary condition. More generally, the Hermitian matrix 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         always possesses an orthonormal eigen-decomposition:
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 B
                                 ,
                                 
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 :
                                 =
                                 
                                    diag
                                 
                                 
                                    [
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                         where B is some orthonormal matrix, and 
                           
                              
                                 (
                                 
                                    
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         are the eigenvalues of 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         written in the modulus form to emphasize their non-negative nature. In practice, the basis B will represent trigonometric transforms, i.e. FFT, DCT (discrete cosine transform), and DST (discrete sine transform), with a periodic, an even symmetric, and an odd-symmetric boundary conditions [2] respectively imposed on the matrix 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        .

Consequently, for any order 
                           α
                           >
                           0
                         one can define 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         to be a fractional differential operator such that:
                           
                              (7)
                              
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 B
                                 ,
                                 
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 :
                                 =
                                 
                                    diag
                                 
                                 
                                    [
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          |
                                       
                                       
                                          2
                                          α
                                       
                                    
                                    ,
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          2
                                          α
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          2
                                          α
                                       
                                    
                                    ]
                                 
                              
                           
                         We will keep noting the spectrum of 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         by
                           
                              (8)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       |
                                       Λ
                                       |
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                    
                                       2
                                       α
                                    
                                 
                              
                           
                         In the subsequent presentation, we will concentrate on the periodic boundary condition (i.e., 
                           B
                           =
                           F
                        ).

Similar to Eq. (6), for an arbitrary 
                           α
                           >
                           0
                        , the minimizer of Eq. (2) is the solution to the following linear system:
                           
                              (9)
                              
                                 A
                                 u
                                 =
                                 b
                                 ,
                                 
                                 where 
                                 A
                                 :
                                 =
                                 W
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                 
                                 
                                 and
                                 
                                 b
                                 :
                                 =
                                 W
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         where A is Hermitian and semi-positive definite, and can be written as:
                           
                              (10)
                              
                                 A
                                 =
                                 W
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 F
                              
                           
                         The k-th eigenvalue of 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         is given by 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 |
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 |
                              
                              
                                 2
                                 α
                              
                           
                           =
                           
                              
                                 [
                                 
                                    2
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                                 sin
                                 (
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 /
                                 2
                                 )
                                 ]
                              
                              
                                 2
                                 α
                              
                           
                        . These definitions will be extended to multi-dimensional case in Section 2.5.

We keep considering the 1D RWLS problem. If the weights are everywhere constant (say 
                           W
                           =
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           I
                         for some constant 
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                        ), A has an explicit inverse. The solution is given by a linear filtering:
                           
                              (11)
                              
                                 u
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 b
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             ¯
                                          
                                       
                                       I
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                             α
                                          
                                       
                                       
                                          
                                             Λ
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 F
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         In plain words, Eq. (11) signifies:
                           
                              (i)
                              take the Fourier transform of 
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                 ;

weight the spectrum by 
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    /
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                          α
                                       
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                  in a pointwise manner;

take the inverse Fourier transform.

Regarding the case of non-constant weights, A no longer has an explicit inverse in general. However some asymptotic analysis sheds light on the expected behavior of the solution.

Suppose that the weights are nowhere zero, 
                           α
                           =
                           1
                         and a sufficiently small γ such that one can consider the first-order approximation of the solution:
                           
                              (12)
                              
                                 u
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 b
                                 =
                                 
                                    
                                       (
                                       W
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 W
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       I
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ≈
                                 
                                    (
                                    I
                                    −
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         It can be seen that Eq. (12) represents a step of diffusion on 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                         where the step length is controlled by 
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           
                              
                                 W
                              
                              
                                 −
                                 1
                              
                           
                        . Clearly, a data point associated with a large weight has a small step length and will undergo little change, while a point with a small weight (or large step) will tend to be blurred out by the diffusion process.

Generally we resort to a PCG scheme for iteratively solving the linear system 
                           A
                           u
                           =
                           b
                        . Let us point out that A is strictly positive definite if the null space of W and that of 
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         do not intersect. This is the case in Eq. (10) as long as the weights are not all zero.

Our preconditioner is formulated as
                           
                              (13)
                              
                                 M
                                 :
                                 =
                                 
                                    
                                       (
                                       ν
                                       I
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                             α
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                          
                                             Λ
                                          
                                          
                                             ˜
                                          
                                       
                                       F
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 H
                                 F
                              
                           
                         where
                           
                              (14)
                              
                                 H
                                 :
                                 =
                                 
                                    
                                       (
                                       ν
                                       I
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                             α
                                          
                                       
                                       
                                          
                                             Λ
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                         The scalar parameter 
                           ν
                           >
                           0
                         is tunable. Note that Eq. (13) can be interpreted as a filter with the spectrum defined by Eq. (14). The PCG iteratively solves the system 
                           M
                           A
                           u
                           =
                           M
                           b
                         which is equivalent to 
                           A
                           u
                           =
                           b
                         but has a better convergence rate when M is properly chosen. The analysis and the choice of the preconditioner are detailed in Section 3.

In practice, PCG method does not need to explicitly store the huge matrices A and M. Instead, given any vector x one only needs to implement the matrix–vector applications 
                           A
                           x
                         and 
                           M
                           x
                        . These operations only involve the FFT, and pointwise additions and multiplications in the Fourier and in the signal domains. Moreover, the eigenvalues 
                           
                              
                                 Λ
                              
                              
                                 ˜
                              
                           
                         can be pre-computed for a given regularization operator. As a consequence, the PCG solver runs very fast and is inherently scalable and parallelizable.

There is no unique way of extending Eq. (2) to multi-dimensional situations. For any extension, we only need to care about the form of 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         in Eq. (9). In this paper, we choose 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         to be any discrete version of the (negative) fractional Laplacian of order α:
                           
                              (15)
                              
                                 
                                    
                                       (
                                       −
                                       Δ
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       (
                                       −
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       −
                                       ⋯
                                       −
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   D
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                           
                         where D is the dimension. Note that 
                           
                              
                                 (
                                 −
                                 Δ
                                 )
                              
                              
                                 α
                              
                           
                         should be understood in the Fourier sense. It is associated with the spectrum 
                           
                              
                                 |
                                 
                                    
                                       ω
                                    
                                    
                                       s
                                    
                                 
                                 |
                              
                              
                                 2
                                 α
                              
                           
                         where 
                           
                              
                                 ω
                              
                              
                                 s
                              
                           
                         is the spatial frequency in the continuous domain.

The rationale of this choice relies on its consistency with two important regularization kinds, i.e., the continuous RWLS energy (Eq. (1)) where the regularization term is either set to: (a) the Dirichlet energy, or to (b) the thin-plate spline bending energy with a periodic boundary condition. In both cases, the Laplacian operator shows up in the associated Euler–Lagrange equations.

For a D-dimension dataset of size 
                           
                              
                                 N
                              
                              
                                 1
                              
                           
                           ×
                           
                              
                                 N
                              
                              
                                 2
                              
                           
                           ×
                           ⋯
                           ×
                           
                              
                                 N
                              
                              
                                 D
                              
                           
                        , the eigenvalues of 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         are written in the multi-index form:
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             d
                                             =
                                             1
                                          
                                          D
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   (
                                                   d
                                                   )
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 
                                    {
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          D
                                       
                                    
                                    )
                                    :
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          d
                                       
                                    
                                    −
                                    1
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                           
                         is the 
                           
                              
                                 k
                              
                              
                                 d
                              
                           
                        -th eigenvalue of the matrix representing the 1D first-order derivative along the dimension d, i.e., 
                           ∂
                           /
                           ∂
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                        . Under the periodic boundary condition, one has
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             d
                                             =
                                             1
                                          
                                          D
                                       
                                       
                                          
                                             [
                                             
                                                2
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                             sin
                                             
                                                (
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                                )
                                             
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 :
                                 =
                                 2
                                 π
                                 
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 /
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        
                     

For a positive-definite linear system 
                        A
                        u
                        =
                        b
                     , the condition number of the matrix A is defined as the ratio between its maximum eigenvalue 
                        
                           
                              λ
                           
                           
                              max
                           
                        
                        (
                        A
                        )
                      and its minimum one 
                        
                           
                              λ
                           
                           
                              min
                           
                        
                        (
                        A
                        )
                     , i.e., 
                        κ
                        (
                        A
                        )
                        :
                        =
                        
                           
                              λ
                           
                           
                              max
                           
                        
                        (
                        A
                        )
                        /
                        
                           
                              λ
                           
                           
                              min
                           
                        
                        (
                        A
                        )
                     . It is known that the convergence of a conjugate gradient method is faster if the condition number is smaller (i.e., closer to 1) [3], or in other words, if the spectrum of A is more compact. In this sense, 
                        κ
                        (
                        A
                        )
                      can also be deemed as a measure of the spectral compactness. The maximal compactness is achieved by a scalar matrix 
                        A
                        =
                        c
                        I
                        
                        (
                        c
                        >
                        0
                        )
                      where one has 
                        κ
                        (
                        A
                        )
                        =
                        1
                     .

The purpose of a preconditioner is to improve the conditioning of a linear system. In our case the preconditioner M is written in the form of Eq. (13). In the subsequent sections, we make detailed analysis of the system conditioning before and after introducing the preconditioner M (Section 3.1), and provide suggestions of choosing the parameter ν (Section 3.2).

Exact computation of the condition number turns out to be prohibitive for large data, as we have to evaluate the eigenvalues of a huge-size matrix. Alternatively, we will introduce another spectral compactness measure based on the coefficient of variation (CV) of the spectrum. Although different from the condition number, the CV is found to be directly related to a certain upper bound of the condition number. It is in this sense that the CV can be deemed as an estimator of the system conditioning. Moreover, this measure possesses an explicit expression that can be easily evaluated.

Let us first establish some notations and preliminary results. Given an N by N matrix G with real eigenvalues, we define:
                              
                                 (18)
                                 
                                    μ
                                    (
                                    G
                                    )
                                    :
                                    =
                                    
                                       1
                                       N
                                    
                                    tr
                                    (
                                    G
                                    )
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    G
                                    )
                                    :
                                    =
                                    μ
                                    
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    G
                                    )
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    τ
                                    (
                                    G
                                    )
                                    :
                                    =
                                    
                                       
                                          σ
                                          (
                                          G
                                          )
                                       
                                       
                                          μ
                                          (
                                          G
                                          )
                                       
                                    
                                 
                              
                            where 
                              tr
                              (
                              G
                              )
                            denotes the trace of G. It can be seen that Eq. (18), Eq. (19) and Eq. (20) represent the average, the variance and the CV of the spectrum of G.

We recall the form of the preconditioner in Eq. (13). The diagonal matrix H (Eq. (14)) contains on its diagonal the eigenvalues of M written as
                              
                                 (21)
                                 
                                    
                                       
                                          η
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                                α
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    k
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                 
                              
                           
                        

We use 
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                            to denote the average of the weights, and 
                              
                                 
                                    σ
                                 
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                            for the sample variance of the weights:
                              
                                 (22)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    :
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            We also define
                              
                                 (24)
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    :
                                    =
                                    F
                                    W
                                    
                                       
                                          F
                                       
                                       
                                          ⁎
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          q
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    ]
                                 
                              
                            where 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                            is the i-th column vector. We use 
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                            to denote the j-th element of 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           . Note that since W is diagonal, 
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                            has a periodic structure such that it can be written as a Kronecker product of circulant matrices.

Eigenvalues of A are real positive, and so do those of 
                              M
                              A
                            since M is a symmetric positive definite matrix. We note for any 
                              m
                              >
                              0
                           :
                              
                                 (25)
                                 
                                    
                                       
                                          β
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    A
                                    )
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      (
                                                      A
                                                      )
                                                      +
                                                      m
                                                      ⋅
                                                      σ
                                                      (
                                                      A
                                                      )
                                                   
                                                   
                                                      μ
                                                      (
                                                      A
                                                      )
                                                      −
                                                      m
                                                      ⋅
                                                      σ
                                                      (
                                                      A
                                                      )
                                                   
                                                
                                             
                                             
                                                if 
                                                μ
                                                (
                                                A
                                                )
                                                >
                                                m
                                                ⋅
                                                σ
                                                (
                                                A
                                                )
                                             
                                          
                                          
                                             
                                                +
                                                ∞
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                            
                           
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                              (
                              A
                              )
                            will become an upper bound of 
                              κ
                              (
                              A
                              )
                            as m increases. As a result, one way to compare the system conditioning before and after preconditioning is to assess 
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                              (
                              A
                              )
                            and 
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                              (
                              M
                              A
                              )
                            for a certain m. We do not bother to find the optimal m that results in the tightest bounds as we have the following relation:
                              
                                 (26)
                                 
                                    ∀
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    τ
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩾
                                    τ
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                    ⟺
                                    
                                    
                                       
                                          β
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩾
                                    
                                       
                                          β
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                    for any 
                                    m
                                    >
                                    0
                                 
                              
                            Eq. (26) implies that comparing 
                              
                                 
                                    β
                                 
                                 
                                    m
                                 
                              
                           's and comparing τ's are equivalent since Eq. (26) holds for any m. Comparing the CV's no longer involves this parameter and consequently, to tell that a preconditioner M is potentially effective, one only needs to verify the relation 
                              τ
                              (
                              M
                              A
                              )
                              <
                              τ
                              (
                              A
                              )
                           .


                           Propositions 1 and 2 show the CV of A and that of 
                              M
                              A
                           , respectively. Reader can find the proofs in the appendices. 
                              Proposition 1
                              
                                 The CV of the matrix 
                                 A 
                                 is given by 
                                 
                                    τ
                                    (
                                    A
                                    )
                                    =
                                    
                                       
                                          σ
                                          (
                                          A
                                          )
                                       
                                       
                                          μ
                                          (
                                          A
                                          )
                                       
                                    
                                  
                                 where
                                 
                                    
                                       (27)
                                       
                                          μ
                                          (
                                          A
                                          )
                                          =
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                                α
                                             
                                          
                                          μ
                                          (
                                          
                                             
                                                Λ
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       (28)
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          A
                                          )
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                4
                                                α
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                Λ
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                 
                              


                                 The CV of the matrix 
                                 
                                    M
                                    A
                                  
                                 is given by 
                                 
                                    τ
                                    (
                                    M
                                    A
                                    )
                                    =
                                    
                                       
                                          σ
                                          (
                                          M
                                          A
                                          )
                                       
                                       
                                          μ
                                          (
                                          M
                                          A
                                          )
                                       
                                    
                                  
                                 where
                                 
                                    
                                       (29)
                                       
                                          μ
                                          (
                                          M
                                          A
                                          )
                                          =
                                          1
                                          +
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                          −
                                          ν
                                          )
                                          μ
                                          (
                                          H
                                          )
                                       
                                    
                                 
                                 
                                    
                                       (30)
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          M
                                          A
                                          )
                                          =
                                          
                                             1
                                             N
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                      ,
                                                      i
                                                   
                                                
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                −
                                                ν
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          H
                                          )
                                          −
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          μ
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                  
                                 with 
                                 H
                                 , 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                  
                                 defined in Eq. 
                                 (14)
                                 , Eq. 
                                 (21) 
                                 and Eq. 
                                 (24) 
                                 respectively.
                              

We also introduce an upper bound of 
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              (
                              M
                              A
                              )
                            which is noted as 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              (
                              M
                              A
                              )
                            as precised in Proposition 3. The CV computed from this upper bound is written as 
                              
                                 
                                    τ
                                 
                                 
                                    ˜
                                 
                              
                              (
                              M
                              A
                              )
                              :
                              =
                              
                                 
                                    σ
                                 
                                 
                                    ˜
                                 
                              
                              (
                              M
                              A
                              )
                              /
                              μ
                              (
                              M
                              A
                              )
                           . 
                              Proposition 3
                              
                                 We have the relation 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    M
                                    A
                                    )
                                    ⩾
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    M
                                    A
                                    )
                                  
                                 where
                                 
                                    
                                       (31)
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          M
                                          A
                                          )
                                          :
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          μ
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                −
                                                ν
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          H
                                          )
                                       
                                    
                                 
                              

The purpose of introducing this approximation is to simplify Eq. (30) by avoiding computing the high-order harmonics 
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                           . Clearly, any preconditioner M verifying 
                              
                                 
                                    τ
                                 
                                 
                                    ˜
                                 
                              
                              (
                              M
                              A
                              )
                              <
                              τ
                              (
                              A
                              )
                            automatically satisfies 
                              τ
                              (
                              M
                              A
                              )
                              <
                              τ
                              (
                              A
                              )
                           . One can see that only the first and the second statistical moments of the weights are involved in the quantities 
                              τ
                              (
                              A
                              )
                            and 
                              
                                 
                                    τ
                                 
                                 
                                    ˜
                                 
                              
                              (
                              M
                              A
                              )
                           .

In practice, we are more interested in the asymptotic behavior of the CV's for the case of large datasets. In Eq. (17), if we let 
                              
                                 
                                    N
                                 
                                 
                                    d
                                 
                              
                              →
                              +
                              ∞
                            and write
                              
                                 (32)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    ω
                                    )
                                    :
                                    =
                                    
                                       
                                          (
                                          
                                             ∑
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          
                                             
                                                [
                                                
                                                   2
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                ]
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          α
                                       
                                    
                                    ,
                                    
                                    ω
                                    ∈
                                    A
                                    :
                                    =
                                    
                                       {
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             D
                                          
                                       
                                       )
                                       :
                                       
                                          
                                             ω
                                          
                                          
                                             d
                                          
                                       
                                       ∈
                                       [
                                       0
                                       ,
                                       2
                                       π
                                       )
                                       }
                                    
                                 
                              
                            Eq. (27) and Eq. (28) become respectively:
                              
                                 (33)
                                 
                                    μ
                                    (
                                    A
                                    )
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    +
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                             α
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       ∫
                                       A
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    ω
                                    )
                                    
                                    d
                                    ω
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    A
                                    )
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          4
                                          α
                                       
                                    
                                    
                                       [
                                       
                                          1
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                D
                                             
                                          
                                       
                                       
                                          ∫
                                          A
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                       
                                          
                                             (
                                             ω
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       ω
                                       −
                                       
                                          
                                             (
                                             
                                                1
                                                
                                                   
                                                      (
                                                      2
                                                      π
                                                      )
                                                   
                                                   
                                                      D
                                                   
                                                
                                             
                                             
                                                ∫
                                                A
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             ω
                                             )
                                             
                                             d
                                             ω
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                              
                            Likewise, Eq. (29) and Eq. (31) respectively tend to:
                              
                                 (35)
                                 
                                    μ
                                    (
                                    M
                                    A
                                    )
                                    =
                                    1
                                    +
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                          −
                                          ν
                                       
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       ∫
                                       A
                                    
                                    
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                                α
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          ω
                                          )
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                    d
                                    ω
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    M
                                    A
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                −
                                                ν
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       ∫
                                       A
                                    
                                    
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                                α
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          ω
                                          )
                                          )
                                       
                                       
                                          −
                                          2
                                       
                                    
                                    
                                    d
                                    ω
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   ¯
                                                
                                             
                                             −
                                             ν
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             2
                                             D
                                          
                                       
                                    
                                    
                                       
                                          [
                                          
                                             ∫
                                             A
                                          
                                          
                                             
                                                (
                                                ν
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      2
                                                      α
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                (
                                                ω
                                                )
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                          d
                                          ω
                                          ]
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

To understand the behavior of our preconditioners, we compute the ratio 
                           
                              
                                 R
                              
                              
                                 CV
                              
                           
                           :
                           =
                           
                              
                                 τ
                              
                              
                                 ˜
                              
                           
                           (
                           M
                           A
                           )
                           /
                           τ
                           (
                           A
                           )
                         for the 2D case (derived from Eq. (33)–(36)) as a function of 
                           ν
                           /
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                         for different weight moments and for different values of γ and α. Without loss of generality, we suppose the weights to be normalized within 
                           [
                           0
                           ,
                           1
                           ]
                        . The weight mean and variance are uniformly sampled in the area 
                           A
                           =
                           {
                           (
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                           :
                           0
                           <
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           ⩽
                           1
                           
                           and
                           
                           0
                           ⩽
                           
                              
                                 σ
                              
                              
                                 w
                              
                              
                                 2
                              
                           
                           ⩽
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           (
                           1
                           −
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           )
                           }
                        . Note that the variance upper bound comes from the Bhatia–Davis inequality [4]. α and γ are sampled within 
                           [
                           1
                           ,
                           2
                           ]
                         and 
                           [
                           0.1
                           ,
                           5
                           ]
                         respectively. Each combination of a weight mean, a weight variance, a value of γ and a value of α produces a curve of 
                           
                              
                                 R
                              
                              
                                 CV
                              
                           
                         (as a function of 
                           ν
                           /
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                        ). We have about 
                           3
                           ×
                           
                              
                                 10
                              
                              
                                 4
                              
                           
                         combinations in total.


                        Fig. 2
                         shows some of them for 
                           α
                           =
                           1
                         and 
                           γ
                           =
                           1
                        , curves for the other cases being similar. One can see that the highest efficiency of the preconditioners (i.e., the valleys of 
                           
                              
                                 R
                              
                              
                                 CV
                              
                           
                        ) is achieved for ν typically ranging from 
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                         up to several multiples of 
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                        . Indeed, the optimal ν is found within 
                           [
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           ,
                           5
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                           ]
                         for more than 
                           94
                           %
                         among all cases. For a given RWLS problem, ultimately one could use some line search methods in this range to find the optimal ν which minimizes 
                           
                              
                                 τ
                              
                              
                                 ˜
                              
                           
                           (
                           M
                           A
                           )
                        . Practically, we choose 
                           ν
                           =
                           
                              
                                 w
                              
                              
                                 ¯
                              
                           
                         in all our experiments of Section 4. Out of all the combinations above, this value of ν makes 
                           
                              
                                 τ
                              
                              
                                 ˜
                              
                           
                           (
                           M
                           A
                           )
                         strictly lower than 
                           τ
                           (
                           A
                           )
                         (i.e., 
                           
                              
                                 R
                              
                              
                                 CV
                              
                           
                           <
                           1
                        ) for more than 
                           90
                           %
                         cases. In other words, the preconditioner M is effective in most of the time. We point out that this choice also makes 
                           
                              
                                 M
                              
                              
                                 −
                                 1
                              
                           
                         the best approximation to the matrix A in the least squares sense.

Data smoothing with missing values refers to filling unobserved pixels with some estimates computed from the observed pixels. This problem is straightforwardly addressed by the RWLS (Eq. (2)) where the weights are typically binary by taking zero values for unobserved areas and values of 1 for the observed ones. This application is studied in detail by Garcia [5] where the issues of robustness and of choice of γ are emphasized. Numerically, the author proposed Keller's preconditioned gradient descent solver [6] for RWLS.


                        Fig. 3
                         compares the performances of Keller's approach and the PCG on a 2-dimensional (2D) image smoothing example. The original image (of size 
                           256
                           ×
                           256
                        ) is composed of a mixture of Gaussian functions. The observed image is generated by first adding a Gaussian noise, followed by dropping off about 2/3 data points. The missing data are first picked out randomly, then cropped out by 4 squares of size 
                           50
                           ×
                           50
                         each. We set 
                           α
                           =
                           2
                         and 
                           γ
                           =
                           1
                        . An even symmetry boundary condition is assumed and the DCT is employed to be the diagonalization basis of 
                           
                              
                                 L
                              
                              
                                 α
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 L
                              
                              
                                 α
                              
                           
                         as in [5].

Compared to the PCG result, the square masks are still partially visible in the estimate of Keller after 100 iterations. This shows that the PCG diffuses faster the observed information into the unfilled areas. The energy evolutions confirm that PCG converges much faster than Keller's iterations. The PCG is also more accurate: after 100 replications, the mean squared error (MSE) of the PCG estimates is evaluated to be 0.015, in comparison to 0.48 for Keller.

We also measured the execution time of both methods for indicative purpose. To achieve the same MSE target of 0.2 in this example, our approach took 0.9 seconds in contrast to Keller's method which took 11.5 seconds. The time was measured on a PC with 3.33 GHz Intel Xeon® CPU. Both methods are implemented in Matlab®.


                        Fig. 4
                         shows a more realistic case where we try to restore an image with 1/3 randomly sampled data available. Here the underlying image contains both low-frequency information and discontinuities. As we have shown in Section 2.3, one can view the weights in RWLS as actors of boundary conditions in a diffusion process. The boundary conditions are not strictly imposed but handled in a soft way through these weights. Eq. (12) shows that pixels receiving large fidelity weights prevent the diffusion induced by the regularity term at those pixels. In this sense, RWLS is very flexible as the weights automatically manage boundary conditions of any spatial shapes.

Here the observed pixels serve as our boundary condition which are associated with weights 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                        , and the unobserved pixels with zero weights. We set 
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           =
                           0.1
                        . Therefore, our RWLS will interpolate the unobserved areas while keeping observed values almost unchanged. Note that this procedure is quite similar to the interpolation based on partial differential equations [7].

In the purpose of regularizing image while preserving discontinuities, one may apply the RWLS framework by using large fidelity weights on the pixels with discontinuities and small ones for homogeneous regions. According to Eq. (12), 
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           
                              
                                 W
                              
                              
                                 −
                                 1
                              
                           
                         plays a similar role as the diffusion-rate function in the Perona–Malik anisotropic diffusion model [8].


                        Fig. 5
                         shows a filtering example using RWLS using 
                           γ
                           =
                           0.5
                         and 
                           α
                           =
                           1
                        . Our weights are defined as follows:
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 =
                                 1
                                 −
                                 exp
                                 
                                    (
                                    −
                                    
                                       
                                          |
                                          ∇
                                          I
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                         The parameter K can be considered as a reference edge-saliency level above which the diffusion will be hampered. Parallely, homogeneous areas encircled by the salient edges will be associated with small weights closed to zero. It follows that the remaining Dirichlet regularity term in Eq. (2) favors an approximation with harmonic functions on those areas.
                           1
                        
                        
                           1
                           This is due to the fact that Dirichlet penalty leads to Laplace equation as Euler–Lagrange equation with harmonic functions as solutions.
                         Consequently, this results in piecewise smooth images.

The gradient-vector flow (GVF) [9] is widely used in deformable-model based applications in order to extend the attraction range of external forces (see [1] and references therein). GVF in 2D continuous setting consists in solving the following variational problem:
                           
                              (37)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       u
                                       :
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    Ω
                                 
                                 g
                                 
                                    (
                                    
                                       |
                                       ∇
                                       v
                                       (
                                       x
                                       )
                                       |
                                    
                                    )
                                 
                                 
                                    
                                       |
                                       u
                                       (
                                       x
                                       )
                                       −
                                       ∇
                                       v
                                       (
                                       x
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∫
                                    Ω
                                 
                                 
                                    
                                       |
                                       ∇
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       |
                                       ∇
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                              
                           
                         Here Ω is the image domain, 
                           x
                           =
                           
                              
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                           ∈
                           Ω
                        , 
                           ∇
                           v
                           (
                           x
                           )
                         is the observed gradient field, and 
                           u
                           (
                           x
                           )
                           :
                           =
                           
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 ]
                              
                              
                                 T
                              
                           
                         is the sought extended field. g is an “edge” weighting function which is typically monotone increasing and smooth.

It can be seen that the components 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                         are decoupled in the optimization problem (37). Solving (37) is equivalent to minimizing for 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                         independently:
                           
                              (38)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    ∫
                                    Ω
                                 
                                 g
                                 
                                    (
                                    
                                       |
                                       ∇
                                       v
                                       (
                                       x
                                       )
                                       |
                                    
                                    )
                                 
                                 
                                    
                                       [
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       x
                                       )
                                       −
                                       
                                          
                                             ∂
                                             v
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   l
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                       ]
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∫
                                    Ω
                                 
                                 
                                    
                                       |
                                       ∇
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 x
                              
                           
                         with 
                           l
                           =
                           1
                         or 2. The Euler–Lagrange equation of Eq. (38) is given by 
                           g
                           (
                           |
                           ∇
                           v
                           (
                           x
                           )
                           |
                           )
                           (
                           
                              
                                 u
                              
                              
                                 l
                              
                           
                           (
                           x
                           )
                           −
                           
                              
                                 ∂
                                 y
                              
                              
                                 ∂
                                 
                                    
                                       x
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           x
                           )
                           )
                           −
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           Δ
                           
                              
                                 u
                              
                              
                                 l
                              
                           
                           (
                           x
                           )
                           =
                           0
                        . Therefore, it is straightforward to convert Eq. (38) to our discrete RWLS framework of Eq. (2) by setting:
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 =
                                 g
                                 
                                    (
                                    
                                       |
                                       ∇
                                       v
                                       
                                          (
                                          x
                                          [
                                          i
                                          ]
                                          )
                                       
                                       |
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 [
                                 i
                                 ]
                                 :
                                 =
                                 
                                    
                                       ∂
                                       v
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    [
                                    i
                                    ]
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 −
                                 Δ
                                 ,
                                 
                                 α
                                 =
                                 1
                              
                           
                         where 
                           x
                           [
                           i
                           ]
                         is the position of the i-th pixel.

A vast number of schemes have been proposed to solve Eq. (37) such as the gradient-descent [9], operator-splitting based schemes [10], augmented Lagrangian method [11], and the alternating-direction methods [12]. Boukerroui [12] also provides a comparative study of the different numerical approaches.

In our comparative study, we include the alternating direction explicit scheme (ADES) solver which is recommended in [12], and the augmented Lagrangian (AL) based approach [11]. For ADES we followed the advice in [12] by including a left-right domain flipping in our iterations.

Our comparison is based on a synthetic image of a centered disk (Fig. 6
                        (a)) as in [12]. The gradient of this image (i.e., ∇v), which is nonzero only in a local vicinity of the disk boundary, is used to construct the edge-weighting function:
                           
                              
                                 g
                                 (
                                 t
                                 )
                                 :
                                 =
                                 1
                                 −
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                         We set 
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           =
                           1.5
                         for all three methods. In ADES, the time step in the iteration scheme is set to 10 (see [12] for details).

As [12], our goal is to compare the orientation accuracy of the estimated vector fields. To build the ground truth, we compute analytically the orientation at each pixel of the image with respect to the disk center. These orientations are color-coded for 
                           [
                           −
                           π
                           ,
                           π
                           )
                         and shown in Fig. 6(c). The orientations of 
                           u
                           (
                           x
                           )
                         derived from the different GVF estimates are demonstrated in Fig. 6(d), (e) and (f), as well as their absolute residual in Fig. 6(g), (h) and (i) for the three approaches at the end of 15 iterations.

Visually, some bias for pixels far from the image center can be seen in ADES, and some inaccurate estimates in the AL method lie around the image corners. Generally, we found that more iterations are necessary for ADES to reduce the bias, and for AL to diffuse the local gradient information sufficiently far away to the image boundaries and corners. Finally, the PCG result looks the closest to the ground truth.

Quantitatively, the evolutions of the root mean squared error (RMSE) of the orientations of 
                           u
                           (
                           x
                           )
                         (measured in degrees) for the three methods are shown in Fig. 7
                        . One can see that the PCG needs very few iterations to reduce most of the error. This best performance is followed by ADES, and then AL. At the end of the iterations, we have 
                           RMSE
                           =
                           0.71
                         degrees for PCG, 4.17 degrees for ADES, and 11.1 degrees for AL.

In terms of execution time, in order to attain an RMSE less than 5 degrees, it took 17.4 seconds for ADES, 1.04 seconds for AL, and 0.16 seconds for PCG. The time was evaluated on the same PC as in Section 4.1.

Registration between two 2D images consists in seeking a smooth deformation field that approximately maps an observed image to a reference. We are particularly interested in Demons registration algorithm [13], which is extensively employed in medical imaging [14,15] for its simplicity and fast performance.

The deformation field is derived as a solution of a variational problem such that the field is the best tradeoff between an image similarity measure and a field regularity measure. Here we consider the following minimization problem using the sum of squared difference (SSD) as our similarity term:
                           
                              (39)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    u
                                 
                                 J
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∑
                                    i
                                 
                                 
                                    
                                       (
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             L
                                          
                                          
                                             α
                                          
                                       
                                       u
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         where v and 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         are the observed image and the reference image respectively, and u the sought deformation field.

We will cast the problem Eq. (39) into our RWLS framework using the approximation of [14]. For this purpose, we first adopt a first-order approximation of the SSD measure, or in other words the assumption of a small deformation u.
                           
                              (40)
                              
                                 
                                    
                                       SD
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       (
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 
                                    
                                       (
                                       ∇
                                       v
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    (
                                    v
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          v
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    )
                                 
                                 ∇
                                 v
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 ∇
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ∇
                                 v
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

We then approximate the Hessian tensor 
                           ∇
                           v
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           ∇
                           v
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                         in Eq. (40) by the optimal scalar matrix in the least squares sense 
                           
                              1
                              2
                           
                           Tr
                           (
                           ∇
                           v
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           ∇
                           v
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           )
                           I
                        . Completing the squares in Eq. (40), the problem Eq. (39) is converted into:
                           
                              (41)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    u
                                 
                                 
                                    ∑
                                    i
                                 
                                 
                                    
                                       |
                                       ∇
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                       α
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             L
                                          
                                          
                                             α
                                          
                                       
                                       u
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 with 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          |
                                          ∇
                                          v
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ∇
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                         It can be seen that Eq. (41) fits our RWLS framework with the weights given by 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           :
                           =
                           
                              
                                 |
                                 ∇
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 |
                              
                              
                                 2
                              
                           
                        . This dependency of the weights on the gradient is very intuitive: the deformation of the image is entirely encoded by the pixels having high gradients (i.e., discontinuities like contours and edges), while a small displacement of a pixel inside a homogeneous area is totally invisible.

Let us also point out that the first order approximation in (40) is valid for small displacement u. In registrating two images with large deformation, we basically need to solve a sequence of problems (39) where in each step, v is replaced by the estimate from the previous warped result. Consequently, the final field is estimated as a successive composition of the small deformation fields.

In parallel, Demons registration consists first in computing the field Eq. (43) then followed by a Gaussian smoothing on both 
                           
                              
                                 u
                              
                              
                                 ˆ
                              
                           
                         and the cumulated composite deformation field [13,15]. Compared to Eq. (42), Eq. (43) possesses an additional term in the denominator for preventing instabilities due to small gradient values. Note that this is not a problem for the RWLS model as small gradients are weighted by small values in Eq. (41).
                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             |
                                             ∇
                                             v
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       ϵ
                                       
                                          
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             v
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ∇
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     


                        Fig. 8
                         shows an example comparing Demons method and the RWLS approach on a synthetic case where we register a disk onto a peanut shape. The top three rows correspond to Demons warping progression using three increasing smoothing Gaussian widths (
                           σ
                           =
                           1
                        , 
                           σ
                           =
                           3
                        , and 
                           σ
                           =
                           6
                        ). The value of ϵ is set to 0.01. The last row demonstrates the warping results given by RWLS. The corresponding deformation field estimates are presented in Fig. 9
                        . Fig. 9 clearly shows that Demon requires a large enough Gaussian width to guarantee the regularity of the warping (in our example 
                           σ
                           ⩾
                           3
                        ). However, as the Gaussian width increases the displacement magnitudes shrink implying that many more warpings are needed and hence can be time consuming.


                        Fig. 10
                         presents the evolution of the registration errors (defined as the norm of the difference between the warped image and the reference) as a function of the number of warpings. For a fixed error target, considerably fewer warpings are required in our PCG-based approach. The error reduction is slow in Demon's iterations and eventually almost stagnating.

In this section, we will briefly discuss a generalization of the RWLS framework and its potential in real applications. We will consider its extension by weighting both the data term and the regularization term. In addition, we will consider a general linear regularization operator L:
                        
                           (44)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    :
                                    
                                       
                                          R
                                       
                                       
                                          D
                                       
                                    
                                    →
                                    R
                                 
                              
                              J
                              (
                              u
                              )
                              :
                              =
                              
                                 ∫
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                              w
                              (
                              x
                              )
                              
                                 
                                    (
                                    u
                                    (
                                    x
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                              +
                              γ
                              
                                 ∫
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                              v
                              (
                              x
                              )
                              
                                 
                                    |
                                    L
                                    u
                                    (
                                    x
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                           
                        
                      Here, 
                        v
                        (
                        x
                        )
                        ⩾
                        0
                      are the weights applied pointwisely on the regularization penalty. It follows that the generalized discrete RWLS can be written as:
                        
                           (45)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                              J
                              (
                              u
                              )
                              :
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          W
                                       
                                       
                                          
                                             1
                                             2
                                          
                                       
                                    
                                    (
                                    u
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              +
                              γ
                              
                                 
                                    ‖
                                    
                                       
                                          V
                                       
                                       
                                          
                                             1
                                             2
                                          
                                       
                                    
                                    L
                                    u
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        
                      where the diagonal matrix 
                        V
                        ∈
                        
                           
                              R
                           
                           
                              N
                              ×
                              N
                           
                        
                      bears the weights 
                        
                           
                              v
                           
                           
                              i
                           
                        
                        ⩾
                        0
                      on its diagonal elements. The minimizer is the solution to the following linear system:
                        
                           (46)
                           
                              A
                              u
                              =
                              b
                              ,
                              
                              where 
                              A
                              :
                              =
                              
                                 (
                                 W
                                 +
                                 γ
                                 
                                    
                                       L
                                    
                                    
                                       ⁎
                                    
                                 
                                 V
                                 L
                                 )
                              
                               and 
                              b
                              :
                              =
                              W
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                           
                        
                      Mimicking the standard RWLS case, we can solve the system by PCG with a preconditioner M given by
                        
                           (47)
                           
                              M
                              :
                              =
                              
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    I
                                    +
                                    γ
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          ⁎
                                       
                                    
                                    L
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                        
                      where 
                        
                           
                              v
                           
                           
                              ¯
                           
                        
                      represents the average value of the weights 
                        
                           
                              v
                           
                           
                              i
                           
                        
                     .

The advantage of considering the extended RWLS framework is that, by properly designing the weights v, one may address other penalties such as 
                        
                           
                              L
                           
                           
                              1
                           
                        
                     -minimization by this quadratic optimization framework. This point has been exploited by several works in the literature. For example, Daubechies et al. [16] proposed a sparse solution solver in compressed-sensing applications by casting an 
                        
                           
                              L
                           
                           
                              1
                           
                        
                     -norm minimization into a sequence of weighted 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm minimization problems. In [17], a half-quadratic algorithm [18,19] was applied to solve the total-variation (TV) minimization. The method converts the TV-regularization term 
                        ∫
                        |
                        ∇
                        u
                        (
                        x
                        )
                        |
                        
                        d
                        x
                      into a weighted quadratic term through the weights 
                        v
                        (
                        x
                        )
                     :
                        
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    ,
                                    v
                                    >
                                    0
                                 
                              
                              Data-Term
                              (
                              u
                              )
                              +
                              ∫
                              
                                 [
                                 v
                                 (
                                 x
                                 )
                                 
                                    
                                       |
                                       ∇
                                       u
                                       (
                                       x
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       4
                                       v
                                       (
                                       x
                                       )
                                    
                                 
                                 ]
                              
                              
                              d
                              x
                           
                        
                      At each iterative step, the algorithm first minimizes u by fixing v, and then solves the weights v while fixing u. Note that the solution of v given u has a simple form: 
                        v
                        (
                        x
                        )
                        =
                        1
                        /
                        (
                        2
                        |
                        ∇
                        u
                        (
                        x
                        )
                        |
                        )
                     . The updated u and v serve as initializations at the next iteration.

The generalized RWLS model allows us to deal with even richer applications under this flexible framework. Here we show its potential on a toy example of texture restoration application in Fig. 11
                     . We simulated a periodic textural pattern by setting random amplitudes on 4 DCT coefficients and zeroing the rest. This image is shown by Fig. 11(a). Then in the spatial domain, we added a white noise (
                        PSNR
                        =
                        30
                     ) and randomly kept only 
                        5.6
                        %
                      of the samples. The sampling mask is presented in Fig. 11(b). Our goal is to estimate the underlying pattern given the heavily down-sampled image.

This textural restoration problem can be formulated as:
                        
                           (48)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 u
                              
                              ∫
                              w
                              (
                              x
                              )
                              
                                 
                                    (
                                    u
                                    (
                                    x
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                              +
                              γ
                              ∫
                              
                                 |
                                 L
                                 u
                                 (
                                 ω
                                 )
                                 |
                              
                              
                              d
                              ω
                           
                        
                      where L represents the DCT transform, and 
                        
                           
                              u
                           
                           
                              0
                           
                        
                      the observed noisy and down-sampled image. The weights 
                        w
                        (
                        x
                        )
                      are binary which take value of 1 only at the positions of the spatial sampling. The penalty of the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                     -norm on 
                        L
                        u
                      promotes a solution with sparse DCT coefficients. Using the same technique of half-quadratic algorithm, Eq. (48) is converted into Eq. (49) by introducing the weights v:
                        
                           (49)
                           
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    u
                                    ,
                                    v
                                    >
                                    0
                                 
                              
                              ∫
                              w
                              (
                              x
                              )
                              
                                 
                                    (
                                    u
                                    (
                                    x
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              d
                              x
                              +
                              γ
                              ∫
                              
                                 [
                                 v
                                 (
                                 ω
                                 )
                                 L
                                 u
                                 
                                    
                                       (
                                       ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       4
                                       v
                                       (
                                       ω
                                       )
                                    
                                 
                                 ]
                              
                              
                              d
                              ω
                           
                        
                      While fixing the weights v, Eq. (49) is a generalized RWLS. The solution of u can be obtained by our PCG schema. While fixing u, the weights v can be explicitly computed. Consequently, we alternatively minimize u and v at each iteration and use the results as initial points for the next iteration. Fig. 11(d) shows the restored texture pattern despite the heavily degraded observations.

@&#CONCLUSION@&#

In this paper, we proposed to solve a range of computational imaging problems under the perspective of a regularized weighted least-squares model using a PCG approach. We provided a detailed convergence analysis justifying our choice of the preconditioner that improves the system conditioning. This numerical solver, which is simple, scalable and parallelizable, is found to outperform most of the competing schemes proposed in the literature in terms of the convergence rate. We also discussed an extended RWLS formulation by introducing weights on the regularization term, making the model even more flexible. We believe that a lot more imaging applications could join this framework and benefit from the efficient PCG scheme. This is the area of our future investigations.

Applying the trace operator on A in Eq. (10), we immediately establish Eq. (27). To show Eq. (28), we compute 
                        μ
                        (
                        
                           
                              A
                           
                           
                              2
                           
                        
                        )
                     :
                        
                           (A.1)
                           
                              μ
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              μ
                              
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              2
                              
                                 
                                    γ
                                 
                                 
                                    2
                                    α
                                 
                              
                              μ
                              
                                 (
                                 W
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 F
                                 )
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    4
                                    α
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                      Eq. (24) implies that 
                        μ
                        (
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                        )
                        =
                        μ
                        (
                        W
                        )
                        =
                        
                           
                              w
                           
                           
                              ¯
                           
                        
                     . Due to the circulant structure in 
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                     , one can show that the diagonal elements of 
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                      are all equal to 
                        
                           
                              w
                           
                           
                              ¯
                           
                        
                     . Therefore, we have
                        
                           (A.2)
                           
                              μ
                              
                                 (
                                 W
                                 
                                    
                                       F
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ˜
                                    
                                 
                                 F
                                 )
                              
                              =
                              μ
                              (
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    ˜
                                 
                              
                              )
                              =
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              μ
                              (
                              
                                 
                                    Λ
                                 
                                 
                                    ˜
                                 
                              
                              )
                           
                        
                      Inserting Eq. (A.2) into Eq. (A.1) and using the definition Eq. (19), we obtain Eq. (28). This ends the proof.

Recall the definitions of M (i.e., Eq. (13)), of H (i.e., Eq. (14)) and of 
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                      (i.e., Eq. (24)). We have
                        
                           (B.1)
                           
                              μ
                              (
                              M
                              A
                              )
                              =
                              μ
                              
                                 [
                                 H
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                          α
                                       
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                 
                                 ]
                              
                              =
                              μ
                              
                                 [
                                 H
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    −
                                    ν
                                    I
                                    )
                                 
                                 ]
                              
                              =
                              1
                              +
                              (
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              −
                              ν
                              )
                              μ
                              (
                              H
                              )
                           
                        
                      where we used the fact that 
                        (
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                        −
                        ν
                        I
                        )
                      has all its diagonal elements equal to 
                        (
                        
                           
                              w
                           
                           
                              ¯
                           
                        
                        −
                        ν
                        )
                     . This shows Eq. (29)
                  

To show Eq. (30), we first show that
                        
                           (B.2)
                           
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 1
                                 N
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                      we can write 
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                        H
                        =
                        [
                        
                           
                              η
                           
                           
                              0
                           
                        
                        
                           
                              q
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              η
                           
                           
                              1
                           
                        
                        
                           
                              q
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              η
                           
                           
                              N
                              −
                              1
                           
                        
                        
                           
                              q
                           
                           
                              N
                              −
                              1
                           
                        
                        ]
                     . Using the fact that 
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        =
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                     , we have
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                              H
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                              H
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                           
                        
                      Therefore, the j-th diagonal element of the matrix 
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                        H
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                      is given by
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    H
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                      Consequently,
                        
                           
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              μ
                              
                                 (
                                 H
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ˆ
                                    
                                 
                                 H
                                 
                                    
                                       W
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 )
                              
                              =
                              
                                 1
                                 N
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    j
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                      This shows Eq. (B.2).

Now, 
                        μ
                        (
                        
                           
                              (
                              M
                              A
                              )
                           
                           
                              2
                           
                        
                        )
                      can be computed as
                        
                           (B.3)
                           
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       M
                                       A
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       H
                                       
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                W
                                             
                                             
                                                ˆ
                                             
                                          
                                          −
                                          ν
                                          I
                                          )
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              μ
                              
                                 (
                                 I
                                 +
                                 2
                                 H
                                 
                                    
                                       W
                                    
                                    
                                       ˆ
                                    
                                 
                                 −
                                 2
                                 ν
                                 H
                                 +
                                 
                                    
                                       ν
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              −
                              2
                              ν
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              +
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              1
                              +
                              2
                              (
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              −
                              ν
                              )
                              μ
                              (
                              H
                              )
                              +
                              
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    −
                                    ν
                                    )
                                 
                                 
                                    2
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                      Inserting Eq. (B.2) into Eq. (B.3), we obtain Eq. (30) by the definition Eq. (19). This ends the proof.

First, we point out that for any matrix G with real eigenvalues, we have 
                        tr
                        (
                        
                           
                              G
                           
                           
                              2
                           
                        
                        )
                        ⩽
                        tr
                        (
                        
                           
                              G
                           
                           
                              ⁎
                           
                        
                        G
                        )
                     . In effect, if we use 
                        
                           
                              g
                           
                           
                              i
                              ,
                              j
                           
                        
                      to denote the element of G at the i-th row and the j-th column, one has
                        
                           
                              tr
                              
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ⩽
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              |
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              +
                              2
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    <
                                    i
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              |
                              ⩽
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    <
                                    i
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       |
                                       
                                          
                                             g
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       |
                                       
                                          
                                             g
                                          
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          i
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    ≠
                                    i
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              =
                              tr
                              
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 G
                                 )
                              
                           
                        
                     
                  

Using this result and replacing G by 
                        M
                        A
                     , we have
                        
                           (C.1)
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              (
                              M
                              A
                              )
                              =
                              μ
                              
                                 (
                                 
                                    
                                       (
                                       M
                                       A
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              −
                              μ
                              
                                 
                                    (
                                    M
                                    A
                                    )
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              μ
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       ⁎
                                    
                                 
                                 M
                                 A
                                 )
                              
                              −
                              μ
                              
                                 
                                    (
                                    M
                                    A
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                      The term 
                        μ
                        (
                        
                           
                              A
                           
                           
                              ⁎
                           
                        
                        
                           
                              M
                           
                           
                              ⁎
                           
                        
                        M
                        A
                        )
                      is computed as follows:
                        
                           (C.2)
                           
                              μ
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       ⁎
                                    
                                 
                                 M
                                 A
                                 )
                              
                              =
                              μ
                              
                                 (
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    ν
                                    I
                                    +
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    ν
                                    I
                                    +
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 )
                              
                              =
                              1
                              +
                              2
                              (
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              −
                              ν
                              )
                              μ
                              (
                              H
                              )
                              +
                              
                                 (
                                 
                                    
                                       ν
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 ν
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              1
                              +
                              2
                              (
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              −
                              ν
                              )
                              μ
                              (
                              H
                              )
                              +
                              
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    −
                                    ν
                                    )
                                 
                                 
                                    2
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 (
                                 μ
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              1
                              +
                              2
                              (
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                              −
                              ν
                              )
                              μ
                              (
                              H
                              )
                              +
                              
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                    −
                                    ν
                                    )
                                 
                                 
                                    2
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              μ
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                      where we have used 
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        =
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                      and that 
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              2
                           
                        
                        =
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        
                           
                              W
                           
                           
                              ˆ
                           
                        
                      has all diagonal elements equal to 
                        μ
                        (
                        
                           
                              W
                           
                           
                              2
                           
                        
                        )
                     .

Inserting Eq. (C.2) into Eq. (C.1) we obtain Eq. (31). This ends the proof.

@&#REFERENCES@&#

