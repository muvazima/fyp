@&#MAIN-TITLE@&#Spike sorting paradigm for classification of multi-channel recorded fasciculation potentials

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Distribution of ‘amplitude’ and ‘area’ can be used to discriminate waveforms recorded by HDsEMG.


                        
                        
                           
                           Interactive modification module increases the accuracy of classification and is efficient time-wise.


                        
                        
                           
                           The spike sorting output, tested by two-source method, is reproducible.


                        
                        
                           
                           In each subject, only 1–2 classes were continuingly firing, albeit numerous classes had been derived.


                        
                        
                           
                           The final result of this program will further be subject to many other research studies.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Amyotrophic lateral sclerosis

Fasciculation potential

Feature extraction

Principal component analysis

Unsupervised clustering

Supervised classification

@&#ABSTRACT@&#


               
               
                  Background
                  Fasciculation potentials (FPs) are important in supporting the electrodiagnosis of Amyotrophic Lateral Sclerosis (ALS). If classified by shape, FPs can also be very informative for laboratory-based neurophysiological investigations of the motor units.
               
               
                  Methods
                  This study describes a Matlab program for classification of FPs recorded by multi-channel surface electromyogram (EMG) electrodes. The program applies Principal Component Analysis on a set of features recorded from all channels. Then, it registers unsupervised and supervised classification algorithms to sort the FP samples. Qualitative and quantitative evaluation of the results is provided for the operator to assess the outcome. The algorithm facilitates manual interactive modification of the results. Classification accuracy can be improved progressively until the user is satisfied. The program makes no assumptions regarding the occurrence times of the action potentials, in keeping with the rather sporadic and irregular nature of FP firings.
               
               
                  Results
                  Ten sets of experimental data recorded from subjects with ALS using a 20-channel surface electrode array were tested. A total of 11891 FPs were detected and classified into a total of 235 prototype template waveforms. Evaluation and correction of classification outcome of such a dataset with over 6000 FPs can be achieved within 1–2 days. Facilitated interactive evaluation and modification could expedite the process of gaining accurate final results.
               
               
                  Conclusion
                  The developed Matlab program is an efficient toolbox for classification of FPs.
               
            

@&#INTRODUCTION@&#

Amyotrophic lateral sclerosis (ALS) is a progressive, degenerative disorder that affects both upper and lower motor neurons. There is currently no unique marker to diagnose ALS. The crucial factor in establishing the diagnosis of ALS is to observe the clinical progression of motor neuron loss, beginning from the region(s) of onset, and then as it spreads to muscles in other regions in the body [4]. Active denervation is reflected by abnormal spontaneous activity in the affected muscle, including fasciculation potentials (FPs), generated from single or multiple motor units (MUs). FPs are detectable by conventional clinical electromyography (EMG). While not necessarily an indicator of denervation, frequent occurrence of FPs in association with changes in motor unit potentials (reflecting MU reinnervation) has been recognized as important supportive evidence for the electrodiagnosis of ALS [4–5].

Needle electrodes are used to detect spontaneous muscle activity in routine clinical EMG studies. Conventional surface electrodes are historically limited by their non-selective measurement of the electrical activity of a muscle that may be attenuated by the large electrode size. In the last decade, High Density surface EMG (HDsEMG) electrode arrays have been developed [33]. This technique has attracted much attention in laboratory-based investigations including examination of FPs, [8,17,20,21]. A HDsEMG electrode contains an array of small recording surfaces spaced closely to one another. The muscle’s electrical activity can then be simultaneously recorded by a number of channels. This multi-channel electrode array enhances temporal resolution and adds spatial information and selectivity that conventional surface electrodes lack. A thorough review of surface electrode array EMG analysis and its advantages compared with concentric needle EMG has been described by Farina et al. [10]. Zhou et al. recently demonstrated that a HDsEMG array can be more sensitive than a needle electrode in capturing FPs from the superficial muscles in ALS patients [38].

Although different FPs, regardless of waveform or motor unit origin, would have the same clinical diagnostic significance, it would be helpful to further classify the FPs for laboratory-based investigations. Results of FP classification can be further analyzed to characterize the firing pattern and action potential waveforms of fasciculating MUs. Potential applications may include (but are not limited to) indirect discovery of their site of origin and distinguishing between FPs that are encountered in the normal population and those associated with pathological processes such as ALS [11,28]. These pieces of information can be obtained through classification of FPs into groups of similar waveform shapes. The task of FP classification is somewhat similar to the task of EMG decomposition, which is the process of breaking down an epoch of voluntary EMG signal to derive its constituent single MU potential firings. In the past several decades, much effort has been focused on EMG decomposition, but using traditional intramuscular needle electrodes. The concept and methods of decomposition in clinical EMG have been reviewed by Stashuk [32]. In recent years, there have been numerous studies on EMG decomposition using surface electrodes [2,3,7,12–16,22,24,26,27,29,37,39]. However, available EMG decomposition software, such as Spike2 (Cambridge Electronic Design Limited, Cambridge, England) or EMGLab [25] is not applicable to FP classification, due to different characteristics of spontaneously fired spikes compared with voluntarily firing MUs.

In light of these limitations, the objective of this study is to design a spike sorting program specific to the unique features of FPs. Some routines derived originally from EMG decomposition are adopted for FP classification. However, our classification strategy does not rely on MU firing rate information because of the sporadic character of FPs. In this program, robust unsupervised and supervised classification techniques are combined with facilitated interactive decision making modules. Throughout this process, automatically classified FPs are evaluated in several steps. Erroneous assignments are corrected interactively. Consistency of waveforms in each class is visually examined. In addition to qualitative evaluation, quantitative within-class distance and between-class distances are also examined for the sake of class accuracy estimation. Moreover, performance of the classification is examined using the concept of “two-source” method by applying independently to two non-overlapping sets of channels derived from an array recording. The classification program is tested with FP data sets of ALS patients. Both advantages and limitations of the program are discussed.

@&#EXPERIMENTS@&#

FPs recorded from subjects with Definite ALS or Probable ALS with Laboratory Support based on El Escorial criteria [1] were used to test the classification program. Data recording was performed at the second author’s institution and had the approval of the local Human Studies Committee. All subjects gave written informed consent prior to their participation. Subjects were seated comfortably in a regular chair or in their wheelchair, with their elbow partially flexed and forearm semi-pronated. Subjects were asked to completely relax.

A linear array of 20-channel HDsEMG electrodes, designed and fabricated in our laboratory, is used for the recording of FPs in the biceps brachii muscle. The electrode is oriented along the long axis of the muscle fibers such that the center of the electrode array is close to the center of the muscle belly, with the proximal edge oriented toward the muscle’s origin and the distal edge oriented toward the muscle’s tendinous insertion. Each bar of electrode is 1mm in width and 10mm in length. The inter electrode distance is 5mm. The signals are amplified by the Refa128 EMG Recording System (TMS International BV, the Netherlands). The reference electrode is placed on the ipsilateral elbow. Sampling rate is 2kHz per channel. Band pass filter is set for 20–500Hz, which can slightly smooth out waveform shapes, but does not affect classification performance. Hardware-based common feedback (average of all available channels) is subtracted from each channel.

In this study, 10 data sets of FPs recorded from the biceps brachii muscles of five ALS subjects (56±10 years; 4 males, 1 female) are presented. The duration of recording ranges from 300 to 2500s, with an average of approximately 1000s.

The FP classification program includes the following steps or modules. Prolonged recordings of spontaneous muscle activity are broken down into 100-sepoch. Spike detection algorithm [18] is applied to the EMG signal. Extracted FPs are stored in a database along with information of their firing times. Below, we describe the feature extraction, spike sorting, evaluation and interactive modification processes. All programs are coded in Matlab version 7.12 (R2011), the MathWorks Inc.

Prior to classification, FPs are detected using a modification of previously described algorithm [18]. This algorithm starts by transforming the HDsEMG multi-dimensional signal into a one-dimensional signal. Amplitude thresholding is then applied to the one-dimensional signal to determine the timings of individual spikes. To construct the one-dimensional signal, the difference between maximum and minimum voltage values across all the channels is used to make a new data point at each time sample. In this study, we use the standard deviation of the EMG data at each sample time across all channels. Although it is a common practice to apply spatial filtering on multichannel EMG data in order to improve the quality of the signal [27], we deliberately chose not to do so, since it has been shown that sensitivity of FP detection is dramatically reduced after spatial filtering [19]. 
                           Fig. 1 illustrates the procedure for FP extraction, starting from raw EMG (recorded at rest) at left. At the right panel, a sample database of FPs recorded by the 20-channel electrode array is shown. Firing times and maximum peak-to-peak amplitude across all channels are also reported.

A matrix ([]
                              nCh×w) is used to represent a spike, where ‘nCh’ is the number of channels and ‘w’ is the duration of the waveform (in this work: []20×55), and this is done regardless of electrode configuration. Two features from each channel are measured:
                              
                                 (1)
                                 Peak to peak amplitude (polarity considered). Amplitude ‘polarity’ is considered positive when the negative peak of the waveform occurs prior to the positive peak;

Area under the curve (sum of absolute values).

An FP is ‘nf’-dimensional vector, where nf=nCh×2. To increase the efficiency of the feature domain, Principal Component Analysis (PCA) is applied. By selecting only a limited number of principal components, we can reduce the dimensionality of the feature space, and thus reduce the complexity of the processing. This is especially helpful in HDsEMG recordings where the number of recorded channels is large, or when the sample size for classification is relatively small. In general, in parametric methods (i.e. methods involving any type of Expectation-Maximization, including K-means and Gaussian mixture model estimation), the relative number of samples to the number of parameters has to be sufficiently large for reliable density estimation. However, in experimental data, the number of samples is usually limited. Efficient dimension reduction strategies are very helpful in this regard. For PCA implementation, first the dataset in feature space is built as a matrix feat-Data=[]
                              N×nf, with N number of FP samples. Covariance matrix of ‘feat-Data’ matrix is computed, covfeat-Data=[]
                              nf×nf. Eigen-decomposition is applied on the covariance matrix. Data samples transformed by the eigenvector corresponding to the largest eigenvalue hold the highest variance. This can be the most discriminative feature for classification purpose. We can choose one, two, or ‘nf’ principals to transform the data. As the dimensionality of feature space increases, the condition number of covfeat-Data matrix is checked. A ‘too large’ condition number will lead to an ill-conditioned covariance matrix, which in turn impairs the reliability of PCA. In theory, a ‘too large’ condition number is defined for when the logarithm of the condition number
                              
                           is larger than the precision of the entry data. In this study, to optimize the PCA, the dimensionality of feature space does not exceed a value that causes the condition number to surpass 1000. A five dimensional space is usually chosen for the 20-channel data in this work.

The K-means technique (built in Matlab Statistics Toolbox) is used for the initial attempt of spike sorting. To use this technique, the number of classes and initial seeds (initial estimate of class templates) need to be known. To assist with the estimation of number of classes, FPs are plotted in 3D space using the first three principal components (an example is shown in Fig. 4, Panel C). The plot (partially) demonstrates how the data are scattered, and so the number of clusters may be estimated. Overestimation is preferable to underestimation at this stage. The former can be adjusted later by cluster combination. ‘Underestimation’ would lead to erroneous classes, which is undesirable. The initial seeds can be picked randomly (default) or selected manually. Once K-means is applied, the first set of clustered FPs is ready. The members of each class are then visualized in their waveform format, in separate plots. A good performance would be easily recognizable by overall consistency in waveform shapes within each class. If the overall outcome is poor for most of the classes, then input parameters (including feature set dimension, initial estimate of class numbers, or distance metric) may be modified. Then, the clustering step is repeated until the overall output is reasonable. The variables ‘Cluster’ and ‘Label’ are adjusted accordingly afterwards. The variables are described in 
                           Table 1.

The objective of this step is to make each class as accurate as possible. For this purpose, each class is visually examined and refinements are made as necessary. Class examination starts by first illustrating members of each class by their waveform shape. A class is either overall accurate (members’ waveform shapes are consistent) or inaccurate (there are too many inconsistencies). In the latter instance, if there are too many low-SNR or erroneous waveform shapes, the whole class is assigned to Label-1. If the cluster is composed of two or more patterns of data, then that class requires another round of clustering.

When the class is accurate overall, and the number of erroneous assignments is minimal, the ‘Interactive Class Refinement’ module is called up to remove inconsistent assigned samples. In this module, there are four possible options to modify the status of each assignment. For each assigned member, the four options include: (1) accept and include in class template measurement; (2) accept but not include for class template; (3) move it to Label0 group; or (4) move it to Label-1. The second option refers to correctly assigned members that for some reason (e.g. superimposition with other waveforms, unexpected noise on some channels, or misalignment of the waveforms compared to other members of a class) are excluded from computing class template shape. 
                           Fig. 2, panel A, shows a sample plot by this module. Waveforms belonging to one class are plotted side by side in a default number of 25. The entire group can be Accepted/Rejected, or individual samples can be modified one-by-one. For this purpose, the screen is divided into four regions by dotted lines, corresponding to options 1 to 4. The user can click in a particular region to select the appropriate option for a sample. The program will re-adjust the ‘Cluster’ and ‘Label’ variables accordingly.

After modifying classification results, it is common to find two or more classes with almost identical waveform templates. This is primarily due to the initial overestimation of class number and presence of noise. Such classes need to be merged. The inter-cluster distance matrix is used to provide an initial list of potential twin classes. A plot of potential twin classes, in feature space, is provided which assists the user in narrowing down the list, such as in Fig. 2 panel B. Furthermore, the candidate templates are investigated in their waveform shape format before making a final decision about merging, such as in Fig. 2, Panel C. Variables ‘K’, ‘Cluster׳ and ‘Label’ are updated, if a change has occurred. An additional round of ‘Interactive Class Refinement’ module amy be called up for final refinement of the combined classes.

In the previous step, the goal was to make each class as accurate as possible. Uncertain samples were left unassigned. Now in this final step, classification decisions are made for the remaining unlabeled samples. Class templates are known, whereas in step 1 (unsupervised clustering) such knowledge was unavailable. Therefore, the assignment of remaining samples can be made through supervised classification. A classifier is trained based on discriminant analysis (linear or quadratic) technique using thus far classified samples as training data. Theoretically a sample should be assigned to the closest class (minimum distance). However, since we deal with ‘difficult to classify’ spikes in this step, the waveform shapes of a sample and the candidate class templates are visualized before any decision is made.

The algorithm pulls samples with Label0, and finds the closest classes to each sample. In a first attempt, a few waveforms from each class along with all of the potentially new members are plotted side by side. The user can interactively “accept” or “reject” the classification (as shown in Fig. 4). In a second attempt, thus far unlabeled samples are examined individually. An FP waveform is plotted along with candidate class templates, such as in Fig. 2 panel D.

As a supplement to qualitative visual evaluation, a quantitative measurement is provided to the user. As a measure of internal consistency in each class, within-class distance (S
                           
                              W
                           ) is measured and compared to between-class distances (S
                           
                              B
                           ). An ideal classification has a large S
                           
                              B
                            compared to S
                           
                              W
                           . This means that the classes are well separated from each other, while members of a class are located compactly, close to its center (i.e. similarity between members of a group is relatively high and similarity of members of different groups is small). Euclidean distance between members of a class and class template are measured and averaged, leading to S
                           
                              W
                           . Euclidean distance between templates of all possible pairs of classes are also measured and stored in the matrix S
                           
                              B
                           . For each class, a more-than-unity ratio of S
                           
                              B
                           /S
                           
                              W
                            is desired.

This program involves the operator in modification of the outcome. In an attempt to evaluate the reproducibility of the final outcome, the set of 20-channels data is divided into two non-overlapping 10-channels sets. Set1 refers to data on channels 1–10, and set2 refers to channels 11–20. The program is applied on set1 and set2, and the results are compared. The number of clusters might vary between the two sets. This is partially because of possibly high similarity of different waveforms, when the number of channels is reduced. Class labels of corresponding samples do not necessarily match. The only known variable is the index of class members. For each class, from the set of results with lower number of classes, we examine the corresponding labels from the other set of results. The most frequent label is determined, L
                           
                              f
                           . We quantify the accuracy of the result for that class, by the ratio of number of members with L
                           
                              f
                            to the total number of members. At the end, we average the accuracy ratios of all the classes.

@&#RESULTS@&#

FPs were extracted from spontaneous electrical activity in the biceps brachii muscle recorded by linear array HDsEMG electrode from subjects with ALS. The extracted spikes were stored in a database along with their firing times. Feature selection, initial unsupervised clustering, interactive evaluation and refinement, and final supervised classification steps were applied to the FP database.

One example set of results, on dataset ‘5–2׳ in 
                     Table 2, is partially presented in Fig. 4. The raw EMG of this data set – on a single channel – is presented in 
                     Fig. 3. It is essential for the user to examine the whole length of recording to ensure that there is no unwanted voluntary muscle activity. Further discussion on the presence of voluntary activity during spontaneous activity recording is presented in Section 4.1. Illustrating the entire length of the EMG on all channels is not feasible. Only one channel (where amplitude is high) is depicted here.

The outcome of each step described in the methods section is illustrated in 
                     Fig. 4. A total of 749 FPs were detected. Panel A shows a FP in its waveform format, and a sample outcome of spike detection algorithm. Panel B shows selected feature values. From each available trace of a multichannel FP, the peak-to-peak amplitude and area under the curve are measured. The blue thin circles represent the amplitude and the thick dark circles represent ‘area’ under the curve. Whole feature space in the first three components after PCA is depicted in panel C. Panel D refers to the same dataset after initial clustering and its refinement. Not all samples are included here. Panel E shows templates of each class (not all classes included). Panel F shows the final outcome of classification.

Quantitative evaluation of classification performance was also computed. Averaged S
                     
                        B
                     /S
                     
                        W
                      for each class with respect to all other classes were measured. The averaged mean was again averaged across all classes and reported in Table 2. Furthermore, averaged accuracy following two-source method was reported along with yielded number of classes.

Overall, the number of waveform classes varied from 3 to 57. A large number of classes refers to high variability of FP shapes and may be indicative of unstable membrane potentials at multiple locations. Within-class to Between-class distance ratio is always above 1, and the average value ranges from 2 to 67. Reproducibility of the outcome is tested with two source method, and accuracy ranges from 62 to 99%, with an average of 87.5%.

@&#DISCUSSION@&#

Ten sets of fasciculation potentials, collected from subjects with ALS, were tested for spike sorting with our proposed program. The results reveal that on average, only one or two classes of FPs are continually firing over the course of recording. The frequency of most other classes is much lower. This fact might explain the complexity of the classification problem from a mathematical point of view. To partially show the heterogeneity of class sizes in the FP data, the FP classes are categorized into single classes, classes with 2–9 members, classes with 10 to 99 members, and classes with above 100 members. A summary of class size shows that, on average, there are 7 classes with only one member, 9 with 2–9 members, 6 with 10–99 members, and only 2 classes with above 100 members. Further investigation is needed to understand this phenomenon, which may or may not be related to the site of origin of the FPs.

It is very common that over the long period of spontaneous EMG recording, short periods of voluntary activity show up, due to slight movements of the subject. Before deriving any conclusion over the firing pattern of an FP class, it is necessary to examine the inter-discharge interval histogram of the class. Interval histograms can be inspected for any evidence of voluntary recruitment. Corresponding EMG potentials should be excluded from further analysis of FPs. As Fig. 3 shows, raw EMG is inspected before each FP detection step. Any epoch of voluntary activity is excluded manually. Voluntary activity is usually easily distinguishable from spontaneous activity. Unlike the sporadic nature of FPs, voluntarily recruited motor units have a more regular firing pattern.

EMG decomposition is an inverse process of EMG signal generation, which breaks down the EMG signal into the contributions from different MUs. For EMG decomposition, different classes of waveform potentials indicate that they are derived from different MUs. In contrast, the number of different classes of FPs does not necessarily indicate that each class belongs to a different MU. This is primarily due to the fact that FPs may arise from different places in the terminal branches of the motor axons near the muscle fibers, and hence have different shapes. Since they are all derived from the same alpha motor neuron (i.e. same anterior horn cell), hence by definition they belong to a single MU.

The concept and methods of EMG decomposition have been developed during the past 4 decades (see review by Stashuk [32]). The discharges of FPs are much less frequent than those of voluntarily activated MUs. Therefore, superimposition of waveform potentials is a less challenging problem. Template-based clustering is then appropriate for the purpose of FP classification. Conversely, as a consequence of the slower discharge frequency of FPs, a longer duration of EMG recording time (on the order of minutes or longer) might be necessary to adequately capture a sufficient number of FPs. Analysis of long recordings with a large number of traces using HDsEMG is computationally costly, if performed on raw data, which is a common approach in many of the available EMG decomposition toolboxes. Also, a classification paradigm is needed that does not rely on firing time of spontaneous spikes. This is because FPs discharge randomly, in contrast with the more regular firing of voluntarily recruited MUs.

High variability in FP waveform shapes makes accurate classification difficult. High variability in waveform shapes causes overlap among different classes of FPs in feature space. It is known that even waveforms of voluntarily recruited MUs in healthy subjects vary over time, measured as jiggle [31]. The variability in voluntary motor unit potential comes from slight variations in inter-discharge interval times of two consecutive muscle fiber action potentials. Since a motor unit potential is the summation of all its component muscle fiber potentials, the motor unit potential shape may vary. By ‘high variability of waveform shapes we refer to the fact that FPs come from (electrically) unstable axon membranes, and the site of this instability might vary. FPs might fire from different axon terminal branches at different times from within one single MU. These differing sites of FP origin may lead to variation of FP waveform shapes even for FPs belonging to a single MU. From a classification perspective, the distribution of such data may not have a clustered shape and the data may be spread over the feature space. The visual interactive modification module designed in this work aims to help with difficult-to-classify samples.

Although considerable work has been reported on decomposition of HDsEMG, classification of spontaneous spikes recorded from long durations of time has only been approached in a limited number of studies. Drost et al. [8], reported HDsEMG recorded FPs and illustrated the value of 2D spatial information in discriminating different waveforms. However in this earlier work, only one set of data was analyzed using a previously developed EMG decomposition technique, [22].

Another study in FP classification was performed by Winslow et al. [36]. This focused on classification of 24h-long EMG (at rest) from the paralyzed hand muscles of subjects with spinal cord injury. However, their technique was designed for only two-channel EMG data. An average of approximately 3000 spontaneous action potentials were detected, that required about 17 days to be fully classified, with 5h of segmentation, 1 day for clustering, 10 days for manual evaluation, and 5 days for finalizing classification. The authors claimed that it would take up to two years for each dataset to be classified with a fully manual approach.

In contrast, the current study demonstrates relatively good time efficiency of FP classification. Spike detection and first round of clustering take seconds to be complete. Modification of the results might take up to 1–2 days for a database with thousands of FPs.

Unsupervised clustering (classification of a data set without a priori information about the number of classes or their shape) is applied to the data. Existing techniques for clustering are numerous, including parametric, non-parametric, iterative, or hierarchical methods [9]. In general, no clear evidence exists about the benefit of one clustering algorithm over another [23]. Depending on the nature of the data, one technique might prove to be superior to others. Here, the K-means algorithm is selected for clustering the FPs. K-means technique has been widely used in many applications. It is computationally faster than hierarchical methods, especially when the number of variables is large. However, K-means has poor performance on non-hyper elliptical datasets [23]. Feature selection plays a key role in performance of the clustering task. If the K-means method fails to correctly separate the groups, then another approach must be sought. We found Gaussian Mixture Model (GMM) clustering algorithm – also integrated in Matlab – very efficient in such cases. However, GMM fails to operate on classes with rather small sample size, especially if feature space dimension is large.

In this study, more automated clustering techniques must be attempted. Combination of K-means with another clustering technique is one example, as shown by Takahashi et al. [34], where each class obtained from the K-means is split and later (similar ones) are agglomerated to overcome the problem of overlapped classes. In all assessments, a meticulous visual assessment of the results is essential,

Choosing discriminative features plays a key role in classification performance. In intramuscular needle recordings, features measured from motor unit potentials typically include amplitude, duration, area, number of phases, number of turns, etc. [30]. These features are usually less useful for surface recordings, due to the low-pass filtering effect of the skin and subcutaneous body tissues that attenuate the high frequency components of the EMG signal. Based on the visual inspection of many experimental data sets, we believe that distribution of amplitude and area across all channels constitute reliable features.

In the electrodiagnostic study of a muscle, the primary question of interest is related to the presence or absence of FPs. However, the origin and pathophysiological significance of FPs are not yet fully understood [6]. Thus, further investigation of FPs to address these issues is of interest.

FPs firing pattern and waveform shapes may provide additional pathophysiologic and diagnostic information. A potential application is the discrimination between FPs observed in healthy population and those observed in pathological conditions such as ALS, as suggested by Mills [28]. Discovering a discriminatory feature between the two groups would be very valuable.

As described by Wettstein [35], such investigations go back to 1936, when Denny-Brown and Pennybacker first defined FPs as originating from the anterior horn cell in the spinal cord. This finding has since been challenged, and the body of research shows that FPs might arise from cortex, as well as from the distal or proximal portions of the lower motor neuron.; and, some can be driven, as by cortical magnetic stimulation (summarized by DeCarvalho [6]). Although most of these studies have used invasive techniques; HDsEMG has also been utilized to study FPs [8,21–22]. Kleine et al. [21] investigated firing time of a (fasciculating) MU, specifically the Inter-Discharge Interval (IDI) histogram, believing that IDI histogram is a marker of membrane excitability property. The authors examined the IDI histograms of different FPs and concluded that both neuronal and axonal disturbances exist in ALS patients.

The waveform shapes are also discussed in terms of their pathological diagnosis [8], which still needs further investigation. FPs can be also studied in conjunction with drugs, since certain medications (e.g. cholinergic drugs) can affect their firing [8]. FPs are not limited to ALS and may appear in other neuropathic disorders. Not always as a neurological symptom, FPs also may occur in a healthy individual.

Our paradigm design applies the fast and simple K-means technique, which requires only seconds for even the longest dataset. It is the ‘validation and refinement’ section that takes the most time in this process. For datasets of less than 500 samples, the refinement process may take up to one to two hours (depending on the signal’s ambiguity). The required time for validation increases as the number of samples increases (i.e. above two or three thousand). Using this toolbox, and depending on the nature of dataset, it could take a user about 2 days to modify the results of classifications when the number of samples is greater than one or two thousand(s) spikes. This is still much faster than the aforementioned 10 days by Winslow et al. [36].

A major factor affecting the speed of modification step is the ‘cleanliness’ of the waveforms. Waveforms from a ‘clean’ EMG signal are typically more distinct from each other, and consequently the initial results are more accurate and minimal further modification may be required. Recordings of low SNR, or presence of a considerable amount of superposition, will lead to greater uncertainty in classification. The noisier the signal, the greater will be the interference between corresponding samples of individual classes. This leads to the feature space becoming non-hyper elliptical. Consequently, the K-means algorithm will perform poorly and, this will lead to the prolongation of the refinement process.

Managing large data sets increases the evaluation and modification process, making it tedious. A large number of spikes in a dataset usually correlate with the detection of many small amplitude low SNR samples. Depending on the goal of a study, such potentials may not be of interest and can be quickly excluded from the dataset. A reduction in data size simplifies analysis. However, when all the spikes need to be included, one approach in dealing with a large data size is to divide it into smaller sets. The results from each subset can then be combined and matched to provide the global output.

A key advantage of this program is the visualization of multi-channel waveforms to facilitate interactive decision-making. A user is then able to observe an unlabeled waveform along with other members of a class, and waveforms of other classes, and make classification decisions.

Manual spike sorting is often used by experts in EMG techniques. Nevertheless, relying solely on observational or qualitative investigation can lead to erroneous classification due to the limitations in subjective visual assessment. Therefore, visually aided classification has both advantages and limitations. Human visual error typically occurs when two FP samples are very close in shape: comparison of waveforms across all channels is not always straightforward. One effective step to alleviate this issue is the sizing of displayed images of FPs on the screen. The default size of a figure in Matlab has fixed square borders. If the number of waveforms in a figure is relatively high, then the waveform shapes will appear compressed. If the number of waveforms is small, their shapes may appear stretched out. In both instances, it is visually hard to assess the waveforms. So at each plot, the user would need to adjust the plot borders to a proper size. To avoid this display problem, our toolbox automatically sets the size of a figure (width and height) based on a fixed maximum number of waveforms for each figure (width) and the number of channels (height). This minimizes the risk of “visual artifact” and expedites the evaluation process.

@&#SUMMARY@&#

This study addresses the problem of FP classification, which is important in the electrodiagnosis and investigation of ALS and other neuromuscular diseases. Beyond their detection, examination of their detailed time course and waveform shape may elucidate their pathophysiology. In this study, a paradigm for the classification of FPs was developed and tested with surface EMG data recorded from ALS patients, using a 20-channel linear electrode array. The classification paradigm included individual FP detection, feature extraction, and spike classification. The distributions of spike ‘amplitude’ and ‘area’ across all the existing channels were measured from FP waveforms to build the initial feature space. Principal Component Analysis was applied for the purpose of feature space dimension reduction. For the spike sorting purpose, we used the existing unsupervised and supervised algorithms such as K-means, GMM, and Linear Discriminant Analysis.

The key feature of our design was the development of visually-aided interactive modules for the step-by-step evaluation and modification of classification results. The spike sorting process began by employing the unsupervised ‘K-means’ clustering algorithm. The results were then evaluated and modified through our facilitated user interactive modules. Supervised ‘Linear Discriminant’ function was then applied to classify thus far unassigned samples, in a ‘controlled’ manner. Accuracy of classification was visually ascertained. A quantitative measure of class consistency was also provided.

Overall, the accuracy of classification can be improved to a satisfactory level, utilizing the interactive modification modules. From 10 sets of data, a total of 11891 FPs were detected, and classified into a sum of 235 prototype template waveforms. The final output was reproducible, as tested by a two-source method. Evaluation and correction of classification outcome of a dataset with over 6000 samples was achieved within 1–2 days. We observed that number of FP prototypes can be very large, but on average only 1–2 of the classes were continuingly firing over the course of recording. The result of this work facilitates further investigation of FPs.

“None declared”.

@&#ACKNOWLEDGEMENTS@&#

This study was supported by the National Institute on Disability and Rehabilitation Research of the U.S. Department of Education (Grant H133G 090093) and the National Institutes of Health (Grant 2R24HD050821 and R01NS080839).

@&#REFERENCES@&#

