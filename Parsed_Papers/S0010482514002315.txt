@&#MAIN-TITLE@&#Dynamic thermal imaging analysis in the effectiveness evaluation of warming and cooling formulations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Image analysis allows qualitative assessment of the rate of skin temperature changes.


                        
                        
                           
                           Skin temperature perception is not correlated with the skin temperature.


                        
                        
                           
                           Major factor lowering the skin temperature is the weight of the applied formulation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image processing

Measurement automation

Warming and cooling

Subjective feelings

Thermal images

@&#ABSTRACT@&#


               
               
                  Warming cosmetics and medicines are used to accelerate recovery from injuries whereas cooling preparations are used in the pains of muscles, joints, spine, bruises or edema. The paper verifies subjective heating or warming sensations with respect to the measured temperature changes. The influence of three formulations, labelled C
                     1, C
                     2, W
                     1, on skin reaction was tested. The first two formulations (C
                     1, C
                     2) had a cooling effect while the formulation W
                     1 had warming properties. Two hundred thermal images with a resolution of N×M=120×120pixel were acquired with the Flir i7 infrared camera. The paper also shows how to analyse low resolution thermal images and their practical usefulness. For this purpose, a dedicated algorithm for image analysis and processing, which uses morphological operations, segmentation and area analysis, was applied. Application of both C
                     1 and C
                     2 resulted in subjective perception of feeling cold. Approximately 7min following application of the formulation C
                     1, the skin temperature returned to baseline levels. The minimum skin temperature after using the formulation C
                     1 was 27.5°C and it was registered at the time of application. Application of W
                     1, which by definition is a warming formulation, caused a sensation of coolness in the first minutes following the application. The perception of cool and warm sensations after the application of topical formulations is in no way correlated with the skin temperature assessed using a thermal imaging method.
               
            

@&#INTRODUCTION@&#

Warming topical preparations are traditionally used in muscle, joint and nerve pain. Warming substances due to their vasodilator action cause local congestion. Therefore they can be used as permeation promoters. Warming cosmetics and medicines are sometimes used to speed recovery from injuries. Cooling preparations are used in muscle, joint or spine pain, bruises, edema as well as to reduce the effect of “heavy legs” [1]. The substances most often used as warming agents are: capsaicin, camphor and methyl nicotinate. In contrast, menthol, ethyl alcohol and isopropyl alcohol are used as cooling agents [1,2].

It is extereceptors that are responsible for the feeling of warmth or coolness—kind of a superficial sensation received by skin receptors [3]. Feeling temperature is perceived by thermoreceptors present at the ends of small myelinated fibres (Aδ) and fibres without myelin sheath (C). Feeling warm or cool sensations is possible owing to separate receptors with separate receptive fields. The fibres that transmit a sensation of coolness temporarily increase the frequency of impulses, and thus intensify the perception of feeling cold when the skin temperature decreases, and temporarily reduce the frequency when the skin temperature increases. Thus, a rapid drop in temperature is subjectively perceived as an intense stimulus, regardless of the amplitude of temperature drop/rise. In the ambient temperature and neutral zone (thermal comfort), there is complete perceptual adaptation (temperature sensation disappears). Warm and cold receptors sense a temperature drop or rise only when the ambient temperature differs from the temperature of the skin surface. Given the same skin surface temperature and ambient temperature, the receptors are not activated. This condition is called physiological zero. Cold receptors (called Krause’s end bulbs), whose number is 10 times bigger than that of the warm receptors, sense temperature in a wider range (15±35°C) than warm receptors (referred to as Rufini corpuscles) which are responsive in the range of 35±43°C [4,5]. Feeling cold and warmth takes place only when the temperature change concerns receptors and occurs quickly enough. The threshold stimulus for cold receptors is the skin temperature drop of 0.004°C/s in the range from 10 to 41°C, whereas for warm receptors it is an increase in the skin temperature of 0.001°C/s in the range from 20 to 45°C [4]. Conduction of nerve impulses responsible for cold and warm sensations is possible owing to the presence of various types of ion channels within the warm and cold receptors. Thermoreceptors belong to the group of thermosensitive channels Transient Receptor Potential (TRP) for which seven different subfamilies have been identified: Transient Receptor Potential Cation (TRPC), Transient Receptor Potential Vanilloid (TRPV), Transient Receptor Potential Ion—Melastatin (TRPM), Transient Receptor Potential Ion—mechanical stress sensor (TRPA), Transient Receptor Potential Polycystic (TRPP), Transient Receptor Potential Cation (TRPML) and Transient Receptor Potential—mechanoreception (TRPN) [6]. Six of them are responsible for the perception of thermal stimuli in mammals, including humans [6,7]. In summary, by means of chemical stimuli – substances contained in cosmetics or medicines – it is possible to cause subjective feelings of coolness or warmth [6–9].

One of the most important factors controlling the skin surface temperature is the blood flow within the skin microcirculation. About 90% of the skin flow is responsible for thermoregulation during a game, and only about 10% is responsible for the metabolic needs of the skin [10]. At rest, without the participation of chemical and physical stimuli, the blood flow is approximately 5% of the cardiac output and 25% of blood vessels are active [10,11]. The blood flow in the skin vascular bed depends on the vascular tone, which is controlled by local autoregulation, neurogenic stimulation and humoral factors [10,12]. It is also possible to control – increase or decrease – the blood flow by skin vessels using chemical agents: blood vessel dilators, vasodilators, and blood vessel constrictors, vasoconstrictors. Cosmetic ingredients acting as vasodilators are, inter alia, methyl nicotinate, ethyl nicotinate and others [13]. Another mechanism of action, which changes the skin temperature by affecting the skin vascular bed, is reaction of substances whose rapid evaporation from the skin lowers its temperature. Such a method, with the use of, inter alia, isopropyl and ethyl alcohol, was used to treat hyperthermia [14]. Currently, ethyl alcohol is no longer used in the treatment of hyperthermia but is sometimes used in cooling topical formulations. However, the use of ethanol in the skin care cosmetics is limited because of its drying action [15].

The analysis of thermal images only in some areas is consistent with the analysis of images in visible light. It is difficult to work and interpret results for virtually every operation of image analysis and processing. There are problems with separation, segmentation of objects with very little temperature differences. There are problems with sharpening the edges due to their natural blur—convection of temperature to the ambient temperature in the case of objects warmer than the room. In the case of tests conducted on patients, there is a problem with their individual impact on the results, e.g. warm meals consumed before the test, obtaining thermal comfort in the room, undisclosed illnesses, contact of the measured area of the body with extraneous objects causing a local increase in temperature, etc. [16–18]. Also test implementation itself can cause later problems with automatic data analysis. For example, in all the places where one skin area touches another one, such as inner thighs, there is a problem with edge detection [19,20]. This causes considerable problems with segmentation which do not occur, or occur to a lesser extent, in visible light. The only practically important element in which segmentation of thermal images brings better results than that of images taken in visible light are areas with temperature differences. The temperature difference allows for not only segmentation of areas not visible in visible light but also enables to carry out almost perfect binarization [22]. Perfect binarization here means separation of an object from the background without artefacts and holes in the object—typical for image thresholding in visible light or another type of imaging [23,24]. Fully automatic measurement and data analysis, without an operator, are only possible when the algorithm for image analysis and processing is profiled [25–27].

The analysis of thermal images can be divided independently into static and dynamic one. In the case of static analysis, absolute temperature changes of a given area of the human body are recognized. These values are mostly average temperatures in the region of interest (ROI), a minimum or maximum value. Dynamic analysis enables to observe temperature changes in response to a specified force applied in the ROI. It is then possible to identify the object, in this case a human, as a measurement of time constants τ or delays in temperature changes. Dynamic analysis can also be used here to assess the impact of cooling or warming preparations, which is presented in this paper.

The paper studied the influence of three formulations, labelled C
                     1, C
                     2, W
                     1, on the skin reaction. The first two formulations (C
                     1, C
                     2) had a cooling effect while W
                     1 had warming properties. The composition of formulations was as follows:


                     C
                     1: alcohol denta., propane/butene/isobutane, aqua, menthol, glycerin, aesculus hippocastanum extract, arnica montana extract, calendulae officinalis extract, glucosyl hesperidini, panthnol, propylene glycol, PEG-40, hydroenated castor oil, parfum, hexyl cinnamal, limonene, linalol, geraniol, citronellol. Active ingredients: menthol 2.1%, ethyl alcohol 42%.


                     C
                     2: butane, aqua, isobutene, propane, alcohol denat., cyclopentasioxane, cyclohexasiloxane, PPg-5 ceteth-20, glycerin, hydroxyetylocellulose, PEG-40, hydrogenated castor oil, parfum, rucus aculeatus root extract, citrus limon peel extract, solidago virgaurea extract, phenoxyethanol, benzoic acid, dehydroacetic acid, benzyl salicylate, buthylphenyl methylpropional, linalool, hexyl cinnamal, geraniol. Active ingredient: ethyl alcohol 4.7%.


                     W
                     1: cyclopentasiloxane, propane/butane/isobutene, alcohol. Denat., diethylhexyl carbonate, isopropyl myristate, dipropylene glycol, boswellia serrate gum, methyl nicotinate. Active ingredient: methyl nicotinate 0.55%.

Two hundred thermal images were acquired with the Flir i7 infrared camera. These have the following parameters: thermal sensitivity of <100mK, field of view—25°×25°, spectral range from 7.5 to 13µm. This provided a sequence of images L
                     
                        GRAY
                     (m,n) with a resolution of N×M=120×120pixel. The objects of imaging were patients with manually applied formulations C
                     1, C
                     2 or W
                     1. In total, one image sequence was acquired for 3 patients. The measurements were performed at room temperature of 24.4°C and relative humidity of 39.9%. The patients before measurements were acclimatized to room conditions for at least 20min. The measurement conditions were minimized: a lack of infrared sources in the test room, errors related to damping, scattering and emission of own atmosphere, errors arising from the registration of radiation reflected from the object, convection of air currents, patient’s emotional state and movements during data acquisition. A block diagram of the test procedure is shown in 
                     Fig. 1. On the right hand side of the image there is a typical graph of changes in temperature caused by application of a formulation cooler than skin and the dynamics of temperature changes over time. It also shows the response of the object (patient) to force in the form of a cooler formulation and time constant τ.

The thermogram acquisition was performed according to the following scheme:
                        
                           For C
                              1: before application, immediately after application (about 2s), and then every 1min for another 12min.

For C
                              2: before application, immediately after application (about 2s), and then every 1min for another 12min.

For W
                              1: before application, immediately after application (about 2s), and then every 1min for another 60min.

The formulations were applied to undamaged skin of the ventral forearm of volunteers. Areas sized 6×6cm on which the test formulations were applied were marked with a marker on the proband’s skin. This gave I=10 thermal images and three images in visible light per patient. The images were anonymised and patients were examined in accordance with the Declaration of Helsinki.

@&#METHOD@&#

The acquired thermal images were further analysed taking into account two elements: position correction of successive images in a sequence and separation of the ROI. Adjustment of the position of each image in a sequence is important for finding corresponding points (pixels) in the subsequent images. Separation of the ROI is essential for calculating dynamic changes in temperature.

The algorithms presented hereafter were implemented in MATLAB Version 7.11.0.584 (R2010b) with Image Acquisition Toolbox (Version 4.0) and Image Processing Toolbox (Version 7.1). The authors’ own methods of image analysis and processing, as proposed hereafter, were applied.

The resulting sequence of images L
                        
                           GRAY
                        (m,n) is the main subject of analysis. In order to determine the correspondence of individual pixels of successive images, it is necessary to correct shifts and rotations. For each recorded series of images, the first image for i=1 is taken as a model. The position of the other images in a series i∈(2,I) is corrected relative to the reference image. The position correction of individual images involves selecting three parameters: position correction in the row axis Δm, position correction in the column axis Δn, and correction of rotation relative to the image centre Δα. Three parameters, namely Δm
                        *
                        ,Δn
                        *
                        ,Δα
                        *, are the correct position of each image. For these three parameters, there is a minimum value of the criterion J, i.e.:
                           
                              (1)
                              
                                 
                                    
                                       J
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       Δ
                                       m
                                       ,
                                       Δ
                                       n
                                       ,
                                       Δ
                                       α
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   B
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                (
                                                
                                                   m
                                                   +
                                                   Δ
                                                   m
                                                   ,
                                                   n
                                                   +
                                                   Δ
                                                   n
                                                   ,
                                                   Δ
                                                   α
                                                
                                                )
                                             
                                             
                                                V
                                                
                                                   ̲
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   B
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             
                                                (
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                    
                                       M
                                       ×
                                       N
                                    
                                 
                                 ×
                                 100
                                 
                                 %
                              
                           
                        for i∈(2,I),where:
                           
                              (2)
                              
                                 
                                    
                                       L
                                    
                                    
                                       B
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       +
                                       Δ
                                       m
                                       ,
                                       n
                                       +
                                       Δ
                                       n
                                       ,
                                       Δ
                                       α
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       S
                                       E
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       K
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       +
                                       Δ
                                       m
                                       ,
                                       n
                                       +
                                       Δ
                                       n
                                       ,
                                       Δ
                                       α
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       L
                                    
                                    
                                       K
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       +
                                       Δ
                                       m
                                       ,
                                       n
                                       +
                                       Δ
                                       n
                                       ,
                                       Δ
                                       α
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         G
                                                         R
                                                         A
                                                         Y
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         m
                                                         +
                                                         Δ
                                                         m
                                                         ,
                                                         n
                                                         +
                                                         Δ
                                                         n
                                                         ,
                                                         Δ
                                                         α
                                                      
                                                      )
                                                   
                                                   >
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        p
                        
                           r
                        —binarization threshold determined from the Otsu formula.

The shift of the image L
                        
                           GRAY
                        (m+Δm,n+Δn,Δα) concerns the rows and columns and involves rotation. The size of the image N×M is maintained at these transformations and the missing pixels are filled with the value “0“. The value of the criterion J is defined as the x or operation between the binary images obtained from binarization with the threshold p
                        
                           r
                         and dilatation with a structural element SE. The chosen size of the structural element SE was N
                        
                           SE
                        ×M
                        
                           SE
                        =3×3pixel. A larger size of the structural element reduces the accuracy of the position correction of individual images. Dilatation enables to close any holes in the object resulting from the noise entering the measurement path. The value of the criterion J reaches the minimum for the full correspondence between black and white pixels of the corrected image L
                        
                           GRAY
                        
                        
                           (i)
                        (m+Δm,n+Δn,Δα) relative to the first image L
                        
                           GRAY
                        
                        
                           (1)
                        (m,n). An exemplary graph of changes in the criterion J is shown in 
                        Fig. 2. 
                        Fig. 3 shows the optimal selection of values (Δm
                        *
                        ,Δm
                        *
                        ,Δα
                        *) calculated on this basis for each successive ith image in a series. The variability range of Δm and Δm was set at ±10pixel on the basis of tests. Similarly, Δα was varied in the range of ±10°. There were increments of one pixel and one degree, respectively. The corrected position of ith sequence image L
                        
                           GRAY
                        
                        
                           (i)
                         is hereinafter referred to as L
                        
                           W
                        
                        
                           (i)
                        , and in subsequent stages it is subjected to further steps of analysis.

The acquired thermal images with automatically adjusted position L
                        
                           W
                        
                        
                           (i)
                         are further used to analyse the dynamics of temperature changes. In general, the area of temperature changes varies depending on the subject of measurement: type and method of applying ointment or another preparation. It was further assumed that the application area of a specific formulation is completely visible in each image L
                        
                           W
                        
                        
                           (i)
                        . Consequently, the other areas of the patient’s skin whose temperature variation is small are visible. This assumption allows for the automatic comparison of temperature changes occurring in each ith sequence image and separation of the area of changes (the ROI). Assuming the maximum difference in temperature between any combination of images p
                        
                           r2=0.5
                        °C, a binary image L
                        
                           R
                         is created. It contains the ROI indicated by Boolean values of “1”:
                           
                              (4)
                              
                                 
                                    
                                       L
                                    
                                    
                                       R
                                    
                                    
                                       
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       ,
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  W
                                                               
                                                               
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  m
                                                                  ,
                                                                  n
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  W
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  m
                                                                  ,
                                                                  n
                                                               
                                                               )
                                                            
                                                         
                                                         |
                                                      
                                                      )
                                                   
                                                   <
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        for m∈(10,M−10), n∈(10,N−10)

The binary image L
                        
                           R
                        , i.e. the ROI, obtained from the above relationship is shown in 
                        Fig. 4. The automatically designated binary image provides information on the areas of temperature changes. Further transformations refer to detailed analysis of temperature changes in the ROI for three registered sequences—for the formulations C
                        1, C
                        2 and W
                        1.

On the basis of the obtained image L
                        
                           R
                         and series images L
                        
                           W
                         
                        
                           (i)
                        (m,n), the minimum T
                        
                           m
                        (i) and maximum T
                        
                           a
                        (i) as well as average temperature T
                        
                           e
                        (i) in the ROI are calculated, i.e.:
                           
                              (5)
                              
                                 
                                    
                                       T
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             L
                                          
                                          
                                             W
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                       ×
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       T
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             L
                                          
                                          
                                             W
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                       ×
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       T
                                    
                                    
                                       e
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             L
                                          
                                          
                                             W
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                       ×
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             ,
                                             n
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The results are shown in 
                        Fig. 5. The presented temperature changes confirm the lack of impact of the cooling formulation C
                        1 and a significant impact of the warming formulation W
                        1. This is thoroughly discussed in the next section.

From a practical point of view, uniformity of temperature changes is also of interest. Therefore, in the ROI, areas with temperature differences of Δt=0.5°C being within the range of verified temperature from T
                        
                           a
                         to T
                        
                           m
                         were separated. The results obtained are shown in 
                        Fig. 6. On this basis, quantitative evaluation and comparison of the impact of different formulations on the subjective patient’s feelings and their correlation with changes in temperature are possible. A block diagram of the discussed algorithm and methodology is shown 
                        Fig. 7.

From the point of view of metrology, the presented measurements are not error free. In addition to the sources mentioned in the introduction, these errors are affected by both methodological errors related to the adopted measurement method and those resulting from the accuracy of the used thermal imaging camera. Static errors mostly concern the camera temperature resolution of 0.1°C and spatial resolution of M×N=120×120pixel. For a constant distance from the skin area, there is 1.4mm per one pixel. The image resolution (120×120pixel) is also associated with a significant influence of the threshold p
                        
                           r
                         which is selected automatically. Small differences in the selected threshold p
                        
                           r
                         affect inclusion or rejection of boundary pixels from the ROI. Boundary pixels that are on the edge of the ROI differ considerably in terms of temperature. As calculated on the basis of the analysed cases, these differences result in the calculation of the average temperature at 0.1°C. This effect is strongly dependent on the number of pixels present on the ROI edge—the ROI shape and its surface.

An important factor contributing to the measurement error is also patient movement during the test. Using the criterion (1), displacement and rotation (Δm, Δn, Δα) were automatically corrected. An important element which should be paid attention to during measurements is the rotation of a limb (forearm) around its own axis. In the presented methodology of image acquisition, the patient’s arm was properly stabilized. The error resulting from the arm rotation around its axis was negligibly small. In the general case, however, particular attention should be paid to the proper stabilization of the patient during image acquisition [28,29].

Dynamic errors include inaccuracy of taking individual images in a sequence (every minute) of about 1s which does not grow over time. Intervals were timed by software. In addition, the errors were affected by the selection of the skin area subjected to application—more specifically the rate of blood flow. A change in the blood flow caused by the heart rate also directly affects the result, but to a small extent. In this case, the infrared camera was not directly synchronized with the phase of the heartbeat. The application method was also significant as it affected, to a great extent, the amount of formulation applied to the skin surface. Similarly, the temperature of C
                        1, C
                        2 and W
                        1 amounting to 27°C, which is about 5°C lower than the skin temperature, was vital. Examples of the temperature measurement mean values in the ROI for the formulations C
                        1, C
                        2 and W
                        1 with a standard deviation of the mean are given in 
                        Table 1. Because of these errors and the time constant of the human skin response, τ≈2min, a fixed value of the temperature tolerance of ±0.5°C was assumed.

@&#RESULTS@&#

The application of both C
                     1 and C
                     2 resulted in subjective sensation of coolness. For the formulation C
                     1, it persisted for 46min after application. The strongest subjective sensation of coolness for the preparation C
                     1 was registered in the first three minutes following the application. This was related to application of a formulation whose temperature was lower than the temperature of the patient’s skin by 5°C and the heat exchange between the cooler formulation and warmer skin. In addition, the formulation C
                     1 includes 42% of ethanol, whose rapid evaporation also resulted in the reduction in the registered temperature. 5min after application of formulation C
                     1, the temperature of the skin returned to baseline levels while subjective sensation of coolness still remained. This was due to the use of menthol (2.1%) whose interaction with TRPM8 caused subjective coolness sensation. Interaction of the preparation C
                     1 was restricted only to the area of application. The minimum temperature of the skin achieved by using the formulation C
                     1 was 27.5°C and it was registered at the time of application. From this moment, the skin temperature rose in order to achieve initial temperature after the said 5min following the application. The formulation C
                     2, whose main cooling agent was 4.7% ethyl alcohol, also gave subjective sensation of cooling the skin. Immediately after application and for the first five minutes the skin was moist. After 5min, ethyl alcohol evaporated completely from the skin surface, which resulted in a rapid increase in the skin temperature. Like in the case of the formulation C
                     1, C
                     2 only works in the application area. The minimum skin temperature was 28.0°C and it was registered immediately after formulation application. Subjective sensation of coolness for the preparation C
                     2 lasted 16min. After 9min, the skin temperature returned to baseline levels.

Application of W
                     1, which is considered as a warming formulation, resulted in coolness sensation for the first two minutes. It was related to the application of a cooler preparation (25.5°C) on the skin whose temperature was 34°C. After another 2min (4min after application), the preparation caused subjective sensation of warmth although the skin temperature was still lower than the initial temperature. This is probably related to the stimulation of the heat receptors. Contemporary literature [1–15] does not specify whether methyl nicotinate may directly affect the TRP receptors. 15min after application, warm sensation passes although the skin temperature is clearly higher than the initial one. This can be explained by adaptation to the effects of the stimulus.

The known literature, such as [20,21,30], deals with thermoregulation of temperature distribution but it is related to a lesser extent to the image analysis and processing itself. Full automation of measurement is not addressed here. Another group of publications [31,32] concerns image analysis and processing, but it is not profiled to thermal images. The reason for this is the difficulty in creating software dedicated to the analysis of thermal images. The difficulty is mainly related to invisible edges of an object in the absence of temperature differences, a large number of artefacts in the case of skin diseases, etc. [32]. Thus, the method proposed in this paper provides a new dedicated solution to the automatic evaluation of the thermal effectiveness of warming and cooling formulations.

@&#CONCLUSIONS@&#

Using the proposed algorithm for thermal image analysis and processing that allows for qualitative, dynamic assessment of the rate of temperature changes, it has been noted that:
                        
                           ▪
                           Application of formulations C
                              1 and C
                              2 results in clear sensation of coolness, but in the case of formulation C
                              1 the most intense cold is present for the first 3min.

subjective perception of coolness is stronger and longer for the formulation C
                              1, it is related to the stimulation of TRPM8 receptors by menthol contained in its composition.

vasodilating effect of methyl nicotinate results in erythema in the area well beyond the application area of the formulation.

application of all three formulations (C
                              1, C
                              2,
                               
                              W
                              1) causes strong sensation of coolness in the initial phase. A rapid, yet slight, decrease in the skin temperature caused by the application of the formulation results in the suspension of the pulsed frequency and thus strong subjective sensation of coolness. After a few seconds, this sudden sensation passes, which is related to the onset of the plateau phase. The factor that has a greater impact on the perception of warmth/coolness is the dynamics of a stimulus rather than its severity.

formulations C
                              1 and C
                              2 cause skin coolness resulting from the cold mass of the preparation applied to the skin and not its chemical composition.

The perception of warmth and coolness after application of topical formulations is in no way correlated with the skin temperature assessed using a thermal imaging method. Assessment of the effectiveness of preparations having a cooling or warming effect (evaluated as the change in skin surface temperature) with the use of subjective analysis of thermal sensation perception is not possible. Warming and cooling substances can cause a cooling or warming effect on the skin without changing its temperature. This is due to the fact that perception of thermal sensations is based on the activity of receptors that respond to external stimuli. The stimulus that causes a given effect, e.g. skin warming, does not have to be physical – temperature change – but it can be chemical. In addition, a major factor lowering the skin temperature is the weight of the formulation which is very important in practical applications.

The authors’ own functions in Matlab, created on the basis of the presented relationships, enable fully automatic measurements of the ROI parameters of the patient’s forearm. The analysis time of a sample sequence of images for one patient does not exceed a few seconds (using Intel Core i7). The most time-consuming analysis stage (absorbing about 85% of the time) is automatic adjustment of the position of each image in the sequence. Therefore, in subsequent papers, the authors intend to optimize computational complexity of the algorithm as well as verify the usefulness of the proposed method in other areas of the human body and, in particular, practically verify the repeatability of measurements for different types of infrared cameras, different operators and patient’s positions relative to the camera [28].

@&#SUMMARY@&#

Warming cosmetics and medicines are used to accelerate recovery from injuries whereas cooling preparations are used in the pains of muscles, joints, spine, bruises or edema. The paper verifies subjective heating or warming sensations with the measured temperature changes.

The influence of three formulations, labelled C
                     1, C
                     2, W
                     1, on skin reaction was tested. The first two formulations (C
                     1, C
                     2) had a cooling effect while the formulation W
                     1 had warming properties. Two hundred thermal images with a resolution of N×M=120×120pixel were acquired using the Flir i7 infrared camera. The paper also shows how to analyse low resolution thermal images and what their practical usefulness is. For this purpose, a dedicated algorithm for image analysis and processing, which uses morphological operations, segmentation and area analysis, was applied.

Application of both C
                     1 and C
                     2 resulted in subjective perception of feeling cold. After about 7min following the application of the formulation C
                     1 the skin temperature returned to baseline levels. The minimum skin temperature achieved by using the formulation C
                     1 was 27.5°C and it was registered at the time of application. Application of W
                     1, which by definition is a warming formulation, caused a sensation of coolness in the first minutes after application. For the next 10min, there was a sensation of warmth that after 15min following the application passed, even though the skin temperature was significantly higher than the initial temperature.

The perception of warmth and coolness after application of topical formulations is in no way correlated with the skin temperature assessed using a thermal imaging method. Assessment of the effectiveness of preparations having a cooling or warming effect (evaluated as the change in skin surface temperature) with the use of subjective analysis of thermal sensation perception is not possible. Warming and cooling substances can cause a cooling or warming effect on the skin without changing its temperature. This is due to the fact that perception of thermal sensations is based on the activity of receptors that respond to external stimuli. The stimulus that causes a given effect, e.g. skin warming, does not have to be physical – temperature change – but it can be chemical. In addition, a major factor lowering the skin temperature is the weight of the formulation which is very important in practical applications.

We certify that there is no conflict of interest with any financial organization regarding the material discussed in the manuscript—“Dynamic thermal imaging analysis in the effectiveness evaluation of warming and cooling formulations”.

The authors declare that they have no competing interests.

RK suggested the algorithm for image analysis and processing, implemented it and analysed the images. SW, BB, ZW, performed the acquisition of the images from THV camera and consulted the obtained results. All authors have read and approved the final manuscript.

@&#ACKNOWLEDGEMENTS@&#

No outside funding was received for this study.

@&#REFERENCES@&#

