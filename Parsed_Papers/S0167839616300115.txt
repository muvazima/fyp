@&#MAIN-TITLE@&#On constructing RAGS via homogeneous splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Piecewise rational functions, called rational geometric splines (or RAGS), are studied.


                        
                        
                           
                           RAGS are suitable for representing surfaces of arbitrary genus and continuity.


                        
                        
                           
                           A construction of parametric homogeneous splines is proposed.


                        
                        
                           
                           Interpolation and approximation methods for constructing smooth splines are presented.


                        
                        
                           
                           It is shown how homogeneous splines can be used to obtain RAGS.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Splines on triangulations

Piecewise rational function

Unstructured mesh

Arbitrary topological genus

Homogeneous geometry

Homogeneous spline

@&#ABSTRACT@&#


               
               
                  Recently, a construction of spline spaces suitable for representing smooth parametric surfaces of arbitrary topological genus and arbitrary order of continuity has been proposed. These splines, called RAGS (rational geometric splines), are a direct generalization of bivariate polynomial splines on planar triangulations. In this paper we discuss how to construct parametric splines associated with the three homogeneous geometries (spherical, affine, and hyperbolic) and we also consider a number of related computational issues. We then show how homogeneous splines can be used to obtain RAGS. As examples of RAGS surfaces we consider direct analogs of the Powell–Sabin macro-elements and also spline surfaces of higher degrees and higher orders of continuity obtained by minimizing an energy functional.
               
            

@&#INTRODUCTION@&#

In a recent paper (Beccari et al., 2014), we have proposed a general method of defining rational splines, so-called RAGS (or rational geometric splines), capable of representing surfaces of general topological genus. The main advantage of RAGS surfaces in comparison to alternative representations, for example those based on so-called manifold splines (Grimm and Hughes, 1995; Navau and Garcia, 2000; Della Vecchia et al., 2008; Gu et al., 2008; Tosun and Zorin, 2011), subdivision methods (Warren and Weimer, 2001; Sabin, 2005; Peters and Reif, 2008; Cashman, 2012), and T-splines (Sederberg et al., 2003; Li and Qin, 2012; Scott et al., 2013), is that they mimic the standard bivariate splines on planar domains and their constructive aspects, and as such, they are closer in spirit to the traditional NURBS representation. The point of departure for constructing RAGS is a given mesh, which is a triangulation in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      and an appropriate collection of so-called transition maps that are linear rational transformations. Such transformations allow one to “glue” together neighboring triangles of the mesh and have also been recently considered in Peters and Fan (2010), Peters and Sarov (2015). As was pointed out in our mentioned paper, a possible way of finding such transition maps is by means of a homogeneous geometry. Our purpose in the current paper is to give more details on this approach and also to report on our initial numerical experience with RAGS.

Before we delve into details, we point out that the idea of using homogeneous geometry in connection with defining splines is not new. One attempt in this direction is reported in Alfeld et al. (1996a, 1996b, 1996c) where the authors consider the so-called spherical splines, which are in essence piecewise spherical harmonic functions. In Liu and Schumaker (1996), such spherical splines are also used to define a class of 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      interpolating splines on the sphere that are piecewise rational functions and, as it turns out, they represent special instances of RAGS. Another kind of homogeneous geometry, namely the hyperbolic geometry, can be used to model surfaces of genus larger than one. This was initially noticed in Ferguson and Rockwood (1993) and later also considered in Wallner (1996), Pottmann and Wallner (1997). It was also pointed out in these last two references that such surfaces can be parameterized as piecewise rational surfaces. For a more detailed historical perspective on these topics, we refer to the discussion in Beccari et al. (2014).

The paper is organized as follows. The first part is concerned with the construction of parametric homogeneous splines and a number of algorithmic issues. Then we describe several specific interpolation and approximation methods for constructing smooth splines, including analogs of the Powell–Sabin method and a global energy-minimization method. Finally, we show how homogeneous splines can be used to obtain RAGS and present a few numerical examples.

The starting point for the construction of splines in this paper is a mesh Δ. We assume that Δ is a triangulation of a finite set of points in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . Thus, Δ will be thought of as a surface or, more precisely, a closed 2-manifold (orientable or non-orientable) embedded in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . The assumption that Δ has no boundary is not essential, it merely serves here to simplify the exposition. Depending on its genus, this surface can be equipped with one of the standard homogeneous geometries, spherical, affine, or hyperbolic. This means that one can find a triangulation, denoted by 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     , which is combinatorially equivalent to Δ, corresponding to one of these homogeneous geometries (hence the subscript “H” in the notation). In particular, 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      will be a collection of triangles that are either spherical (if the genus g is 0), planar (or affine, 
                        g
                        =
                        1
                     ), or hyperbolic (
                        g
                        >
                        1
                     ). More precisely, “triangles” in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      will be equivalence classes of congruent triangles. To work with such triangles, we will either select a specific representative, i.e. a triple of vertices in one of the three homogeneous planes (denoted by the generic symbol 
                        P
                     , so that 
                        P
                      will either be the sphere, the affine plane, or the hyperbolic plane), or we will represent such a triangle as a triple of its interior angles.

In order for 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      to be a well-defined triangulation, triangles in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      must be compatible in the following sense. Let v be a vertex of Δ and let 
                        C
                        (
                        v
                        )
                      be the set of all triangles 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              T
                           
                           
                              ν
                           
                        
                        ∈
                        Δ
                      containing v. We call 
                        C
                        (
                        v
                        )
                      the cell corresponding to vertex v. Here ν denotes the valence of v, i.e., the cardinality of 
                        C
                        (
                        v
                        )
                     . Without loss of generality, we will assume that the triangles of 
                        C
                        (
                        v
                        )
                      are ordered such that 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        =
                        〈
                        v
                        ,
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        〉
                        ,
                        …
                        ,
                        
                           
                              T
                           
                           
                              ν
                              −
                              1
                           
                        
                        =
                        〈
                        v
                        ,
                        
                           
                              v
                           
                           
                              ν
                              −
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              ν
                           
                        
                        〉
                        ,
                        
                           
                              T
                           
                           
                              ν
                           
                        
                        =
                        〈
                        v
                        ,
                        
                           
                              v
                           
                           
                              ν
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              1
                           
                        
                        〉
                     , where 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              v
                           
                           
                              ν
                           
                        
                      are the vertices of Δ that are connected to v by an edge of Δ. Next, let 
                        C
                        (
                        v
                        )
                        =
                        {
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              T
                           
                           
                              ν
                           
                        
                        }
                      be the set of triangles in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      corresponding to 
                        C
                        (
                        v
                        )
                     . The mentioned compatibility condition on 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      is that there must exist a set of points 
                        u
                        ,
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              ν
                           
                        
                        ∈
                        P
                     , such that triangles 
                        〈
                        u
                        ,
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        〉
                        ,
                        …
                        ,
                        〈
                        u
                        ,
                        
                           
                              u
                           
                           
                              ν
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              1
                           
                        
                        〉
                      have disjoint interiors (i.e. are non-overlapping) and are congruent to 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              T
                           
                           
                              ν
                           
                        
                     , respectively. Thus, we can think of 
                        C
                        (
                        v
                        )
                      as a set of physical triangles in 
                        P
                     , sharing a common vertex u.

The above compatibility condition implies the following fact, to be used later. Let 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      be adjacent triangles of Δ, i.e. such that they share a common edge, and let 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      be their corresponding counterparts in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      (we also call such 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      
                     adjacent.) Then one can find four points 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                           
                              ′
                           
                        
                      such that the triangles 
                        〈
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                        〉
                        ,
                        〈
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                           
                              ′
                           
                        
                        〉
                      do not overlap and that they are congruent with 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     , respectively.

To explain the construction of a spline space corresponding to Δ (or, equivalently, to 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     ), we first consider a single triangle 
                        T
                      in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      and define appropriate spaces of “polynomials” that will be used as building blocks for the desired splines.

Given three linearly independent vectors 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , any vector 
                           u
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         can be expressed in a unique way as a linear combination 
                           u
                           =
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           (
                           u
                           )
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           (
                           u
                           )
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                           (
                           u
                           )
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                        . The numbers 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         are linear homogeneous functions of u and are called the trihedral or homogeneous barycentric coordinates of u with respect to 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                         (Alfeld et al., 1996b). Recall that a function f defined on 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is said to be homogeneous of degree n provided 
                           f
                           (
                           α
                           v
                           )
                           =
                           
                              
                                 α
                              
                              
                                 n
                              
                           
                           f
                           (
                           v
                           )
                        , 
                           α
                           ∈
                           R
                        , 
                           v
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . Thus, the coordinates 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         are trivariate homogeneous polynomials of degree one.

In this paper we will be interested in the cases where the points 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                         are vertices of a triangle in one of the three homogeneous planes 
                           P
                        . In particular, we assume that 
                           P
                         is one of the standard surfaces, i.e. either the sphere, 
                           S
                           =
                           {
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           |
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           =
                           1
                           }
                        , the affine plane, 
                           A
                           =
                           {
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           |
                           z
                           =
                           1
                           }
                        , or the hyperbolic plane, 
                           H
                           =
                           {
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           |
                         
                        
                           −
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           =
                           1
                           ,
                           z
                           >
                           0
                           }
                        , and we will consider the restrictions of 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         to 
                           P
                        . In the first case, these restrictions have been termed spherical barycentric coordinates (Alfeld et al., 1996a), in the second case, one obtains the standard planar or affine coordinates (since 
                           (
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                           )
                           
                              
                                 |
                              
                              
                                 A
                              
                           
                           =
                           1
                        ), and, lastly, if 
                           P
                           =
                           H
                        , the restrictions could be dubbed hyperbolic barycentric coordinates. However, for simplicity, we will use the generic term barycentric coordinates, or b.c.s, for short.

Barycentric coordinates share many properties with their planar counterparts. Let 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           ∈
                           P
                         be linearly independent and let 
                           V
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           )
                           :
                           =
                           {
                           u
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           :
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           (
                           u
                           )
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           (
                           u
                           )
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                           (
                           u
                           )
                           ⩾
                           0
                           }
                         be the corresponding trihedron. By 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                           ⊂
                           P
                        , we denote the triangle obtained as the intersection of 
                           V
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           )
                         with 
                           P
                        . We list the following facts without proof. For 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , one has
                           
                              (P1)
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 , 
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                 , where 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                  is the Kronecker delta;


                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    u
                                    )
                                    ⩾
                                    0
                                 , 
                                    u
                                    ∈
                                    T
                                 ;


                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    0
                                 , for 
                                    u
                                    ∈
                                    P
                                 , if and only if u is on the geodesic containing edge 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                  of 
                                    T
                                  opposite to 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 . In the canonical setting, where 
                                    P
                                  is one of the three standard surfaces considered above, a geodesic is the intersection of 
                                    P
                                  with a plane in 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  passing through the origin;

for 
                                    u
                                    ∈
                                    T
                                    \
                                    {
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    }
                                 , one has 
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    u
                                    )
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    u
                                    )
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       {
                                       
                                          
                                             
                                                >
                                                1
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                S
                                                ,
                                             
                                          
                                          
                                             
                                                =
                                                1
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                A
                                                ,
                                             
                                          
                                          
                                             
                                                <
                                                1
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                H
                                                .
                                             
                                          
                                       
                                    
                                 
                              

Property (P3) implies that a point u on an edge of 
                           T
                         can be expressed by means of its b.c.s with respect to the endpoints of that edge, or 
                           u
                           =
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        , 
                           u
                           ∈
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                        , where 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         denotes the edge (or geodesic arc) of 
                           T
                         with endpoints 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        . The next three propositions provide means for the evaluation of b.c.s. The following result is stated without proof (but see Alfeld et al., 1996a for the spherical case).


                        
                           Proposition 1
                           
                              Let 
                              
                                 T
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                                 ⊂
                                 P
                               
                              be a non-degenerate triangle, i.e. such that 
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                               
                              are independent, and let 
                              
                                 u
                                 ∈
                                 P
                              
                              . Then
                              
                                 
                                    (1)
                                    
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                    
                                 
                               
                              where 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                               
                              are the respective signed distances of 
                              
                                 u
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                               
                              from the geodesic containing edge 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                               
                              (
                              
                                 Fig. 1
                              
                               
                              (left)) and
                              
                                 
                                    
                                       ρ
                                       (
                                       t
                                       )
                                       :
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   sin
                                                   ⁡
                                                   (
                                                   t
                                                   )
                                                   ,
                                                
                                                
                                                    
                                                   P
                                                   =
                                                   S
                                                   ,
                                                
                                             
                                             
                                                
                                                   t
                                                   ,
                                                
                                                
                                                    
                                                   P
                                                   =
                                                   A
                                                   ,
                                                
                                             
                                             
                                                
                                                   sinh
                                                   ⁡
                                                   (
                                                   t
                                                   )
                                                   ,
                                                
                                                
                                                    
                                                   P
                                                   =
                                                   H
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              We use the convention that 
                              
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                               
                              and that 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 <
                                 0
                              
                              , if 
                              
                                 u
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                               
                              are on the opposite sides of the plane passing through 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                               
                              and the origin, and 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                               
                              otherwise.
                           

Another useful property of b.c.s is that they are invariant under congruence transformations. This can be seen as a direct consequence of the following formulas for b.c.s, showing that the b.c.s depend only on internal angles of associated triangles. 
                           Proposition 2
                           
                              Let 
                              
                                 T
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                                 ⊂
                                 P
                               
                              be non-degenerate and 
                              
                                 u
                                 ∈
                                 P
                              
                              . Then
                              
                                 
                                    (2)
                                    
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                    
                                 
                               
                              where the expression on the right is defined as 0 if 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 π
                              
                              , and where we assume that the indices 
                              
                                 i
                                 −
                                 1
                                 ,
                                 i
                                 ,
                                 i
                                 +
                                 1
                               
                              are a cyclic permutation of 
                              
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                              . Here we denoted by 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                               
                              the interior angles of the triangle 
                              
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 u
                                 〉
                              
                              , see 
                              
                                 Fig. 1
                               
                              (right).
                           


                        
                           Proof
                           We adopt the convention that 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 [
                                 0
                                 ,
                                 π
                                 ]
                              , 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 (
                                 0
                                 ,
                                 π
                                 ]
                               if u and 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                               are on the same side of edge 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              , whereas 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 [
                                 π
                                 ,
                                 2
                                 π
                                 ]
                              , 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 [
                                 π
                                 ,
                                 2
                                 π
                                 )
                               otherwise. We will prove the statement for the case 
                                 i
                                 =
                                 3
                              , the other cases being similar. If u is on the geodesic containing edge 
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              , or 
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 π
                              , then by property (P3), 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 0
                              . Otherwise, identity (2) can be proved by a repeated application of the law of sines. In particular, for triangle 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 u
                                 〉
                               and one of its subtriangles, we get
                                 
                                    
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   γ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   δ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   β
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             (
                                             π
                                             /
                                             2
                                             )
                                          
                                       
                                       ,
                                    
                                 
                               whereas for triangle 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               and one of its subtriangles, one has
                                 
                                    
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             (
                                             π
                                             /
                                             2
                                             )
                                          
                                       
                                       .
                                    
                                 
                               Formula (1), together with the above identities, yields the desired equality
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       
                                          
                                             ρ
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             ρ
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   β
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   γ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   δ
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               which completes the proof. □

The result above allows us to prove the following important formulas for b.c.s associated with adjacent triangles.


                        
                           Proposition 3
                           
                              Consider two adjacent triangles 
                              
                                 T
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               
                              and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                               
                              in 
                              
                                 P
                              
                              , with angles 
                              
                                 〈
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               
                              and 
                              
                                 〈
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                              
                              . Let 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                               
                              be the b.c.s of 
                              
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                               
                              w.r.t. 
                              
                                 T
                              
                              . Then
                              
                                 
                                    (3)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

We follow the notation in Fig. 2
                              , where angles 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                               are the interior angles of triangle 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                               corresponding to vertices 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                              , respectively. The expression for 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                               is an immediate consequence of Proposition 2, with 
                                 i
                                 =
                                 3
                              , 
                                 u
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 2
                                 π
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       β
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 2
                                 π
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 2
                                 π
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                              . As for 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              , suppose first that 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              . Then the three points 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                               lie on a single geodesic and hence, by property (P3), 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              . On account of 
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 π
                              , this is consistent with the first identity in (3). Next, we proceed under the assumption that 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 0
                              . Then formula (2), with 
                                 i
                                 =
                                 1
                              , 
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                              , gives
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             sin
                                             ⁡
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Therefore, to prove the assertion of the proposition, it remains to show that
                                 
                                    
                                       
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             sin
                                             ⁡
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                               However, this can be easily verified by applying the law of sines to triangles 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 〉
                              , 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                              , and 
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                              . The proof for 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                               is analogous. □

The above proposition states that the interior angles associated with triangles 
                           T
                           ,
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         readily determine the b.c.s 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                        . This is not surprising, given the mentioned fact that the b.c.s are invariant under congruence transformations. Curiously, the formula is formally the same in all three cases (spherical, affine, hyperbolic). Moreover, the expressions for 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                         are always well defined as long as the two triangles are non-degenerate, i.e., all associated angles are in 
                           (
                           0
                           ,
                           π
                           )
                        . Lastly, in the affine case one has 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                           =
                           π
                         and it is easy to see that then 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                           =
                           1
                        , as expected.

We recall some elementary facts concerning homogeneous polynomials (Alfeld et al., 1996a). Let 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                         be a nondegenerate triangle in 
                           P
                         and let 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         denote the associated b.c.s. Homogeneous Bernstein basis polynomials of degree n are defined as
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 :
                                 =
                                 
                                    
                                       n
                                       !
                                    
                                    
                                       i
                                       !
                                       j
                                       !
                                       k
                                       !
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                                 
                                 i
                                 +
                                 j
                                 +
                                 k
                                 =
                                 n
                                 ,
                                 
                                 u
                                 ∈
                                 P
                                 .
                              
                           
                        
                     

It can be easily proved that such functions are linearly independent and hence every p in 
                           
                              
                                 π
                              
                              
                                 n
                              
                           
                        , the space of homogeneous parametric polynomials of degree n, has a unique expansion of the form
                           
                              (4)
                              
                                 p
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                                 
                                 u
                                 ∈
                                 P
                                 ,
                              
                           
                         where the 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         are the so-called Bézier or control points of p. This equation is customarily referred to as the Bernstein–Bézier representation, or simply the B-form, of p.

Due to their formal analogy with ordinary bivariate polynomials, homogeneous polynomials in the B-form inherit many of the properties of their planar counterparts. In particular, they can be evaluated by means of the well-known de Casteljau algorithm and conditions for two polynomials on adjacent triangles joining smoothly across their common edge are formally the same as those for ordinary polynomials, as can be seen below. We will omit the proof of the next result since it follows along standard lines (see e.g. Alfeld et al., 1996a).


                        
                           Proposition 4
                           
                              Let 
                              
                                 T
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               
                              and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                               
                              be two adjacent triangles in 
                              
                                 P
                               
                              and let
                              
                                 
                                    
                                       p
                                       =
                                       
                                          ∑
                                          
                                             i
                                             +
                                             j
                                             +
                                             k
                                             =
                                             n
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       
                                       
                                          and
                                       
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             +
                                             j
                                             +
                                             k
                                             =
                                             n
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                          
                                             ′
                                             
                                             n
                                          
                                       
                                    
                                 
                               
                              be polynomials defined on 
                              
                                 T
                               
                              and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              
                              , respectively. Then p and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                               
                              join with 
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                               
                              continuity, 
                              
                                 m
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                              
                              , along the common edge 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                               
                              if and only if
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             ν
                                             +
                                             μ
                                             +
                                             κ
                                             =
                                             k
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             ν
                                             ,
                                             j
                                             +
                                             μ
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             ν
                                             μ
                                             κ
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ,
                                       
                                       k
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       m
                                       ,
                                       
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       n
                                       .
                                    
                                 
                              
                           

Homogeneous polynomials defined in the previous section can be used to construct spline spaces corresponding to a given mesh Δ by means of the combinatorially equivalent triangulation 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        . A spline s in such a space will simply be a piecewise-defined function composed of individual polynomial pieces 
                           
                              
                                 s
                              
                              
                                 T
                              
                           
                           :
                           =
                           s
                           
                              
                                 |
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 π
                              
                              
                                 n
                              
                           
                           
                              
                                 |
                              
                              
                                 T
                              
                           
                        , where 
                           T
                         will vary over the triangles of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        . Note that by definition (4), for given fixed Bézier coefficients 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         of 
                           
                              
                                 s
                              
                              
                                 T
                              
                           
                        , this function will not depend on which particular representative of the equivalence class of congruent triangles with 
                           T
                         is considered, given that b.c.s are invariant under congruence transformations. We will use the notation 
                           s
                           :
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         for composite parametric functions s such that, for any 
                           T
                           ∈
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        , the restriction 
                           
                              
                                 s
                              
                              
                                 T
                              
                           
                         satisfies 
                           
                              
                                 s
                              
                              
                                 T
                              
                           
                           (
                           u
                           )
                           =
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                           (
                           b
                           (
                           u
                           )
                           )
                           ,
                           u
                           ∈
                           T
                        , for some function 
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                         independent of the particular representative chosen for 
                           T
                        , where 
                           b
                           (
                           u
                           )
                         is the vector of b.c.s of u w.r.t. 
                           T
                        .

In addition to being piecewise (homogeneous) polynomials, our splines will be required to be globally 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                         continuous, for some 
                           m
                           ≥
                           0
                        , i.e. they will belong to the class 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                           )
                        . This will be the space of all functions 
                           f
                           :
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         that are 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                         continuous in the following sense. Let v be a vertex of Δ and let 
                           C
                           (
                           v
                           )
                         be the cell of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         corresponding to cell 
                           C
                           (
                           v
                           )
                         of Δ, whose existence was postulated at the beginning of Section 2. Also, let 
                           U
                           (
                           v
                           )
                           ⊂
                           P
                         be the union of all triangles of 
                           C
                           (
                           v
                           )
                        . We say that a function 
                           f
                           :
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                         continuous if f is 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                         continuous in the interior of 
                           U
                           (
                           v
                           )
                        , for all vertices v of Δ. We note that f is well defined in all of 
                           U
                           (
                           v
                           )
                         since it is defined for all 
                           T
                           ∈
                           C
                           (
                           v
                           )
                         and values of 
                           f
                           
                              
                                 |
                              
                              
                                 T
                              
                           
                         do not depend on the particular representative for 
                           T
                         that we choose (since 
                           f
                           
                              
                                 |
                              
                              
                                 T
                              
                           
                         is a function of b.c.s).

We are now ready to define a spline space of piecewise homogeneous polynomial functions associated with Δ. Let 
                           m
                           ,
                           n
                         be nonnegative integers. We call
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 Δ
                                 )
                                 :
                                 =
                                 {
                                 s
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       H
                                    
                                 
                                 )
                                 :
                                 s
                                 
                                    
                                       |
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       π
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 T
                                 ∈
                                 
                                    
                                       Δ
                                    
                                    
                                       H
                                    
                                 
                                 }
                              
                           
                         the space of homogeneous splines of degree n and smoothness m. We will refer to these spaces as spherical, affine, and hyperbolic splines in the cases 
                           P
                           =
                           S
                           ,
                           A
                           ,
                           H
                        , respectively.

To construct a spline for a given triangulation Δ, we will first need to find an appropriate triangulation 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        . This will be discussed in the next section. After that continuity conditions will be imposed between neighboring Bézier patches (i.e. polynomials associated with adjacent triangles 
                           T
                           ,
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        ), specified in Proposition 4, which will give rise to a linear system of equations for the Bézier points of the individual patches.

Of immediate interest is the problem of the dimension of the space 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 m
                              
                           
                           (
                           Δ
                           )
                        . This is known to be a difficult question even in the affine case and, in fact, the exact dimension is known only when n is sufficiently large relative to m, see the extensive discussion in Lai and Schumaker (2007). In the non-affine case, the situation is similar. For example, the spherical case has been dealt with in detail in Alfeld et al. (1996b) and we expect that in the hyperbolic case the results will be similar, especially in the tractable case 
                           n
                           ≥
                           3
                           m
                           +
                           2
                        , since, as was pointed out earlier, smoothness conditions between neighboring polynomial pieces are formally the same for all three types of geometries. However, the dimension question and the construction of bases for 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 m
                              
                           
                           (
                           Δ
                           )
                         will not be dealt with in this paper.

Here we will content ourselves with stating the dimension in the special case of 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         splines. To this end we let 
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 E
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 T
                              
                           
                         denote the respective numbers of vertices, edges, and triangles of Δ. Then
                           
                              (6)
                              
                                 dim
                                 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 Δ
                                 )
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                                 +
                                 (
                                 n
                                 −
                                 1
                                 )
                                 
                                    
                                       n
                                    
                                    
                                       E
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 (
                                 n
                                 −
                                 1
                                 )
                                 (
                                 n
                                 −
                                 2
                                 )
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         which is a direct consequence of the 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                        -continuity conditions (5) and the fact that the Bernstein basis polynomials in (4) are independent and in one-to-one correspondence with control points 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        . We also note in passing the following well-known formulas for the numbers 
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 E
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 T
                              
                           
                        , and the genus g of Δ:
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                                 +
                                 4
                                 (
                                 g
                                 −
                                 1
                                 )
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       E
                                    
                                 
                                 =
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                                 +
                                 6
                                 (
                                 g
                                 −
                                 1
                                 )
                                 .
                              
                           
                        
                     

Given the initial triangulation Δ, the definition of the spline space in previous section requires the knowledge of a triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     . In particular, there is a one-to-one correspondence between triangles in Δ and 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     . We will use the notation 
                        Δ
                        =
                        
                           
                              {
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    T
                                 
                              
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                        =
                        
                           
                              {
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           
                              i
                              =
                              1
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    T
                                 
                              
                           
                        
                     .

In this section we will introduce a possible way to obtain 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     . Since elements of 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      are equivalence classes of congruent triangles in 
                        P
                     , we will assume that triangles in 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      are represented as triples of angles rather than triples of points in 
                        P
                     . We will henceforth use the notation 
                        
                           
                              T
                           
                           
                              i
                           
                        
                        =
                        〈
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        〉
                     , where 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        ∈
                        (
                        0
                        ,
                        π
                        )
                     . The lengths of the edges opposite to these angles will be denoted by 
                        
                           
                              d
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              2
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              3
                           
                           
                              i
                           
                        
                     . It is well known that in the spherical case one has
                        
                           (7)
                           
                              cos
                              ⁡
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                           
                        
                      whereas in the hyperbolic case the same formula holds, with 
                        cos
                        ⁡
                        
                           
                              d
                           
                           
                              3
                           
                           
                              i
                           
                        
                      replaced with 
                        cosh
                        ⁡
                        
                           
                              d
                           
                           
                              3
                           
                           
                              i
                           
                        
                      (Ratcliffe, 2007). Formulas for 
                        
                           
                              d
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              2
                           
                           
                              i
                           
                        
                      are analogous.

We also recall that any triple 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        ∈
                        (
                        0
                        ,
                        π
                        )
                      gives rise to a unique triangle (up to congruence) in one of the three homogeneous geometries, namely to a hyperbolic triangle, if 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        <
                        π
                     , or affine, if 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        =
                        π
                     , or spherical, if 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        >
                        π
                     .

The following are necessary and sufficient conditions on angles 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                     , for the existence of a consistent triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     :
                        
                           (T1)
                           the sum of angles around each vertex is 2π;

common sides of adjacent triangles have equal lengths.

The problem of finding a suitable triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      can be thought of as a parametrization problem and it has received considerable attention in the planar case, see for example Floater (1997). In the following we describe the algorithm we have used in our examples, although alternative approaches are possible.

We use the convention that all angles surrounding vertex j of valence 
                        
                           
                              ν
                           
                           
                              j
                           
                        
                      are labeled as 
                        
                           
                              β
                           
                           
                              j
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                        
                     , where 
                        
                           
                              i
                           
                           
                              k
                           
                        
                      is the index of the k-th triangle containing vertex j, and where 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              ν
                           
                           
                              j
                           
                        
                      (Fig. 3
                      (left)). We will seek a set of appropriate angles defining 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      as a solution of a constrained minimization problem with a suitable objective function and with nonlinear constraints represented by conditions (T1) and (T2). A possibility is to minimize the quadratic function
                        
                           (8)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      so as to obtain a triangulation which is as close as possible to being “uniform”. Moreover, by (7), condition (T2) gives rise to a set of distance constraints:
                        
                           (9)
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              :
                              =
                              
                                 
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          j
                                       
                                    
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    cos
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                       
                                          j
                                       
                                    
                                    sin
                                    ⁡
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                           
                        
                      for all pairs of adjacent triangles 
                        
                           
                              T
                           
                           
                              i
                           
                        
                        =
                        〈
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        〉
                        ,
                        
                           
                              T
                           
                           
                              j
                           
                        
                        =
                        〈
                        
                           
                              α
                           
                           
                              1
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              j
                           
                        
                        〉
                     , where angles 
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              3
                           
                           
                              j
                           
                        
                      are assumed to be opposite the common edge (cf. Fig. 3 (right)), whereas condition (T1) can be expressed as
                        
                           (10)
                           
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              2
                              π
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    V
                                 
                              
                              .
                           
                        
                     
                  

Equations (9) and (10) are constraints associated with vertices and edges of 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     , and hence their total number is 
                        
                           
                              n
                           
                           
                              V
                           
                        
                        +
                        
                           
                              n
                           
                           
                              E
                           
                        
                     . For meshes of moderate size, such as the one depicted later in Fig. 6, we have successfully solved the above optimization problem by the MATLAB routine FSOLVE, using the Levenberg–Marquard algorithm, with the tolerance set to the machine precision, and with initial values
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    2
                                    π
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       j
                                    
                                 
                              
                              ,
                              
                              k
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    V
                                 
                              
                              .
                           
                        
                      It should be pointed out that the expression on the right-hand side of (7) is not related to the length of an edge in the affine case, i.e. when 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              2
                           
                           
                              i
                           
                        
                        +
                        
                           
                              α
                           
                           
                              3
                           
                           
                              i
                           
                        
                        =
                        π
                     . In that case the expression equals 1 and hence condition (9) is automatically satisfied. We further note that the formulation of the optimization problem does not require the genus g as input and nor is it necessary to specify which of the three homogeneous geometries is to be used. Lastly, instead of (8), it would make sense to devise more sophisticated objective functions, for example ones that take into account the geometry of the mesh Δ, so as to minimize distortions in the parametrization. We view this as a separate problem of finding an optimal parametrization. Although not studied in the current paper, we think this problem deserves a thorough investigation.

A distinct advantage of homogeneous splines is that standard bivariate spline methods — which are well suited for modeling (scalar and vector) functions over planar triangulations — can be adapted to surfaces of general topology without the need to invent entirely new approaches. To illustrate this point, we present in this section a few examples of local and global surface fitting methods.

Local techniques are traditionally based on the use of so-called macro-elements. As a prototype of such splines, we have chosen the classical Powell–Sabin method, although other well-known types of elements can be obtained as a direct generalization of the affine case, such as the Clough–Tocher cubic element and many others (described for example in the recent monograph Schumaker, 2015).

As for global methods, we describe here how to construct interpolating spline surfaces of arbitrary degrees and orders of continuity by minimizing a suitable energy functional.

The Powell–Sabin scheme consists in subdividing each triangle 
                           T
                           ∈
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        , called in this context a macro-triangle, into six subtriangles. A quadratic polynomial is then defined on each subtriangle in such a way that the resulting composite surface is globally 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuous (for more details on this construction in the planar case, see Lai and Schumaker, 2007; Schumaker, 2015). To explain this further, let 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                        , where 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           ∈
                           P
                        . The splitting of the triangle can be done by considering the incenter ξ of 
                           T
                        , i.e., the intersection of the angle bisectors of 
                           T
                        . One way to compute the incenter is to radially project the incenter of the flat triangle with vertices 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                         onto 
                           P
                        . The next step in the subdivision is to split each of the three edges of 
                           T
                        . Let 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         be an adjacent triangle to 
                           T
                        , with common edge 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                        , say, and let 
                           
                              
                                 ξ
                              
                              
                                 ′
                              
                           
                         be the incenter of 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        . We define 
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                         to be the intersection of 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         with the geodesic line passing through the two incenters ξ and 
                           
                              
                                 ξ
                              
                              
                                 ′
                              
                           
                        . The reason for choosing incenters of 
                           T
                         and 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         is that this guarantees that 
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                         is strictly inside the edge 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                        . This follows by a similar argument as in the plane (see Lemma 4.19 in Lai and Schumaker (2007)). Points 
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         are defined analogously.

The four points 
                           ξ
                           ,
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                         give rise to a subdivision of 
                           T
                         into six subtriangles, as shown in Fig. 4
                         (left). To associate a quadratic Bézier polynomial with each subtriangle, it will be necessary to determine appropriate Bézier points, which will be labeled as in Fig. 4 (right). These will be defined such that the resulting spline surface interpolates the vertices of Δ and is globally 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         smooth. The standard way to achieve the latter is to also interpolate directional derivatives at the vertices of each of the macro-elements. If these derivatives are not given, which is often the case, they can be estimated.

A reasonable way of estimating the directional derivatives is to require that the resulting interpolating spline has the so-called quadratic reproduction property. This means that if the vertices of the mesh Δ are incident on a quadratic homogeneous polynomial surface, then locally the spline must be identical to this surface. Such reproduction property is usually necessary for the interpolation scheme to have optimal approximation order. More precisely, suppose that we desire to estimate directional derivatives at a vertex 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         and that 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                           ∈
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         is a triangle containing this vertex. To this end, we first find a best quadratic fit of the mesh points of Δ in the vicinity of 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        , the mesh point of Δ corresponding to vertex 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        . In particular, our objective is to find a quadratic parametric polynomial 
                           q
                           ∈
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                        , parameterized by 
                           b
                           =
                           
                              
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                        , the barycentric coordinates w.r.t. the reference triangle 
                           T
                        , such that
                           
                              
                                 q
                                 (
                                 b
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 =
                                 q
                                 (
                                 
                                    
                                       (
                                       1
                                       ,
                                       0
                                       ,
                                       0
                                       )
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and that
                           
                              
                                 
                                    ∑
                                    
                                       u
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ‖
                                       q
                                       (
                                       b
                                       (
                                       u
                                       )
                                       )
                                       −
                                       v
                                       (
                                       u
                                       )
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       u
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          ∑
                                          
                                             i
                                             +
                                             j
                                             +
                                             k
                                             =
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       v
                                       (
                                       u
                                       )
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is minimized, where 
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                              
                                 2
                              
                           
                         denotes the Euclidean norm, and where 
                           v
                           (
                           u
                           )
                         denotes the mesh point of Δ corresponding to vertex u. The sum above is taken over all vertices 
                           
                              
                                 U
                              
                              
                                 1
                              
                           
                         of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         that are in the vicinity of 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        . In our implementation, we considered the set 
                           
                              
                                 U
                              
                              
                                 1
                              
                           
                         of all mesh points of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         that either belong to a triangle of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         containing 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        , or to a triangle sharing an edge with a triangle containing 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        . This guarantees that the size of 
                           
                              
                                 U
                              
                              
                                 1
                              
                           
                         is at least 6, the dimension of 
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                        , and that the above problem has a unique solution. Note that the minimization problem gives rise to three separate linear systems for the 
                           x
                           ,
                           y
                           ,
                           z
                        -coordinates of the Bézier points 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . Moreover, the resulting quadratic fit will not depend on which reference triangle 
                           T
                         containing vertex 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         we select or which particular representative 
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                         in the equivalence class of congruent triangles we consider for 
                           T
                        .

Once a local quadratic fit q is found for vertex 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        , we can compute the sought-for directional derivatives in the direction of edges emanating from 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         as follows. Let 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ℓ
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                           ⊂
                           P
                        , 
                           ℓ
                           ≠
                           1
                        , be one such edge and suppose that 
                           
                              
                                 t
                              
                              
                                 1
                                 ℓ
                              
                           
                         is the unit tangent vector to the arc 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ℓ
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         at 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        , see Fig. 4 (left). The directional derivative 
                           
                              
                                 δ
                              
                              
                                 1
                                 ℓ
                              
                           
                         of q at 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         in the direction 
                           
                              
                                 t
                              
                              
                                 1
                                 ℓ
                              
                           
                         is given as
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                       ℓ
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                             ℓ
                                          
                                       
                                    
                                 
                                 q
                                 (
                                 b
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 :
                                 =
                                 
                                    
                                       d
                                       q
                                       (
                                       b
                                       (
                                       u
                                       (
                                       h
                                       )
                                       )
                                       )
                                    
                                    
                                       d
                                       h
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       h
                                       =
                                       0
                                    
                                 
                                 ,
                              
                           
                         where 
                           u
                           (
                           h
                           )
                         is any smooth parametrization of the arc 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ℓ
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                        , such that 
                           u
                           (
                           0
                           )
                           =
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 ′
                              
                           
                           (
                           0
                           )
                           =
                           
                              
                                 t
                              
                              
                                 1
                                 ℓ
                              
                           
                        . Using the chain rule, one obtains the following formula:
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                       ℓ
                                    
                                 
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       b
                                    
                                 
                                 q
                                 (
                                 b
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 ∇
                              
                              
                                 b
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       ∂
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       ∂
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       ∂
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                         and 
                           b
                           (
                           
                              
                                 t
                              
                              
                                 1
                                 ℓ
                              
                           
                           )
                         is the column vector of b.c.s of 
                           
                              
                                 t
                              
                              
                                 1
                                 ℓ
                              
                           
                         w.r.t. the reference triangle 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                        . We note that since q is quadratic, all three components of 
                           
                              
                                 ∇
                              
                              
                                 b
                              
                           
                           q
                           (
                           b
                           )
                         are linear. As a result, one has 
                           
                              
                                 ∇
                              
                              
                                 b
                              
                           
                           q
                           (
                           b
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           )
                           )
                           =
                           2
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       200
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       110
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       101
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                        , which are coefficients of the obtained quadratic fit q.

From now on, the construction of the Powell–Sabin macro-elements can proceed in a fully local way, as is standard in the classical setting (Schumaker, 2015). First, Bézier coefficients associated with the edges of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                         are determined. For example, referring to Fig. 4 (right), for edge 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                        , these are coefficients 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 6
                              
                           
                        . The first two of these are readily determined by the interpolation conditions, 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                        . The coefficients 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 6
                              
                           
                         are obtained by the requirement that the directional derivatives in the direction of the edge are equal to 
                           
                              
                                 δ
                              
                              
                                 12
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 21
                              
                           
                        , respectively. For example, for the macro-element to interpolate the directional derivative 
                           
                              
                                 δ
                              
                              
                                 12
                              
                           
                         at 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        , coefficient 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         can be obtained as the solution of
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       12
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             12
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 b
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 =
                                 2
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                         are the b.c.s of 
                           
                              
                                 t
                              
                              
                                 12
                              
                           
                         w.r.t. points 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                        , i.e. 
                           
                              
                                 t
                              
                              
                                 12
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                        , and where p is the quadratic polynomial associated with edge 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         (i.e. with coefficients 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 5
                              
                           
                        ). Coefficient 
                           
                              
                                 c
                              
                              
                                 5
                              
                           
                         can now be determined by the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         conditions from 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 6
                              
                           
                        , namely
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       6
                                    
                                 
                                 ,
                              
                           
                         where now 
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         are the b.c.s of 
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                         w.r.t. 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        , or 
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        . All remaining Bézier coefficients, that are “interior” to a given triangle, say triangle 
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                         (i.e. coefficients 
                           
                              
                                 c
                              
                              
                                 13
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 19
                              
                           
                         in Fig. 4 (right)), can be obtained from 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -continuity conditions corresponding to adjacent subtriangles of the macro-element. For example, one has
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       13
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       12
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       14
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       13
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       15
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       19
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ‴
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       13
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       ‴
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       15
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                    
                                       ‴
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       17
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ″
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                              
                                 ″
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                              
                                 ″
                              
                           
                         are the b.c.s of ξ w.r.t. 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ‴
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                              
                                 ‴
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                              
                                 ‴
                              
                           
                         are the b.c.s of ξ w.r.t. 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                        .

The above construction guarantees that adjacent macro-elements are 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuous and thus so is the resulting composite spline surface. In particular, the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity across the macro-edges (edges of 
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        ) is due to the fact that the directional derivatives 
                           
                              
                                 δ
                              
                              
                                 ℓ
                                 
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         are, by construction, compatible with a uniquely defined tangent plane at each vertex of Δ.

In the previous section we considered a local construction of a 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         surface, composed of macro-elements. An alternative to the above approach is not to subdivide individual triangles of the mesh Δ and instead use the spline space 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 m
                              
                           
                           (
                           Δ
                           )
                         directly, as defined in Section 2.3. Such an approach is quite robust in that it can be in principle applied for any parameters 
                           m
                           ,
                           n
                         and can be used for a variety of data-fitting methods. In particular, if one wants to interpolate the vertices of the mesh Δ by a smooth spline, a standard possibility is to seek a solution of the following minimization problem: For given 
                           m
                           <
                           n
                        , find a spline 
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 m
                              
                           
                           (
                           Δ
                           )
                        , such that 
                           s
                           (
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                        , and such that an energy or “fairness” functional, 
                           E
                           (
                           s
                           )
                        , is minimized. In the context of CAGD, this minimization is done to uniquely determine available degrees of freedom (i.e. any spline control points that are not readily set by the interpolation and smoothness conditions) and in such a way as to obtain a visually pleasing surface, free of artificial undulations not suggested by the geometry of the mesh Δ.

The above interpolation problem can be formulated explicitly in terms of the Bézier coefficients of the sought-for spline. Let us suppose that these coefficients are collected in a vector 
                           c
                           =
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       M
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                        , where 
                           M
                           =
                           dim
                           ⁡
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 0
                              
                           
                           (
                           Δ
                           )
                         is as in (6). For convenience, we will assume that the coefficients are ordered such that the first 
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                         entries, 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                              
                           
                        , of c correspond to the Bézier points associated with vertices 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                        , of Δ. Moreover, we assume that when two polynomial pieces join along an edge, the Bézier points along that edge are included in vector c just once. With this convention, the interpolating spline s can be determined as the minimizer of the energy functional 
                           E
                           (
                           s
                           )
                        , subject to the constraints
                           
                              (11)
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              (12)
                              
                                 C
                                 c
                                 =
                                 0
                                 .
                              
                           
                         Here, C is a 
                           K
                           ×
                           M
                         matrix that encodes the set of 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                        -continuity conditions for s across all edges of Δ, specified in Proposition 4. These are linear homogeneous equations for the coefficients c.

Frequently, the energy functional can be expressed as a quadratic form:
                           
                              (13)
                              
                                 E
                                 (
                                 c
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                 
                                 Q
                                 c
                                 ,
                              
                           
                         where Q is an 
                           M
                           ×
                           M
                         symmetric positive definite matrix. In that case, the interpolation problem reduces to finding a solution to the linear system:
                           
                              (14)
                              
                                 
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             E
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          
                                             κ
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where E is the 
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                           ×
                           M
                         matrix of the form 
                           E
                           =
                           (
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                              
                           
                            
                           0
                           )
                         (
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       V
                                    
                                 
                              
                           
                         is the 
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                           ×
                           
                              
                                 n
                              
                              
                                 V
                              
                           
                         identity matrix), 
                           v
                           =
                           
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             V
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                        , and 
                           μ
                           =
                           
                              
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             V
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                        , 
                           κ
                           =
                           
                              
                                 (
                                 
                                    
                                       κ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       κ
                                    
                                    
                                       K
                                    
                                 
                                 )
                              
                              
                                 t
                              
                           
                         are vectors of Lagrange multipliers associated with (11) and (12), respectively.

Some remarks on the above system are in order. If the full set of continuity conditions is considered, then the number of rows of C is 
                           K
                           =
                           (
                           n
                           +
                           n
                           −
                           1
                           +
                           ⋯
                           +
                           n
                           −
                           m
                           +
                           1
                           )
                           
                              
                                 n
                              
                              
                                 E
                              
                           
                           =
                           (
                           m
                           n
                           −
                           
                              (
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    
                                       2
                                    
                                 
                              
                              )
                           
                           )
                           
                              
                                 n
                              
                              
                                 E
                              
                           
                         since there are n 
                        
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -continuity conditions per edge, 
                           n
                           −
                           1
                         equations for 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity, etc. It turns out that such matrix C is rank deficient and therefore the system matrix in (14) is singular. This has been well known already in the context of ordinary splines (Lai and Schumaker, 2007) and even spherical splines (Alfeld et al., 1996b). However, the rank-deficiency of C does not affect the consistency of the linear system. There are two basic approaches to attempt to solve such a system. Either one employs a system solver that can handle consistent singular linear systems or, alternatively, instead of C one can consider a matrix with a reduced number of rows by eliminating dependent rows of C. The latter approach is tractable if m is small compared to n (in particular, if 
                           n
                           ≥
                           4
                           m
                           +
                           1
                         or even 
                           n
                           ≥
                           3
                           m
                           +
                           2
                        ), for in that case one can identify explicitly and in a local way redundant continuity conditions.

It is clear that the above-described approach is global, since all coefficients are the solution of a single linear system, which might be in fact quite large. However, the system is typically very sparse and hence system solvers taking advantage of the sparsity should be used. In particular, matrix Q is sparse for a variety of energy functionals, including the one considered below, and so is the matrix C. For example, for 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity (
                           m
                           =
                           1
                        ) there are at most 4 nonzero entries in each row of C and at most 7 such entries for 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -continuous splines.

Concerning the solvability of the system, because of the close resemblance of the splines considered here with the classical splines, we have reasons to believe that the system is uniquely solvable for any degree n and smoothness m, as long as n is sufficiently large relative to m. We plan to address this issue more rigorously elsewhere and, instead, we will content ourselves with pointing out that this claim is supported by our numerical experiments.

In the remainder of this subsection, we will discuss a suitable choice of energy for (13) that we have implemented and used in our experiments. Our starting point is the operator
                           
                              (15)
                              
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                    
                                 
                                 
                                    
                                       ∂
                                    
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                    
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                              if  
                                             P
                                             =
                                             S
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                              if  
                                             P
                                             =
                                             A
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             1
                                             ,
                                          
                                          
                                              if  
                                             P
                                             =
                                             H
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         Thus, in the first two cases, 
                           
                              
                                 L
                              
                              
                                 P
                              
                           
                         is the standard Laplacian operator. We can now define the Laplace–Beltrami operator, 
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 ⁎
                              
                           
                        , by
                           
                              (16)
                              
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 f
                                 :
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                 
                                 f
                                 
                                    (
                                    ⋅
                                    /
                                    
                                       
                                          ‖
                                          ⋅
                                          ‖
                                       
                                       
                                          P
                                       
                                    
                                    )
                                 
                                 
                                    
                                       |
                                    
                                    
                                       P
                                    
                                 
                                 ,
                              
                           
                         which should hold for all sufficiently differentiable functions f on 
                           P
                        . Thus, 
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 ⁎
                              
                           
                           f
                         is defined as the restriction to 
                           P
                         of 
                           
                              
                                 L
                              
                              
                                 P
                              
                           
                         applied to the homogeneous extension of f of degree 0. Here 
                           
                              
                                 ‖
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 ‖
                              
                              
                                 P
                              
                           
                           :
                           =
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , so that 
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           /
                           
                              
                                 ‖
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 ‖
                              
                              
                                 P
                              
                           
                           ∈
                           P
                        , for all 
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         for which 
                           
                              
                                 σ
                              
                              
                                 P
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           )
                           +
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           >
                           0
                        .

We now define the energy functional 
                           E
                           (
                           s
                           )
                         of a spline 
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 m
                              
                           
                           (
                           Δ
                           )
                         as
                           
                              
                                 E
                                 (
                                 s
                                 )
                                 =
                                 
                                    ∑
                                    
                                       T
                                       ∈
                                       
                                          
                                             Δ
                                          
                                          
                                             H
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    T
                                 
                                 
                                    
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             P
                                          
                                          
                                             ⁎
                                          
                                       
                                       s
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 τ
                                 ,
                              
                           
                         where dτ is the Lebesgue measure on 
                           P
                         corresponding to the standard metric on 
                           P
                        . We can now work out the entries of matrix Q in (13). Clearly, if s is a spline with coefficient vector c, the above functional has the form (13), with matrix entries
                           
                              (17)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ℓ
                                       ,
                                       
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       T
                                       ∈
                                       
                                          
                                             Δ
                                          
                                          
                                             H
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    T
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 )
                                 d
                                 τ
                                 ,
                                 
                                 ℓ
                                 ,
                                 
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 .
                              
                           
                         Here, the function 
                           
                              
                                 B
                              
                              
                                 ℓ
                              
                              
                                 n
                                 ,
                                 T
                              
                           
                         denotes the Bernstein basis polynomial corresponding to Bézier point 
                           
                              
                                 c
                              
                              
                                 ℓ
                              
                           
                        . If 
                           
                              
                                 c
                              
                              
                                 ℓ
                              
                           
                         is not associated with 
                           T
                        , then 
                           
                              
                                 B
                              
                              
                                 ℓ
                              
                              
                                 n
                                 ,
                                 T
                              
                           
                         is understood to be zero. Thus, it is not difficult to see that Q is sparse. Indeed, let 
                           ℓ
                           ,
                           
                              
                                 ℓ
                              
                              
                                 ′
                              
                           
                         be such that the Bézier points 
                           
                              
                                 c
                              
                              
                                 ℓ
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         correspond to interior Bézier points (i.e., points not associated with vertices or edges of Δ) of two separate triangles 
                           T
                         and 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        . Then 
                           
                              
                                 Q
                              
                              
                                 ℓ
                                 ,
                                 
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           0
                        , since all summands in (17) are trivially zero.

To compute the non-zero entries of Q, we can use numerical quadrature. In our implementation, this has been done as follows. Consider a triangle 
                           T
                           =
                           〈
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           〉
                           ∈
                           
                              
                                 Δ
                              
                              
                                 H
                              
                           
                        . Then the value of 
                           
                              
                                 ∫
                              
                              
                                 T
                              
                           
                           (
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 B
                              
                              
                                 ℓ
                              
                              
                                 n
                                 ,
                                 T
                              
                           
                           )
                           (
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 ⁎
                              
                           
                           
                              
                                 B
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 n
                                 ,
                                 T
                              
                           
                           )
                           d
                           τ
                         can be computed by parameterizing 
                           T
                         by the planar triangle 
                           
                              
                                 T
                              
                              ‾
                           
                         with the same vertices as 
                           T
                         (Alfeld et al., 1996c). In particular, a point 
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                           ∈
                           
                              
                                 T
                              
                              ‾
                           
                         can be mapped to 
                           u
                           ∈
                           T
                         by the transformation
                           
                              
                                 u
                                 =
                                 
                                    
                                       A
                                       
                                          
                                             u
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ‖
                                             A
                                             
                                                
                                                   u
                                                
                                                
                                                   ¯
                                                
                                             
                                             ‖
                                          
                                          
                                             P
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where A is the matrix whose columns are vectors 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                        . One can show that the surface integral of an integrable function f on 
                           T
                         can be evaluated as
                           
                              
                                 
                                    ∫
                                    T
                                 
                                 f
                                 (
                                 u
                                 )
                                 d
                                 τ
                                 =
                                 
                                    ∫
                                    
                                       
                                          T
                                       
                                       ‾
                                    
                                 
                                 f
                                 
                                    (
                                    
                                       
                                          A
                                          
                                             
                                                u
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ‖
                                                A
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ‖
                                             
                                             
                                                P
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ‖
                                       N
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ‖
                                    
                                    
                                       P
                                    
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                              
                           
                         where 
                           N
                           (
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                           )
                         is a normal vector of 
                           P
                         at 
                           u
                           =
                           A
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                           /
                           
                              
                                 ‖
                                 A
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ‖
                              
                              
                                 P
                              
                           
                        , such that 
                           
                              
                                 ‖
                                 N
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 ‖
                              
                              
                                 P
                              
                           
                           =
                           |
                           det
                           ⁡
                           A
                           |
                           /
                           
                              
                                 ‖
                                 A
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ‖
                              
                              
                                 P
                              
                              
                                 3
                              
                           
                        . Thus, defining
                           
                              
                                 h
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 :
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                          
                                             
                                                u
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ‖
                                                A
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ‖
                                             
                                             
                                                P
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                          
                                             
                                                u
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ‖
                                                A
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ‖
                                             
                                             
                                                P
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         we obtain
                           
                              
                                 
                                    ∫
                                    T
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       T
                                    
                                 
                                 )
                                 d
                                 τ
                                 =
                                 |
                                 det
                                 ⁡
                                 A
                                 |
                                 
                                    ∫
                                    
                                       
                                          T
                                       
                                       ‾
                                    
                                 
                                 
                                    
                                       h
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       
                                       
                                       
                                          
                                             ‖
                                             A
                                             
                                                
                                                   u
                                                
                                                
                                                   ¯
                                                
                                             
                                             ‖
                                          
                                          
                                             P
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 .
                              
                           
                         The value of this integral can be computed by any standard numerical quadrature. We used a Gauss quadrature formula in our implementation.

The final issue that needs to be addressed is the evaluation of 
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 ⁎
                              
                           
                           p
                        , where p is a homogeneous polynomial of degree n, required in the computation of function h above. Similarly to the spherical case (Alfeld et al., 1996c), one can accomplish this by using the identity
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       ⁎
                                    
                                 
                                 p
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                 
                                 p
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                    
                                 
                                 n
                                 (
                                 n
                                 +
                                 1
                                 )
                                 p
                                 ,
                              
                           
                         which holds for any homogeneous trivariate polynomial p of degree n. This is a direct consequence of definitions (15) and (16). To evaluate the expression 
                           
                              
                                 L
                              
                              
                                 P
                              
                           
                           p
                        , we can view p as a homogeneous trivariate function of the barycentric coordinates 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         w.r.t. 
                           T
                        . By differentiating w.r.t. 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         instead of 
                           x
                           ,
                           y
                           ,
                           z
                        , we obtain
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                 
                                 p
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 p
                                 )
                                 b
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 p
                                 )
                                 b
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       P
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 p
                                 )
                                 b
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           3
                         are the unit coordinate vectors and 
                           
                              
                                 H
                              
                              
                                 b
                              
                           
                           (
                           p
                           )
                         is the Hessian matrix
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 p
                                 )
                                 :
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             p
                                          
                                          
                                             ∂
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                             
                                             ∂
                                             
                                                
                                                   b
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       ,
                                       j
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        
                     

Having discussed homogeneous splines in previous sections, it is natural to also consider rational versions of such functions. These turn out to be special cases of the rational geometric splines (or RAGS) introduced recently in Beccari et al. (2014), capable of representing smooth surfaces of arbitrary topological genus. To obtain RAGS from homogeneous splines, let 
                        s
                        :
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                      be a spline in 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                      and let 
                        w
                        :
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                        →
                        R
                      be a scalar homogeneous spline of degree n and smoothness 
                        
                           
                              C
                           
                           
                              m
                           
                        
                      (i.e., an element of the scalar counterpart of 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                     ). We now consider a rational spline of the form 
                        
                           
                              r
                           
                           
                              H
                           
                        
                        =
                        s
                        /
                        w
                     . In particular, for any triangle 
                        T
                        ∈
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     , denoting by 
                        b
                        (
                        u
                        )
                      the b.c.s of 
                        u
                        ∈
                        T
                      w.r.t. 
                        T
                     , one can write for the restriction 
                        
                           
                              r
                           
                           
                              H
                           
                           
                              T
                           
                        
                      of 
                        
                           
                              r
                           
                           
                              H
                           
                        
                      to 
                        T
                     :
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    H
                                 
                                 
                                    T
                                 
                              
                              (
                              b
                              (
                              u
                              )
                              )
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    u
                                    )
                                 
                                 
                                    ∑
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    u
                                    )
                                 
                              
                              ,
                              
                              u
                              ∈
                              T
                              ,
                           
                        
                      where 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                        ,
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ∈
                        R
                      are the respective Bézier coefficients of 
                        s
                        
                           
                              |
                           
                           
                              T
                           
                        
                      and 
                        w
                        
                           
                              |
                           
                           
                              T
                           
                        
                     , indexed by 
                        T
                        ∈
                        Δ
                     , the triangle associated with 
                        T
                        ∈
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                     , and where the summation is over all 
                        i
                        ,
                        j
                        ,
                        k
                      such that 
                        i
                        +
                        j
                        +
                        k
                        =
                        n
                      (see Fig. 5
                     ). For the above rational function to be well-defined, we will assume that all coefficients 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                     , which will be referred to as the weights, are positive. This is a sufficient condition for the spline w to be positive. Clearly, since both splines 
                        s
                        ,
                        w
                      are 
                        
                           
                              C
                           
                           
                              m
                           
                        
                      continuous, so is 
                        
                           
                              r
                           
                           
                              H
                           
                        
                     . Moreover, 
                        
                           
                              r
                           
                           
                              H
                           
                           
                              T
                           
                        
                      can be parameterized by the (flat) triangle T and, consequently, it can be viewed as an ordinary rational function (i.e. the quotient of two algebraic bivariate polynomials). This can be seen by invoking the homogeneity of the Bernstein polynomials 
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              n
                              ,
                              T
                           
                        
                      as follows (cf. Beccari et al., 2014):
                        
                           (18)
                           
                              
                                 
                                    r
                                 
                                 
                                    H
                                 
                                 
                                    T
                                 
                              
                              (
                              b
                              (
                              u
                              )
                              )
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    v
                                    )
                                 
                                 
                                    ∑
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    v
                                    )
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    v
                                    )
                                 
                                 
                                    ∑
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                    (
                                    v
                                    )
                                 
                              
                              =
                              :
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    b
                                 
                                 
                                    ¯
                                 
                              
                              (
                              v
                              )
                              )
                              ,
                           
                        
                      where 
                        
                           
                              b
                           
                           
                              ¯
                           
                        
                        (
                        v
                        )
                        :
                        =
                        
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           
                              t
                           
                        
                        /
                        (
                        
                           
                              b
                           
                           
                              1
                           
                        
                        +
                        
                           
                              b
                           
                           
                              2
                           
                        
                        +
                        
                           
                              b
                           
                           
                              3
                           
                        
                        )
                      are the affine b.c.s of 
                        v
                        :
                        =
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              1
                           
                        
                        
                           
                              v
                           
                           
                              1
                           
                        
                        +
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              2
                           
                        
                        
                           
                              v
                           
                           
                              2
                           
                        
                        +
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              3
                           
                        
                        
                           
                              v
                           
                           
                              3
                           
                        
                        ∈
                        T
                     , 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              3
                           
                        
                      are the vertices of T, and where 
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              n
                              ,
                              T
                           
                        
                      are ordinary Bernstein polynomials (i.e. functions of affine b.c.s 
                        
                           
                              b
                           
                           
                              ¯
                           
                        
                     ). Note that 
                        
                           
                              b
                           
                           
                              ¯
                           
                        
                        (
                        v
                        )
                      is well defined for all 
                        v
                        ∈
                        T
                      since by our definition of b.c.s, 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        +
                        
                           
                              b
                           
                           
                              2
                           
                        
                        +
                        
                           
                              b
                           
                           
                              3
                           
                        
                        =
                        
                           
                              b
                           
                           
                              1
                           
                        
                        (
                        u
                        )
                        +
                        
                           
                              b
                           
                           
                              2
                           
                        
                        (
                        u
                        )
                        +
                        
                           
                              b
                           
                           
                              3
                           
                        
                        (
                        u
                        )
                        >
                        0
                     , 
                        u
                        ∈
                        T
                     . A consequence of the previous discussion is that 
                        
                           
                              r
                           
                           
                              H
                           
                        
                      can be viewed as a rational (algebraic) spline parameterized by the mesh Δ, namely the rational spline 
                        r
                        :
                        Δ
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                      such that 
                        r
                        
                           
                              |
                           
                           
                              T
                           
                        
                        =
                        
                           
                              r
                           
                           
                              T
                           
                        
                        ,
                        T
                        ∈
                        Δ
                     . Moreover, this spline, viewed as the image of the mapping 
                        r
                        :
                        Δ
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , is a 
                        
                           
                              C
                           
                           
                              m
                           
                        
                      surface. It follows that r is a RAGS spline in the sense of Beccari et al. (2014). However, it should be pointed out that while homogeneous geometry and the resulting homogeneous splines make it possible to construct RAGS, this is by no means the only way. We are currently exploring alternative methods of obtaining such splines.

Offhand, it is not clear whether a smooth positive spline w needed for the above construction even exists. The answer is affirmative, at least in the case where n is even, for then we can set w to be identically equal to the constant function 1. This is because it is well known that the space of homogeneous polynomials of an even degree, restricted to 
                        P
                     , contains constants. As a consequence, in the even-degree case, constants are also elements of 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                     , for all m. Note that this is not true for odd-degree polynomials, unless 
                        P
                        =
                        A
                     . The existence of a smooth positive spline w (with positive weights) for odd-degree splines is not guaranteed in general. However, we expect that such w will typically exist if n is “large enough” relative to m.

Next, we restrict ourselves to the even-degree case and derive a formula for the weights corresponding to the constant spline w. It will be sufficient to consider the case 
                        n
                        =
                        2
                      since for larger even values of n the weights can be determined by degree elevation. More precisely, if 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                        
                      are such that the quadratic polynomial 
                        w
                        =
                        
                           
                              ∑
                           
                           
                              i
                              +
                              j
                              +
                              k
                              =
                              2
                           
                        
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                        
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              2
                           
                        
                      is identically equal to 1, we can obtain the weights corresponding to any other (even) degree n by expanding out the right-hand side of identity 
                        1
                        =
                        
                           
                              w
                           
                           
                              n
                              /
                              2
                           
                        
                     .


                     
                        Proposition 5
                        
                           Let 
                           
                              w
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    +
                                    j
                                    +
                                    k
                                    =
                                    2
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    2
                                 
                              
                            
                           be a quadratic polynomial associated with a triangle 
                           
                              T
                              ⊂
                              P
                            
                           with interior angles 
                           
                              〈
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    3
                                 
                              
                              〉
                           
                           , and suppose that w is identically equal to one. Then
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          200
                                       
                                    
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          020
                                       
                                    
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          002
                                       
                                    
                                    =
                                    1
                                 
                              
                            
                           and
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          011
                                       
                                    
                                    =
                                    
                                       
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          101
                                       
                                    
                                    =
                                    
                                       
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          110
                                       
                                    
                                    =
                                    
                                       
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          cos
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          sin
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The first set of identities follows from the interpolation property of the Bézier coefficients at the vertices of 
                              T
                           . As for the second set, we only prove the formula for 
                              
                                 
                                    w
                                 
                                 
                                    110
                                 
                              
                           , i.e. the Bézier coefficient associated with the edge of 
                              T
                            opposite to the third vertex of 
                              T
                           . Let us assume that a triangle with vertices 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ∈
                              P
                            is a representative of the equivalence class of triangles congruent to 
                              T
                           . To obtain 
                              
                                 
                                    w
                                 
                                 
                                    110
                                 
                              
                           , the following must hold:
                              
                                 (19)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          200
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          200
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    u
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          110
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          110
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    u
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          020
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          020
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          w
                                       
                                       
                                          110
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                    ,
                                 
                              
                            for all 
                              u
                              ∈
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           , where 
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                            are the b.c.s of u w.r.t. 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           . It will be sufficient to select any point u in the interior of edge 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                            (so that 
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ≠
                              0
                           ) and solve for 
                              
                                 
                                    w
                                 
                                 
                                    110
                                 
                              
                           . This will guarantee that equation (19) holds for three distinct values of u, and therefore it must be true for all u, given that constants are in the linear span of 
                              
                                 
                                    B
                                 
                                 
                                    200
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    110
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    020
                                 
                                 
                                    2
                                 
                              
                           . For simplicity, we set 
                              u
                              =
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ∥
                                    
                                    
                                       P
                                    
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           , which gives 
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                              /
                              
                                 
                                    ∥
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    ∥
                                 
                                 
                                    P
                                 
                              
                           , or, by (19),
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          110
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∥
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             ∥
                                          
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    −
                                    1
                                    .
                                 
                              
                            By an elementary calculation in the three separate cases, 
                              P
                              =
                              S
                              ,
                              A
                              ,
                              H
                           , the previous expression simplifies to
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          110
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                cos
                                                ⁡
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                S
                                                ,
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                A
                                                ,
                                             
                                          
                                          
                                             
                                                cosh
                                                ⁡
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                 
                                                P
                                                =
                                                H
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                            is the length of edge 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           . The assertion of the proposition is now a consequence of formula (7) and the analogous formula in the hyperbolic case. □

In the context of rational splines it is customary to express individual patches of r, defined in (18), in the form
                        
                           (20)
                           
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                          ,
                                          T
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where the 
                        
                           
                              d
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        :
                        =
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        /
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      are called the control points of the rational spline. On account of the positivity of the weights, the control points are well defined. These control points are more convenient to work with since by (20), values of 
                        
                           
                              r
                           
                           
                              T
                           
                        
                      are obtained as convex combinations of such control points and hence they are geometrically more meaningful than the 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                     's. In the usual way, the control points give rise to the so-called control net of r. By virtue of the convex hull property and the property that the control net is tangent to the corresponding surface at the vertices of the mesh, the control net mimics the behavior of the corresponding spline surface. In many other ways, working with RAGS is analogous to working with classical bivariate polynomial splines.

The set of rational splines r considered here, corresponding to given fixed 
                        m
                        ,
                        n
                     , and Δ, is not a linear space. However, one can obtain a linear space by fixing the weights 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ,
                        T
                        ∈
                        Δ
                     , i.e. by fixing the denominator of each rational patch 
                        
                           
                              r
                           
                           
                              T
                           
                        
                     . In the setting considered here, in which RAGS are obtained from homogeneous splines, we propose to fix these weights, in the even-degree case, in accordance with Proposition 5 and the degree-elevation idea for degrees larger than two. Thus, one can think of the weights as being determined mainly by the combinatorial structure of the triangulation Δ, i.e. by its topology, whereas the control points 
                        
                           
                              d
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                      can be selected independently of the weights, with the aim to control the geometry of the resulting RAGS surface. Thinking of RAGS as linear spaces is of interest in connection with using such splines as finite elements for purposes of isogeometric analysis, i.e. for approximation as opposed to merely geometric modeling.

The following numerical examples illustrate RAGS surfaces obtained by methods described in previous sections. The surfaces displayed in Figs. 7 and 8 are examples of local and global interpolation by 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin macro-elements for the mesh in Fig. 6
                      (left). In the former case, the required directional derivatives are estimated by the local approach presented in Section 4.1, which guarantees that the RAGS spline has the quadratic reproduction property. For the surface in Fig. 8, the derivatives are computed by requiring that the surface minimize the energy functional (13). As a consequence, the latter approach is global in nature and, as can be reasonably expected, it results in better aesthetic quality. Finally, the example in Fig. 9 is generated by the global interpolation method described in Section 4.2, employing degree-6 patches and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuity conditions. It turns out that each surface is tangent to its respective control net at the vertices of Δ, in the same way as in the case of standard splines.

The illustrations in Figs. 7, 8, and 9
                     
                     
                      depict, from left to right, collections of individual surface patches, the final surface plots, the Gaussian curvature, and the zebra-line plots.

@&#ACKNOWLEDGEMENTS@&#

The first author acknowledges the support from the Italian INdAM National Group for Scientific Calculus (GNCS). She was also partially supported by the NSF grant DMS-1418742, by the Vanderbilt University International Research grant 4-50-999-1505, and by the Marco Polo program of the University of Bologna. The second author was supported by the NSF grant DMS-1418742. We also wish to thank the anonymous referees for many detailed comments that helped us to improve the final manuscript.

@&#REFERENCES@&#

