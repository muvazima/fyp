@&#MAIN-TITLE@&#Two dimensional hashing for visual tracking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In this paper, we propose a 2D-based hashing method which could fast extract the binary feature of samples.


                        
                        
                           
                           We successfully apply the hashing method into tracking model by some details.


                        
                        
                           
                           We design an effective and suitable learning model to update hash functions at every frame.


                        
                        
                           
                           Comparison experiments are done to demonstrate the effectiveness and efficiency of our tracker.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hashing

Tracking

Appearance model

Incremental learning

@&#ABSTRACT@&#


               
               
                  Appearance model is a key part of tracking algorithms. To attain robustness, many complex appearance models are proposed to capture discriminative information of object. However, such models are difficult to maintain accurately and efficiently. In this paper, we observe that hashing techniques can be used to represent object by compact binary code which is efficient for processing. However, during tracking, online updating hash functions is still inefficient with large number of samples. To deal with this bottleneck, a novel hashing method called two dimensional hashing is proposed. In our tracker, samples and templates are hashed to binary matrices, and the hamming distance is used to measure confidence of candidate samples. In addition, the designed incremental learning model is applied to update hash functions for both adapting situation change and saving training time. Experiments on our tracker and other eight state-of-the-art trackers demonstrate that the proposed algorithm is more robust in dealing with various types of scenarios.
               
            

@&#INTRODUCTION@&#

Visual tracking, as a main topic in computer vision, has been widely used in many applications, such as augmented reality, surveillance and object identification. Numerous tracking algorithms have been proposed during past decades [1–19]. Most visual trackers can be divided into four parts: feature extraction, appearance model, sampling method and online learning model. Among these four parts, appearance model is the key element to the success of coping with occlusion, pose change, illumination and other complex scenarios.

How to design an effective and robust appearance model is the main task in most state-of-the-art trackers. These algorithms often construct appearance models by low-level and mid-level cues such as: Raw pixel, Color Histogram, Gradient, Superpixel, Texture, Haar-like, SIFT, SURF, MSER, LBP, HoG, Harris corner and Saliency object [20]. Mei and Ling [1] treat tracking as sparse approximation problem, which uses raw pixel representation. Based on this idea, much works [2–6] focus on using sparse representation method to solve the tracking problem and have achieved good performance. He et al. [7] propose a new histogram extraction method called local sensitive histogram. Based on this histogram technique, illumination invariant feature is proposed, which is proven to be effective to track object. Wang et al. [8,9] propose superpixel tracking algorithm, which uses superpixels to generate local parts’ confidence of object. The tracker is proven to be effective to occlusion and pose change by its unique appearance model. Some other work [10,11] also use superpixel feature to construct robust appearance model for visual tracking and achieve well tracking results in experiments. Chen et al. [12] integrate several types of features and construct a robust appearance model. The model is combined with complex cells by adaptive weights and appears to be effective to deal with occlusion, pose change and illumination. Besides these trackers, there are also many other algorithms [13–15,17–19], which use the artificial feature or model as the base of tracking algorithm.

An alternative method for constructing appearance model is data dependent technique. Given sufficient descriptor or raw pixel of samples, the data dependent method aims to find a map from high dimensional space to low dimensional space. The most representative literature based on this method is IVT [21,22]. Given the samples at first frame, the tracker obtains a low dimensional representation by PCA, and candidates obtained from coming frames would be mapped into low dimensional feature space to get compact representation. By the support of theory, IVT achieves well performance in experiments. However, the tracker does not take semantic information into consideration and the mapping functions have limited discriminability, which may cause drift or loss of target under complex cases. Compressive tracking [23,24] is another work that uses dimensionality reduction manner. It uses compressive method to reduce the dimension of original feature vector. Although the tracker owns the ability to deal with some tracking situations, its performance is instable because of the random process in mapping method. Recently data-dependent hashing approach becomes a popular method in large-scale vision problems. It is shown to be a good method to expedite similarity computation. This property makes it possible to apply the hashing method to tracking algorithms. Li et al. [25] propose learning compact binary code for visual tracking. The algorithm always keeps a sample buffer and updates the hash functions every ten frames. Although the tracker obtains effective tracking results in experiments, its training stage is not an efficient manner to update hash functions.

To better apply hashing method in tracking and provide an efficient updating strategy, we proposed two dimensional hashing method for visual tracking. Inspired by 2DPCA [26] and 2DLDA [27], the proposed two dimensional hashing method is based on 2D sample matrices (object image) rather than 1D feature vectors. The algorithm does not need to vectorize the sample matrices, and then the dimension of covariance matrix is reduced dramatically, which is the key element for computational efficiency. Given training samples at first frame, the hash functions are initialized by the proposed hash method. Then we can formulate the binary codes of candidates at coming frame. Confidences of candidates are calculated by their hamming distances to the templates, and the highest one is chosen as target at current frame. For adapting to the situation changing, hash functions are updated by the designed incremental learning model during tracking. Due to this learning model, our algorithm only needs to store few matrices. Experimental results show that the approach achieves good performance in evaluation metrics CLE, SR and FPS, which demonstrate the effectiveness and efficiency of our tracker, and outperforms the-state-of-art tracking algorithms.

The rest of our paper is organized as follows: Section 2 introduces some related literatures. Section 3 presents the details of two dimensional hashing method. Section 4 shows the framework of tracking by two dimensional hashing. Experimental results are analyzed detailedly in Section 5. And final conclusion is drawn in Section 6.

@&#RELATED WORK@&#

Recently, hashing techniques attract great attention in computer vision and pattern recognition due to its efficiency and accuracy in data organization. Hashing method aims to map the original high-dimensional data into a compact binary code, while preserving structure of original data. After mapping to binary code, the pairwise comparison could be calculated efficiently. Hashing techniques can be categorized to data-independent methods [28–32] and data-dependent methods [33–40,25]. One of the most well-know data-independent hashing method is Local Sensitive Hashing (LSH) [28], which generates hash code by random projections. Based on LSH’s idea, many methods [29–32] belonging to the LSH family have been proposed and have achieved good performance in computer vision and pattern recognition applications. Compared to data-independent techniques, more recent works have focused on data-dependent techniques with the goal of capturing more compact binary codes. They learn hash functions by optimizing objective function, which preserves samples similarity in Hamming space. However, directly solving optimization problem is very difficult. Thus relaxation technique is often used to simplify the optimization. Spectral hashing [33] uses spectral relaxation method to solve this problem and has proved successful. Liu et al. [34] propose hashing with graph, which utilizes manifold structure to generate binary codes of data. The widely developing deep learning techniques are also applied into hashing techniques [41–43]. They use common framework (RBM and neural network) of deep learning to learn the binary code of data, which achieves good performance in computer vision applications. Recently LDA Hashing [35] and Semi-supervised Hashing [36] are proposed. They both provide methods to learn hash functions with labeled train samples. With the success of hashing methods, many applications [37,44] begin to use hashing technique to solve the real problems.

Incremental learning is widely used to online learning applications, which is suit for objecting tracking. Many incremental learning works [27,45–49] have been proposed and applied successfully. Pang et al. [46] propose an Incremental LDA for online face recognition. They address the method of updating the scatter matrices with incremental manner, but the updating scheme is still time and memory consuming. To solve speed limitation, Kim et al. [47] use sufficient spanning set approximation to address problem of incremental LDA. The method significantly improves the calculation speed and provides the similar results with batch LDA. Based on 2DLDA, Wang et al. [48] propose incremental 2DLDA for face recognition, which achieves fast speed and effective performance. And the idea is also applied to the tracking algorithm by Li et al. [45]. Zhao and Yuen [27] improve the LDA/GSVD algorithm and fast SVD updating technique by the proposed incremental supervised learning method called GSVD–ILDA which can incrementally learn an adaptive subspace instead of recomputing the LDA/GSVD. Lu et al. [49] extend the CLDA algorithm to online manner by incremental method and apply it to face recognition successfully.

In our work, we aim to apply data-dependent hashing technique into object tracking, which is challenge. The hashing methods mentioned above are designed for off-line training application which is not suit for online training. If we use batch manner to apply these hash functions directly in tracking, it will take several seconds per-frame. Even if it may achieve good performance, the processing time could not be accepted. So in order to solve this problem, we use incremental learning model to update our hashing functions at each frame. However, because of the demands of hashing method, the covariance matrices are not same as other incremental LDA algorithms such as [45], which makes original incremental method cannot be applied directly. Fortunately, by the proof of Theorem 1, we could update the covariance matrices incrementally and improve the tracking speed. Overall, we list our main contributions of our tracker as below:
                        
                           1.
                           In this paper, we propose a 2D-based hashing method which could fast extract the binary feature of samples.

We successfully apply the hashing method into tracking model by some details.

We design an effective and suitable learning model to update hash functions at every frame.

Comparison experiments are done to demonstrate the effectiveness and efficiency of our tracker.

In this section, we introduce the details of our hashing method. Given training image samples 
                        
                           X
                           =
                           {
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           }
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                           
                           A
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 D
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                        
                      is the label of i-th sample, which represents positive (foreground) or negative (background). In these samples, pairs of them are categorized into two sets: neighbor pair set 
                        
                           NE
                        
                      and non-neighbor pair set 
                        
                           NO
                        
                     . A pair of 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NE
                        
                      is represented as neighbor pair (both positive or both negative). Similarly, 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NO
                        
                      is non-neighbor pair (one of them is positive and the other is negative). 
                        
                           
                              
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                      are centralized samples of 
                        
                           X
                        
                     . So the proposed hashing method aims to map data 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        
                      to hamming space to obtain binary representation. Suppose the number of projection directions to be K, that is to say K hash functions need to be learned by training samples. Follow general idea, our hash function is defined as
                        
                           (1)
                           
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              sgn
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                        
                      is the mean of projected data. Since training data 
                        
                           
                              
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                      is zero mean, we can get 
                        
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                           =
                           -
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 w
                              
                              
                                 k
                              
                              
                                 ⊤
                              
                           
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                           /
                           n
                           =
                           0
                        
                     . 
                        
                           sgn
                           (
                           ·
                           )
                        
                      is element-wise sign function. The hash functions make binary code be −1 or 1. We can get common binary bit by
                        
                           (2)
                           
                              
                                 
                                    z
                                 
                                 
                                    ki
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       1
                                       +
                                       sgn
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

One thing to keep in mind here is that 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                        
                      is a matrix and 
                        
                           
                              
                                 w
                              
                              
                                 k
                              
                              
                                 ⊤
                              
                           
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 1
                              
                           
                        
                      is a vector, so the 
                        
                           
                              
                                 z
                              
                              
                                 ki
                              
                           
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 1
                              
                           
                        
                      is a binary code vector which represents the binary code of 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                        
                      in direction 
                        
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                        
                     . Thus the binary code of 
                     
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        
                      
                     is a matrix 
                     
                        
                           
                              
                                 z
                              
                              
                                 i
                              
                           
                           =
                           [
                           
                              
                                 z
                              
                              
                                 1
                                 i
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 2
                                 i
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 z
                              
                              
                                 Ki
                              
                           
                           ]
                        
                      
                     rather than a vector. Let 
                        
                           W
                           =
                           [
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 K
                              
                           
                           ]
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 K
                              
                           
                        
                      be a set of K projections. Our goal is to learn a 
                        
                           W
                        
                      that gives same bits for pair 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NE
                        
                      and different bits for pair 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NO
                        
                      as much as possible. An objective function reaching this goal on training samples can be defined as:
                        
                           (3)
                           
                              J
                              (
                              W
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             |
                                             NE
                                             |
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                             ∈
                                             NE
                                          
                                       
                                       
                                          
                                             
                                                sgn
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                sgn
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             |
                                             NO
                                             |
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                             ∈
                                             NO
                                          
                                       
                                       
                                          
                                             
                                                sgn
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                sgn
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           〈
                           ·
                           ,
                           ·
                           〉
                        
                      is inner product operator and 
                        
                           |
                           ·
                           |
                        
                      means the cardinality of set. However, the objective function 
                        
                           J
                           (
                           W
                           )
                        
                      is hard to solve, because it is not differentiable. To overcome this limitation, we apply relaxation to Eq. (3). A simple way is to replace the sign function with its signed magnitude. The new objective function can be derived as
                        
                           (4)
                           
                              J
                              (
                              W
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             |
                                             NE
                                             |
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                             ∈
                                             NE
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             c
                                             ⊤
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             j
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             |
                                             NO
                                             |
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                                
                                                   c
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                             ∈
                                             NO
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             c
                                             ⊤
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             j
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           
                              
                                 A
                              
                              
                                 ‾
                              
                           
                        
                      be the mean of 
                        
                           
                              
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                     . Then the matrix 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                                 ⊤
                              
                           
                           
                              
                                 A
                              
                              
                                 j
                              
                              
                                 c
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       A
                                    
                                    
                                       ‾
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                           (
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           -
                           
                              
                                 A
                              
                              
                                 ‾
                              
                           
                           )
                        
                     . By taking this formulation into Eq. (4), we can get
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          J
                                          (
                                          W
                                          )
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         |
                                                         NE
                                                         |
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         NE
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         |
                                                         NO
                                                         |
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         NO
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  |
                                                                  NE
                                                                  |
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  )
                                                                  ∈
                                                                  NE
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  |
                                                                  NO
                                                                  |
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  )
                                                                  ∈
                                                                  NO
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We define 
                        
                           
                              
                                 S
                              
                              
                                 NE
                              
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 NO
                              
                           
                        
                      as covariance matrices for pairs 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NE
                        
                      and pairs 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NO
                        
                     . These two covariance matrices are denoted by:
                        
                           (6)
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    NE
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    ‾
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    |
                                    NE
                                    |
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       ∈
                                       NE
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    ‾
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    NO
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    ‾
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    |
                                    NO
                                    |
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       ∈
                                       NO
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    ‾
                                 
                              
                              )
                           
                        
                     
                  

Here we should notice that if 
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           NE
                        
                      then 
                        
                           (
                           
                              
                                 A
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           )
                           ∈
                           NE
                        
                     , this trick ensures that the matrix 
                        
                           
                              
                                 S
                              
                              
                                 NE
                              
                           
                        
                      is symmetric. Similarly, 
                        
                           
                              
                                 S
                              
                              
                                 NO
                              
                           
                        
                      is symmetric too. So Eq. (5) can be rewritten as
                        
                           (8)
                           
                              J
                              (
                              W
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             NE
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             NO
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Assume 
                        
                           |
                           |
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                           |
                           |
                           =
                           1
                        
                      for any k, the above function can be expressed as matrix form:
                        
                           (9)
                           
                              J
                              (
                              W
                              )
                              =
                              tr
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             NE
                                          
                                       
                                       -
                                       
                                          
                                             S
                                          
                                          
                                             NO
                                          
                                       
                                       )
                                       W
                                    
                                 
                              
                           
                        
                     
                  

The optimal projection directions 
                        
                           W
                        
                      is obtained by
                        
                           (10)
                           
                              
                                 
                                    W
                                 
                                 
                                    ∗
                                 
                              
                              =
                              arg
                              
                                 
                                    
                                       max
                                    
                                    
                                       W
                                    
                                 
                              
                              
                              J
                              (
                              W
                              )
                              
                              s
                              .
                              t
                              .
                              
                              
                                 
                                    W
                                 
                                 
                                    ⊤
                                 
                              
                              W
                              =
                              I
                           
                        
                     
                  

Now, achieving optimal 
                        
                           W
                        
                      becomes a typical eigen-problem, which can be easily solved by doing eigen-decomposition to matrix 
                        
                           
                              
                                 S
                              
                              
                                 NE
                              
                           
                           -
                           
                              
                                 S
                              
                              
                                 NO
                              
                           
                        
                     :
                        
                           (11)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   W
                                                
                                             
                                          
                                          
                                          J
                                          (
                                          W
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ∗
                                             
                                          
                                          =
                                          [
                                          
                                             
                                                e
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                L
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           >
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           >
                           ⋯
                           >
                           
                              
                                 λ
                              
                              
                                 L
                              
                           
                        
                      are top eigenvalues of matrix 
                        
                           
                              
                                 S
                              
                              
                                 NE
                              
                           
                           -
                           
                              
                                 S
                              
                              
                                 NO
                              
                           
                        
                     , and 
                        
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 e
                              
                              
                                 L
                              
                           
                        
                      are corresponding eigenvectors. Finally, the binary code of 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        
                      is 
                        
                           sgn
                           (
                           
                              
                                 W
                              
                              
                                 ⊤
                              
                           
                           
                              
                                 A
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                           )
                           =
                           
                              
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       Ki
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 K
                              
                           
                        
                      and it should be noted that the proposed hash code for image sample is a matrix rather than vector. Hashing methods always vectorize the original object matrix or generate a high dimensional feature vector to represent object, which makes the covariance matrix to be high-dimensional. However, the covariance matrices (
                        
                           
                              
                                 S
                              
                              
                                 NE
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 NO
                              
                           
                        
                     ) in our method can be calculated directly by matrix 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 IR
                              
                              
                                 D
                                 ×
                                 D
                              
                           
                        
                      (similar to 2DLDA [27]) and the dimension of them are reduced significantly. Owing to this property, it makes the speed of learning binary code reach the time requirement of object tracking.

This section introduces the framework of our tracking algorithm, the basic flow is shown in Fig. 1
                     . Three main parts (appearance model, tracking model and update model) would be described later.

Given object 
                           
                              O
                           
                         and current frame 
                           
                              F
                           
                        , tracking task is to locate the object 
                           
                              O
                           
                         in 
                           
                              F
                           
                        . 
                           
                              O
                           
                         is represented by positive templates 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 
                                    s
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                         and background 
                           
                              B
                           
                         is represented by negative templates 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    s
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          -
                                       
                                    
                                 
                              
                           
                        . We wish to find the scale and position of a candidate 
                           
                              C
                           
                         in 
                           
                              F
                           
                         which is most similar to positive templates and most dissimilar to negative templates. Similarity measurement between candidates and templates is defined by hamming distance:
                           
                              (12)
                              
                                 d
                                 (
                                 C
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 |
                                 |
                                 h
                                 (
                                 C
                                 )
                                 -
                                 h
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       H
                                    
                                 
                              
                           
                        where 
                           
                              |
                              |
                              ·
                              |
                              
                                 
                                    |
                                 
                                 
                                    H
                                 
                              
                           
                         is hamming distance in hamming space and 
                           
                              h
                              (
                              ·
                              )
                           
                         denotes hash functions for samples. As Section 3 defined, the binary code of a candidate is a binary code matrix, and hamming distance between matrices can be measured by bit-wise XOR operation, which is similar to vectors. The confidence (described below) of each candidate is calculated based on Eq. (12).

However, mapping candidate rectangle directly into binary code cannot give best description to target. To the best of our understanding of tracking problem, structure information of target is discriminative for distinguishing target from background. In order to describe structure better, we cut rectangle of target into several patches (
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           
                        ), as Fig.2
                         shows. Each patch 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is mapped by corresponding hash functions 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              (
                              ·
                              )
                              =
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    i
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    iK
                                 
                              
                              )
                           
                        . Then similarity measurement Eq. (12) is replaced by:
                           
                              (13)
                              
                                 d
                                 (
                                 C
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       C
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 )
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       H
                                    
                                 
                              
                           
                        where n is the number of patches, 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    C
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                           
                         represent i-th patch of candidate 
                           
                              C
                           
                         and template 
                           
                              
                                 
                                    T
                                 
                                 
                                    s
                                 
                              
                           
                        . Finally, we can define the confidence of j-th candidate 
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                           
                         as the average distance to all templates,
                           
                              (14)
                              
                                 Con
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The proposed appearance model resizes candidates and training samples into same size (
                           
                              32
                              ×
                              32
                           
                         in experiments), which could handle different scale rectangles. And a predefined patch partition category (discussed in Section 5.2.2) is applied to all candidates or samples from beginning to end. The patches of target are processed respectively, and i-th hash functions 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              (
                              ·
                              )
                              =
                              (
                              
                                 
                                    h
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    i
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    iK
                                 
                              
                              )
                           
                         must be trained by the i-th patch of samples. The property encodes the structure of target into appearance model and makes our tracker handle many situations successfully.

The proposed tracking approach follows the Bayesian framework. Given a sequence, state 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             v
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                           
                         is represented by horizontal position, vertical position and scale. The 
                           
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                              
                           
                         represents observation at frame t. The posterior of the state at given time t is computed by
                           
                              (15)
                              
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                       :
                                       t
                                    
                                 
                                 )
                                 =
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                       :
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       dX
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Y
                                 
                                 
                                    1
                                    :
                                    t
                                 
                              
                           
                         is all the observation from the first frame to current frame. It is important to construct an effective observation model 
                           
                              p
                              (
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         as demonstrated by numerous tracking algorithms. In our formulation,
                           
                              (16)
                              
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∝
                                 Con
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              Con
                              (
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the confidence of state 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                           
                         defined in Section 4.1. Besides the observation model, motion model is another one that we need to determine. Here the motion model 
                           
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    X
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                         in Eq. (15) is assumed to be gaussian distribution for both location and scale:
                           
                              (17)
                              
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 ;
                                 
                                    
                                       X
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 Φ
                                 )
                              
                           
                        where Φ denotes the diagonal covariance matrix and the elements (
                           
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    s
                                 
                              
                           
                        ) of the matrix are standard deviations of X axis location, Y axis location and scale. 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         represents previous target’s state (
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        ), which are next frames mean values for gaussian model. These elements decide how the tracker accounts for the change of location and scale. After determining the observation model and motion model, the estimate of the target 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         at current frame can be obtained by the MAP estimate over M the samples.
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 |
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                       :
                                       t
                                    
                                 
                                 )
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                        where 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         denotes the i-th sample’s state.

Training samples obtained from first frame are always insufficient for handling all frames of a sequence. Thus we need to update hash functions in time. A naive strategy is to store positive and negative samples in a buffer and use them to retrain the hash functions at each frame. It is obviously a time-consuming strategy. Here in our method, we use incremental learning model to update covariance matrices 
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                              
                           
                         defined in Section 3. These two covariance matrices measure the correlation between pairwise data, which are different with the common covariance matrix in LDA and its follow-up work. Since every patch is processed respectively, we only take one patch as an example to introduce the update model.

Assume 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         are samples extracted at previous frames and current frame samples are 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    n
                                    +
                                    1
                                 
                                 
                                    n
                                    +
                                    m
                                 
                              
                           
                        . We define 
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                           
                         are covariance matrices for pair dataset 
                           
                              
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                           
                         and 
                           
                              
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                           
                         obtained from 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                        , while 
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                                 
                                    △
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                                 
                                    △
                                 
                              
                           
                         are covariance matrices for pair dataset 
                           
                              
                                 
                                    NE
                                 
                                 
                                    ▵
                                 
                              
                           
                         and 
                           
                              
                                 
                                    NO
                                 
                                 
                                    ▵
                                 
                              
                           
                         extracted from 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    n
                                    +
                                    1
                                 
                                 
                                    n
                                    +
                                    m
                                 
                              
                           
                        . Similarly, 
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                                 
                                    new
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                                 
                                    new
                                 
                              
                           
                         are covariance matrices for 
                           
                              
                                 
                                    NE
                                 
                                 
                                    new
                                 
                              
                              =
                              {
                              
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                              |
                              
                                 
                                    NE
                                 
                                 
                                    ▵
                                 
                              
                              }
                           
                         and 
                           
                              
                                 
                                    NO
                                 
                                 
                                    new
                                 
                              
                              =
                              {
                              
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                              |
                              
                                 
                                    NO
                                 
                                 
                                    ▵
                                 
                              
                              }
                           
                        . 
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    o
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    △
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    new
                                 
                              
                           
                         are means of old samples 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                        , new coming 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    n
                                    +
                                    1
                                 
                                 
                                    n
                                    +
                                    m
                                 
                              
                           
                         and whole samples 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                    +
                                    m
                                 
                              
                           
                        . Our goal is to get 
                           
                              tr
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             NE
                                          
                                          
                                             new
                                          
                                       
                                       -
                                       
                                          
                                             S
                                          
                                          
                                             NO
                                          
                                          
                                             new
                                          
                                       
                                       )
                                       W
                                    
                                 
                              
                           
                         by new coming training samples (refresh Eq. (9)). By simple algebraic steps, we could divide objective functions into two parts and update them separately:
                           
                              (19)
                              
                                 J
                                 (
                                 W
                                 )
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                NE
                                             
                                             
                                                new
                                             
                                          
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                NO
                                             
                                             
                                                new
                                             
                                          
                                          )
                                          W
                                       
                                    
                                 
                                 =
                                 tr
                                 {
                                 
                                    
                                       W
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       NE
                                    
                                    
                                       new
                                    
                                 
                                 W
                                 }
                                 -
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                NO
                                             
                                             
                                                new
                                             
                                          
                                          W
                                       
                                    
                                 
                              
                           
                        
                        
                           Theorem 1
                           
                              Let 
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          n
                                       
                                    
                                    }
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          q
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          n
                                          +
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          n
                                          +
                                          m
                                       
                                    
                                    }
                                 
                              
                              , and 
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          X
                                       
                                       
                                          q
                                       
                                    
                                    }
                                 
                              
                              . The 
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                 
                               
                              are means of 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                 
                               
                              which are pair dataset extracted from 
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          p
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              , and 
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                 
                               
                              is mean of 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    }
                                 
                              
                              . 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                 
                               
                              are covariance matrices defined in Section 
                              3 
                              for 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          w
                                       
                                    
                                 
                               
                              respectively: 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                p
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          q
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                q
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                q
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    )
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                w
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 
                              
                              . Then:
                              
                                 
                                    
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             w
                                          
                                       
                                       W
                                       )
                                       ≈
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               |
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     q
                                                                  
                                                               
                                                               |
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     q
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Theorem 1By definition we have:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      w
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      p
                                                   
                                                
                                                +
                                                |
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      p
                                                   
                                                
                                                |
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                                +
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      q
                                                   
                                                
                                                +
                                                |
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      q
                                                   
                                                
                                                |
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                +
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      q
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           

Here:
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  w
                                                               
                                                            
                                                            )
                                                            +
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        w
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  q
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  q
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  w
                                                               
                                                            
                                                            )
                                                            +
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ‾
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        w
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  q
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Let 
                                 
                                    
                                    
                                       
                                          S
                                       
                                       
                                          pq
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          q
                                       
                                    
                                    +
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    |
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                q
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 
                              . We take trace of both side of above function, then:
                                 
                                    
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             w
                                          
                                       
                                       W
                                       )
                                       =
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             pq
                                          
                                       
                                       W
                                       )
                                       +
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             p
                                          
                                       
                                       W
                                       )
                                       +
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             q
                                          
                                       
                                       W
                                       )
                                    
                                 
                              
                           

By definition:
                                 
                                    
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                W
                                             
                                          
                                       
                                       =
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                {
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      w
                                                   
                                                
                                                )
                                                }
                                                W
                                             
                                          
                                       
                                       +
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                {
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                }
                                                W
                                             
                                          
                                       
                                       =
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                2
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                           

Similarly,
                                 
                                    
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             q
                                          
                                       
                                       W
                                       )
                                       =
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                2
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                   
                                                
                                                )
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                           

In our tracking applications, there are two different pair-sets 
                                 
                                    E
                                 
                               (same-class) and 
                                 
                                    O
                                 
                               (different-class) in 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                 
                               which are defined in Section 3 (Fig. 3
                               shows the pair-set). Without loss of generality, we take 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          p
                                       
                                    
                                 
                               as an example to discuss. By definition, 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                               contains 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          E
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          O
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              . Then we should discuss that whether 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          E
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          O
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                               are zero or not. Assume the number of negative samples is 
                                 
                                    N
                                 
                               and number of positive samples is 
                                 
                                    P
                                 
                              . So the cardinality of neighbor pair 
                                 
                                    |
                                    E
                                    |
                                    =
                                    N
                                    (
                                    N
                                    -
                                    1
                                    )
                                    +
                                    P
                                    (
                                    P
                                    -
                                    1
                                    )
                                 
                               and the cardinality of non-neighbor pair 
                                 
                                    |
                                    O
                                    |
                                    =
                                    2
                                    NP
                                 
                              . In pair-set 
                                 
                                    E
                                 
                              , it contains 
                                 
                                    2
                                    P
                                    (
                                    P
                                    -
                                    1
                                    )
                                 
                               positive samples and 
                                 
                                    2
                                    N
                                    (
                                    N
                                    -
                                    1
                                    )
                                 
                               negative samples. Similarly, in pair-set 
                                 
                                    O
                                 
                              , it contains 
                                 
                                    NP
                                 
                               positive samples and 
                                 
                                    NP
                                 
                               negative samples. We list all possible cases below:
                                 
                                    1.
                                    
                                       
                                          
                                             N
                                             =
                                             P
                                          
                                        and 
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         P
                                                         +
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   P
                                                   +
                                                   N
                                                
                                             
                                          
                                        is mean of all samples. Under this situation, we could do some simple transforms:
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     )
                                                                     ∈
                                                                     E
                                                                  
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            2
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     )
                                                                     ∈
                                                                     E
                                                                  
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            -
                                                            2
                                                            (
                                                            P
                                                            (
                                                            P
                                                            -
                                                            1
                                                            )
                                                            +
                                                            N
                                                            (
                                                            N
                                                            -
                                                            1
                                                            )
                                                            )
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            2
                                                            (
                                                            P
                                                            -
                                                            1
                                                            )
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     P
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            2
                                                            (
                                                            N
                                                            -
                                                            1
                                                            )
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            2
                                                            (
                                                            P
                                                            (
                                                            P
                                                            -
                                                            1
                                                            )
                                                            +
                                                            N
                                                            (
                                                            N
                                                            -
                                                            1
                                                            )
                                                            )
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     )
                                                                     ∈
                                                                     O
                                                                  
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            2
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     )
                                                                     ∈
                                                                     O
                                                                  
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            -
                                                            4
                                                            NP
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            2
                                                            N
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     P
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            2
                                                            P
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            4
                                                            NP
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       Because 
                                          
                                             N
                                             =
                                             P
                                          
                                       , we can easily get 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             )
                                             =
                                             0
                                          
                                        and 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∈
                                                   O
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             )
                                             =
                                             0
                                          
                                       .


                                       
                                          
                                             N
                                             
                                             ≠
                                             
                                             P
                                          
                                        and 
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       , where 
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                          
                                        is the mean of positive samples and 
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                          
                                        is the mean of negative samples. In this case, we substitute the conditions into above equations, and only 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ∈
                                                   O
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             )
                                             =
                                             0
                                          
                                        is correct.


                                       
                                          
                                             N
                                             
                                             ≠
                                             
                                             P
                                          
                                        and 
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                        is the mean of all samples. In this case, none of them meet the criteria.

By above analysis, we can make a conclusion that only the number of positive samples and negative samples be equal could make 
                                 
                                    tr
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                    
                                    W
                                    )
                                    +
                                    tr
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          q
                                       
                                    
                                    W
                                    )
                                 
                               have no or little impact on the 
                                 
                                    tr
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    W
                                    )
                                 
                              . Fortunately, we could easily handle this problem by repeatedly sampling the less one in real applications. Then:
                                 
                                    
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             w
                                          
                                       
                                       W
                                       )
                                       ≈
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             pq
                                          
                                       
                                       W
                                       )
                                       =
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         +
                                                         |
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               w
                                                            
                                                         
                                                         )
                                                         +
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         +
                                                         |
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     q
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               w
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                           

According to the definition, 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                w
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                q
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                w
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                q
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                w
                                             
                                          
                                          |
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          w
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                w
                                             
                                          
                                          |
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              . By substituting them to above formulation, we could get final conclusion in theorem:
                                 
                                    
                                       tr
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             w
                                          
                                       
                                       W
                                       )
                                       ≈
                                       tr
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               |
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     q
                                                                  
                                                               
                                                               |
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     q
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           A
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               q
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                              □

By the Theorem 1, the trace of new covariance matrices for positive pairs and negative pairs can be calculated as follows:
                           
                              (20)
                              
                                 tr
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       NE
                                    
                                    
                                       new
                                    
                                 
                                 W
                                 )
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               NE
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         +
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               △
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               NE
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         +
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               △
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         |
                                                         
                                                            
                                                               NE
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         |
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               |
                                                               
                                                                  
                                                                     NE
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               |
                                                               +
                                                               |
                                                               
                                                                  
                                                                     NE
                                                                  
                                                                  
                                                                     △
                                                                  
                                                               
                                                               |
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          W
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 tr
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       NO
                                    
                                    
                                       new
                                    
                                 
                                 W
                                 )
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               NO
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         +
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               △
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               NO
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         +
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               △
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         |
                                                         |
                                                         
                                                            
                                                               NO
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         |
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               |
                                                               
                                                                  
                                                                     NO
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               |
                                                               +
                                                               |
                                                               
                                                                  
                                                                     NO
                                                                  
                                                                  
                                                                     △
                                                                  
                                                               
                                                               |
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          W
                                       
                                    
                                 
                              
                           
                        
                     

In practical implementation, 
                           
                              |
                              
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                              |
                              ,
                              |
                              
                                 
                                    NE
                                 
                                 
                                    ▵
                                 
                              
                              |
                              ,
                              |
                              
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                              |
                           
                         and 
                           
                              |
                              
                                 
                                    NO
                                 
                                 
                                    ▵
                                 
                              
                              |
                           
                         are constant at each frame, so we can use learning rate 
                           
                              
                                 
                                    λ
                                 
                                 
                                    NE
                                 
                              
                           
                         and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    NO
                                 
                              
                           
                         to represent 
                           
                              |
                              
                                 
                                    NE
                                 
                                 
                                    ▵
                                 
                              
                              |
                              /
                              (
                              |
                              
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                              |
                              +
                              |
                              
                                 
                                    NE
                                 
                                 
                                    ▵
                                 
                              
                              |
                              )
                           
                         and 
                           
                              |
                              
                                 
                                    NO
                                 
                                 
                                    ▵
                                 
                              
                              |
                              /
                              (
                              |
                              
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                              |
                              +
                              |
                              
                                 
                                    NO
                                 
                                 
                                    ▵
                                 
                              
                              |
                              )
                           
                        . Then:
                           
                              (22)
                              
                                 tr
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       NE
                                    
                                    
                                       new
                                    
                                 
                                 W
                                 )
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NE
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         NE
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NE
                                                      
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         NE
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NE
                                                      
                                                   
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NE
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          W
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 tr
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       NO
                                    
                                    
                                       new
                                    
                                 
                                 W
                                 )
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NO
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         NO
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NO
                                                      
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         NO
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NO
                                                      
                                                   
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         NO
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ‾
                                                                  
                                                               
                                                            
                                                            
                                                               ▵
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         ▵
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          W
                                       
                                    
                                 
                              
                           
                        
                     

And the mean of 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                    +
                                    m
                                 
                              
                           
                         is updated by:
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 (
                                 1
                                 -
                                 λ
                                 )
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       ▵
                                    
                                 
                              
                           
                        Here 
                           
                              λ
                              =
                              (
                              
                                 
                                    λ
                                 
                                 
                                    NE
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    NO
                                 
                              
                              )
                              /
                              2
                           
                         (In experiments, we set 
                           
                              
                                 
                                    λ
                                 
                                 
                                    NE
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    NO
                                 
                              
                           
                        , so 
                           
                              λ
                              =
                              
                                 
                                    λ
                                 
                                 
                                    NE
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    NO
                                 
                              
                           
                        ). By Eqs. (19), (22) and (23) the objective function 
                           
                              J
                              (
                              W
                              )
                           
                         can be updated in an efficient way, and then the new hash functions can be obtained by Eq. (11). From the incremental learning model in this section, we can see that the algorithm only need to store 
                           
                              
                                 
                                    S
                                 
                                 
                                    NE
                                 
                                 
                                    o
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    NO
                                 
                                 
                                    o
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    o
                                 
                              
                           
                        , which is time- and space- saving. For every patch’s hash functions, the incremental learning is processed respectively. Algorithm 1 shows pseudo-code of our incremental learning model.
                           Algorithm 1
                           Incremental Learning Model. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: Covariance matrices 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NE
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NO
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                , Mean value 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                , New coming dataset 
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            n
                                                            +
                                                            1
                                                         
                                                         
                                                            n
                                                            +
                                                            m
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                Output: new project directions 
                                                   
                                                      W
                                                      =
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                   
                                                 for each patch;
                                          
                                          
                                             1: Calculate mean value 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            n
                                                            +
                                                            1
                                                         
                                                         
                                                            n
                                                            +
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      /
                                                      m
                                                   
                                                .
                                          
                                          
                                             2: Get pair dataset 
                                                   
                                                      
                                                         
                                                            NO
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            NE
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                   
                                                 from 
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            n
                                                            +
                                                            1
                                                         
                                                         
                                                            n
                                                            +
                                                            m
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             3: for 
                                                
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                 to n 
                                                do
                                             
                                          
                                          
                                             4: Calculate 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NE
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  NE
                                                               
                                                               
                                                                  ▵
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  ▵
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            ▵
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      )
                                                      /
                                                      |
                                                      
                                                         
                                                            NE
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                      |
                                                   
                                                ;
                                          
                                          
                                             5: Calculate 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NO
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  NO
                                                               
                                                               
                                                                  ▵
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  ▵
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            ▵
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      )
                                                      /
                                                      |
                                                      
                                                         
                                                            NO
                                                         
                                                         
                                                            ▵
                                                         
                                                      
                                                      |
                                                   
                                                ;
                                          
                                          
                                             6: Calculate 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NE
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NO
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                   
                                                , and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                   
                                                 by Eqs. (21)–(23);
                                          
                                          
                                             7: Generate 
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 for p-th patch with 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NE
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            NO
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                   
                                                 by Eq. (11);
                                          
                                          
                                             8: end for
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTS@&#

In Section 5, we compare our tracker 2DHT (Two Dimensional Hashing for Visual Tracking) with eight state-of-the-art trackers on ten challenging sequences. We use the source code published by authors of these trackers. These eight trackers are compressive tracker CT [23,24], IVT method [21,22], complex cell tracker CCT [12], L1APG method [2], local sensitive histogram tracker LSHT [7], LSST tracker [6], multiple instance learning tracker MIL [14] and superpixel tracking SPT [8,9]. Some experimental screenshots are shown in Figs. 8–10. The tested sequences are provided by the paper [50]. To better analyze our tracker’s performance, we design comparison experiments with different settings in Section 5.2.2. Our 2DHT is implemented by C++ and opencv without any optimization, and the tracker can run at about ten frames per second on Intel Core 2 Duo E7500 CPU with 2GB RAM. Two most popular metrics are used to evaluate the proposed tracker and other eight state-of-the-art trackers. The first one is the success rate (SR), which is defined as the proportion between successful tracking frames and total number of sequence frames, successful tracking is defined as:
                           
                              
                                 SUC
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         area
                                                         (
                                                         
                                                            
                                                               ROI
                                                            
                                                            
                                                               gt
                                                            
                                                         
                                                         
                                                            ⋂
                                                         
                                                         
                                                            
                                                               ROI
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         area
                                                         (
                                                         
                                                            
                                                               ROI
                                                            
                                                            
                                                               gt
                                                            
                                                         
                                                         
                                                            ⋃
                                                         
                                                         
                                                            
                                                               ROI
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   >
                                                   0.5
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ROI
                                 
                                 
                                    gt
                                 
                              
                           
                         denotes manually labeled ground truth, and 
                           
                              
                                 
                                    ROI
                                 
                                 
                                    t
                                 
                              
                           
                         denotes the trackers’ tracking result. The other one is center location error (CLE) measured with manually labeled ground truth. Center location error is defined as follows:
                           
                              
                                 CLE
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             x
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   gt
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             y
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   gt
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         denotes the target location given by tracker, and 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    gt
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    gt
                                 
                              
                              )
                           
                         denotes the ground-truth position. The compared results are summarized in Tables 1 and 2
                        
                        .

In addition, there are small number of parameters that we need to set in our tracker. During tracking, all image candidates or samples are resized to 
                           
                              32
                              ×
                              32
                           
                         rectangle. The number of hash functions (K in Section 3) for each patch is set to be 4, so the number of binary code of one patch is 
                           
                              4
                              ×
                              D
                           
                        . D is the width of patch which is different with different strategies. In Section 4.3, the defined learning rate λ is set to 0.15–0.25 according to the extent of variation of target or background. For example, the target and background in sequence Mhyang change slowly and learning rate could be set lower, but in sequence Dudek they change quickly and learning rate should be set higher to adapt fast changing.

In our experiments, we use success rate and center error to evaluate our tracking algorithm. The ground truth is obtained by manually labeling at all frames in sequences. Table 1 lists average center error of our tracker and eight state-of-the-art trackers. The success rate is the ratio between the number of successfully tracked frames and the number of total frames. And Table 2 gives the success rate of the nine trackers on ten test sequences. Our tracker achieves most best or second performance as see in tables. The curve Fig. 7 also shows the stable tracking results of 2DHT. The second best tracker is CCT, which benefits from its powerful appearance model (combination of complex cells). But it appears to be unstable to some sequences such as David, Dudek and FleetFace. MIL also performs well both on SR and CLEs owing to its delicate update model. However, the appearance model of MIL is not robust and makes the tracker lose the target under fuzzy situation (Deer) and pose change (FleetFace). LSHT also achieves well performance in several sequences (David, Dog, FaceOcc2 and Mhyang) due to its illumination invariant feature. But the LSH cannot catch the discriminative information well from fuzzy object, which is the failure factor of the tracker in sequences Deer and Jumping. LSST and L1APG are the sparse representation based trackers. The sparse coding techniques have been proven to be effective in object tracking since literature [1] published. But this type of technique is rough method of representing object, thus the performance is limited. In our experiments, these two trackers only track object well in few sequences. SPT achieves worst results as Tables 1 and 2 list. The tracker only considers the confidence of local parts and does not take use of global distinctiveness. In this point, it also confirms the importance of our patch-based appearance model. IVT and CT can be taken as same type as our tracker (dimensionality reduction manner). However, our tracker performs better than them owing to the techniques used in our tracker. For IVT tracker, it shows its high-efficiency and ability in tracking. The success of IVT proves that data-driven feature selection has good performance in object tracking. But IVT do not use negative samples to help learning map functions, so that the tracker’s discriminative ability is limited. However, if IVT takes negative samples into consideration, the feature selection process would be time-consuming with large amount of samples. In our tracker, we use 2D hash manner to improve the processing speed, which makes the tracker could take large number of samples to train mapping directions in real-time. CT also uses both negative and positive samples, but its map functions are randomly predefined by compressive technique. Although the mapping functions are guaranteed by mathematical theory, the random mapping process cannot always provide a stable appearance model, which makes CT lose the target completely in several sequences. In conclusion, the experiments demonstrate that our 2DHT is a robust and efficiency tracker, which provides a reasonable and efficiency feature selection way, as shown in Tables 1, 2 and Fig. 7.


                           
                              
                                 (1)
                                 
                                    Patch strategies: The patch-based appearance model introduced in Section 4.1 is an important part of our tracker. We design six patch strategies to estimate the influence of the tracker’s performance. The strategies are listed in Table 3
                                    , where left column denotes number of patches inside one rectangle, middle column means patch size (all rectangles are resized to 
                                       
                                          32
                                          ×
                                          32
                                       
                                    ) and right column tells that patches are overlapped or not. The results are shown in Fig. 4
                                    . It is easy to find in Fig. 4(a) that more patches the appearance model has, the lower speed of tracking process is. But Fig. 4(b) and (c) shows that the performance rises with patches increases. Let us focus on the changing from no-patch to 
                                       
                                          2
                                          ×
                                          2
                                       
                                     strategy, the tracking results improve a lot with this changing. It is a strong evidence for the importance of patch-based appearance model. However, the performance of 
                                       
                                          2
                                          ×
                                          2
                                       
                                     strategy does not meet precision requirement. Then we increase the patches from 
                                       
                                          3
                                          ×
                                          3
                                       
                                     to 
                                       
                                          7
                                          ×
                                          7
                                       
                                    . 
                                       
                                          3
                                          ×
                                          3
                                       
                                     strategy has low FPS than 
                                       
                                          4
                                          ×
                                          4
                                       
                                     because patches of 
                                       
                                          3
                                          ×
                                          3
                                       
                                     are overlapped. In our view, 
                                       
                                          4
                                          ×
                                          4
                                       
                                     strategy achieves best balance between time cost and accuracy. Although 
                                       
                                          5
                                          ×
                                          5
                                       
                                     and 
                                       
                                          7
                                          ×
                                          7
                                       
                                     strategies get better performance, they improve the performance rarely and sacrifice a lot of processing time.


                                    Column dimension reduction vs. row dimension reduction: In 2D manner, there exists two directions of dimension reduction: column reduction and row reduction. Our hashing method in Section 3 is proposed by row reduction. To transform to column reduction manner, we only need to change covariance matrix 
                                       
                                          S
                                       
                                     to 
                                       
                                          E
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    . We implement comparison experiments between both directions on sequence David, Deer, Mhyang and Jumping. As shown in Fig. 5
                                    , the difference between performances of two manners is not significant, because columns and rows both contain the structure information of target. However, we would like to suggest users to test both two manners and choose the better one when applying our method into applications.


                                    2DH tracker vs. PCAHash tracker: Because the hashing method utilized in our tracker is similar to the idea of LDA, we also implement the tracker with PCAhash for comparison. To be fair, 2D manner and other settings are used in PCAhash method too. According to the idea of PCA, the PCAhash tracker could be easily implemented by let covariance matrix 
                                       
                                          S
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                ‾
                                             
                                          
                                          )
                                       
                                     and objective function be 
                                       
                                          J
                                          (
                                          W
                                          )
                                          =
                                          tr
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                ⊤
                                             
                                          
                                          SW
                                          )
                                       
                                    . As shown in Fig. 6
                                    , the performance of PCAHash tracker is similar to our tracker in sequence Jumping, Deer and Dog. In sequence David, FaceOcc, Dudek, FleetFace, Sylvester, our tracker performs much better than PCAhash tracker. The reason is that PCAhash does not utilize the discriminative information of samples. Due to it, the target sample and other background samples may not be separated after mapping, which makes the tracker be difficult to distinguish target from other candidates. In conclusion, the PCAhash tracker can handle sequences with simple background, but appears to lose target of sequences under complex cases. And our tracker is much more robust than tracker with PCAhash.

The computation time of our tracking algorithm is analyzed in this section. During tracking, the whole process can be divided into two parts: confidence calculation and hashing training. Table 4
                            also lists the computation time of two parts on each sequence. The experiments are implemented in the same computer mentioned in Section 5.1, and we do not use parallel optimization to improve the speed. We can see that the tracker could reach average 100ms per frame (10FPS) with 
                              
                                 4
                                 ×
                                 4
                              
                            patch strategy as shown in Table 4. We also attempt to optimize the tracker by simple parallel computing, and it makes our tracker reach 20FPS. The confidence calculation spends nearly 65% of whole computation time and it is still the most time-consuming part. But it also proves the importance of the hashing technique, which makes similarity computation have a qualitative leap. The learning part only takes average 34ms per frame, which benefits from 2D manner and incremental learning designed in this paper.

We analyze the computational complexity here for better knowing the time consuming of our tracking algorithm. Assume there are N candidates and M training pairs at each frame. Patch number is P and dimensionality of patch matrix is d (equal to the number of matrix elements). We list the complexity as follows:
                              
                                 1.
                                 
                                    
                                       
                                          O
                                          (
                                          PdNT
                                          )
                                       
                                    : the tracker calculates the hamming distance between each candidate and templates(the number of templates is T) by Eq. (13). Actually, Hamming distance could be calculated faster than Euclidean distance and 
                                       
                                          P
                                          ,
                                          d
                                          ,
                                          T
                                       
                                     are much smaller than N. So the process costs a little time.


                                    
                                       
                                          O
                                          (
                                          
                                             
                                                MPd
                                             
                                             
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          MPd
                                          )
                                       
                                    : calculate covariance matrices for all pairs with 2D manner and calculate the average covariance matrices. If we vectorizes sample matrix like original method, the complexity would be 
                                       
                                          O
                                          (
                                          2
                                          
                                             
                                                MPd
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    , which could not be accepted for online update.


                                    
                                       
                                          O
                                          (
                                          MPd
                                          )
                                       
                                    : calculate average patch matrices of training samples.


                                    
                                       
                                          O
                                          (
                                          Pd
                                          +
                                          
                                             
                                                Pd
                                             
                                             
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    : update covariance matrices and average matrix.

The summation of these four parts is the total complexity. As we can see, the overall computational complexity of tracking algorithm is dominated by first part and second part. The analysis tells us that the usage of hash is an important factor for efficiency tracking. Besides it, second part further highlights the importance of our two dimensional hashing technique for saving time.

In this section, we evaluate the performance of trackers qualitatively. Figs. 8–10 show the screenshots of trackers’ performance and Fig. 7
                         presents the curves of tracking results on CLE. Several challenging situations are the key element to test trackers performance, and we listed them happening at each sequence in Table 5
                        .


                        Illumination variation: In the experiments, we utilized sequence David and Mhyang to test trackers. The tracked target in David is human face which moves from dark to light. From frame #120 to frame #220 as shown in Figs. 8–10
                        
                        
                        , CT, IVT and MIL lost the target because they did not have any mechanism to deal with illumination. At frame #302, SPT and L1APG appeared to give imprecise tracking result. The key challenge happened at frame #498, most trackers lost the target completely. CCT and LSHT performed well because of their used robust feature. However, our tracker performed best owing to the robust appearance model and real-time update model. In sequence Mhyang, most trackers could get through the first 1000 frames, but when the illumination variation and pose change happened together, these trackers began to lose target as shown in Fig. 10 frame #1456 and #1488. Taken tables and figures together, the proposed tracker and CCT achieved the best performance. By this fact, we can make a conclusion that robust appearance model and real-time update model are two important factors to deal with this situation. Owing to these two elements, our tracker tracked object more robustly than CCT in these two sequences as experiments show.


                        Fast motion: Fast motion is always an intractable problem in tracking. It always makes trackers easily lose target. In these experiments, we tested two sequences Jumping and Deer with fast motion. Heads of human and deer move fast and become fuzzy during movement. It is a challenge for trackers’ appearance model. As shown in Fig. 8, most trackers lost target completely in sequence Deer. However, our tracker and CCT benefit from powerful appearance model, and provide best and second best performance. Tracking sequence Jumping precisely is also a hard task. Trackers SPT, L1APG and LSHT cannot deal with fast motion well as shown in Fig. 9. However, our 2DHT tracker presented most precise results due to the robust appearance model and real-time update model. The test results show that 2DHT could handle fast motion well.


                        Pose change: Pose change is a common situation which exists in several tested sequences (David, Dudek, FleetFace, Mhyang and Sylvester). As shown at frame #498 in sequence David, the compared eight trackers lose or drift away from the target after pose variation. The pose change in sequences Dudek is not severe, thus LSHT and LSST could handle the situation, while other trackers appeared to lose target at some frames. With robust appearance model, our tracker could easily handle these two sequences and perform better than other eight trackers (see Fig. 8). In sequences FleetFace, Mhyang and Sylvester, objects’ poses changed heavily, which made several trackers could not locate the target well. The situation in Mhyang happened at frames #1456 to #1488, all trackers except CCT and 2DHT drifted away from the target. At frames #454, #522 and #633 of FleetFace, only LSHT and 2DHT caught the face well. In sequence Sylvester, CCT and 2DHT are the only two trackers which could track object all the time. These experimental results demonstrate that our tracking algorithm is able to deal with pose change more robustly than other trackers.


                        Occlusion: We tested on FaceOcc1 and FaceOcc2 which have partial and heavy occlusion. As shown in Fig. 9, our method located object well due to our patch-based appearance model when the target was under heavy occlusion. CCT, CT and SPT performed well before occlusion came, but began to drift away after occlusion occurred. Especially in FaceOcc2, when the man’s face under heavy occlusion (frame #700), almost all trackers could not give imprecise location of target. Here we notice that the discriminative model trackers (CT, MIL and 2DHT) performed better than generative model under this situation. That is mainly because when most parts of object are not visible, the tracker locating object by eliminating negative samples could achieve good performance. With such characteristic, our tracker could handle the situation easily and efficiently. Besides it, 2DHT’s appearance model is more sophisticated than appearance models of CT and MIL, which makes the proposed tracking algorithm present more robust results.


                        Background clutters: Background clutter exists in several sequences (Deer, Jumping), which tests the discriminative ability of tracking algorithms. Trackers with global discriminativeness always deal with the situation well. As screenshots of Deer shown (Fig. 8), except 2DHT and CCT all trackers lost the target completely. The reason is that they do not catch the global structure information of target well. However, our tracker benefits from patch-based appearance model and could handle background clutters well. CCT also provided good tracking results because of its appearance model. This advantage makes 2DHT and CCT perform well in sequence Jumping too, while other trackers cannot give better results than them.

Overall, our tracker, as a novel tracking technique, proves its ability in visual tracking. In the experiments, the robust tracking results and short computational time are strong evidence that demonstrates the worth of our tracker.

@&#CONCLUSION@&#

In this paper, we propose a hashing based tracking algorithm called 2DHT. General data-dependent hashing methods could improve the speed of similarity measurement significantly, which could be utilized to track object. However, it is still time-consuming to train hash functions with large number of samples. To overcome this bottleneck, we proposed two dimensional hashing method. The method greatly reduces the dimensionality of covariance matrices, and then the speed of learning hash functions is improved significantly. Both theoretical framework in Section 3 and experimental evaluations in Section 5 demonstrate the effectiveness and efficiency of our 2D hashing method. To obtain global distinctiveness, patch-based appearance model is designed for catching structure information, and it achieves a big success in experiments. During tracking, hash functions are updated by incremental learning model for adapting situation changing. By these innovations, our tracker obtains great performance in accuracy and efficiency. In addition, our proposed two dimensional hashing technique can be easily implemented and applied to many other applications in computer vision such as image retrieval and object detection.

The authors declare that they have no conflict of interest.

@&#ACKNOWLEDGMENTS@&#

This work is supported by National Natural Science Foundation of China (Grant Nos. 61373063, 61373062), the project of Ministry of Industry and Information Technology of China (Grant No. E0310/1112/02–1).

@&#REFERENCES@&#

