@&#MAIN-TITLE@&#Pharmacokinetics of insulin lispro in type 2 diabetes during closed-loop insulin delivery

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A model described lispro PK during closed loop insulin delivery in T2D.


                        
                        
                           
                           The linear two-compartment model fitted well the data.


                        
                        
                           
                           Time-to-peak of lispro and its metabolic clearance rate (MCR) were estimated.


                        
                        
                           
                           Relationships between PK and metabolic/demographic data were examined.


                        
                        
                           
                           Negative correlation found between lispro MCR and fasting insulin/C-peptide.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Pharmacokinetics

Insulin lispro

Artificial pancreas

Type 2 diabetes

Bayesian estimation

Mathematical modelling

@&#ABSTRACT@&#


               
               
                  Insulin pharmacokinetics is not well understood during continuous subcutaneous insulin infusion in type 2 diabetes (T2D). We analyzed data collected in 11 subjects with T2D [6 male, 9 white European and two of Indian ethnicity; age 59.7(12.1) years, BMI 30.1(3.9)kg/m2, fasting C-peptide 1002.2(365.8)pmol/l, fasting plasma glucose 9.6(2.2)mmol/l, diabetes duration 8.0(6.2) years and HbA1c 8.3(0.8)%; mean(SD)] who underwent a 24-h study investigating closed-loop insulin delivery at the Wellcome Trust Clinical Research Facility, Cambridge, UK. Subcutaneous delivery of insulin lispro was modulated every 15min according to a model predictive control algorithm. Two complementary insulin assays facilitated discrimination between exogenous (lispro) and endogenous plasma insulin concentrations measured every 15–60min. Lispro pharmacokinetics was represented by a linear two-compartment model whilst parameters were estimated using a Bayesian approach applying a closed-form model solution. The time-to-peak of lispro absorption (t
                     max) was 109.6 (75.5–120.5)min [median (interquartile range)] and the metabolic clearance rate (MCR
                     
                        I
                     ) 1.26 (0.87–1.56)×10−2
                     l/kg/min. MCR
                     
                        I
                      was negatively correlated with fasting C-peptide (r
                     
                        s
                     
                     =−0.84; P
                     =.001) and with fasting plasma insulin concentration (r
                     
                        s
                     
                     =−0.79; P
                     =.004). In conclusion, compartmental modelling adequately represents lispro kinetics during continuous subcutaneous insulin infusion in T2D. Fasting plasma C-peptide or fasting insulin may be predictive of lispro metabolic clearance rate in T2D but further investigations are warranted.
               
            

@&#INTRODUCTION@&#

Closed-loop insulin delivery, also known as ‘the artificial pancreas’ combines a continuous glucose monitoring (CGM) device, a control algorithm, and an insulin pump, and has the potential to transform diabetes care [1,2]. The control algorithm receives, in real-time, sensor glucose concentration and computes the amount of insulin to be delivered by the insulin pump. Clinical trials have demonstrated the safety and efficacy of closed-loop delivery in adults [3], adolescents [4] and pregnant women [5] with type 1 diabetes (T1D). A recent study evaluated closed-loop system in 12 subjects with type 2 diabetes (T2D) [6] in preparation for testing in non-critically ill inpatients with insulin treated T2D [7].

Computer-based simulations have the capability to accelerate cost-effective development of the artificial pancreas. In an in silico testing environment, alternative study protocols can be tested against competing glucose control algorithms prior to clinical evaluations [8]. A number of in silico environments have been proposed in T1D [9,10] but T2D virtual populations are not documented and would be helpful.

A glucoregulatory model normally comprises a sub-model of insulin kinetics describing absorption of subcutaneously administered insulin. A number of insulin kinetics models have been proposed mostly applying compartmental modelling [11–15]. However, none of the models was identified using clinical data collected during continuous subcutaneous insulin infusion in T2D.

In the present work, we used compartmental modelling to describe absorption of insulin lispro in subjects with T2D who underwent investigations of closed-loop insulin delivery over 24h [16]. Model parameters were estimated using Bayesian inference [17] by fitting the statistical model to the plasma insulin concentration. We derived a closed-form solution of the compartmental model and integrated it into the statistical model which markedly accelerated the parameter estimation process. We assessed correlations between lispro pharmacokinetics and subjects’ demographic data to identify factors predictive of lispro absorption and clearance.

@&#MATERIAL AND METHODS@&#

Insulin-naïve subjects with T2D underwent investigations of closed-loop insulin delivery at the Wellcome Trust Clinical Research Facility, Addenbrooke's Hospital, Cambridge [16]. The study was approved by the Cambridge Research Ethics Committee and subjects signed informed consent prior to the commencement of the study. We analyzed data collected during a 24-h study visit when subjects’ usual diabetes treatment (non-insulin glucose-lowering medication) was withheld and was replaced by exogenous insulin [16].

A subcutaneous cannula was inserted in the abdomen for the delivery of insulin lispro (Humalog, Eli Lilly, Indiana) by a study pump (Animas 2020 Johnson&Johnson, NJ) in the morning of the study. A continuous glucose monitoring device (FreeStyle Navigator®, Abbott Diabetes Care, Alameda, CA, USA) informed insulin delivery by the pump using a model-predictive-control algorithm [18]. From 9:00 a.m. on Day 1 until 9:00 a.m. on Day 2, the insulin infusion rate was adjusted every 15min according to the control algorithm. Three meals of 50, 80 and 60g carbohydrate were consumed at 9:00 a.m., 1:00 p.m. and 6:00 p.m. (all Day 1), respectively, without administering prandial insulin boluses. Subjects remained sedentary during the study. Blood samples were taken for measuring plasma insulin at the following time points relative to 9:00 a.m. on Day 1: 0, 15, 30, 45, 60, 90, 120, 150, 180, 210, 240, 255, 270, 285, 300, 330, 360, 390, 420, 450, 480, 510, 540, 555, 570, 585, 600, 630, 660, 690, 720, 750, 780, 810, 840, 870, 900, 960, 1020, 1080, 1140, 1200, 1260, 1320, 1380 and 1440min. Blood samples were taken every 15min to measure plasma glucose.

Samples were centrifuged immediately with plasma kept on ice and stored at −80°C prior to further analyses. Plasma insulin was measured using two approaches, an immunochemiluminometric assay (Invitron, Monmouth, UK; intra-assay CV 4.7%; inter-assay CV 7.2–8.1%) which has 100% cross reactivity with insulin lispro to quantify total plasma insulin, and AutoDELFIA immunoassay (Perkin Elmer Life Sciences, Wallac Oy, Turku, Finland; inter-assay CV 3.1% at 29pmol/l, 2.1% at 79.4pmol/l, 1.9% at 277pmol/l, 2.0% at 705pmol/l) which has zero cross reactivity with insulin lispro to quantify endogenous plasma insulin.

Baseline fasting C-peptide was measured by a chemiluminescence immunoassay (Diasorin Liaison XL, Deutschland GmbH, Dietzenbach, Germany; inter-assay CV 5.6% at 563pmol/l, 4.5% at 2529pmol/l, 5.8% at 5449pmol/l).

Plasma glucose was measured by YSI2300 STAT Plus Analyser (YSI, Fleet, Hampshire, UK).

The kinetics of exogenous insulin was described by a two-compartment model:
                           
                              (1)
                              
                                 
                                    
                                       
                                          d
                                          
                                             i
                                             1
                                          
                                          (
                                          t
                                          )
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             i
                                             1
                                          
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             t
                                             
                                                max
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          u
                                          (
                                          t
                                          )
                                       
                                       
                                          60
                                       
                                    
                                    ,
                                     
                                    
                                       i
                                       1
                                    
                                    (
                                    0
                                    )
                                    =
                                    D
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          d
                                          
                                             i
                                             2
                                          
                                          (
                                          t
                                          )
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    −
                                    
                                       1
                                       
                                          
                                             t
                                             
                                                max
                                             
                                          
                                       
                                    
                                    [
                                    
                                       i
                                       2
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       i
                                       1
                                    
                                    (
                                    t
                                    )
                                    ]
                                    ,
                                     
                                    
                                       i
                                       2
                                    
                                    (
                                    0
                                    )
                                    =
                                    0
                                 
                              
                           
                        where i
                        1(t) and i
                        2(t) are the amounts of unabsorbed insulin in the subcutaneous insulin depots (U), u(t) denotes the exogenous insulin infusion (U/h), t
                        max is the time-to-peak of insulin absorption (min), and D is a small amount of priming insulin bolus administered at time t
                        =0. The exogenous plasma insulin concentration is obtained assuming instantaneous equilibration between insulin appearance in plasma and plasma insulin reflecting a short plasma insulin half-life relative to the frequency of plasma insulin measurements [19,20]:
                           
                              (3)
                              
                                 
                                    
                                       I
                                       
                                          E
                                          X
                                          O
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          1000
                                       
                                       
                                          
                                             t
                                             
                                                max
                                             
                                          
                                          M
                                          C
                                          
                                             R
                                             I
                                          
                                          W
                                       
                                    
                                    
                                       i
                                       2
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        where I
                        
                           EXO
                        (t) is the exogenous plasma insulin concentration (mU/l), MCR
                        
                           I
                         is the metabolic clearance rate of insulin (l/kg/min), and W is subject's weight (kg). t
                        max and MCR
                        
                           I
                         are individual model parameters.

Total, exogenous, and endogenous insulin concentrations were related using a linear correction to account for between-assay differences [21]:
                           
                              (4)
                              
                                 
                                    
                                       I
                                       
                                          T
                                          O
                                          T
                                          A
                                          L
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       I
                                       
                                          E
                                          X
                                          O
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    a
                                    +
                                    b
                                    ×
                                    
                                       I
                                       
                                          E
                                          N
                                          D
                                          O
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        where I
                        
                           TOTAL
                        (t) is the total plasma insulin determined by immunochemiluminometric assay (mU/l), I
                        
                           ENDO
                        (t) is the endogenous plasma insulin determined by AutoDELFIA immunoassay (mU/l), I
                        
                           EXO
                        (t) is the exogenous plasma insulin (mU/l), a (mU/l) and b (unitless) are offset and slope characterizing the linear between-assay correction and are also regarded as individual parameters.

The model input was the exogenous insulin infusion and the model output the total plasma insulin concentration as specified in Eq. (4). The measurement error for the total and endogenous plasma insulin was assumed to be multiplicative with a CV of 6%. The standard deviation (SD) of the measurement error associated with the total exogenous insulin concentration was obtained as
                           
                              (5)
                              
                                 
                                    S
                                    D
                                    (
                                    
                                       I
                                       
                                          E
                                          X
                                          O
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                0.06
                                                *
                                                
                                                   I
                                                   
                                                      T
                                                      O
                                                      T
                                                      A
                                                      L
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                (
                                                0.06
                                                *
                                                
                                                   I
                                                   
                                                      E
                                                      N
                                                      D
                                                      O
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Prior distributions of model parameters are shown in Table 1
                        . Vague prior information was assigned to t
                        max and MCR
                        
                           I
                         using log-normal distributions to ensure positivity. We assumed a vague normal prior with a large variance for the offset a while the slope b had a more informative normal prior with both mean and variance equal to 1. Details of the Bayesian approach are given in Appendix A. Appendices B and C show outline of the WinBUGS code describing the statistical model and the closed-form solution, respectively.

We calculated correlations between estimates of the pharmacokinetic parameters (t
                        max and MCR
                        
                           I
                        ) and demographic characteristics including age, body mass index (BMI), total cholesterol, HbA1c, fasting C-peptide concentration, fasting plasma insulin concentration, duration of diabetes and the total daily dose (TDD) of insulin administered. The Spearman's rank correlation coefficient (r
                        
                           s
                        ) was calculated given that the pharmacokinetic parameters were not normally distributed. P values less than 0.05 were considered statistically significant. R software was used to carry out the statistical calculations [22].

@&#RESULTS@&#

Twelve subjects with T2D were studied but one subject's dataset was excluded from the analysis due to its unfeasibly low exogenous plasma insulin concentrations. It took 172s for WinBUGS to run 100,000 iterations on a standard 32-bit desktop (OPTIPLEX™ 760, DELL™ Computers Ltd.) yielding posterior parameter distributions of the 11 remaining subjects [6 male, 9 white European and two of Indian ethnicity; age 59.7(12.1) years, BMI 30.1(3.9)kg/m2, fasting C-peptide 1002.2(365.8)pmol/l, diabetes duration 8.0(6.2) years and HbA1c 8.3(0.8)%; fasting plasma glucose 9.6(2.2)mmol/l, mean(SD)]. Each subject's dataset was fitted by the model individually. The first 10,000 iterations were discarded as burn-ins to allow the initial stabilization of the Markov chain [23].


                     Table 1 gives estimates of the kinetic parameters t
                     max and MCR
                     
                        I
                     , and the correction factors a and b. The offset a was low and centred around zero while the median slope was 1.25 indicating 25% higher measurements by immunochemiluminometric assay compared to AutoDELFIA immunoassay. A significant negative correlation was observed between MCR
                     
                        I
                      and t
                     max (r
                     
                        s
                     
                     =−0.80, P
                     =0.003).


                     Fig. 1
                      shows an example model fit to the exogenous plasma insulin concentration along with the insulin infusion rate, which increased rapidly after each meal (0, 240, and 540min) and was followed by an elevated exogenous plasma insulin concentration. Individual model fit is shown in Appendix F. As standard when modelling insulin assays data, not all data points were fitted perfectly due to factors such as the measurement and sample timing errors, temporal occlusion and other delivery errors, and model misspecification, particularly in subjects 2, 4, 6, 8 and 9. Fig. 2
                      shows weighted residuals associated with the exogenous plasma insulin concentration documenting overall acceptable and unbiased model fit. Appendix G shows Q–Q plots of weighted residuals which validate the assumption of normally distributed residuals observed during the fitting process.


                     Table 2
                      shows correlations between the pharmacokinetic parameters and demographic characteristics. MCR
                     
                        I
                      correlated negatively with the fasting C-peptide concentration (r
                     
                        s
                     
                     =−0.84; P
                     =0.001) and the fasting insulin concentration (r
                     
                        s
                     
                     =−0.79; P
                     =0.004). The positive correlation between t
                     max and the fasting C-peptide concentration (r
                     
                        s
                     
                     =0.73; P
                     =0.01) might be confounded by multicorrelinarity between t
                     max and MCR
                     
                        I
                      (Spearman correlation shown in Appendix E).


                     Fig. 3
                      shows scatter plots between MCR
                     
                        I
                      and fasting C-peptide/insulin. Appendix D shows plasma glucose levels.

@&#DISCUSSION@&#

We used compartment modelling to study the kinetics of rapid-acting insulin analogue in T2D during a 24-h closed-loop study, with the exogenous plasma insulin concentration obtained from the total and endogenous plasma insulin measurements. Plausible parameter estimates were obtained and significant correlations were identified between lispro pharmacokinetics and fasting C-peptide and insulin concentrations.

Compartmental modelling has been used extensively to study kinetics of human insulin and its analogues [11–13,24]. The model used in the present study was previously employed to study insulin aspart pharmacokinetics in T1D [19,20]. Compared to T1D, t
                     max is longer and MCR
                     
                        I
                      lower in the present study investigating T2D.

Bolli et al. [25] compared pharmacokinetics of two other rapid-acting insulin analogues aspart and glulisine and obtained median estimates of t
                     max at 93min and 120min, respectively, following a prandial insulin bolus. Gagnon et al. [26] demonstrated a delayed absorption of insulin lispro administered in the form of boluses with increased insulin dosage in obese subjects with T2D with t
                     max at 55.7±14.0min (mean±SD) following a 10U bolus whereas after a 50U bolus, t
                     max was 130±46min. Our t
                     max estimate at 109.6 (75.5–120.5) min [median (IQR)] compares well but unlike other studies was obtained during a prolonged 24-h investigation utilizing continuous subcutaneous insulin infusion. Heinemann hypothesized that the mode of insulin delivery may affect insulin kinetics [27] possibly explaining some of the differences between our results and the literature.

When comparing insulin concentrations measured by different insulin assays, researchers need to be aware that there may be up to a two-fold variation in insulin results for the same serum sample possibly due to assay specificity, manufacturers’ calibration procedures, and other factors [21]. In the present work we obtained the exogenous (lispro) plasma insulin concentration by accounting for the between-assay difference through parameter estimation (the slope b with median(IQR) 1.25 (0.98–1.31) compares well to the two-fold variation between insulin assays reported elsewhere [21]). This proved robust and appropriate given that our data comprised samples containing endogenous but not exogenous insulin at time zero, and a mixture of endogenous and total insulin after the start of the exogenous insulin delivery. We did not use a specific lispro assay as it is not generally available.

We observed significant negative correlations between MCR
                     
                        I
                      and fasting C-peptide/insulin indicating that a lower insulin clearance may be associated with elevated fasting insulin secretion. We hypothesized that this may be related to the natural history of type 2 diabetes; a reduced insulin clearance as a primary factor may lead to higher fasting plasma insulin, which in turn through elevated peripheral insulin concentration leads to insulin resistance. This positive feedback between insulin clearance and insulin secretion gradually accentuates the effect of reduced clearance on insulin sensitivity. Literature results also support the link between insulin clearance and insulin secretion [28–30]. However, our study was not powered to make firm conclusions.

The strength of our approach is the use of a closed-form solution instead of numerical methods to solve the compartmental model accelerating the parameter estimation process especially when the Bayesian inference and Markov chain Monte Carlo methods are utilized. Note that the availability of such a closed-form solution results from the linearity of the system of ordinary differential equations. A drawback is that the exogenous plasma insulin concentration was not measured directly due to general unavailability of a lispro-specific insulin assay but this was accounted for through a suitable approach to determine lispro concentration. Another weakness is a small sample size but comparable to previous studies.

In conclusion, a compartmental model was used to describe the kinetics of rapid-acting insulin lispro in subjects with T2D who underwent a 24-h closed-loop study. A Bayesian approach was used to estimate individual parameters and physiologically plausible estimates and good model fits were obtained. Significant associations were identified between insulin metabolic clearance rate and fasting C-peptide/insulin concentration but further investigations of this observation are warranted.

K.K. and H.T. organized clinical data collection and biochemical measurements. Y.R. analyzed data. Y.R. and R.H. interpreted data. Y.R. drafted manuscript. Y.R. and R.H. reviewed/edited manuscript. All authors reviewed the manuscript and approved final version.

The authors declare no competing interest.

@&#ACKNOWLEDGEMENT@&#

This work was funded by a National Institute for Health Research (NIHR) Cambridge Biomedical Research Centre Grant. The research was conducted with support from Addenbrooke's Clinical Research Facility (Cambridge, UK).

We gratefully acknowledge laboratory support from Angie Watts (University of Cambridge, Cambridge UK), Dr Stephen Luzio and Mr Gareth Dunseath (University of Swansea, Swansea, UK), and Dr Keith Burling (University of Cambridge, UK).

We estimated the model parameters by the Bayesian inference theory [17] using the Bayes Theorem:
                        
                           (6)
                           
                              
                                 p
                                 (
                                 θ
                                 |
                                 y
                                 )
                                 =
                                 
                                    
                                       p
                                       (
                                       θ
                                       )
                                       p
                                       (
                                       y
                                       |
                                       θ
                                       )
                                    
                                    
                                       ∫
                                       
                                          p
                                          (
                                          θ
                                          )
                                          p
                                          (
                                          y
                                          |
                                          θ
                                          )
                                          d
                                          θ
                                       
                                    
                                 
                                 ∝
                                 p
                                 (
                                 θ
                                 )
                                 p
                                 (
                                 y
                                 |
                                 θ
                                 )
                              
                           
                        
                     where y is the dataset of the total plasma insulin measurements, θ represent the unknown individual parameters comprising a, b in Eq. (4) and t
                     max, MCR
                     
                        I
                      in Eq. (3). The prior knowledge on these parameters is represented by prior distributions p(θ) which are updated using the likelihood p(y|θ) to yield parameters’ posterior distributions p(θ|y). ∫p(θ)p(y|θ)dθ, which equals to p(y), performs as a scale factor.

The WinBUGS software (Bayesian inference Using Gibbs Sampling for Windows) [31] was used for Bayesian inference. It employs Markov Chain Monte Carlo (MCMC) methods and Metropolis–Hasting algorithm to approximate the posterior distribution p(θ|y).

We derived a closed-form solution of the model given in Eqs. (1)–(3) and regarded it as a non-linear function. The WinBUGS extension ‘WBDev’ [32,33] was utilized to implement this solution into WinBUGS through a separate module file.

In WinBUGS, each parameter is represented by a Markov chain with the stationary distribution as the corresponding parameter's posterior distribution. When running the statistical model, at each iteration, a set of parameter values are sampled by the algorithm from their posterior distributions. A number of iterations must be run before the Markov chains converge. Inference information such as point estimates of the parameter mean, median and the corresponding credible intervals can be derived from these Markov chains at their stationary distributions.

Outline of the WinBUGS code with explanatory notes:
                        
                           
                              
                              
                              
                                 
                                    for (i in S1:S2) #over subject
                                    #1
                                 
                                 
                                    {
                                    
                                 
                                 
                                    #calculate solutions via WBDev
                                    
                                 
                                 
                                    
                                       # initial conditions
                                    
                                 
                                 
                                    
                                       for (j in 1:2) {init[i,j]<-state_0[i,j]}
                                    #2
                                 
                                 
                                    
                                       #theta
                                    
                                 
                                 
                                    
                                       theta[i,1]<-Nt
                                    #3
                                 
                                 
                                    
                                       theta[i,2]<-Np
                                    #4
                                 
                                 
                                    
                                       theta[i,3]<-t_x_I[i]
                                    #5
                                 
                                 
                                    
                                       theta[i,4]<-MCR_I[i]
                                    #6
                                 
                                 
                                    
                                       theta[i,5]<-W[i]
                                    #7
                                 
                                 
                                    
                                       for (j in 1:Nt)
                                    #8
                                 
                                 
                                    
                                       
                                       {theta[i,2+Np+j]<-t[j]}
                                    #9
                                 
                                 
                                    
                                       for (j in 1:(Nt-1))
                                    #10
                                 
                                 
                                    
                                       
                                       {theta[i,2+Np+Nt+j]<-u[i,j]}
                                    #11
                                 
                                 
                                    
                                       solutions[i,1:(Nt-1)]<-InsulinKinetics(init[i,],theta[i,])
                                    #12
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    #priors…
                                    
                                 
                                 
                                    
                                       log.t_x_I[i]∼dnorm(4.094,0.01)
                                    #13
                                 
                                 
                                    
                                       t_x_I[i]<-exp(log.t_x_I[i])
                                    #14
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       log.MCR_I[i]∼dnorm(-3.507,0.01)
                                    #15
                                 
                                 
                                    
                                       MCR_I[i]<-exp(log.MCR_I[i])
                                    #16
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       a[i]∼dnorm(0,0.0001)
                                    #17
                                 
                                 
                                    
                                       b[i]∼dnorm(1,1)
                                    #18
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    # likelihood...
                                    
                                 
                                 
                                    
                                       # exogenous insulin correction
                                    
                                 
                                 
                                    
                                       
                                       for (j in 1: Nip_meas)
                                    #19
                                 
                                 
                                    
                                       
                                       {
                                    #20
                                 
                                 
                                    
                                       
                                       Ip_total[i,j] ∼dnorm(Ip_total_m[i,j],tau_Ip_total[i,j])
                                    #21
                                 
                                 
                                    
                                       
                                       Ip_total_m[i,j]<-Ip_exo[i,j]+(a[i]+b[i]*Ip_endo[i,j])
                                    #22
                                 
                                 
                                    
                                       
                                       tau_Ip_total[i,j]<-1/(0.06*Ip_total[i,j]*0.06*Ip_total[i,j])
                                    #23
                                 
                                 
                                    
                                       
                                       }
                                    #24
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       # exogenous plasma insulin concentration
                                    
                                 
                                 
                                    
                                       
                                       for (j in 1: Nip_meas)
                                    #25
                                 
                                 
                                    
                                       
                                       {
                                    #26
                                 
                                 
                                    
                                       
                                       Ip_exo[i,j]∼dnorm(Ip_solutions[i,j],tau_Ip[i,j])
                                    #27
                                 
                                 
                                    
                                       
                                       tau_Ip[i,j]<-1/(0.06*Ip_total[i,j]*0.06*Ip_total[i,j]+0.06*Ip_endo[i,j]*0.06*Ip_endo[i,j])
                                    #28
                                 
                                 
                                    
                                       
                                       Ip_solutions[i,j]<-solutions[i,map_PI[j]]
                                    #29
                                 
                                 
                                    
                                       
                                       }
                                    #30
                                 
                                 
                                    }
                                    #31
                                 
                              
                           
                        
                     
                     
                        
                           •
                           Line 1: the loop runs one subject's data at one time and parameters are estimated individually.

Lines 3–11: the vector theta packages all data and parameter values needed to solve the differential equations via the function InsulinKinetics() in line 12.

Line 12: the function InsulinKinetics() calculates plasma exogenous insulin concentrations, with the initial conditions init[i,] and information in theta[i,], at time points defined in the time series vector t in line 9.

Lines 13–18: normal distributions in WinBUGS are parameterized with mean and precision (1/variance).

Line 29: map_PI is a vector which allows extracting exogenous plasma insulin solutions to match measurements at appropriate time points.

The closed-form solution is expressed in a recursive fashion to represent transition of i
                     1 and i
                     2 from time k
                     −1 to time k
                  

For i
                     1,k−1
                     →
                     i
                     1,k
                     :
                        
                           
                              
                                 
                                    i
                                    
                                       1
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    f
                                    
                                       10
                                    
                                 
                                 +
                                 
                                    f
                                    
                                       11
                                    
                                 
                                 
                                    i
                                    
                                       1
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                              
                           
                        
                     where
                        
                           
                              
                                 
                                    f
                                    
                                       10
                                    
                                 
                                 =
                                 
                                    
                                       
                                          u
                                          k
                                       
                                       
                                          t
                                          
                                             max
                                          
                                       
                                    
                                    
                                       60
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    e
                                    
                                       −
                                       
                                          Δ
                                       
                                       
                                          t
                                          k
                                       
                                       /
                                       
                                          t
                                          
                                             max
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    f
                                    
                                       11
                                    
                                 
                                 =
                                 
                                    e
                                    
                                       −
                                       
                                          Δ
                                       
                                       
                                          t
                                          k
                                       
                                       /
                                       
                                          t
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

For i
                     2,k−1
                     →
                     i
                     2,k
                     :
                        
                           
                              
                                 
                                    i
                                    
                                       2
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    f
                                    
                                       20
                                    
                                 
                                 +
                                 
                                    f
                                    
                                       21
                                    
                                 
                                 
                                    i
                                    
                                       1
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    f
                                    
                                       22
                                    
                                 
                                 
                                    i
                                    
                                       2
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                              
                           
                        
                     where
                        
                           
                              
                                 
                                    f
                                    
                                       20
                                    
                                 
                                 =
                                 
                                    f
                                    
                                       10
                                    
                                 
                                 −
                                 
                                    f
                                    
                                       11
                                    
                                 
                                 
                                    
                                       
                                          u
                                          k
                                       
                                       
                                          Δ
                                       
                                       
                                          t
                                          k
                                       
                                    
                                    
                                       60
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    f
                                    
                                       21
                                    
                                 
                                 =
                                 
                                    f
                                    
                                       11
                                    
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          t
                                          k
                                       
                                    
                                    
                                       
                                          t
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    f
                                    
                                       22
                                    
                                 
                                 =
                                 
                                    f
                                    
                                       11
                                    
                                 
                              
                           
                        
                     And i
                     
                        k
                     :
                        
                           
                              
                                 
                                    i
                                    k
                                 
                                 =
                                 
                                    
                                       1000
                                    
                                    
                                       
                                          t
                                          
                                             max
                                          
                                       
                                       M
                                       C
                                       
                                          R
                                          I
                                       
                                       W
                                    
                                 
                                 
                                    i
                                    
                                       2
                                       ,
                                       k
                                    
                                 
                              
                           
                        
                     
                  

The following pseudo-code was used in the ‘hard-wired’ WBDev module for evaluating the differential equations via the above closed-form solution.
                        
                           
                              
                              
                              
                                 
                                    k=0;
                                    #1
                                 
                                 
                                    pre_state=(i1_0, i2_0)
                                    #2
                                 
                                 
                                    WHILE k≤Nt
                                    #3
                                 
                                 
                                    
                                       i1_p=pre_state[0];
                                    #4
                                 
                                 
                                    
                                       i2_p=pre_state[1];
                                    #5
                                 
                                 
                                    
                                       h=delta_t[i];
                                    #6
                                 
                                 
                                    
                                       u_k=I_infusion[i];
                                    #7
                                 
                                 
                                    
                                       #i1_k
                                    
                                 
                                 
                                    
                                       f10=(u_k/60.0) *t_x_I*(1-exp(-h/t_x_I));
                                    #8
                                 
                                 
                                    
                                       f11=exp(-h/t_x_I);
                                    #9
                                 
                                 
                                    
                                       i1_k=f10+f11*i1_p;
                                    #10
                                 
                                 
                                    
                                       #i2_k
                                    
                                 
                                 
                                    
                                       f20=f10-f11*u_k*h/60.0;
                                    #11
                                 
                                 
                                    
                                       f21=f11*h/t_x_I;
                                    #12
                                 
                                 
                                    
                                       f22=f11;
                                    #13
                                 
                                 
                                    
                                       i2_k=f20+f21*i1_p+f22*i2_p;
                                    #14
                                 
                                 
                                    
                                       pre_state[0]=i1_k;
                                    #15
                                 
                                 
                                    
                                       pre_state[1]=i2_k;
                                    #16
                                 
                                 
                                    
                                       I[k]=1/t_x_I*1000/(MCR_I*W)*i2_k;
                                    #17
                                 
                                 
                                    
                                       k=k+1;
                                    #18
                                 
                                 
                                    END WHILE;
                                    #19
                                 
                                 
                                    RETURN I;
                                    #20
                                 
                              
                           
                        
                     
                     
                        
                           •
                           Line 2: initialize values in the two compartments with i1_0, i2_0.

Line 3: loop over a list of time points where we want to calculate the exogenous plasma insulin concentration.

Lines 4–7: define current values of the two compartments, time interval between the current time point and the next, and the corresponding insulin infusion rate during this time interval.

Lines 8–16: update the two compartments’ values using the closed-form solution.

Line 17: calculate the exogenous plasma insulin concentration and store the value.

See Fig. A1
                     .

See Table A1
                     .

See Fig. A2
                     .

See Fig. A3
                     .

@&#REFERENCES@&#

