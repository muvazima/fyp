@&#MAIN-TITLE@&#Image tag refinement by regularized latent Dirichlet allocation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel regularized latent Dirichlet allocation approach to tag refinement is proposed.


                        
                        
                           
                           The proposed approach can explore the multiple-wise tag relations and visual relations.


                        
                        
                           
                           The tag relevance estimation using the proposed approach is interpreted in the form of the deep structure.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image tag refinement

Visual affinity

Regularized latent Dirichlet allocation

@&#ABSTRACT@&#


               
               
                  Tagging is nowadays the most prevalent and practical way to make images searchable. However, in reality many manually-assigned tags are irrelevant to image content and hence are not reliable for applications. A lot of recent efforts have been conducted to refine image tags. In this paper, we propose to do tag refinement from the angle of topic modeling and present a novel graphical model, regularized latent Dirichlet allocation (rLDA). In the proposed approach, tag similarity and tag relevance are jointly estimated in an iterative manner, so that they can benefit from each other, and the multi-wise relationships among tags are explored. Moreover, both the statistics of tags and visual affinities of images in the corpus are explored to help topic modeling. We also analyze the superiority of our approach from the deep structure perspective. The experiments on tag ranking and image retrieval demonstrate the advantages of the proposed method.
               
            

@&#INTRODUCTION@&#

The community-contributed multimedia content in the internet, such as Flickr, Picasa, Youtube and so on, has been exploding. To facilitate the organization of the uploaded images or videos, media repositories usually offer a tool to enable consumers to manually assign tags (a.k.a. labels) to describe the media content [1]. These assigned tags are adopted to index the images to help consumers access shared media content.

Reliable tagging results in making shared media more easily accessible to the public. However, the reliability of tagging is not guaranteed in that the tags may be noisy, orderless and incomplete [17], possibly due to carelessness of the taggers. First, some tags are noises and may be irrelevant to media. According to the statistics in Flickr, there are about only 50% tags indeed relevant to photos [17,10]. Second, different tags essentially have different relevance degrees to the media, but such information is not indicated in the current tag list, where the order is given according to the input sequence. We did an analysis on the MSRA-TAG dataset [24], which was crawled from Flickr, about what percentage of images have the most important tags in different positions. A statistics figure is shown in Fig. 1
                      to indicate the result. It can be observed from this statistics that less than 20% images have the most relevant tags at the top position, which shows that the tags are almost in a random order in terms of the relevance. Last, the tags of some photos are incomplete due to the interest limitation of taggers, and even not given.

We address the problem of refining the tags, to facilitate the access of the shared media. To be specific, we investigate the tagging problem in Flickr, one of the most popular photo sharing web sites, and propose to reorder the tags. The available information to refine the tags consists of manual tags and image affinity.
                        
                           1.
                           Although they are not completely reliable, the manual tags still reflect the photo content in some degree and their relations can be explored for tag refinement. Existing solutions only make use of the pairwise relation between tags, mined from WordNet [31], or estimated from Web photo tags [21,22,24,37].

Visually similar images usually tend to have similar semantics and hence have similar tags, which means that the tag refinement of one image may benefit from those of other images. The typical exploration [24,22] is to utilize the visual popularity of one image among the images having the same tag as a cue to estimate the relevance of the tag with this image.

In this paper, we present a novel probabilistic formulation, to estimate the relevance of a tag by considering all the other images and their tags. To this goal, we propose a novel model called regularized latent Dirichlet allocation (rLDA), which estimates the latent topics for each document, with making use of other documents. The model is applicable in tag refinement due to the observation that the content of an image essentially contains a few topics and the reasonable assumption that the tags assigned to the image accordingly form a few groups. The latent topics are estimated by viewing the tags of each image as a document, and the estimation also benefits from other visually similar images by the regularization term, instead of the estimation by LDA only from the corresponding document. The main contribution of our approach lies in the following aspects. On the one hand, both LDA and rLDA explore the multiple-wise relation among tags through the latent topics, rather than pairwise relations in the random walk based methods. On the other hand, the tag relevance estimation from rLDA can be interpreted using the deep structure [3,13]. Compared with random walk and LDA, our approach is the deepest, and the illustration is presented in Fig. 2
                     .

@&#RELATED WORK@&#

The automatic image tagging or annotation problem is usually regarded as an image classification task. Typical techniques [2,4,7,9,11,12,14,16,20,28,29,35] usually learn a generative/discriminative multi-class classifier from the training data, to construct a mapping function from low level features extracted from the images to tags, and then predict the annotations or tags for the test images. Later, a more precise formulation is presented to regard it as a multi-label classification problem by exploring the relations between multiple labels [15,30]. The automatic annotation techniques have shown great successes with small scale tags and the well-labeled training data. But in the social tags, e.g., image tags on Flickr, there exist noisy or low-relevance tags, and the vocabulary of tags is very large, which limits the performance of conventional automatic tagging techniques in social tagging. The study in [17] has shown that classifiers trained with Flickr images and associated tags got unsatisfactory performance and that tags provided by Flickr users actually contain noise. Moreover, the relevance degrees of the tags, i.e., the order of the tags, are not investigated in automatic annotation.

Various approaches have been developed to refine tags using the available tags and visual information. The following reviews some closely-related methods, and more discussions can be found from a survey [36]. The straightforward approach directly exploits the tag relation, e.g., co-occurrence relation mined from WordNet [26], or the internet, and then refines tags [31,37,19]. For example, the tag ambiguities are resolved [37] by finding two tags that appear in different contexts but are both likely to co-occur with the original tag set and then presenting such ambiguous tags to users for further clarification. The random walk approach over the pairwise graph on the provided tags with edges weighted by the tag similarities is presented in [33,24]. The visual information is proved very useful to help tag refinement. For example, the neighborhood voting approach [21] is to recommend the tags by exploring the tags of the visually similar images. The likelihood that a tag is associated with an image is computed in [33,24] from probabilistic models learnt the images assigned with such a tag, and then put it into the random walk framework for further refinement. A hybrid probabilistic model [41] is introduced to combine both collaborative and content based algorithms for tagging, which is similar to [24] in using the visual contents. A RankBoost based approach [38] is presented to learn a function to combine ranking features from multi-modalities, including tag and visual information. An optimization framework [23] is proposed to perform tag filter and enrichment by exploring visual similarity and additional knowledge from WordNet [26]. An approach [42] formulates the tag refinement problem as a decomposition of the user-provided tag matrix into a low-rank matrix and a sparse error matrix, targeting the optimality by low-rank, content consistency, tag correlation and error sparsity.

Rather than exploring the pairwise relation among tags, some techniques are proposed to adopt the multiple wise relations among tags, through latent models. Latent topic models, alternatives of latent Dirichlet allocation, is adopted [19,18,6] to learn a generative model from the tags, which then can estimate the posterior probability that a tag is associated with an image. Those methods are limited in lack of capabilities of adopting visual information. Therefore, this paper proposes a novel topic model, called regularized latent Dirichlet allocation, to estimate the topic models with exploiting the visual information. The latent topic based models are also justified by the conclusion in [31] that these tags assigned to images span a broad spectrum of the semantic space.

From the perspective of the deep learning theory [13], the random walk based approaches essentially estimate the tag relevance with a shallow structure, which only consists of two levels, the provided tags as the input level and the tag being considered as the output level. The LDA based approach is with a deep structure, introducing a latent topic level, which has potential to get better performance. The proposed regularized LDA model is deeper, with four levels, the tags associated with other images as the first level, the latent topics of other images and the tags of the image being considered as the second level, the latent topic as the third level, and the tag being considered as the output level.

The relational topic model [8] and the joint latent Beta composition model [34] are closely related to the proposed regularized LDA. But they are clearly different because our approach imposes the regularization over the topic distribution instead of the latent variables and moreover our approach deals multiple modalities and makes use of additional visual similarity to formulate the regularization term. Our approach is also different from topic models for image annotation [4,2,28,29]: The image tagging problem in our paper is more challenging than image annotation as aforementioned. and moreover the proposed regularized LDA aims to impose the consistency of tags within similar images while they are supervised algorithms [28,29] or aim to find common topics shared by tags and visual contents. This paper is different from the short version [39] because we present a formal derivation of our approach, introduce a new inference approach, conduct more experiments, and particularly, we use the deep network structure to analyze the benefit of regularized LDA.

The tag refinement problem is conceptually related to cross-media retrieval [40], in which the returned results can be of different modalities from the query. For example, the user can query images of an animal by submitting either its image or its sound [40]. Generally speaking, the two problems are differently defined: tagging problem is more like image recognition, while cross-media retrieval is to generalize content based image retrieval. They are similar in some aspect. Tag ranking can be regarded as a version of cross-media retrieval: the query is a specific media type, an image, and the result is an ordered list of another media type, tags. The scheme of applying tag ranking results to text-based image search can be viewed as a two-step approach to cross-media retrieval. Ideally, if images can be exactly tagged (annotated), the two-step approach will be more promising, while the text-image joint modeling approach to cross-media retrieval, e.g., finding the common hamming space for cross media [32], is more general as it can support both image and tag queries and even return a mixture of both texts and images. However, tag ranking belongs to a fundamental problem, image recognition, in computer vision and can benefit many applications, such as Google Goggles, fashion recognition, and so on, besides image search. The tag ranking result from our approach compared to projecting the tags and images into a common subspace as done in most cross-media retrieval algorithms are checkable and editable: the result can be easily checked and corrected by users. In addition, the tag ranking result can be easily deployed into current commercial image search engines that rely on texts to index the images and can also be combined with attributes for image search.

The input consists of an image corpus, M images 
                        
                           I
                           =
                           {
                           
                              
                                 I
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 I
                              
                              
                                 M
                              
                           
                           }
                        
                     , and M tag documents 
                        
                           W
                           =
                           {
                           
                              
                                 W
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 W
                              
                              
                                 M
                              
                           
                           }
                        
                     , with 
                        
                           
                              
                                 W
                              
                              
                                 k
                              
                           
                        
                      being the set of tags manually assigned to image 
                        
                           
                              
                                 I
                              
                              
                                 k
                              
                           
                        
                     . Here 
                        
                           
                              
                                 W
                              
                              
                                 k
                              
                           
                        
                      is defined, similarly to [5], as a sequence of 
                        
                           
                              
                                 N
                              
                              
                                 k
                              
                           
                        
                      words denoted by 
                        
                           
                              
                                 W
                              
                              
                                 k
                              
                           
                           =
                           {
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           }
                        
                     . 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      represents a word, an item from a vocabulary indexed by 
                        
                           {
                           1
                           ,
                           …
                           ,
                           V
                           }
                        
                     , and is a V-dimensional vector, with only one entry equal to 1 and all the other entries equal to 0, e.g., 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 v
                              
                           
                           =
                           1
                        
                      and 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 u
                              
                           
                           =
                           0
                        
                      for 
                        
                           u
                           
                           ≠
                           
                           v
                        
                      if 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      represents the v-th word. Besides, we use 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        
                      to represent the visual feature of image 
                        
                           
                              
                                 I
                              
                              
                                 k
                              
                           
                        
                     . The goal is to reorder the tags in each document, finding reordered tags 
                        
                           {
                           
                              
                                 w
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                           }
                        
                      with 
                        
                           {
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           }
                        
                      being a permutation of 
                        
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 N
                              
                              
                                 k
                              
                           
                           }
                        
                     , so that the tags on the top are semantically more relevant to the image.

Given the image corpus and the associated tag documents, we introduce a term, tag relevance, which is then used to reorder the tags. The tag relevance is inferred based on the joint probability, 
                        
                           P
                           (
                           
                              
                                 W
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 W
                              
                              
                                 d
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 W
                              
                              
                                 M
                              
                           
                           |
                           
                              
                                 I
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 I
                              
                              
                                 d
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 I
                              
                              
                                 M
                              
                           
                           )
                        
                     .

The manually-assigned tags, in some degree, describe the semantic content of an image, although it may contain noise, or not be complete. Hence, as a candidate solution, the relevance of each tag can be inferred from these tags. The joint probability over the tags 
                           
                              
                                 
                                    W
                                 
                                 
                                    d
                                 
                              
                           
                         of image 
                           
                              
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                           
                         is formulated as a pairwise Markov random field (MRF),
                           
                              (1)
                              
                                 P
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 ∝
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          ,
                                          j
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                          }
                                       
                                    
                                 
                                 P
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       di
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       dj
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              P
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    dj
                                 
                              
                              )
                           
                         is valuated from the tag relation. This model can be further interpreted by a random walk model. Specifically, a transition probability is defined from the tag relation as
                           
                              (2)
                              
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             di
                                          
                                       
                                       →
                                       
                                          
                                             w
                                          
                                          
                                             dj
                                          
                                       
                                    
                                 
                                 ∝
                                 sim
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       di
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       dj
                                    
                                 
                                 )
                                 .
                              
                           
                        Here 
                           
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          di
                                       
                                    
                                    →
                                    
                                       
                                          w
                                       
                                       
                                          dj
                                       
                                    
                                 
                              
                           
                         has been normalized such that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          di
                                       
                                    
                                    →
                                    
                                       
                                          w
                                       
                                       
                                          dj
                                       
                                    
                                 
                              
                              =
                              1
                           
                        . 
                           
                              sim
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    dj
                                 
                              
                              )
                           
                         is the similarity between 
                           
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    dj
                                 
                              
                           
                        , and may be computed from WordNet [31] or other methods [21,22,24,37]. Given this model, the stable distribution of this model, 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              [
                              P
                              (
                              
                                 
                                    w
                                 
                                 
                                    d
                                    1
                                 
                              
                              )
                              …
                              P
                              (
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          dN
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              )
                              ]
                           
                         is then used to evaluate the relevance of each tag.

The visual description of a tag, u, can be obtained from a set of images, 
                           
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              =
                              {
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              |
                              u
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , associated with that tag. Given an image I, the posteriori probability 
                           
                              p
                              (
                              u
                              |
                              I
                              )
                           
                         can be computed as follows,
                           
                              (3)
                              
                                 p
                                 (
                                 u
                                 |
                                 I
                                 )
                                 =
                                 
                                    
                                       p
                                       (
                                       I
                                       |
                                       u
                                       )
                                       p
                                       (
                                       u
                                       )
                                    
                                    
                                       p
                                       (
                                       I
                                       )
                                    
                                 
                                 ∝
                                 p
                                 (
                                 I
                                 |
                                 u
                                 )
                                 p
                                 (
                                 u
                                 )
                                 ,
                              
                           
                        where 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                           
                         can be estimated by 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                              =
                              p
                              (
                              I
                              |
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              )
                           
                         that can be computed using the kernel density estimation [24], e.g., 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                              ∝
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              K
                              (
                              I
                              ,
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . The scheme estimating the density can also be interpreted as the stable distribution of a random walk over the images 
                           
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                           
                        , where the transition probability is estimated from the kernel 
                           
                              K
                              (
                              I
                              ,
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . Without any bias for any tag, 
                           
                              p
                              (
                              u
                              )
                           
                         can be thought as a uniform distribution. To the end, 
                           
                              p
                              (
                              u
                              |
                              I
                              )
                              ∝
                              p
                              (
                              I
                              |
                              u
                              )
                           
                         can be used as the relevance of tag u for image I.

As a straightforward scheme exploring of both tag and visual cues, the relevances from the visual cue can be viewed as observations to the probability model over tags. Denote 
                           
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              )
                           
                         as the observations of tag 
                           
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                           
                        , the model can be written as
                           
                              (4)
                              
                                 P
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 ∝
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       di
                                    
                                 
                                 )
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          ,
                                          j
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                          }
                                       
                                    
                                 
                                 P
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       di
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       dj
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

It can also be interpreted as a random walk with restarts. The transition model is the same to Eq. (2). 
                           
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              )
                           
                         can be defined as 
                           
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              )
                              ∝
                              p
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              |
                              I
                              )
                           
                         with 
                           
                              p
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              |
                              I
                              )
                           
                         formulated in Eq. (3) and is normalized so that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    di
                                 
                              
                              )
                              =
                              1
                           
                        . It can be viewed as the restarts. The resulted approach includes two steps: relevance from visual cue and a random walk with restart over tags. The solution is essentially the fixed point 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              λ
                              
                                 
                                    T
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              +
                              (
                              1
                              -
                              λ
                              )
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              =
                              [
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    d
                                    1
                                 
                              
                              )
                              …
                              
                                 
                                    p
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          dN
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              )
                              ]
                           
                        . The two-step approach, presented in [24], can be cast into this formulation.

The above formulations actually consider each image independently, and as a result, tag relevances for each image can be estimated separately. In the computation of 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                              =
                              p
                              (
                              I
                              |
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              )
                           
                        , each image in the set, 
                           
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              =
                              {
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              |
                              u
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , is equivalently considered. In fact, an image is associated with several tags, and accordingly the typicality degree of each image to represent the tag may be different. Alternatively, the tag relevance can be jointly estimated by considering a joint probability,
                           
                              (5)
                              
                                 P
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       M
                                    
                                 
                                 )
                                 ∝
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   u
                                                   ,
                                                   v
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          P
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                du
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                dv
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                d
                                             
                                          
                                          |
                                          u
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        where the first term corresponds to the pairwise MRF, and the second term is from the visual constraint and can be viewed as the visual regularization. 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                           
                        , can be furthermore written as 
                           
                              p
                              (
                              I
                              |
                              u
                              )
                              =
                              p
                              (
                              I
                              |
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    u
                                 
                              
                              )
                              ∝
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    u
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              )
                              K
                              (
                              I
                              ,
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        , (viewed as a weighted random walk model) where 
                           
                              
                                 
                                    A
                                 
                                 
                                    u
                                 
                              
                              =
                              {
                              
                                 
                                    a
                                 
                                 
                                    u
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              )
                              |
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              }
                           
                         is a set of weights, with each corresponding to the typicality degree of each image and estimated as 
                           
                              P
                              (
                              I
                              |
                              u
                              )
                           
                        . To the end, the solution of the approach can be equivalently obtained by solving a fixed point problem,
                           
                              (6)
                              
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ·
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 λ
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ·
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 (
                                 1
                                 -
                                 λ
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ·
                                    
                                    
                                       o
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ·
                                       u
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       u
                                    
                                    
                                       w
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ·
                                       u
                                    
                                    
                                       o
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    T
                                 
                                 
                                    u
                                 
                                 
                                    w
                                 
                              
                              ∝
                              diag
                              (
                              
                                 
                                    p
                                 
                                 
                                    ·
                                    u
                                 
                                 
                                    s
                                 
                              
                              )
                              P
                           
                         is a weighted transition matrix, with 
                           
                              P
                           
                         corresponding to the pairwise probability 
                           
                              P
                              (
                              
                                 
                                    w
                                 
                                 
                                    du
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    dv
                                 
                              
                              )
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ·
                                    u
                                 
                                 
                                    o
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    d
                                    ·
                                 
                                 
                                    o
                                 
                              
                           
                         are the observation probability vectors, a column vector and a row vector of 
                           
                              P
                              =
                              
                                 
                                    [
                                    p
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    u
                                    )
                                    ]
                                 
                                 
                                    M
                                    ×
                                    V
                                 
                              
                           
                        normalized w.r.t. image set and tag set, respectively.

The aforementioned approach builds the relationship among the tags, using the pairwise framework, which is lack of the ability to describe the multiple wise relations among tags. However, we observed that the relation among tags is beyond pairwise and that some tags may have closed relations and the tags associated with one image form several meaningful cliques. To make use of the multiple wise relations, we introduce a topic model to construct the tag relation, which uses latent topic variables to connect the tags for building the multiple wise relationships. Moreover, rather than separately building the topic model independently for each image, we propose a novel approach to jointly model the images together based on the observation that visually similar images should have similar semantic contents, To this goal, we introduce smoothness terms over the latent topics of images.

Latent Dirichlet allocation (LDA) is a generative probabilistic model of a corpus, e.g., a set of documents. The basic idea is that documents are represented as random mixtures over latent topics, where each topic is characterized by a distribution over tags (words), or intuitively is viewed as a group of soft (partially weighted) tags. LDA is a special directed graphical model (a.k.a. Bayesian network), and its graphical representation is shown in Fig. 3
                           (a). In this graphical model, 
                              
                                 z
                              
                            is a topic vector of length k, with k being the number of latent topics, where it corresponds to the i topic if 
                              
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                            and 
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 j
                                 
                                 ≠
                                 
                                 i
                              
                           . 
                              
                                 θ
                              
                            is a k-dimensional vector, the parameter of the multinomial distribution. 
                              
                                 α
                              
                            is the Dirichlet parameter, a vector of k positive reals. Matrix 
                              
                                 β
                              
                           , of dimension 
                              
                                 k
                                 ×
                                 V
                              
                           , is used to parameterize the tag-topic probability, where 
                              
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 )
                              
                           .

It can be interpreted as a generative process for each document 
                              
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                              
                            as follows.
                              
                                 1.
                                 Choose 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ∼
                                          Dir
                                          (
                                          α
                                          )
                                       
                                    .

For each of the 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                     tags 
                                       
                                          
                                             
                                                w
                                             
                                             
                                                dn
                                             
                                          
                                       
                                    ,
                                       
                                          (a)
                                          Choose a topic 
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                   ∼
                                                   Multinomial
                                                   (
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                             .

Choose a tag 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                
                                              from 
                                                
                                                   p
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                   ;
                                                   β
                                                   )
                                                
                                             , a multinomial probability conditioned on the topic 
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                
                                             .

In the graphical representation, there are three levels. The parameters 
                              
                                 α
                              
                            and 
                              
                                 β
                              
                            are corpus level parameters, assumed to be sampled once in the generative process for a single corpus. The variable 
                              
                                 θ
                              
                            is a document-level (image-level) variable sampled for each document (image). Finally, the variables 
                              
                                 
                                    
                                       z
                                    
                                    
                                       dn
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       dn
                                    
                                 
                              
                            are word-level (tag-level) variables, sampled once for each word in each document.

The goal to use LDA here is to mine the latent topic distribution for a given document 
                              
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                              
                           , 
                              
                                 p
                                 (
                                 θ
                                 |
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 α
                                 ,
                                 β
                                 )
                              
                           . The topic distribution can be obtained by integrating out other latent variables 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                              
                            over the posterior distribution, 
                              
                                 p
                                 (
                                 θ
                                 ,
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 }
                                 |
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 α
                                 ,
                                 β
                                 )
                              
                           . This distribution is intractable to compute in general. The approximate inference algorithms, e.g., Markov chain Monte Carlo and variational inference, can be used to tackle this problem. The variational inference algorithm introduces a variational distribution,
                              
                                 
                                    q
                                    (
                                    θ
                                    ,
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    |
                                    γ
                                    ,
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    )
                                    =
                                    q
                                    (
                                    θ
                                    |
                                    γ
                                    )
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    q
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          n
                                       
                                    
                                    |
                                    
                                       
                                          ϕ
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where the Dirichlet parameter 
                              
                                 γ
                              
                            and the multinomial parameters 
                              
                                 {
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 }
                              
                            are the free variational parameters. The variational parameters can be obtained from the following optimization problem:
                              
                                 (8)
                                 
                                    γ
                                    ∗
                                    ,
                                    {
                                    ϕ
                                    
                                       
                                          ∗
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    ϕ
                                    
                                       
                                          ∗
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    =
                                    arg
                                    
                                       
                                          
                                             min
                                          
                                          
                                             γ
                                             ,
                                             {
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                       
                                    
                                    KL
                                    (
                                    q
                                    (
                                    θ
                                    ,
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    |
                                    γ
                                    ,
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    )
                                    |
                                    |
                                    p
                                    (
                                    θ
                                    ,
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    }
                                    |
                                    
                                       
                                          W
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    α
                                    ,
                                    β
                                    )
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 KL
                                 (
                                 q
                                 (
                                 ·
                                 )
                                 |
                                 p
                                 (
                                 ·
                                 )
                                 )
                              
                            is the Kullback–Leibler (KL) divergence between the variational distribution 
                              
                                 q
                                 (
                                 ·
                                 )
                              
                            and the true posterior 
                              
                                 p
                                 (
                                 ·
                                 )
                              
                           . Fig. 3(b) illustrates this variational distribution. This minimization can be achieved via an iterative fixed-point method. The update equations are as follows,
                              
                                 (9)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ni
                                       
                                    
                                    ∝
                                    
                                       
                                          β
                                       
                                       
                                          iv
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                    
                                    exp
                                    {
                                    
                                       
                                          E
                                       
                                       
                                          q
                                       
                                    
                                    [
                                    log
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    |
                                    γ
                                    ]
                                    }
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          ni
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 v
                                 (
                                 w
                                 )
                              
                            is a function that maps a vector representation of a word to an index in the vocabulary.

In the LDA model, two model parameters, 
                              
                                 α
                              
                            and 
                              
                                 β
                              
                           , can be estimated from the given corpus of documents, 
                              
                                 W
                              
                           , by maximizing the following log likelihood,
                              
                                 (11)
                                 
                                    L
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    log
                                    p
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    α
                                    ,
                                    β
                                    )
                                    .
                                 
                              
                           
                        

Here, 
                              
                                 p
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                                 |
                                 α
                                 ,
                                 β
                                 )
                              
                            can be efficiently estimated by an expectation–maximization (EM) algorithm [5].

Given this topic model, the relevance of a tag 
                              
                                 w
                              
                            for each image is formulated as the probability conditioned on the set of tags 
                              
                                 W
                              
                            associated with this image. It is mathematically formulated as
                              
                                 (12)
                                 
                                    p
                                    (
                                    w
                                    |
                                    W
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    W
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    W
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ∫
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    θ
                                    |
                                    W
                                    )
                                    d
                                    θ
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ∫
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    θ
                                    )
                                    p
                                    (
                                    θ
                                    |
                                    W
                                    )
                                    d
                                    θ
                                    ≈
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ∫
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    θ
                                    )
                                    q
                                    (
                                    θ
                                    |
                                    γ
                                    )
                                    d
                                    θ
                                    .
                                 
                              
                           The computation of this conditional distribution can be illustrated by a graphical model shown in Fig. 2(b). From the analysis, it can be observed that the relations between tags are built using the latent variables that is beyond the pairwise relation, illustrated in Fig. 2(a), and can capture the group information.

In the LDA model discussed above, the distribution of topics for each image is estimated separately. However, the tags associated with one image may be incomplete and noisy. Consequently, the distribution of topics is not well estimated, which influences the relevance of tags. It is observed that visually similar images usually have the same semantic content. To utilize this property, we introduce a regularization term over the semantic content. Rather than imposing this over tags directly, we impose it over the latent topics because tags are sometimes too ambiguous for specifying a concept, while topics usually have clearly conceptual meanings.

The straightforward solution to impose the regularization over topics is a two-step sequential scheme: first estimate the distribution of topics for each image, and then to smooth the distribution by considering the distributions of visually similar images. Instead, we propose a collective inference scheme to estimate the distribution of latent topics. To this goal, we build a joint distribution over all the images, called regularized latent Dirichlet allocation (rLDA). This joint distribution is shown in Fig. 4
                        . Different from the latent Dirichlet allocation model, the topics over different images are connected by an extra regularization model, which is defined over the topics of a pair of images.

It can be interpreted as a generative process over the documents as follows.
                           
                              1.
                              For each of the M documents 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       (a)
                                       Choose 
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ∼
                                                Dir
                                                (
                                                α
                                                )
                                             
                                          .

For each of the 
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                           tags 
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      dn
                                                   
                                                
                                             
                                          ,
                                             
                                                i.
                                                Choose a topic 
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                         ∼
                                                         Multinomial
                                                         (
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                         )
                                                      
                                                   .

Choose a tag 
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                      
                                                    from 
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                         ;
                                                         β
                                                         )
                                                      
                                                   , a multinomial probability conditioned on the topic 
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                      
                                                   .

For each of the set of document pairs 
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             W
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       (a)
                                       Choose 
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ∼
                                                Multinomial
                                                (
                                                R
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                          .

Choose a visual similarity 
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ∼
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                μ
                                                ,
                                                σ
                                                )
                                             
                                          , a Gaussian probability conditioned on the latent relation topic 
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          .

The basic idea of the regularization is to align visual similarities with topic similarities between two images. To be specific, it is to classify the two images into two categories that show whether the two images have the same semantic content, and to align the classification result from the topic distribution with that from the visual content.

The latent variable 
                              
                                 τ
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                            , called relational indicator, is a 2-dimensional binary-valued vector, 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       τ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                              
                           . 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                              
                            indicates that the two images are regarded to have the same topics, and otherwise, the two images do not have the same topics. It satisfies a multinomial distribution, 
                              
                                 Multinomial
                                 (
                                 R
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 )
                              
                           , where 
                              
                                 R
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             
                                                
                                                   dd
                                                
                                                
                                                   ′
                                                
                                             
                                             1
                                          
                                       
                                       1
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             
                                                
                                                   dd
                                                
                                                
                                                   ′
                                                
                                             
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                       1
                                    
                                 
                              
                           , the probability of 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                              
                           , is defined to describe the similarity between two topics. In essence, 
                              
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                            reflects the probabilities that the two images are recognized to have the save topics or not. For example, 
                              
                                 R
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                            can be defined as 
                              
                                 
                                    
                                       [
                                       HI
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       1
                                       -
                                       HI
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                           , where 
                              
                                 HI
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                                 min
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       dk
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       k
                                    
                                 
                                 )
                              
                            is a histogram intersection over two topic distributions, 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           .

In this model, 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , an observed variable, is the visual similarity between two images 
                              
                                 
                                    
                                       I
                                    
                                    
                                       d
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           . 
                              
                                 μ
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                            and 
                              
                                 σ
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                            are 2-dimensional vectors, and are used to describe two Gaussian distributions, 
                              
                                 N
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            and 
                              
                                 N
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , which correspond to the conditional probabilities of the visual similarity, conditioned on whether the two images have same semantic content. It can be easily derived that 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                              
                            since the larger the visual similarity, the larger the probability that the two images have the same semantic content.

The probability of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , conditioned on the topic distribution, is given as follows,
                              
                                 (14)
                                 
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    μ
                                    ,
                                    σ
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   
                                                      
                                                         dd
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          τ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    μ
                                    ,
                                    σ
                                    )
                                    p
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    )
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

We analyze the relation between visual similarity 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            and topic similarity 
                              
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                            in a bidirectional way. Given the topic distribution, 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , we can obtain
                              
                                 (15)
                                 
                                    E
                                    [
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    μ
                                    ,
                                    σ
                                    ]
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                          1
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          r
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

This indicates that the expectation of the visual similarity is larger when the topic similarity is larger. This is more reasonable and more robust to noise, compared with the direct requirement that the visual similarity is larger when the topic similarity is larger, because of the gap between visual contents and semantics.

Given the visual similarity, 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , the posterior that the two images have the same content is computed by
                              
                                 
                                    P
                                    (
                                    τ
                                    =
                                    1
                                    |
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          (
                                          1
                                          -
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          )
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

Suppose we expect that the two image have the same content when 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . This leads to that
                              
                                 (16)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                          1
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    >
                                    (
                                    1
                                    -
                                    
                                       
                                          r
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                          1
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ,
                                 
                              
                           in the case 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . This further means that
                              
                                 (17)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                          1
                                       
                                    
                                    >
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    >
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    >
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         
                                                            
                                                               dd
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                |
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

From the above analysis, it can be concluded that the topic similarity must be larger than some constant value in order to align it with the classification result from visual similarity. This is a relaxant requirement since it does not require that the topic similarity must be larger if the visual similarity is larger, and hence also more reasonable because there is some gap between visual and semantic contents.

Let us first look at a possible solution, the variational inference technique that is used in LDA [5] to estimate the posterior distribution of the latent variables:
                              
                                 (18)
                                 
                                    p
                                    (
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    ,
                                    
                                       
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                       
                                       
                                          dn
                                       
                                    
                                    ,
                                    
                                       
                                          {
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    α
                                    ,
                                    β
                                    ,
                                    μ
                                    ,
                                    σ
                                    ;
                                    {
                                    
                                       
                                          w
                                       
                                       
                                          dn
                                       
                                    
                                    }
                                    ,
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    }
                                    )
                                    =
                                    
                                       
                                          p
                                          (
                                          {
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          }
                                          ,
                                          
                                             
                                                {
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            dn
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            dn
                                                         
                                                      
                                                      }
                                                   
                                                   
                                                      n
                                                   
                                                
                                                }
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                {
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            dd
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          α
                                          ,
                                          β
                                          ,
                                          μ
                                          ,
                                          σ
                                          )
                                       
                                       
                                          p
                                          (
                                          {
                                          
                                             
                                                w
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                          ,
                                          {
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          }
                                          |
                                          α
                                          ,
                                          β
                                          ,
                                          μ
                                          ,
                                          σ
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

We introduce the following variational distribution
                              
                                 (19)
                                 
                                    q
                                    (
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    ,
                                    
                                       
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                       
                                       
                                          dn
                                       
                                    
                                    ,
                                    
                                       
                                          {
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    {
                                    
                                       
                                          γ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    ,
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          dn
                                       
                                    
                                    }
                                    ,
                                    {
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    }
                                    )
                                    =
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    [
                                    q
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    
                                       
                                          γ
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    q
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          dn
                                       
                                    
                                    |
                                    
                                       
                                          ϕ
                                       
                                       
                                          dn
                                       
                                    
                                    )
                                    ]
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             
                                                
                                                   dd
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    q
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where the Dirichlet parameter 
                              
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       d
                                    
                                 
                                 }
                              
                           , the multinomial parameters 
                              
                                 {
                                 
                                    
                                       ϕ
                                    
                                    
                                       dn
                                    
                                 
                                 }
                              
                           , and the Dirichlet parameters 
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 }
                              
                            are the free variational parameters. These variational parameters can be obtained by solving the following optimization problem
                              
                                 (20)
                                 
                                    {
                                    γ
                                    
                                       
                                          ∗
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    ,
                                    {
                                    ϕ
                                    
                                       
                                          ∗
                                       
                                       
                                          dn
                                       
                                    
                                    }
                                    {
                                    ρ
                                    
                                       
                                          ∗
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    }
                                    =
                                    arg
                                    
                                       min
                                    
                                    KL
                                    (
                                    q
                                    |
                                    |
                                    p
                                    )
                                    .
                                 
                              
                           This optimization problem can be solved via an iterative fixed-point method. For 
                              
                                 ϕ
                              
                            and 
                              
                                 ρ
                              
                           , we can have the following update equations,
                              
                                 (21)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          dni
                                       
                                    
                                    ∝
                                    
                                       
                                          β
                                       
                                       
                                          i
                                          
                                             
                                                w
                                             
                                             
                                                dn
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             Ψ
                                             (
                                             
                                                
                                                   γ
                                                
                                                
                                                   di
                                                
                                             
                                             )
                                             -
                                             Ψ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               K
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            dj
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ddi
                                       
                                    
                                    ∝
                                    exp
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          q
                                       
                                    
                                    [
                                    log
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    ]
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                2
                                                π
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               dd
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           For 
                              
                                 γ
                              
                           , there is no closed-form solution. The gradient decent based solution requires the computation of 
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             q
                                          
                                       
                                       [
                                       log
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       ∂
                                       
                                          
                                             γ
                                          
                                          
                                             di
                                          
                                       
                                    
                                 
                              
                           , which is intractable.

In order to make the inference feasible, instead, we propose a hybrid sampling based approach, which iteratively samples two latent variables 
                              
                                 
                                    
                                       z
                                    
                                    
                                       dn
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            and computes the conditional expectation, 
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 E
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 |
                                 Θ
                                 -
                                 {
                                 
                                    
                                       θ
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 )
                              
                           :
                              
                                 1.
                                 Sample 
                                       
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                       
                                     from the conditional distribution 
                                       
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          |
                                          Θ
                                          -
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                          )
                                          ∝
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                dn
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          )
                                       
                                    .

This is depicted in Fig. 5
                                    (a).

Sample 
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                     from the conditional distribution 
                                       
                                          p
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          Θ
                                          -
                                          {
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          }
                                          )
                                          ∝
                                          p
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    . This is depicted in Fig. 5(b).

Compute the conditional expectation 
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          =
                                          E
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          |
                                          Θ
                                          -
                                          {
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          }
                                          )
                                       
                                    . This is depicted in Fig. 5(c).

From the definition, 
                              
                                 
                                    
                                       z
                                    
                                    
                                       dn
                                    
                                 
                              
                            is a discrete vector with only one entry being 1 and all the others being 0, thus sampling 
                              
                                 
                                    
                                       z
                                    
                                    
                                       dn
                                    
                                 
                              
                            is straightforward. Similarly, sampling 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            is also straightforward.

We propose to adopt the importance sampling approach to compute the conditional expectation 
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                              
                           . The conditional probability can be calculated as below,
                              
                                 (23)
                                 
                                    p
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    Θ
                                    -
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    )
                                    ∝
                                    p
                                    (
                                    θ
                                    |
                                    α
                                    )
                                    p
                                    (
                                    
                                       
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                       
                                       
                                          n
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          
                                             
                                                dd
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

We use 
                              
                                 p
                                 (
                                 θ
                                 |
                                 α
                                 )
                              
                           , which can be easily sampled, as the proposal function. The conditional expectation is computed as follows,
                              
                                 (24)
                                 
                                    E
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    Θ
                                    -
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    )
                                    =
                                    ∫
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    Θ
                                    -
                                    {
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    )
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          |
                                          α
                                          )
                                          p
                                          (
                                          
                                             
                                                {
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      dn
                                                   
                                                
                                                }
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          )
                                          
                                             
                                                ∏
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          d
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          ∫
                                          p
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          |
                                          α
                                          )
                                          p
                                          (
                                          
                                             
                                                {
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      dn
                                                   
                                                
                                                }
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          )
                                          
                                             
                                                ∏
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                
                                                   
                                                      dd
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          )
                                          d
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    ≈
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         {
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∏
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         
                                                            
                                                               dd
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         {
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               dn
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∏
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         
                                                            
                                                               dd
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                θ
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Given the expectations 
                              
                                 {
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 }
                              
                            of all the documents, 
                              
                                 α
                              
                            can be estimated by maximizing the likelihood,
                              
                                 (25)
                                 
                                    p
                                    (
                                    {
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    }
                                    ;
                                    α
                                    )
                                    =
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          Γ
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∏
                                             
                                             
                                                k
                                             
                                          
                                          Γ
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

The maximization problem can be solved by a fixed-point iteration [27].

Given samples 
                              
                                 
                                    
                                       {
                                       
                                          
                                             z
                                          
                                          
                                             dn
                                          
                                       
                                       }
                                    
                                    
                                       dn
                                    
                                 
                              
                           , 
                              
                                 β
                              
                            can also be estimated by maximizing the likelihood,
                              
                                 (26)
                                 
                                    p
                                    (
                                    
                                       
                                          {
                                          
                                             
                                                w
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                       
                                       
                                          dn
                                       
                                    
                                    |
                                    
                                       
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                dn
                                             
                                          
                                          }
                                       
                                       
                                          dn
                                       
                                    
                                    ;
                                    β
                                    )
                                    =
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             dn
                                          
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          dn
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          dn
                                       
                                    
                                    ;
                                    β
                                    )
                                    .
                                 
                              
                           
                        

Here, 
                              
                                 β
                              
                            can be regarded as a Markov matrix from 
                              
                                 z
                              
                            to 
                              
                                 w
                              
                            that can be easily computed.

Given samples 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , the Gaussian parameters, 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                              
                           , can be easily estimated from visual similarities 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           .

In a summary, given the observations, tags 
                              
                                 W
                              
                            associated with visual similarities 
                              
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             dd
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 }
                              
                           , the whole algorithm is an iterative scheme in which each iteration consists of latent variable inference (Section 4.2.2) and model parameter estimation (this section).

In the rLDA, we can estimate the tag relevance jointly using the information from the image and the information from other images. The relevance of a tag 
                              
                                 w
                              
                            for one image is formulated as the probability conditioned on the set of tags 
                              
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                              
                            associated with this image, and other sets of tags 
                              
                                 W
                                 -
                                 
                                    
                                       W
                                    
                                    
                                       d
                                    
                                 
                              
                           . It is mathematically formulated as
                              
                                 (27)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          
                                             w
                                             |
                                             
                                                
                                                   {
                                                   W
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   {
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    
                                       
                                          
                                             w
                                             ,
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             |
                                             
                                                
                                                   {
                                                   W
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   {
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    p
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                             |
                                             
                                                
                                                   {
                                                   W
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   {
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ∫
                                    p
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   d
                                                
                                             
                                             |
                                             
                                                
                                                   {
                                                   W
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   {
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ∫
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    p
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   d
                                                
                                             
                                             |
                                             
                                                
                                                   {
                                                   W
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   {
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   }
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          d
                                       
                                    
                                    ≈
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                    p
                                    (
                                    w
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ¯
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    .
                                 
                              
                           The computation of tag relevance is similar to that in LDA. Differently, this approximation is obtained by jointly considering the information from the other images. The tag relevance model is illustrated using a graphical representation in Fig. 2(c).

@&#EXPERIMENTS@&#

Our experiments are conducted over two datasets: the MSRA-TAG dataset [24] and the NUS-WIDE-LITE dataset [10]. The MSRA-TAG dataset consists of 50,000 images and their associated tags that are downloaded from Flickr using ten popular tags, including cat, automobile, mountain, water, sea, bird, tree, sunset, flower and sky. 13,330 distinctive tags are obtained after filtering out the misspelling and meaningless tags. Similar to [24], for quantitative evaluation, 8029 images are randomly selected from the dataset and manually labeled to build the ground truth. The statistics about the number of tags associated with images is shown in Fig. 6
                           , and the average number is 6.15. For each image, we ask volunteers to mark the relevance of each tag with a score, ranging from 1 (the least relevant) to 5 (the most relevant). We perform the tag reranking task over this dataset.

The NUS-WIDE-LITE dataset [10] consists of 27,808 images with tags provided by users. 1000 filtered tags that appeared the most frequently were used. We perform the image retagging task over this dataset. The statistics about the number of tags associated with images is shown in Fig. 7
                           , and the average number is 7.34. In our experiments, the top 5 tags with the highest scores are chosen as the new tags of the image and the performance of algorithms is evaluated on 81 tags where the ground truth for these tags are provided in [10].

@&#EVALUATION@&#

The task of tag reranking is to rank the original tags of an image according to their relevances. The confidence scores for the tags are produced and are used to rerank the tags. The normalized discounted cumulative gain (NDCG) measurement is adopted as the evaluation measure, which is calculated as 
                              
                                 
                                    
                                       NDCG
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       r
                                       (
                                       i
                                       )
                                    
                                 
                                 -
                                 1
                                 )
                                 /
                                 log
                                 (
                                 1
                                 +
                                 i
                                 )
                              
                           , where 
                              
                                 r
                                 (
                                 i
                                 )
                              
                            is the relevance score of the i-th tag and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       n
                                    
                                 
                              
                            is a normalization constant that is chosen so that the NDCG score of the optimal ranking is 1. We use the average of the NDCG scores of all the images to compare the performance.

In the task of image retagging, each image is assigned a number of tags. The assigned tags can be either original tags or new tags that are not among the originals. The top 5 tags with the highest scores are chosen as the retagging results of the image. We have the ground truth of 81 tags, where whether each image in the dataset is related to these tags is provided. Similar to [25], we perform a retrieval process based on retagging results and evaluate the average F-measure of 81 tags to compare the performance. The F-measure is calculated as 
                              
                                 
                                    
                                       2
                                       ×
                                       precision
                                       ×
                                       recall
                                    
                                    
                                       precision
                                       +
                                       recall
                                    
                                 
                              
                           , where 
                              
                                 precision
                              
                            and 
                              
                                 recall
                              
                            are computed form the returned retrieval list.

@&#METHODS@&#

To evaluate the performance of our approach, regularized LDA (rLDA), for tag refinement, we also report the experimental results of existing state-of-the-art approaches.
                           
                              1.
                              BaseLine. The score is computed based on the original tag ranking provided by users according to the uploading time.

Random walk with restart (RWR) [33]. This method performs a random walk process on a graph that encodes the relationship between tags. It only uses the text information without using the visual information.

Tag ranking based on visual and semantic consistency (TRVSC) [24]. This work follows RWR [33] using a random walk based method. The difference is that when constructing the graph over tags TRVSC considers the visual similarity between images.

Tag refinement based on low-rank, content-tag prior and error sparsity (LRCTPES) [42]. This approach formulates the tag refinement problem as a decomposition of the user-provided tag matrix into a low-rank matrix and a sparse error matrix, targeting the optimality by low-rank, content consistency, tag correlation and error sparsity.

Collaborative retagging (CRT) [25]. The CRT process is formulated as a multiple graph-based multi-label learning problem. This work also proposes a tag-specific visual sub-vocabulary learning method. In our implementation we did not use the sub-vocabulary part because we focus mainly on the approach of rag refinement, not feature extraction. The parameters of CRT are tuned using the grid search method in [25].

Separate retagging (SRT). SRT performs the same method as CRT [25], but without considering tag similarity. We also use the grid search method described in [25] to find the best parameters.

Latent Dirichlet Allocation (LDA) [5]. We perform LDA by considering each image as a document and each tag as a word.

In our experiments, all the approaches use the same visual features, a 225-dimensional block-wise color moment. The visual similarity is calculated as 
                           
                              
                                 
                                    s
                                 
                                 
                                    ij
                                 
                              
                              =
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             ‖
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             γ
                                          
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                         is the visual feature of image 
                           
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              γ
                              =
                              9
                              E
                              [
                              ‖
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                         with 
                           
                              E
                           
                         being the expectation operator. Two images are connected in the rLDA model only when their similarity is higher than 
                           
                              0.2
                           
                        .

The results of tag reranking are reported in Fig. 8
                           . It can be observed that all approaches perform better results than the baseline result. It demonstrates that tag refinement is a useful process. Among these methods, RWR and LDA are based on the tag information and do not take into account of the visual information. SRT only uses the visual information. TRVSC, LRCTPES, CRT and rLDA make use of both the textual and visual information. We can see that both the textual information and the visual information can make great contributions to tag refinement. Though LDA does not use the visual information, it outperforms most of other methods, showing the significant benefit of jointly estimating the tag similarity and the tag relevance and the powerfulness of exploring multi-wise relationships using the topic model. Our approach, rLDA, further improves LDA by encouraging visually similar images having similar topic distributions. The superiority of rLDA over LDA justifies our analysis that rLDA is deeper than LDA illustrated in Fig. 2.

The superior performance of our approach can be justified from the deep learning theory [13], which shows that a deeper network has large potentials to achieve better performance. By comparison, the random walk based approaches essentially use shallow structures, which only consists of two levels, the provided tags as the input level and the tag being considered as the output level. The LDA based approach is with a deep structure, introducing a latent topic level, which has potential to get better performance. The proposed regularized LDA model is deeper, with four levels, the tags associated with other images as the first level, the latent topics of other images and the tags of the image being considered as the second level, the latent topic as the third level, and the tag being considered as the output level. The comparison has been illustrated in Fig. 2.

To illustrate the superiority of rLDA over LDA clearer, we compare their performances using different numbers of topics, K, which are shown in Fig. 9
                           . We have at least two observations. The first one is that taking visual information into account can be effective for the tag refinement task from the fact that rLDA consistently outperforms LDA on different number of topics. The second one is that the performances of both methods begins to decrease when K grows too large. This is reasonable. Considering the extreme case that 
                              
                                 K
                                 ⩾
                                 V
                              
                           , it can be validated that it will overfit the data distribution if setting each word as a single topic, which indicates that the relations among tags tend to be useless when K is too large.

To understand our approach more deeply, we report the percentage of the images in which the truly most relevant tag is ranked in different positions in Fig. 10
                           . We can see that over 60 percent of the images have their most relevant tag at the first position. This can be helpful for related works like image retrieval, and group recommendation. Some examples of refined tags are depicted in Fig. 11
                           . In addition, experiments show that one latent topic might be related to several concepts. For instance, one topic that has the largest probability of generating tree has also large probability of generating nature. The topic that has the largest probability of generating sunset has also large probability of generating nature. The 2nd image in the 2nd row in Fig. 11 is such an example.

Different from tag reranking, retagging [25] aims to suggest a set of tags that are assigned according to the original tags. These tags may not necessarily be contained in the original tags. In this task, the results of five methods, SRT, LRCTPES, CRT, LDA and our approach, are reported. Other methods based on random walks only produce scores for original tags and cannot perform the retagging task Fig. 12
                         shows the experiment results.

The retagging results of all methods outperformed the base line that is based on the original tag list. This demonstrates that image retagging can make significant contributions for image retrieval. In the image retagging task LDA does not perform as good as in the tag reranking task. This is because LDA is unable to deal well with the images with a few tags (the average number of tags is around 7 as aforementioned) and the images without tags provided by users, while methods using visual features can tag the images using the tags of similar images and weakens the effect brought by short documents. Improving LDA with using visual content of images, our method, rLDA, gets the best result. In both tag reranking and image retagging tasks, the proposed method performs the best, which is because our model is based on a deeper structure and can exploit the semantic information derived from the topic level.

@&#CONCLUSION@&#

This paper presents a regularized latent Dirichlet allocation approach for tag refinement. Our approach succeeds from the factors: (1) our approach explores the multi-wise relationship among the tags that are mined from both textual and visual information; (2) our approach explores a deep structure that has large capability to refine tags. Experimental results also demonstrate the superiority of our approach over existing state-of-the-art approaches for tag refinement.

@&#REFERENCES@&#

