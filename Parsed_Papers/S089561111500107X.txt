@&#MAIN-TITLE@&#Mass-spring systems for simulating mitral valve repair using 3D ultrasound images

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We present a mass-spring model for simulating mitral valve repair.


                        
                        
                           
                           The patient-specific model geometry is based on pre-surgical 3D TEE images.


                        
                        
                           
                           We use a rest-length estimation algorithm for modeling of the tendinous cords.


                        
                        
                           
                           A comparison with post-surgical 3D TEE images proves the feasibility of our approach.


                        
                        
                           
                           Our simulation is faster than comparable state-of-the-art finite-element simulations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Mitral valve annuloplasty

Patient-specific anatomy

Mass-spring model

Image-based therapy planning

@&#ABSTRACT@&#


               
               
                  Mitral valve (MV) diseases are among the most common types of heart diseases, while heart diseases are the most common cause of death worldwide. MV repair surgery is connected to higher survival rates and fewer complications than the total replacement of the MV, but MV repair requires extensive patient-specific therapy planning. The simulation of MV repair with a patient-specific model could help to optimize surgery results and make MV repair available to more patients. However, current patient-specific simulations are difficult to transfer to clinical application because of time-constraints or prohibitive requirements on the resolution of the image data. As one possible solution to the problem of patient-specific MV modeling, we present a mass-spring MV model based on 3D transesophageal echocardiographic (TEE) images already routinely acquired for MV repair therapy planning. Our novel approach to the rest-length estimation of springs allows us to model the global support of the MV leaflets through the chordae tendinae without the need for high-resolution image data. The model is used to simulate MV annuloplasty for five patients undergoing MV repair, and the simulated results are compared to post-surgical TEE images. The comparison shows that our model is able to provide a qualitative estimate of annuloplasty surgery. In addition, the data suggests that the model might also be applied to simulating the implantation of artificial chordae.
               
            

@&#INTRODUCTION@&#

@&#MOTIVATION@&#

Heart diseases are the most common cause of death worldwide [40], and the mitral valve is most often affected by valvular diseases [35].

The mitral valve (MV) is located in the left heart, between the left atrium and the left ventricle. The tissue of the MV forms a continuous skirt along the annulus, which is divided into the anterior and posterior leaflet by the commissural areas. Both leaflets are connected to the papillary muscles, as well as the ventricular walls, by the chordae tendinae (see Fig. 1
                        ). During the systole, the increased pressure in the ventricle causes the MV to close, creating a one-directional blood flow. The chordae tendinae prevent the MV leaflets from entering the atrium and are essential for the stability and the tight closure of the MV [39].

A myxomatous degeneration or a dilatation of the left ventricle can render the MV unable to close correctly, creating a MV insufficiency. This leads to the regurgitation of blood into the atrium, decreasing the cardiac efficiency and placing additional stress onto the pulmonary circulation by causing secondary pulmonary hypertension [35]. Severe cases of MV insufficiency require surgical intervention to repair, or replace, the MV. Recent research suggests that even asymptomatic cases of mitral regurgitation should be treated surgically, based on the size of the effective regurgitant orifice [11].

Research shows that MV repair is the method of choice for MV insufficiency, as it is associated with fewer complications and higher survival rates than MV replacement [36]. In fact, the American Heart Association recommends MV repair over replacement [5]. However, MV repair is performed on the open, non-beating heart, which makes it difficult to predict the effects of surgery, especially if complex procedures like a leaflet tissue resection or the implantation of artificial chordae tendinae are performed [29,33]. According to Carpentier et al. [6], failure to tailor the repair surgery to the individual patient geometry leads to poor results. Therefore the American Heart Association recommends that MV repair should be referred to surgeons with high expertise in repair [5].

MV repair for severe mitral regurgitation routinely incorporates mitral annuloplasty [3–5]. During annuloplasty surgery, an artificial annuloplasty ring is introduced into the MV and attached to the annulus. The goal of an annuloplasty is to stabilize the annulus and to reduce the valve diameter to allow tight closure of the MV with reduced leaflet size. There are several different types of annuloplasty rings with different properties and, most importantly, different sizes. Because MV annuloplasty is performed on the open, non-beating heart, the correct choice of annuloplasty ring size is difficult (see Fig. 2
                        ).

Patient-specific simulation of MV repair surgery, in particular mitral annuloplasty, could aid surgery planning and help the surgeon to choose the optimal annuloplasty ring type and size for every individual patient before surgical intervention. This would reduce the difficulty of the surgery by removing the need to find a good repair strategy during open heart surgery, allowing more patients to receive MV repair surgery instead of replacement.

Since the pioneering work of Kunzelman et al. [18], finite-element models with an idealized model geometry have been employed to evaluate the bio-mechanical properties of the MV during the heart cycle. This research has been applied to study the structural effects of MV repair surgery, for example the effects of different types of annuloplasty rings [19,37], edge-to-edge repair [1,38], or the MitralClip [2].

Because of the highly individualized structure of the MV apparatus, patient-specific models are required for individual therapy planning. Recently, some patient-specific models based on image data have been developed for the simulation of MV repair surgery. A finite-element model based on echocardiographic images has been used for the simulation of a MitralClip intervention of a single patient, comparing the simulated results with the real outcome of the surgery [24]. Finite-element models have been used to simulate MV annuloplasty for a single patient by Stevanella et al. [32] and Choi et al. [7], who used cardiac MRI and echocardiographic images, respectively. However, the simulated results of Stevanella et al. [32] and Choi et al. [7] were not validated against post-surgical image data. Mansi et al. [24], Stevanella et al. [32] and Choi et al. [7] used an idealized geometry for the chordae tendinae. A different approach has been published by Hammer et al. [13] and Tenenholtz et al. [34] using micro CT images of an ex-vivo porcine MV loaded with air, resulting in a resolution of 100μm, which allows for a segmentation of the chordae tendinae. Both employed a mass-spring model, which Hammer et al. [13] used to simulate the changes in MV dynamics due to surgical modification of the chordae tendinae, while Tenenholtz et al. [34] simulated the application of a 3D-printed annuloplasty ring.

While general finite-element studies are helpful for the evaluation and development of MV repair surgery, patient-specific models are required for individual therapy planning. Recent research on patient-specific MV models for therapy planning is promising, but quantitative clinical studies are still missing to date. Even though the simulation times of finite-element models have improved to the point where they are no longer a constraint for clinical application, even faster simulation times could be achieved with the help of mass-spring models [34], making real-time surgery planning a definite possibility. Although mass-spring simulations can always be expected to be less numerically precise than finite-element simulations, Hammer et al. [15] reported that the differences between finite-element and mass-spring simulations of MV closure are in the sub-millimeter range. Therefore the impact of the reduced numerical accuracy of mass-spring simulations should be negligible for MV repair simulation.

While the mass-spring model proposed by Hammer et al. [13] and Tenenholtz et al. [34] yields promising results, it relies on ex-vivo micro CT image data, which is not available for clinical use. The spatial resolution offered by micro CT is impossible to achieve with current CT scanners without excessive patient exposure to ionizing radiation. Furthermore, the validation was limited to ex-vivo porcine hearts loaded with air and a custom 3D-printed annuloplasty ring was used by Tenenholtz et al. [34].

In order to overcome the limitations of current patient-specific finite-element and mass-spring models of the MV, a patient-specific, robust and fast approach for MV annuloplasty simulation based on readily available clinical image data is needed. Therefore, we chose to base our model on image data acquired pre-surgery using 3D transesophageal echocardiography (TEE) instead, which is recommended for MV repair planning [16,21,22], and used a 3D model of annuloplasty rings used during surgery. The clinical value of 3D TEE for MV annuloplasty planning has been shown by Ender et al. [9], using 3D TEE images to predict the annuloplasty ring size.

Here, we present a patient-specific mass-spring model for MV repair simulation based on a semi-automatic segmentation of echocardiographic images that are already routinely acquired during surgery. The capabilities of our model for MV annuloplasty simulation are evaluated by a “proof-of-principle” comparison of the simulation results against post-surgical 3D TEE images of five patients. The comparison indicates that our model is able to recreate the effects of MV annuloplasty and is able to provide a qualitative estimate for the result of annuloplasty surgery. Furthermore, the data suggests that the model might also be applied for simulating the implantation of artificial chordae.

@&#METHODS@&#

The patient-specific mass-spring MV model uses a segmentation of 3D TEE images for the initialization of a mass-spring model of the closed MV under systolic pressure. An iterative approach is used to adjust the spring rest-length so that the model can accurately simulate the shape of the closed MV under systolic pressure. To simulate MV annuloplasty, the model can then be deformed, according to the annuloplasty ring to be used, to create a prediction of the shape of the closed MV after surgery.

The patient-specific MV model consists of a two-dimensional quadrilateral mesh, representing the leaflet tissue, and line segments, representing the chordae tendinae. The vertices of the mesh are used as point masses, and the point masses of each mesh element are interconnected in pairs by translational springs. Therefore every quadrilateral mesh element contains six translational springs, as displayed in Fig. 3
                           . These quadrilateral mesh elements were found to be the most effective for deformable object simulation [8]. The support of the MV leaflets by the chordae tendinae is modeled by non-linear tension springs between the papillary muscles and each of the mesh vertices.

One of the patient-specific MV models used for simulation is displayed in the right hand panel of Fig. 3. The model consists of 400 point masses, forming 360 quadrilaterals. The number of vertices was determined experimentally to provide a reasonable compromise between accuracy and computation time (see left and middle panel of Fig. 4
                           ).

The behavior of the mass-spring model can be described by the following equation:


                           
                              
                                 (1)
                                 
                                    M
                                    
                                       
                                          
                                             x
                                             →
                                          
                                       
                                       ¨
                                    
                                    +
                                    d
                                    
                                       
                                          
                                             
                                                x
                                                →
                                             
                                          
                                          ˙
                                       
                                    
                                    +
                                    K
                                    
                                       x
                                       →
                                    
                                    =
                                    
                                       
                                          F
                                          →
                                       
                                       ext
                                    
                                    .
                                 
                              
                           
                           
                              
                                 x
                                 →
                              
                            is the displacement vector of the free vertices, with the derivatives 
                              
                                 
                                    
                                       x
                                       →
                                    
                                 
                                 ˙
                              
                            (velocity) and 
                              
                                 
                                    
                                       x
                                       →
                                    
                                 
                                 ¨
                              
                            (acceleration). The mass matrix M contains the point masses of the free vertices, and a linear dampening force with the dampening constant d is used. K is the stiffness matrix, calculated as the sum of all spring stiffnesses. The vector of external forces 
                              
                                 
                                    
                                       F
                                       →
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                 
                              
                            is given by the static pressure differential and the collision response forces (see Section 2.1.3). Zero displacement boundary conditions are enforced for the point masses representing the annulus and the papillary muscles.

Eq. (1) is a system of second order ordinary differential equations (ODEs) for the displacements 
                              
                                 x
                                 →
                              
                           , that governs the behavior of the mass-spring system over time. An equilibrium state of the system is given by 
                              
                                 
                                    
                                       x
                                       →
                                    
                                 
                                 ¨
                              
                              =
                              0
                            and 
                              
                                 
                                    
                                       
                                          x
                                          →
                                       
                                    
                                    ˙
                                 
                              
                              =
                              0
                           , leading to the condition that


                           
                              
                                 (2)
                                 
                                    K
                                    
                                       x
                                       →
                                    
                                    =
                                    
                                       
                                          F
                                          →
                                       
                                       ext
                                    
                                    .
                                 
                              
                           
                        

Since Eq. 2 is linear in 
                              
                                 x
                                 →
                              
                            only for small displacements, solving for 
                              
                                 x
                                 →
                              
                            directly is difficult. Instead, Eq. (1) is evolved over time by a Runge-Kutta solver, describing the motion of the system, until an equilibrium state is reached.


                           Mitral valve leaflets. The spring stiffnesses inside the leaflets are calculated according to an approach published by Gelder [12], which is based on equating the combined spring stiffness matrix with the stiffness matrix of a linear finite-element model. This leads to the mass-spring system mimicking the system response of a linear finite-element model. The spring stiffness k for a single spring of a triangular mesh element is given by the following equation:


                           
                              
                                 (3)
                                 
                                    k
                                    =
                                    
                                       
                                          E
                                          ·
                                          A
                                       
                                       
                                          
                                             l
                                             2
                                          
                                       
                                    
                                 
                              
                           
                           E is the Young modulus of the material, A is the area of the mesh element and l is the spring length. Eq. (3) is applied to the quadrilateral mesh by partitioning the mesh elements into triangles and calculating the resulting spring stiffnesses according to the laws of parallel and serial springs.

The value of the Young modulus was chosen according to a porcine MV excitation study by May-Newman and Yin [26] (cf. table 2 of the cited article). Research from Krishnamurthy et al. [17] suggests that the MV leaflets can be simplified as linear elastic tissue in the range of physiological pressure, therefore the pre-transitional Young modulus was used. Furthermore, the location (anterior/posterior leaflet) and the direction (circumferential/radial/shear) of the springs were taken into account. To recreate the low shear resistance of the MV tissue, the value of the Young modulus for the shear springs was chosen as half the Young modulus in radial direction, as the methods of excitation studies do not allow for an evaluation of the shear resistance of the MV tissue. The choice of the shear modulus as half the Young modulus in radial direction is supported by the research of Rausch et al. [30], who performed a numerical parameter estimation in an animal model. In conclusion, this approach leads to an anisotropic and inhomogeneous distribution of spring stiffness values.


                           Tendinous chords. Because the global support of the MV leaflets by the chordae tendinae is modeled by a manifold of springs, each physical cord is represented by an unknown number of springs in the model. Therefore the actual physical properties of the chordae tendinae cannot be transferred directly to the cord springs. A spring stiffness of k
                           =40N/m is used for the cord springs, based on the value used by Hammer et al. [14].


                           Spring rest-length. Contrary to other MV models that use images acquired over the full range of the heart cycle for initialization [24,32], our patient-specific MV model is based on a segmentation of the MV in the mid-systolic phase. As a consequence, the rest length of the springs is unknown, as the unloaded, undeformed state of the MV is unknown.

An estimation of the rest length of the springs was attempted with the MATLAB lsqnonlin optimizer (MATLAB 2009a, MathWorks; MA, United States), an implementation of a trust-region reflective algorithm [25]. In a first attempt, the displacement of the vertices of the mesh in any direction was minimized. In a second attempt, only the displacement in the direction of the cord springs was minimized. However, both approaches failed to converge to a stable solution.

Instead, an iterative computing scheme based on repeated small scale simulations was developed to approximate the true spring rest-length. The algorithm estimates the rest-length rl for each of the springs by minimizing the deformation during the simulation, using a four step process:
                              
                                 1.
                                 Simulation of the movement of the mass-spring system representing the closed MV under pressure (p
                                    =100mmHg, see below) for a small time step of 1ms.

Calculation of the deformation Δl
                                    =
                                    l
                                    
                                       sim
                                    
                                    −
                                    l
                                    
                                       seg
                                     of each spring, where l
                                    
                                       seg
                                     is the length obtained from the segmentation and l
                                    
                                       sim
                                     is the length after the simulation.

Calculation of the new rest length rl
                                    
                                       n+1 for each spring according to the deformation Δl as:
                                       
                                          (4)
                                          
                                             
                                                rl
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                rl
                                                n
                                             
                                             −
                                             α
                                             ·
                                             Δ
                                             l
                                          
                                       
                                    
                                 

Repetition until the maximum number of iterations is reached (ten iterations, see below).

The computation led to errors in the sub-millimeter range for the simulation of the equilibrium position of the mid-systolic MV within ten iterations (see Section 3.1). If the springs are not interconnected (every vertex has only one spring), a choice of α
                           =1 should lead to the exact solution after one iteration. A value of α
                           =0.5 was experimentally determined to be a stable and efficient choice (see right panel of Fig. 4). This approach is similar to the one used by Mansi et al. [24], where the rest lengths of the cords were adjusted manually according to the results of the simulation.


                           Physiological and numeric parameters. For the calculation of the mass matrix M, a uniform density of ρ
                           =1.06g/cm3 is used in conjunction with a uniform leaflet thickness of t
                           =1mm. The entries of the mass matrix M are calculated as M
                           
                              i
                           
                           =
                           A
                           
                              i
                           
                           ·
                           t
                           ·
                           ρ, where A
                           
                              i
                            is the area of the leaflet represented by a point mass i (i.e. one-fourth of the area of every face that contains the point i). The static pressure is set at p
                           =100mmHg. These values were regarded as physically realistic and have also been used by Hammer et al. [14].

The dampening constant d should have no influence on the equilibrium state of the system, but only on the numerical stability and efficiency. A value of d
                           =1Ns/m was suggested by Hammer et al. [14], which was confirmed to be numerically stable and most efficient by our research.

To resolve point-mesh-collisions, a linear collision response force is applied to the colliding vertices [27], which is defined for distances d between the upper and lower threshold d
                           
                              high
                            and d
                           
                              low
                            as


                           
                              
                                 (5)
                                 
                                    F
                                    =
                                    
                                       F
                                       max
                                    
                                    ·
                                    
                                       
                                          
                                             d
                                             high
                                          
                                          −
                                          d
                                       
                                       
                                          
                                             d
                                             high
                                          
                                          −
                                          
                                             d
                                             low
                                          
                                       
                                    
                                    ,
                                    
                                    for
                                    
                                    
                                       d
                                       low
                                    
                                    <
                                    d
                                    <
                                    
                                       d
                                       high
                                    
                                    .
                                 
                              
                           
                        

The parameters were chosen as F
                           
                              max
                           
                           =10N, d
                           
                              high
                           
                           =0.1cm, and d
                           
                              low
                           
                           =10−6
                           cm, which were determined experimentally to prevent intersection of the mesh under physiological conditions, with minimal force and minimal upper threshold. The collision force F is applied to the colliding vertex and mesh element in normal direction. This approach results in frictionless contact of the MV model leaflets, with a minimum distance of 10−6 to 0.1cm between the leaflets.

During annuloplasty surgery, the surgeon implants an artificial annuloplasty ring into the MV to stabilize the annulus and to reduce the valve diameter to allow tight closure of the MV with reduced leaflet size. In the framework of the mass-spring MV model described here, the implantation of an annuloplasty ring can be described as a deformation of the annulus, which will be propagated through the springs to result in a deformation of the complete MV model. Therefore an annuloplasty surgery can be simulated by modifying the displacement boundary conditions of the vertices representing the annulus in the MV model and solving for the equilibrium state of the modified MV model.

To calculate the new displacement boundary conditions in accordance with the selected annuloplasty ring, a previously acquired database of computer-aided design (CAD) models of the Edwards-Carpentier Physio annuloplasty ring (Edwards Lifesciences; Irvine, CA) is used [10]. To minimize user interaction, the selected annuloplasty ring is automatically placed in the MV model, mimicking its positioning during undersized annuloplasty surgery (based on personal communications; [9]). To achieve this, the principal axes of inertia of the annuloplasty ring are aligned with those of the point masses representing the annulus in the MV model, and both the annuloplasty ring and the annulus are projected into their principal plane, i.e. the plane of the MV. Afterward, the mid-point of the long side of the annuloplasty ring is placed at the mid-point of the anterior side of the mitral annulus (see Fig. 5
                           ). To calculate the new displacement boundary conditions, the vertices of the annulus of the MV model are then displaced in direction of the center of mass of the MV model until they rest upon the convex hull of the projection of the annuloplasty ring. Finally, the z-coordinates of the displaced vertices are calculated from the annuloplasty ring by linear interpolation.

To simulate annuloplasty, the newly calculated boundary conditions are applied to the MV model and the modified model is evolved over time until an equilibrium state is reached. For stability reasons, the displacements are applied to the vertices over the course of several small simulation steps of no more than 0.5mm maximum displacement each. This step length was determined experimentally to provide a good compromise between accuracy and computation time.

Additional surgical techniques, such as a leaflet resection or the implantation of artificial cords, can be represented in the MV model by directly modifying the mesh representation of the MV. For example the resection of a part of the leaflet could be simulated by removing the mass points corresponding to the resected tissue. An implantation of an artificial cord would correspond to the insertion of additional cord springs or the modification of the parameters of the existing cord springs.

The images used in this study were obtained at the Leipzig Heart Center from patients undergoing MV repair surgery. All of these patients were implanted with a Carpentier-Edwards Physio annuloplasty ring, and received pre- and post-surgical 3D TEE (iE33, Philips; Best, The Netherlands). The image acquisition has been described previously [9].

The patient-specific MV model is based on a segmentation of the MV in the mid-systolic phase, pre-surgery. The segmentations were performed with a prototype of the TomTec 4D MV-Assessment Tool (TomTec Imaging Systems GmbH; Germany). The 4D MV-Assessment Tool allows a semi-automated segmentation of the systolic MV based on the manual selection of four points on the annulus and one point at the coaptation of the MV. Additionally, the tips of the papillary muscles were selected manually. While the 4D MV-Assessment Tool is able to track the MV over the whole systole, only one image manually chosen at the mid-systole was used for the creation of the MV model.

@&#ANALYSIS@&#

To evaluate the feasibility and the limitations of the application of the proposed patient-specific mass-spring system MV model for the simulation of mitral annuloplasty, the patient-specific MV model was created based on the segmented pre-surgical 3D TEE images. A simulation of a mitral annuloplasty was performed with the same size of annuloplasty ring that was used during the surgery. The simulation result was then visualized as an overlay to post-surgical 3D TEE images for comparison with the actual result of the surgery. Additionally, the point-to-mesh distance between the simulated result and a segmentation of the post-surgical 3D TEE images was calculated.

Furthermore, for the patients for which the simulation of annuloplasty alone did not produce results in agreement with the post-surgery image data, an exploratory evaluation of the effect of the implantation of artificial chordae tendinae was performed. To this end, the length of the cords in the diseased segments of the MV was manually adjusted during repeated simulations to match the result to the post-surgery image data, as no data on the exact course of the surgery was available.

To transform the MV model from the pre-surgical image space to the post-surgical image space, a 3D rigid registration of the point representation of the segmented annulus is performed. As part of the registration, a mean-squares metric of the displacement of the segmented vertices on the annulus is used. This metric is multiplied with a linear weighting function based on the distance along the annulus to the middle point of the anterior annulus. The weighting function increases the weight of the anterior side of the annulus, recreating the movement of the posterior side of the MV as a result of undersized annuloplasty (based on personal communications; [9]).

@&#IMPLEMENTATION@&#

The simulation is implemented in the MATLAB programming language, and the explicit embedded Runge-Kutta-solver ode45 is used to solve the system of ODEs (Eq. (1)). The registration is performed with lsqnonlin, an implementation of a trust-region reflective optimization algorithm [25].

@&#RESULTS@&#

All simulations were performed on an Intel Core Duo T2600 processor with a clock rate of 2.16GHz and 2GB of RAM. The total simulation time was heavily dependent on the size difference between the annulus and the annuloplasty ring. Simulation times were in the range of 20min to 1.5h.

To assess the quality of the spring rest-length estimation, the equilibrium state of the loaded MV model was calculated and compared to the original segmentation of the MV in the mid-systolic phase. The differences in position for each vertex were in the sub-millimeter range for all patients. The maximum displacement usually occurred in the commissural areas, as can be seen in Fig. 6
                        .

Furthermore, after the parameter estimation, the MV model was initialized in an open position to simulate MV closure under pressure, as an additional test of the stability of the MV model and the parameter estimation. As a segmentation of the open MV was not possible with the image data and segmentation tool used here, the open position was obtained by applying a constant, uniform force to all vertices in the direction of the ventricle until the MV model reached a stable state, while setting the pressure to zero. After simulating closure caused by applying the static pressure differential, maximum distances between the MV model before and after the simulation cycle were in the range of up to 2mm, occurring mostly in the commissural areas and the insufficient leaflet segments. The mean and median distances were in the sub-millimeter range for all patients (see Table 1
                        ). An example is shown in Fig. 7
                        , and some discrepancies are visible in the prolapsed segment close to the commissural areas at the coaptation where the MV model does not close completely.

Examples of the registration performed between the segmented pre- and post-surgical annulus are shown in Fig. 8
                        . The size of the annuloplasty ring used during the surgery closely matches the size and position of the segmented post-surgical annulus.

A simulation of a MV annuloplasty was performed for five patients. An example of the visualization of the simulation result superimposed on the post-surgical 3D TEE image can be seen in Fig. 9
                        . In this patient, the model was able to provide a qualitative description of the position and the shape of the post-surgical MV (see also top left panel of Fig. 11). For the remaining patients, the model predicted a continuation of the MV prolapse even after annuloplasty surgery, as shown in the left panel of Fig. 10
                        
                        .

Therefore, even though no data on the exact course of the actual surgery was available, we decided to explore the effect of an additional implantation of artificial chordae tendinae for the patients whose post-surgical images did not match the simulation results. To this end, the spring rest-length of the springs in the prolapsed segment were modified to model the effect of the implantation of artificial chordae tendinae. The new lengths of the modified springs were manually determined by repeated simulation, until the simulation result approximated the shape of the MV post-surgery (see Fig. 10). The comparison of the simulated results with the post-surgical images indicates that these patients, for which the simulation of annuloplasty alone initially did not produce good results, might also have been implanted with artificial chordae tendinae in addition to undergoing annuloplasty during their surgery. The simulation seems to be able to indicate the limits of annuloplasty surgery without additional surgical measures, highlighting the need for additional surgical measures, such as the implantation of artificial chordae tendinae in order to correct the MV prolapse. Furthermore, the MV model seems to be able to approximate the overall position and shape of the anterior leaflet of the post-surgical MV, while the approximation of the position and shape of the posterior leaflet of the post-surgical MV is not optimal, leading to incomplete closure of the MV model.

The point-to-mesh distance between the simulated result and a segmentation of the post-surgical images can be seen in Fig. 11. The maximum, mean, and median distances are given in Table 2
                        .

@&#DISCUSSION AND CONCLUSIONS@&#

@&#DISCUSSION@&#

The goal of this work was to investigate the possibility of using a mass-spring model based on clinical image data for simulation of MV repair, in particular MV annuloplasty. Previous work from Stevanella et al. [32] and Choi et al. [7] showed that finite-element models can be used to simulate the effects of MV annuloplasty from patient-specific image data, but no comparison against post-surgical image data was performed. Mansi et al. [24] successfully simulated a Mitral-Clip intervention for a single patient with a finite-element model based on echocardiographic images, including a comparison against post-surgical images. A mass-spring model was used by Tenenholtz et al. [34] to simulate mitral annuloplasty for an ex-vivo porcine MV based on micro-CT images, reporting sub-millimeter accuracy. In contrast, the mass-spring MV model presented here was based on readily available clinical 3D TEE images, acquired pre- and post-surgery from five MV repair patients at the Heart Center Leipzig, and evaluated against post-surgical image data.

To evaluate the ability of our MV model to predict the outcome of mitral annuloplasty surgery, the simulation was compared against post-surgical image data of annuloplasty patients. The qualitative comparison shows that the MV model was able to approximate the position and shape of the post-surgical MV for one patient receiving MV annuloplasty. While the simulation is able to provide an approximation for the post-surgery position and shape of the anterior leaflet in the patients where a possible implantation of artificial chordae tendinae was simulated, the approximation of the position and shape of the posterior leaflet of the MV is not optimal for these patients, leading to incomplete closure.

The calculation of the point-to-mesh distance for the difference between the simulation result and the segmentation of the post-surgical images shows that the overall differences are in the range of 1–2mm (see Table 2), which is in the same order of magnitude as the TEE resolution, the error of the segmentation and the registration error. These values are comparable to the ones reported by Hammer et al. [14] for their mass-spring model of MV closure. Some of these differences can be attributed to differences between the pre- and post-surgery segmentation, as both the zone of coaptation and the commissural areas are difficult to segment in the closed state of the MV. However, the point-to-mesh distance plot for the simulation of the implantation of artificial cords in addition to the annuloplasty surgery reveals some larger differences in the posterior leaflet, leading to incomplete closure of the MV model (see Fig. 11).

A qualitative evaluation of the coaptation shows that the simulation fails to predict full closure of the MV in the patients for which we decided to simulate a possible implantation of artificial chordae tendinae (see Fig. 11), even though all of the patients underwent successful MV repair without post-surgical regurgitation. As our experiment was limited by the scope of the available data, it is likely that the incomplete closure of the MV model is caused by an inaccurate reproduction of the surgical techniques applied during the MV repair surgery. One possible inaccuracy in the modeling process could be the placement of the annuloplasty ring, which might differ from the actual placement during the surgery. Another possible inaccuracy could be the placement and length of the artificial chordae tendinae, as no data on the exact course of the surgery was available to us. Furthermore, the material properties of the artificial cords might differ, as the artificial cords are represented by several springs in the MV model. However, an incomplete coaptation can also be observed in the results of Hammer et al. [14], where their linear mass-spring MV model did not close completely. Further work of Hammer et al. [13] shows that a bilinear mass-spring model was able to simulate complete closure of the MV (see also Section 4.2). Therefore another possible reason for the incomplete closure could be the choice of linear elasticity. Another possible cause could be the choice of material parameters and their application to the MV model. Furthermore, as a limitation of the 3D TEE data and the segmentation algorithm, the segmentation and the simulation were limited to the closed state of the pressure-loaded MV. The inaccurate geometric model of the MV and the chordae apparatus as well as the limitation to static boundary conditions might be responsible for the incomplete closure after deformation.

For stability testing, the closure of the MV model was simulated from an open position. While the overall differences between the MV model before and after simulation of closure are low (see Table 1), some discrepancies can be found in the zone of coaptation of the diseased segments (see example Fig. 7). It should be noted that the patient collective consists of five patients with MV insufficiency severe enough to justify MV repair simulation. Therefore the segmentation of the closed state of the MV might not be regarded as a stable, steady state of the MV. However, the fact that the differences are also high in the commissural areas might indicate problems with the mesh quality (see Fig. 6). While the simulation of MV closure was not the main focus of this work, further investigation into the quality of the segmentation and the resulting mesh seems necessary.

The 3D TEE images that were used in this study were routinely acquired during MV repair surgery. Therefore our simulation does not require additional imaging procedures, like the cardiac MRI used by Stevanella et al. [32]. To date, 3D TEE is the method of choice for MV repair planning [16,21,22] and does not require any exposure of the patients to ionizing radiation for the acquisition of the necessary image data, unlike a possible clinical adaption of the micro CT imaging procedure used by Hammer et al. [13] or Tenenholtz et al. [34].

While user interaction is required during the segmentation of the MV, the TomTec 4D MV-Assessment Tool prototype is able to complete the segmentation in a few minutes. Therefore the amount of user interaction should not be a limitation for clinical applicability of our model. The mass-spring model itself is independent of the process of segmentation and only requires a two-parametric representation of the MV. Thus, it could also be combined with different segmentation algorithms, if needed.

No user interaction was required for the placement of the annuloplasty ring. While the registration between pre-surgical and post-surgical image space indicates that the placement of the annuloplasty ring was approximated well in our simulation, manual placement of the annuloplasty ring might provide additional useful information. To achieve this interaction, the simulation could be combined with the previously described TomTec Ring Tool Prototype [9].

We used a novel rest-length estimation algorithm to allow the initialization of the mass-spring model based on a single mid-systolic 3D TEE image, solving the problem of the unknown true lengths of the chordae tendinae. This allows for further patient-specific modeling of the MV leaflet support by the chordae tendinae, without the need for clinically unavailable high-resolution image data, as used by Hammer et al. [13] and Tenenholtz et al. [34]. Our method could potentially be extended to create an even more patient-specific model of the chordae tendinae, as will be discussed in Section 4.3.

The goal of simulating a MV annuloplasty in real-time could not be reached, as the simulation of a MV annuloplasty with our model takes about 1h. While this is faster than the comparable finite-element simulation of Stevanella et al. [32], which took a full 23h, the computation times of finite-element simulations have recently experienced substantial improvements [24] and are no longer a constraint for clinical application. One area of possible improvement for our model is the collision-handling, as most of the computation time was spent on collision-checking, which could be sped up drastically by more efficient search strategies. Another area of possible improvement is the use of implicit methods for integration in order to reduce the number of simulation steps and improve convergence. These techniques have been applied by Tenenholtz et al. [34], who reported simulations times below one second, which allows for an interactive simulation. Considering even further developments, like parallelization and the use of GPUs, real-time surgery simulation with refined versions of mass-spring models like ours or the one of Tenenholtz et al. [34] is a definite possibility.

@&#LIMITATIONS@&#

The MV leaflets are modeled as linear elastic materials in this study. As discussed in Section 4.1, this might be the reason for the incomplete closure of the MV model for the patients where a possible implantation of artificial cords was simulated in addition to the annuloplasty surgery. On the one hand, biaxial stress testing of porcine MV tissue shows non-linear elastic behavior of the MV leaflets [26], and recent studies suggest that the leaflets have to be regarded as active components [17,31]. On the other hand, the research of Krishnamurthy et al. [17] also suggests that the leaflets might behave as linear elastic in the range of physiological pressures. In theory, the parameters of a mass-spring model can be used to approximate any kind of tissue behavior. An adaptation of mass-spring models to non-linear elasticity with bilinear spring response functions has been performed by Hammer et al. [13]. As mentioned above (see Section 4.1), our results and the results of Hammer et al. [14,13] suggest that a bilinear mass-spring model might achieve more accurate results, indicating that additional research on this topic is required.

Our approach models the MV leaflets as a two-dimensional structure, neglecting the varying tissue thickness and bending resistance offered by the material. However, the influence of these bending forces on the shape of the closed mid-systolic MV seems to be small, and the mass-spring model of Hammer et al. [14] uses negligible bending spring stiffness. In any case, an exact quantification of MV leaflet thickness is not possible from current echocardiographic images.

No assumptions on the structure or distributions of the chordae tendinae were made. Since the distinction of individual chordae is not possible with clinically available pre-surgery image data, the global support of the MV leaflets by the chordae tendinae is modeled by non-linear springs between every vertex of the leaflet mesh and one of the papillary muscles, personalizing the chordae tendinae by spring rest-length estimation as described in Section 2.1.3. This approach is in contrast to the most commonly applied solution to the problem of chordae modeling, which uses a general, idealized model of the distribution and structure of the chordae [7,24,32]. However, this commonly used approach fails to account for the highly individual nature of the chordae apparatus [20], and the assumptions on the distribution of the chordae might be violated in an insufficient MV. While the cord springs used by our model do not correspond with the actual chordae tendinae, the introduction of non patient-specific data, as found in an idealized chordae model, is prevented. An analysis of the stress distribution of the cord springs could lead to further insights into the validity of our modeling approach.

Even though the results show that the use of artificial chordae will allow the MV model to reach a state similar to the one seen in the post-surgery TEE images, deviations appear in the posterior leaflet (see Section 4.1), and further research is necessary to judge if this approach can accurately simulate the insertion of artificial chordae. The length of the inserted cords was determined in an iterative process by manual intervention and it does not necessarily coincide with the length of the artificial chordae used during surgery. To that end a more sophisticated experimental setup could employ additional information gathered during surgery on the length and position of the artificial chordae to validate the simulation.

Only a generic, static pressure profile was used, as an even distribution of pressure is to be assumed for a correctly closed MV. Even though the dynamic pressure generated by mitral regurgitation will heavily influence the movement of a prolapsed segment, a simulation of the complete hemodynamics would be overly complicated with only a limited effect on the overall simulation accuracy. However, our model could be extended with an individual pressure differential between the atrium and ventricle, which could be acquired from blood pressure measurements.

The simulation of the closure of the pre-surgery MV model used an artificial open position, created from the segmentation of the closed MV via simulation. This artificial open position is not anatomically correct and for simulation of MV closure a segmentation of the open MV should be used for initialization. However, the simulation of closure of the pre-surgery MV model was only performed as a test on the stability of the MV model and the parameter estimation, and not as a prediction of the closed state of the MV model from an open state.

Only the closed, mid-systolic MV was evaluated in our simulation and no dynamic simulation was performed, as the prototype of the 4D MV-Assessment Tool only supports the segmentation of the systolic MV. The deformation of the MV through the implantation of the annuloplasty ring is simulated for the closed MV, using static Dirichlet boundary conditions. This is in contrast to the open heart surgery, where the surgery is performed on the unloaded, open MV. Furthermore, the movement of the annulus and the papillary muscles has been shown to be an important part of the movement of the MV over the heart cycle. Therefore, a comparison to a different MV model, where the deformations are applied to the model of an open MV and MV closure is simulated, could provide additional insights.

The validation of the simulation results with post-surgical image data was limited to a qualitative visual comparison and an evaluation of the point-to-mesh distance between the simulated result and a segmentation of the post-surgery 3D TEE images. However, the segmentation of the 3D TEE images is difficult, leading to problems during the evaluation. While the comparison could be improved by using manual expert traces of the annuloplasty result instead of relying on a semi-automatic segmentation algorithm, this would be very time consuming. Instead, a comparison of the simulation results against clinical parameters obtained during surgery to quantify the success of the annuloplasty procedure, like the length of the coaptation, could be used to assess the value of the simulation for clinical use.

Furthermore, validation of the choice of numerical parameters was limited as no sensitivity analysis was performed for the choice of numerical parameters, e.g. the relaxation parameter α or the maximum collision response force F
                        
                           max
                        . While a more comprehensive approach might be able to improve model performance, the aim of the study was only to assess the feasibility of the approach. However, for further evaluation of the MV model and for the transfer to clinical practice a more thorough examination of the individual influence of the numerical parameters on the MV model, especially in view of highest efficiency (model convergence), seems necessary.

While the numerical accuracy of the deformation step of our simulation was not assessed quantitatively, a simulation based on a mass-spring model can be expected to be less accurate than a finite-element simulation [13]. However, this should not negatively influence the applicability of our model for the simulation of MV annuloplasty with the goal of improved annuloplasty ring choice. If the goal of the simulation is the comparison of the effects of different sizes of annuloplasty ring, the requirements on the numerical accuracy of the simulation are low, as the Carpentier-Edwards Physio annuloplasty ring used at the Leipzig Heart Center for the patients evaluated here is available in steps of two millimeters of ring diameter. Additionally, even the most accurate simulation for MV repair planning will still be limited by the accuracy of the actual surgical procedure where the optimized repair strategy has to be applied and adapted to the “real-life” setting in each individual patient.

The one-step collision handling with a linear collision force applied to the colliding vectors might be insufficient to resolve the collisions occurring during the simulation. If a collision occurs with high relative velocity, the colliding vertices might cover the distance between d
                        
                           high
                         and d
                        
                           low
                         without sufficient resistance. Also, if the force leading to the collision exceeds the maximum collision response force of F
                        
                           max
                        
                        =10N, the collision response force will not be sufficient to prevent the collision. However, a visual qualitative inspection of the results shows no areas where the mesh did penetrate itself, and a more aggressive choice of parameters would result in a more stable collision handling at the cost of higher computation times. Nonetheless, more efficient algorithms for resolving collisions that use information from multiple past steps could lead to a more stable and efficient collision handling.

We believe that the biggest limitation of the research presented here is the small patient collective of only five patients used for the evaluation of our simulation and the limitation to pre- and post-surgery TEE image data without additional information on the exact course of the MV repair surgery, which makes it difficult to fully assess the capabilities of our model for the simulation of MV repair. While the size of the annuloplasty ring used during surgery was reported, no additional information on the surgery was available. However, the scope of this study was to assess the feasibility of the simulation of MV repair with the proposed mass-spring model, and the data presented here indicates that such a simulation is indeed feasible, even though further work is needed. Moreover, although unfortunate, a patient collective of five patients can be regarded as an improvement over comparable feasibility studies, which were limited to the evaluation of only one patient [7,24,32].

As already mentioned in Section 4.1, further integration of current research on the topic of mass-spring-system simulation makes real-time surgery simulation a definite possibility. The simple structure of mass-spring models makes them well suited for parallelization approaches, and GPU programming could lead to large speed-ups [28]. Another promising approach for optimization is the combination of ODE-solvers with non-linear solvers, to solve Eq. (2) directly (see Section 2.1.2). This approach was tested with a small scale 2D MV leaflet model, where the combination of solvers was able to drastically reduce computation times, avoiding the oscillation of the solution around the equilibrium.

Further personalization of our model is possible for the tissue material properties, where machine learning approaches could be applied. In absence of clinical imaging methods capable of chordae visualization, a personalization of the chordae modeling could also be achieved by combining the global chordae model presented in this study with an optimization algorithm. Similar to our spring rest-length estimation, a repeated simulation could be used to identify which of the cord springs are responsible for the shape of the MV leaflets. By successively eliminating superfluous springs, an individual model of the chordae apparatus could be created. Additional information could be provided to the algorithm by extending the simulation to the closure of the MV instead of simulating the equilibrium state of the closed MV. Furthermore, a higher degree of personalization of the leaflet geometry might be possible with the use of more sophisticated segmentation algorithms or the use of image data acquired over the full range of the heart cycle. Patient-specific material parameters might also improve the accuracy of the simulation, but state-of-the-art methods currently available for in-vivo parameter identification are invasive and time-consuming [30] and therefore do seem neither applicable nor easily transferable to clinical routine. While patient-specification is clearly needed for individual therapy planning, it remains unclear how much patient-specification is required, as it increases model complexity as well as the number of parameters.

@&#CONCLUSIONS@&#

The mass-spring MV model presented here is a first step in improving surgery planning for MV repair surgery. Our model is based on 3D TEE image data, which is already routinely acquired and used for surgery planning. While further research is necessary to fully judge the capability of our model for the simulation of MV repair surgery, the results of our comparison show that annuloplasty simulation with a mass-spring model based on 3D TEE image data is feasible.

Marcus Schreckenberg and Georg Schummers are employed at TomTec Imaging Systems GmbH (Unterschleißheim, Germany). Stephan Skornitzke was employed at TomTec Imaging Systems GmbH (Unterschleißheim, Germany) during part of this research. The other authors declare no conflicts of interest.

@&#ACKNOWLEDGMENT@&#

This research was in part supported by the German Research Foundation (DFG) within project R02, SFB/TRR 125 “Cognition-guided Surgery”.

@&#REFERENCES@&#

