@&#MAIN-TITLE@&#High-order curvilinear meshing using a thermo-elastic analogy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a method to generate curved meshes using a thermo-elastic model.


                        
                        
                           
                           A linear elastic analogy is amended to include thermal stress terms.


                        
                        
                           
                           These terms ‘heat’ or ‘cool’ elements to allow for increased deformation.


                        
                        
                           
                           Both isotropic and anisotropic forms of the thermal stress tensor are presented.


                        
                        
                           
                           The method is demonstrated to have benefits in both two and three dimensions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

High-order curvilinear mesh generation

Elastic mesh deformation

Pseudo-thermal stresses

Mesh validity

Mesh quality control

@&#ABSTRACT@&#


               
               
                  With high-order methods becoming increasingly popular in both academia and industry, generating curvilinear meshes that align with the boundaries of complex geometries continues to present a significant challenge. Whereas traditional low-order methods use planar-faced elements, high-order methods introduce curvature into elements that may, if added naively, cause the element to self-intersect. Over the last few years, several curvilinear mesh generation techniques have been designed to tackle this issue, utilizing mesh deformation to move the interior nodes of the mesh in order to accommodate curvature at the boundary. Many of these are based on elastic models, where the mesh is treated as a solid body and deformed according to a linear or non-linear stress tensor. However, such methods typically have no explicit control over the validity of the elements in the resulting mesh. In this article, we present an extension of this elastic formulation, whereby a thermal stress term is introduced to ‘heat’ or ‘cool’ elements as they deform. We outline a proof-of-concept implementation and show that the adoption of a thermo-elastic analogy leads to an additional degree of robustness, by considering examples in both two and three dimensions.
               
            

@&#INTRODUCTION@&#

The generation of high-order finite element meshes, in which faces and edges of elements curve to align with the underlying geometry, is presently an open topic. The difficulty in generating curved meshes lies in striking a balance between obtaining a sufficiently coarse mesh, whilst introducing curvature in such a way as to prevent the self-intersection of elements. There are also additional challenges in terms of producing good quality high-order elements, so that discretized operators on the solution field are well-conditioned and CFL restrictions on the time-marching scheme, where present, are ​minimized. Many of the most promising approaches that are currently being used to tackle this problem adopt a strategy of mesh deformation in their formulation. In this approach, the mesh is treated as a solid body and a model is used to determine a displacement field, which is consequently used to move the position of nodes without altering the connectivity of the elements. This technique is by no means new, having been used in the linear mesh generation community to improve the quality of elements and incorporate boundary layers into existing meshes. Some of the most popular methods include, for instance, Laplacian smoothing  [1,2], Winslow smoothing  [3,4], elastic mesh deformation  [5,6,4] and mesh optimization  [7]. More recently however, these techniques have been extended to be used in the generation of high-order meshes. The approaches to date have fallen into two general categories. The first is mesh optimization, in which regularization  [8,9] and logarithmic barriers  [10,11] have been used to define a functional which is then minimized over the domain. The second approach utilizes linear  [6,12] or non-linear  [13] elasticity analogies, where the mesh is deformed according to a stress–strain relationship. The difference in these techniques, and the resulting meshes that are generated, lies in the strategy they adopt. In the minimization of a functional, which hopefully incorporates a measure of quality of the element, the goal of the optimization procedure should not only untangle an initially invalid mesh, but add an additional degree of robustness and produce high-quality elements. Elasticity models, on the other hand, start from an initially-valid straight sided mesh, but only have ‘passive’ control over the quality and validity of elements. We note that the non-linear dependence on the determinant of the deformation mapping ensures that the creation of invalid elements is penalized. However no explicit measure of quality is generally adopted in these models.

In this work, we introduce a new technique to improve the robustness and quality of elements that are obtained using elastic analogies. We extend the linear elastic equations with a term that can be interpreted as a thermal stress. The aim of this term is to counteract the distortion of elements that arises from introducing curvature at the boundary of the domain. The derivation of this term relies on a measure of the mesh quality, which will therefore allow us to control the validity and quality of elements as the mesh is deformed. We note that a precursor to this idea was presented in the work by Palmerio  [1] for linear elements where a pseudo-pressure term was used to ensure the area of the elements in the mesh remained positive through the smoothing process. The penalty term proposed in  [1] can be seen as a particular case of the linear isotropic thermal stresses in the current formulation. Our formulation is however more general; it provides a physical interpretation of the additional terms that control mesh validity and quality, and it can be generalized to account for mesh anisotropy.

We note that this work is an extension of the initial implementation introduced in  [14]. The goal of this work is to give a detailed derivation of the thermal stress terms, which differs from  [14] in the choice of the isoparametric mapping that is used to determine the thermal stress. We additionally outline an extension to three dimensions, considering a simple extruded annulus and a more complex mesh of a sphere contained within a cube to demonstrate the viability of the method for more complex configurations.

We begin by describing the governing equations of elasticity, which incorporate body forces and thermal stresses in Section  2. Section  3 presents the derivation of the proposed form of the thermal stresses. An outline of the numerical discretization of the equations of elasticity using spectral/
                        h
                        p
                      elements is given in Section  4. Section  5 proposes some forms of the tensor of thermal stresses and illustrates with practical examples that the modifications to the elasticity equations proposed here permit a higher degree of deformation whilst maintaining the validity of the underlying high-order elements.

We seek to deform a mesh of straight-sided high-order elements to accommodate curved boundaries. To achieve this, we adopt a linear elasticity formulation in terms of the displacement, 
                        
                           u
                        
                     , of points in the domain, 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , caused by imposing a prescribed displacement, 
                        
                           
                              
                                 u
                              
                           
                           
                              ˆ
                           
                        
                     , at the points in the boundary of the domain, 
                        ∂
                        Ω
                     . This is illustrated in Fig. 1
                     .

The elastic formulation, see for instance  [15], starts with the equilibrium of forces represented by the equation 
                        
                           (1)
                           
                              ∇
                              ⋅
                              
                                 S
                              
                              +
                              
                                 f
                              
                              =
                              
                                 0
                              
                              
                              in
                              
                              Ω
                           
                        
                      where 
                        
                           S
                        
                      is the stress tensor and 
                        
                           f
                        
                      denotes a distributed force. The force will be, in general, a function of the position, i.e.  
                        
                           f
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      with 
                        
                           x
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                     .

We further assume that the stress tensor 
                        
                           S
                        
                      incorporates both elastic and thermal stresses, so that it can be written as 
                        
                           
                              
                                 S
                              
                              =
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    e
                                 
                              
                              +
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                      where the subscripts 
                        e
                      and 
                        t
                      denote the elastic and thermal terms respectively.

We adopt the usual linear form of the elastic stress tensor as 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    e
                                 
                              
                              =
                              λ
                              Tr
                              
                                 (
                                 
                                    E
                                 
                                 )
                              
                              
                              
                                 I
                              
                              +
                              μ
                              
                                 E
                              
                              ,
                           
                        
                      where 
                        λ
                      and 
                        μ
                      are the Lamé constants, 
                        
                           E
                        
                      represents the strain tensor, and 
                        
                           I
                        
                      is the identity tensor. For small deformations, the strain tensor 
                        
                           E
                        
                      is given as 
                        
                           (2)
                           
                              
                                 E
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 ∇
                                 
                                    u
                                 
                                 +
                                 ∇
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                              .
                           
                        
                      The boundary conditions required to close the problem consist of prescribed displacements at the boundary 
                        ∂
                        Ω
                     , i.e.  
                        
                           (3)
                           
                              
                                 u
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                              in
                              
                              ∂
                              Ω
                              .
                           
                        
                     
                  

We further express the Lamé constants in terms of the Young’s modulus 
                        E
                      and Poisson ratio 
                        ν
                      as 
                        
                           
                              λ
                              =
                              
                                 
                                    ν
                                    E
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       ν
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       2
                                       ν
                                       )
                                    
                                 
                              
                              ,
                              
                              μ
                              =
                              
                                 
                                    E
                                 
                                 
                                    2
                                    
                                       (
                                       1
                                       +
                                       ν
                                       )
                                    
                                 
                              
                              .
                           
                        
                      Note that the elastic parameters of the problem 
                        λ
                      and 
                        μ
                     , or equivalently 
                        E
                      and 
                        ν
                     , might be considered to be functions of 
                        
                           x
                        
                     . This is a strategy used for instance in reference  [5] where smaller elements are made stiffer to permit larger deformations.

The main idea of the paper is to use the thermal stresses terms to control the validity of the mesh and its quality. If the displacement of the boundary nodes is causing an element to distort, we could increase or decrease the temperature to locally expand or contract, respectively, the element so as to prevent the element becoming invalid. We will discuss some potential forms of the thermal stresses for the purpose of controlling mesh validity and quality in Section  3. However, in this work we will assume that they do not depend on 
                        
                           u
                        
                     .

In this section, we will outline two possible choices for the thermal stress terms: a simple isotropic case in which each spatial direction receives an equal stress contribution, and a more complex anisotropic term based on the elemental metric tensor.

The simplest model of thermal stresses is that of a linear isotropic material and the corresponding thermal stress tensor is of the form 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 β
                                 
                                    (
                                    T
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    I
                                 
                              
                           
                         where 
                           T
                         is the temperature, 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is the temperature of the stress-free state, and 
                           β
                         is a thermal coefficient. We will consider the temperature to be a function of the position, i.e.  
                           T
                           =
                           T
                           
                              (
                              
                                 x
                              
                              )
                           
                        .

The main drawback of this term is when considering elements that are highly stretched, such as those found in boundary layer meshes. In these cases, the thermal stress being equal in each spatial direction may result in suboptimal results. To counteract this, in the following sections we define an anisotropic stress form which is designed to take into account stretched elements.

Let us start by introducing the notation to be used in this section to describe the mappings involved in the definition of the thermal stresses. For the purposes of interpolation, a high-order element, denoted by 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                        , is represented as the image of a standard element, 
                           
                              
                                 Ω
                              
                              
                                 s
                              
                              
                                 e
                              
                           
                        , by a mapping 
                           M
                        . Here we will also introduce an additional auxiliary mapping, 
                           A
                           :
                           
                              
                                 Ω
                              
                              
                                 s
                              
                              
                                 e
                              
                           
                           →
                           
                              
                                 Ω
                              
                              
                                 r
                              
                              
                                 e
                              
                           
                        , where 
                           
                              
                                 Ω
                              
                              
                                 r
                              
                           
                         denotes a reference element. 
                           
                              
                                 M
                              
                              
                                 ⋆
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 −
                                 1
                              
                           
                           ∘
                           M
                           :
                           
                              
                                 Ω
                              
                              
                                 r
                              
                              
                                 e
                              
                           
                           →
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                         will be later used as a key ingredient to measure the element quality. The notation is illustrated in Fig. 2
                         for a high-order triangular element.

We note that this formulation differs to the anisotropic term presented in  [14], in which the mapping term 
                           M
                         from the standard element to 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                         was used. The use of the mapping 
                           
                              
                                 M
                              
                              
                                 ∗
                              
                           
                         permits us a greater degree of flexibility in what we define as a ‘good quality’ high-order element. As an example, it may very well be the case that boundary layers of thin, highly stretched elements, are to be deformed. In this case, the use of quality measures that are based on 
                           M
                         will always see these elements as ‘bad quality’. On the other hand, the straight sided element will naturally be thin and elongated. Since 
                           
                              
                                 M
                              
                              
                                 ∗
                              
                           
                         measures the distortion of the element under the imposed curvature, measures of quality based on this mapping will still consider these elements ‘good quality’ and allow us to minimize the distortion which occurs from the curvature of the element.

We will discuss some of the properties in the following with a view to devising an expression of the thermal stresses suitable to control the validity of the mesh by counteracting the deformation caused by the deformation induced by the displacement of the boundary.

Following the notation of Fig. 3
                           , the small displacement, 
                              δ
                              
                                 x
                              
                           , in the reference space is transformed by the mapping 
                              
                                 
                                    M
                                 
                                 
                                    ⋆
                                 
                              
                            into the (also small) displacement, 
                              δ
                              
                                 y
                              
                           , in the physical space. Using a truncated Taylor series expansion, we write 
                              
                                 
                                    
                                       y
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    +
                                    δ
                                    
                                       y
                                    
                                    =
                                    
                                       y
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       +
                                       δ
                                       
                                          x
                                       
                                       )
                                    
                                    ≈
                                    
                                       y
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    +
                                    
                                       J
                                    
                                    δ
                                    
                                       x
                                    
                                    
                                    →
                                    
                                    δ
                                    
                                       y
                                    
                                    ≈
                                    
                                       J
                                    
                                    δ
                                    
                                       x
                                    
                                 
                              
                            where 
                              
                                 J
                              
                            is referred to as the Jacobian matrix of the mapping or as the deformation gradient tensor in solid mechanics  [15], and is given by 
                              
                                 
                                    
                                       J
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             y
                                          
                                       
                                       
                                          ∂
                                          
                                             x
                                          
                                       
                                    
                                    ≡
                                    
                                       
                                          J
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ;
                                    
                                    i
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                            where 
                              n
                            is the number of dimensions of the domain.

The determinant of the Jacobian matrix, 
                              J
                              =
                              det
                              
                                 J
                              
                           , hereafter referred to as the Jacobian, relates (small) areas (
                              n
                              =
                              2
                           ) and volumes (
                              n
                              =
                              3
                           ) in the reference and physical elements, or any other pair of elements. A value 
                              J
                              ≤
                              0
                            indicates that the element is inverted with negative or zero area and thus it is invalid for computation.

The transformation of the length of small displacements is given by 
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             δ
                                             
                                                y
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    δ
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                    δ
                                    
                                       y
                                    
                                    =
                                    δ
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             J
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                    
                                       J
                                    
                                    δ
                                    
                                       x
                                    
                                    
                                    →
                                    
                                    
                                       
                                          
                                             ‖
                                             δ
                                             
                                                y
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ‖
                                             δ
                                             
                                                x
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       G
                                    
                                    
                                       u
                                    
                                 
                              
                            where 
                              
                                 u
                              
                            is a unit vector parallel to 
                              δ
                              
                                 x
                              
                            and 
                              
                                 G
                              
                              =
                              
                                 
                                    
                                       J
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 J
                              
                            is the metric tensor or, in solid mechanics, the right Cauchy–Green deformation tensor. It provides measures of distortion of the physical element, with respect to the reference element, that can be used to determine the validity of the element and used to assess its quality. The metric tensor also contains directional information that will allow us to account for anisotropy in elemental distortion.

We are seeking the extrema of the ratio 
                              ρ
                              =
                              
                                 
                                    
                                       ‖
                                       δ
                                       
                                          y
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    
                                       ‖
                                       δ
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                            subject to 
                              
                                 ‖
                                 
                                    u
                                 
                                 ‖
                              
                              =
                              1
                           . Using Lagrange multipliers, we minimize 
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       G
                                    
                                    
                                       u
                                    
                                    +
                                    λ
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                ‖
                                                
                                                   u
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                            with respect to 
                              
                                 u
                              
                            and this leads to 
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    2
                                    λ
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    0
                                    ;
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    ≡
                                    
                                       (
                                       
                                          G
                                       
                                       −
                                       λ
                                       
                                          I
                                       
                                       )
                                    
                                    
                                       u
                                    
                                    =
                                    
                                       0
                                    
                                    .
                                 
                              
                            The metric tensor is symmetric and positive definite if the Jacobian matrix is non-singular. If 
                              J
                              >
                              0
                            then the metric tensor has two real and positive eigenvalues that correspond to the maximum and minimum values of 
                              
                                 
                                    ρ
                                 
                                 
                                    ˆ
                                 
                              
                           . The metric tensor can be written as 
                              
                                 (4)
                                 
                                    
                                       G
                                    
                                    =
                                    
                                       R
                                    
                                    
                                    
                                       D
                                    
                                    
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                            where 
                              
                                 R
                              
                            is the matrix of eigenvectors and 
                              
                                 D
                              
                            is a diagonal matrix that contains the eigenvalues. Following the notation of Fig. 4
                           , a two-dimensional interpretation of the deformation generated by the mapping is that a circle of radius 
                              L
                            is transformed into an ellipse of semi-axes 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            aligned with the eigenvectors of the tensor 
                              
                                 G
                              
                           .

In general, the strains in the principal directions associated with the mapping deformation are 
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          L
                                       
                                       
                                          L
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    1
                                    ;
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                            where 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                            are the eigenvalues of 
                              
                                 G
                              
                           . We want the thermal stresses to counteract these strain so we propose a tensor of pseudo-thermal stresses of the form 
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    −
                                    α
                                    E
                                    
                                    
                                       R
                                    
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            where 
                              α
                            is a user-defined constant that controls the amount of thermal stresses being added.

Now that we have defined some potential forms of the thermal stresses, in the following section we discuss specific details of our implementation for the system defined by Eq. (1).

@&#IMPLEMENTATION@&#

To obtain a high-order finite element discretization of this problem, we select a mesh of the domain 
                        Ω
                        =
                        
                           
                              ⋃
                           
                           
                              e
                              =
                              1
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    
                                       el
                                    
                                 
                              
                           
                        
                        
                           
                              Ω
                           
                           
                              e
                           
                        
                     , where 
                        
                           
                              Ω
                           
                           
                              e
                           
                        
                      defines an element of the mesh. We will utilize a Galerkin discretization of Eq. (1), which therefore requires the definition of trial and test spaces. As we wish to maintain conformity of the mesh, we select the continuous subspaces 
                        
                           
                              
                                 X
                                 =
                                 
                                    {
                                    
                                       v
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    ∣
                                    
                                       v
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   P
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       v
                                    
                                    
                                       
                                          |
                                       
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    =
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                           
                              
                                 V
                                 =
                                 
                                    {
                                    
                                       v
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    ∣
                                    
                                       v
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   P
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       v
                                    
                                    
                                       
                                          |
                                       
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    =
                                    0
                                    }
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              N
                           
                        
                        
                           (
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                           )
                        
                      is the space of all polynomials of degree up to 
                        N
                      and we recall 
                        
                           
                              
                                 u
                              
                           
                           
                              ˆ
                           
                        
                      is the displacement imposed at the boundary. Multiplying (1) by a test function 
                        
                           v
                        
                        ∈
                        V
                     , taking an approximate solution 
                        
                           
                              
                                 u
                              
                           
                           
                              h
                           
                        
                        ∈
                        X
                      and integrating by parts, we obtain the weak formulation: find 
                        
                           
                              
                                 u
                              
                           
                           
                              h
                           
                        
                        ∈
                        X
                      such that 
                        
                           (6)
                           
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              ∇
                              
                                 v
                              
                              :
                              
                                 S
                              
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                              
                              d
                              x
                              =
                              −
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              
                                 f
                              
                              
                              
                                 v
                              
                              
                              d
                              x
                           
                        
                      for all 
                        
                           v
                        
                        ∈
                        V
                     . Here, 
                        
                           A
                        
                        :
                        
                           B
                        
                      represents the Frobenius inner product 
                        
                           
                              
                                 A
                              
                              :
                              
                                 B
                              
                              =
                              Tr
                              
                                 (
                                 
                                    A
                                 
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

The discretization of this system is performed using the spectral/
                        h
                        p
                      element framework described in  [16] and implemented in the open-source code Nektar++   [17]. Nektar++ supports simplex elements such as triangles and tetrahedra, as well as quadrilateral, prismatic, pyramidal and hexahedral elements. The use of a hierarchical, 
                        
                           
                              C
                           
                           
                              0
                           
                        
                     , tensor product modal basis function locally on each element ensures that along common triangular or quadrilateral faces, 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      continuity is imposed. One can therefore obtain various hybrid meshes by connecting elements. The implementation here generically supports all of these element types.

To facilitate the use of numerical integration required for the calculation of the integrals in the discrete system (6), a high-order element, denoted by 
                        
                           
                              Ω
                           
                           
                              e
                           
                        
                     , is represented as the image of a standard element, 
                        
                           
                              Ω
                           
                           
                              s
                           
                        
                     , by a mapping 
                        M
                     . This is depicted in Fig. 2 for a high-order triangular element. The mapping plays an important role in the quality of the mesh and the conditioning of the system of equation  (6) as discussed in Section  3. Of particular concern are elements with 
                        J
                        ≤
                        0
                     , which indicates that the element is inverted with negative or zero area and thus it is invalid for computation unless specific measures are taken to account for this, as outlined in e.g.  [18].

In the formulation we consider here, the thermal stress terms are not a function of 
                        
                           u
                        
                      and so can be omitted from the stiffness matrix arising from the elastic stress tensor 
                        
                           
                              
                                 S
                              
                           
                           
                              e
                           
                        
                     . For small problems, the matrix system described by the left-hand side of  Eq. (6) is globally assembled across all elements, forming a single, large matrix system. The solution is then found with a direct Cholesky decomposition using the LAPACK libraries. We note that this may not be the most effective strategy. Other sparse matrix packages, such as UMFPACK  [19], may yield faster solution times, depending on parameters such as the polynomial order, problem dimension and element types under consideration. However for larger problems, particularly in three dimensions, we instead construct a matrix representation of 
                        
                           
                              
                                 S
                              
                           
                           
                              e
                           
                        
                      on each element and utilize a Jacobi-preconditioned conjugate gradient method within Nektar++ to solve the system across multiple processors. Optionally, since the modal basis functions permit a decomposition of each element into modes lying on the boundary of an element and those lying within the interior, we may construct a statically-condensed system on which we solve for only the degrees of freedom lying on the boundary of each element. This approach gives significant efficiency improvements at high polynomial orders.

As an indication of performance, the matrix generation, linear solve and subsequent deformation of the domain on a 1000 element triangular mesh at polynomial order 
                        P
                        =
                        6
                      requires around 1.5 s of runtime on a single core of a Intel Xeon E5-2690 processor. It should be noted however that no particular efforts have been made to optimize these routines, particularly in regards to matrix generation.

This section presents some examples of application of the elastic analogy for high-order mesh generation. We start with the deformation of a two-dimensional boundary-layer mesh without thermal stresses and follow with the application of isotropic and anisotropic pseudo-thermal stresses to two- and three-dimensional problems.

Throughout this section, we will consider relatively straightforward test cases of standard two- and three-dimensional shapes such as circles, spheres and cylinders. In each instance, the methodology we use to assess the performance of each method consists of a repeatedly apply translation or rotation transformations to an initially valid high-order mesh, until the presence of negative Jacobians is detected. Whilst this is clearly not a typical mesh generation problem, this does allow us to decide upon the relative benefits of each method using only a single parameter. This therefore allows us to bypass the definition of a (possibly contentious) measure of element quality that would be needed as a benchmark for comparison.

In Fig. 5
                         we demonstrate the general methodology of the linear elastic analogy used in the coming results when applied to a mesh generation problem. The starting point is a small boundary-layer mesh of 72 triangular elements, on which we intend to apply a large sinusoidal deformation to the bottom edge. Since the linear elastic equations are only valid when small deformations are considered, we choose to adopt a sub-stepping approach, whereby the large deformation at the boundary is split into a number of smaller steps in order to allow the generation of a valid mesh. At the end of each step, we apply the deformation to the mesh, reconstruct the matrix system on the mesh to account for the updated geometric factors and then solve the linear system to obtain the next solution field. In the example of Fig. 5 we have used 100 steps to achieve the deformation of the boundary.

Here, and in all the examples that follow, we have assumed 
                           
                              f
                           
                           =
                           
                              0
                           
                         and constant values of the elastic parameters 
                           E
                         and 
                           ν
                        . In the absence of a source term, the value of Young’s modulus, 
                           E
                        , is not important since it is just a multiplicative factor in the expression of the stresses. On the other hand, the Poisson ratio, 
                           ν
                        , is a measure of the compressibility of the material and it is chosen as the maximum value in its allowable range, 
                           0
                           <
                           ν
                           <
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                        , that would permit to accommodate the area changes induced by the displacement of the boundary. We have used 
                           ν
                           =
                           0.3
                         in the present case.

To illustrate the effect of the additional thermal stresses in the validity and quality of the mesh we use a simple geometry that consists of a square plate 
                           
                              
                                 
                                    [
                                    −
                                    1
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 2
                              
                           
                         with circular hole of radius 
                           r
                           =
                           0.1
                         which is depicted in Fig. 6
                        . The points in the boundary of the circular hole are rotated anti-clockwise around its centre by a small angle 
                           θ
                        , whereas the points along the boundary of the square remain stationary. This rotation is then repeatedly applied. Our objective is to determine the maximum value 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                         of the angle that we can impose before the appearance of the first invalid element, i.e. one with a zero or negative Jacobian. Given that we are solving the linear elasticity equations which are only valid for small deformations, the rotation is applied in small angular steps with 
                           θ
                           =
                           
                              
                                 1
                              
                              
                                 ∘
                              
                           
                        .

We now consider the two thermal stress terms discussed in Section  3: an isotropic formulation based on the Jacobian of the elemental mapping and an anisotropic tensor that utilizes the eigenvalues of the metric tensor of the mapping to account for anisotropy in the deformation of the mesh.

First we consider an isotropic tensor of thermal stresses of the form 
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    β
                                    J
                                    
                                       I
                                    
                                 
                              
                            where 
                              J
                            is the Jacobian of the elemental mapping of the element, 
                              β
                            is a scaling factor and 
                              
                                 I
                              
                            is the identity tensor.

The value of 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                            as a function of 
                              β
                            is shown in Fig. 7
                           (a). We also consider three polynomial orders 
                              P
                              =
                              4
                              ,
                              6
                            and 8 to demonstrate how thermal stresses affect both high- and low-order element types.

The value 
                              β
                              =
                              0
                            corresponds to the absence of thermal terms for which 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                              ≈
                              8
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                            almost independently of the polynomial order. The inclusion of thermal stresses clearly improves the performance of the mesh deformation algorithm. It allows higher values of 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                            for 
                              β
                              >
                              0
                            and the best values for 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                            are obtained in the approximate range 
                              20
                              ≤
                              β
                              ≤
                              25
                            with corresponding best values of maximum angle in the range 
                              12
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                              ≤
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                              ≤
                              13
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                            which is a significant improvement with respect to the non-heated case. There is, however, a clear sensitivity to the polynomial order in these results. The deformed mesh and iso-contours of temperature for 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                              =
                              13
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                            in the case where 
                              P
                              =
                              6
                            are shown in Fig. 7(b).

To measure the effect of the isotropic temperature terms on the solution field, for each element we calculate the scaled Jacobian 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          min
                                          J
                                          
                                             (
                                             
                                                ξ
                                             
                                             )
                                          
                                       
                                       
                                          max
                                          J
                                          
                                             (
                                             ξ
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              ξ
                            denotes a coordinate inside the reference element 
                              
                                 
                                    Ω
                                 
                                 
                                    s
                                 
                                 
                                    e
                                 
                              
                           , 
                              J
                              
                                 (
                                 ξ
                                 )
                              
                            is the Jacobian of the mapping 
                              M
                            evaluated at 
                              ξ
                            and the maximum or minimum is evaluated at a tensor product of 
                              
                                 
                                    
                                       (
                                       P
                                       +
                                       1
                                       )
                                    
                                 
                                 
                                    n
                                 
                              
                            quadrature points within 
                              
                                 
                                    Ω
                                 
                                 
                                    s
                                 
                                 
                                    e
                                 
                              
                           .

This is a straightforward measure of quality which is one for all straight-sided elements. Whilst this measure of quality is not necessarily ideal in all circumstances, for this application we note that values of 
                              
                                 
                                    J
                                 
                                 
                                    s
                                 
                              
                            which differ significantly from one indicate badly conditioned elements. We measure the distribution of the scaled Jacobians in the mesh at a fixed rotation angle of 
                              7
                              
                                 
                                    5
                                 
                                 
                                    ∘
                                 
                              
                           . Fig. 8
                            shows the difference in distributions when no thermal stresses are used and when the isotropic thermal stress is applied with 
                              β
                              =
                              25
                            at 
                              P
                              =
                              6
                           . We clearly see that the thermal stress has a positive impact on the quality of the elements, with the entire distribution shifting to the right and the lowest value of the scaled Jacobian significantly increased, demonstrating a notable improvement in the quality of the elements at this rotation angle.

The pseudo-thermal stress term proposed in this section is based on an eigenvalue decomposition of the metric tensor, 
                              
                                 G
                              
                           , of the elemental mapping 
                              
                                 
                                    M
                                 
                                 
                                    ⋆
                                 
                              
                            given by Eq. (4). The metric tensor is represented by a 
                              n
                              ×
                              n
                            matrix with 
                              n
                            being the spatial dimension. Its eigenvalues are a measure of distortion in the direction of its eigenvectors. We take advantage of this property, and adopting the form (5), we write an anisotropic pseudo-thermal stress tensor as 
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    γ
                                    
                                       R
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       D
                                    
                                 
                                 
                                    ˆ
                                 
                              
                            is a diagonal matrix. Its entries are obtained by suitably scaling the eigenvalues of 
                              
                                 D
                              
                            to counteract the elemental distortion generated by the displacement of the boundary.


                           Fig. 9
                            shows the maximum angle obtained for our test case for various values of 
                              γ
                           . The maximum angle is generally higher than in the non-thermal case (
                              γ
                              =
                              0
                           ) and there is an optimal value of 
                              γ
                              ≈
                              0.015
                            for all the polynomial orders (
                              P
                              =
                              4
                              ,
                              6
                              ,
                              8
                           ) leading to a best value 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                              ≈
                              13
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                           . This value is similar to the best obtained for the isotropic case, but here it is achieved for all polynomial orders and is less sensitive to the value of 
                              P
                           . We note that the results presented here are a marked improvement over the anisotropic term used in  [14], both in terms of 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                            and the independence in polynomial order, which highlights the benefits of using the mapping 
                              
                                 
                                    M
                                 
                                 
                                    ∗
                                 
                              
                           .

To demonstrate the significance of using an anisotropic formulation, we visualize the thermal stress tensor 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    t
                                 
                              
                            in Fig. 10
                           . At each quadrature point within an element, we draw an ellipse whose major and minor axes are determined by the two eigenvectors of 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    t
                                 
                              
                           , and are subsequently scaled by its eigenvalues. We see that the anisotropic formulation successfully identifies elements that are significantly deformed, and increases or decreases the ‘heats’ in the direction that would make the element less deformed.

In this section, we consider the extension of this method to three dimensions, which is not previously considered in  [14]. The first example is an extruded version of a two-dimensional problem. The second is distinctly three-dimensional, which shows the potential of this method to improve elasticity-based generation approaches for more complex three-dimensional problems.

The example in this section is an extension of the one described in the previous section to three dimensions. The geometry of the domain is a cylindrical ring of height 
                              L
                              =
                              1
                           , with an inner cylinder of radius 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              =
                              0.25
                            and an outer cylinder of radius 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           . We apply a deformation by twisting the inner cylinder along its axis which is labelled the 
                              z
                           -axis in the sketch of Fig. 11
                           . In this example, we select a Poisson ratio of 
                              ν
                              =
                              0.45
                           .

Here, the angle of rotation 
                              θ
                            is a function of space. We assume that the inner cylinder at 
                              z
                              =
                              L
                            will be rotated by an angle 
                              ϕ
                           . Then, the angle of rotation, 
                              θ
                           , that we impose to the inner cylinder varies linearly along the 
                              z
                           -axis and is given by 
                              θ
                              
                                 (
                                 z
                                 )
                              
                              =
                              ϕ
                              z
                              /
                              L
                           . Likewise, for the plane 
                              z
                              =
                              L
                           , we apply a rotation 
                              θ
                              
                                 (
                                 r
                                 )
                              
                              =
                              ϕ
                              ⋅
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 r
                                 )
                              
                              /
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            where 
                              r
                            denotes the radius of a given point 
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            in polar form. At all other boundaries, 
                              θ
                              =
                              0
                           . As in the previous examples, we choose a small incremental rotation of 
                              ϕ
                              =
                              
                                 
                                    1
                                 
                                 
                                    ∘
                                 
                              
                           , measuring the maximum angle 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                            through which we can rotate the inner cylinder before the appearance of a negative Jacobian.

An illustration of the initial, undeformed, surface of the three-dimensional mesh consisting of 483 high-order tetrahedral elements with a polynomial order 
                              P
                              =
                              4
                            is shown in Fig. 12
                           (a). Fig. 12(b) depicts the deformed mesh corresponding to a twist of 
                              ϕ
                              =
                              10
                              
                                 
                                    0
                                 
                                 
                                    ∘
                                 
                              
                           .

The maximum angle of rotation, 
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                           , that can be imposed before a negative Jacobian appears is given in Table 1
                            for the isotropic and anisotropic thermal stresses. These results confirm those obtained in the two-dimensional cases and show that the inclusion of thermal stresses permits larger deformations in all cases. Notably however, the use of anisotropic pseudo-thermal stresses allows for larger deformations than the isotropic form, in which only a marginal benefit can be seen. We also note that there is a large difference in the relative orders of magnitude between 
                              β
                            and 
                              γ
                           , as observed also in the two dimensional example. This is due to the different geometric scaling factors that are used in the formulation of the isotropic and anisotropic stress terms and could be removed with appropriate normalization.

To assess mesh quality, in Fig. 13
                            we visualize the cumulative distribution of scaled Jacobians, where for each value of the scaled Jacobian 
                              z
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , we measure the number of elements which have 
                              
                                 
                                    J
                                 
                                 
                                    s
                                 
                              
                              <
                              z
                           . Although the distribution shows far less improvement in quality than the two-dimensional example considered previously, at lower values of 
                              
                                 
                                    J
                                 
                                 
                                    s
                                 
                              
                            there is a small decrease in the number of ‘bad’ elements that are found.

This example aims to consider a completely three-dimensional problem that, unlike the previous example, is not extruded. We also consider a variation on the rotation transformation used to assess the method in all of the previous examples. We first generate a high-order mesh of a sphere of radius 0.25 at the point 
                              
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              
                            within a cube 
                              
                                 
                                    
                                       [
                                       −
                                       2
                                       ,
                                       2
                                       ]
                                    
                                 
                                 
                                    3
                                 
                              
                           , as seen in Fig. 14
                           (a). In a similar fashion to previous examples, the sphere is then repeatedly translated in the 
                              z
                           -direction by a displacement of 
                              
                                 Δ
                              
                              z
                              =
                              0.01
                            until negative Jacobians are detected within the mesh. We record the maximum displacement 
                              
                                 Δ
                              
                              
                                 
                                    z
                                 
                                 
                                    m
                                 
                              
                           .

The initial configuration of the mesh, which comprises 8347 curvilinear tetrahedra at polynomial order 
                              P
                              =
                              4
                           , can be seen in Fig. 14(b). This figure shows the faces of tetrahedra in the interior of the domain through a 
                              y
                           -
                              z
                            cross-section. Fig. 14(c) demonstrates the effect of a displacement of 
                              
                                 Δ
                              
                              z
                              =
                              0.40
                           , whereby the tetrahedra become highly deformed.


                           Table 2
                            shows the effects of the anisotropic thermal stress terms for various values of 
                              γ
                           . We note that when no thermal stress is used so that the solid body model is purely elastic (
                              γ
                              =
                              0
                           ), a displacement of 
                              
                                 Δ
                              
                              
                                 
                                    z
                                 
                                 
                                    m
                                 
                              
                              =
                              0.43
                            is obtained. With appropriate choice of the parameter 
                              γ
                           , we see that the maximum displacement can be increased by around 16%, which is similar in magnitude to the extruded ring example considered previously. This highlights that, whilst the effects of the thermal stress terms are not as pronounced as in two dimensions, there is still an advantage to be gained by incorporating them in the solid body model.

We have shown that incorporating thermal stresses which depend on quantities representative of the distortion of the element, such as the Jacobian and the metric tensor of the mapping, permits controlling the quality of high-order meshes generated by deforming a linear mesh through the displacement of its boundary nodes.

The two- and three-dimensional examples of mesh deformation with thermal stresses have shown that the proposed formulation allows for higher distortions than the one based solely on elastic stresses. Whilst the two-dimensional results show larger improvements for these relatively demanding cases, we have also shown that incorporating anisotropy in the definition of the pseudo-thermal stresses allows for larger deformations than the isotropic form and it is less sensitive to the polynomial order.

It is clear, however, that although the proof-of-concept formulation we present here shows the potential of this method, there are some limiting factors that can be improved upon in future work. Namely, while the two-dimensional examples we consider show a large improvement in performance with respect to the standard elasticity analogy, in three dimensions, the effect is far less pronounced. We believe that this can mostly be attributed to the use of linear models for both the elastic and thermal stress terms. With the use of more complex stress tensors, there is clearly more scope for improvement, both in terms of the results that we have presented, as well as in improving the robustness of the method.

We note that presently, parameters such as the number of substeps, as well as constants 
                        β
                      and 
                        γ
                     , must be chosen arbitrarily or based on the experience of previous simulations. In three dimensions in particular, the choice of 
                        β
                      and 
                        γ
                      is quite sensitive in terms of obtaining optimal performance. It is likely that the use of nonlinear elasticity models, where the number of substeps can be notionally aligned with the number of iterations of the method used to tackle the nonlinearity, may very well go some way towards solving this issue. Additionally, in this work, the thermal terms are restricted so that they are not functions of the displacement. This simplifies their implementation and still allows us to show their ability to improve the resulting meshes. However, it also limits their ability to correct for distorted elements and requires the use of parameters 
                        β
                      and 
                        γ
                     .

Future work should therefore focus on removing this restriction, together with the incorporation of these thermal terms into nonlinear elastic analogies. We posit that with further development of the form of the anisotropic terms, this method has the potential to significantly improve the meshes generated using elastic analogies.

@&#ACKNOWLEDGEMENTS@&#

DM acknowledges support under the Laminar Flow Control Centre funded by Airbus/EADS and EPSRC under grant EP/I037946. SJS additionally acknowledges Royal Academy of Engineering support under their research chair scheme.

@&#REFERENCES@&#

