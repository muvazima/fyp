@&#MAIN-TITLE@&#A competitive hub location and pricing problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We solve a hub location- pricing problem.


                        
                        
                           
                           Profit maximization dominates market share maximization in competitive situations.


                        
                        
                           
                           Customers’ sensitivity to price is shown to be determinant for location.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Location

Competitive models

Hub location problems

Location and pricing

Hub and spoke

@&#ABSTRACT@&#


               
               
                  We formulate and solve a new hub location and pricing problem, describing a situation in which an existing transportation company operates a hub and spoke network, and a new company wants to enter into the same market, using an incomplete hub and spoke network. The entrant maximizes its profit by choosing the best hub locations and network topology and applying optimal pricing, considering that the existing company applies mill pricing. Customers’ behavior is modeled using a logit discrete choice model. We solve instances derived from the CAB dataset using a genetic algorithm and a closed expression for the optimal pricing. Our model confirms that, in competitive settings, seeking the largest market share is dominated by profit maximization. We also describe some conditions under which it is not convenient for the entrant to enter the market.
               
            

@&#INTRODUCTION@&#

Most air passenger transportation and package delivery companies have chosen the hub and spoke topology for their networks (Gelareh & Nickel, 2011). This topology makes use of transshipment and flow consolidation facilities called hubs, and significantly reduces the number of routes required to connect all origins and destinations in a region. It also allows taking advantage of any existing economies of scale, by consolidating traffic in inter-hub transportation and on the spokes (arcs that connect hub nodes to non-hub nodes), as compared to a point to point network. Bigger and more efficient vehicles are used on high traffic route segments, and there is a higher asset utilization throughout the network.

The first model for the optimal design of hub networks (the Hub Location Problem) was introduced by O’Kelly (1986) and first formulated as an optimization problem by O’Kelly (1987). The literature about hub problems is now extensive. Hub location problems are classified the same way as facility location problems are (Campbell, 1994): median, covering, center and fixed costs problems. Complete reviews of hub location problems can be found in Campbell, Ernst, and Krishnamoorthy (2004), Alumur and Kara (2008), Kara and Taner (2011), Campbell and O’Kelly (2012), Faharani, Hetmakfar, Arabani, and Nikbakhsh (2013).

Current trends in hub location include the development of new formulations that allow obtaining good or even optimal solutions in less time for larger instances of the problems. The work along this line has explored the use of polyhedral properties of the formulations, as in Hamacher, Labbé, Nickel, and Sonneborn (2004) or the development of tighter and smaller formulations (Marín, Cánovas, & Landete, 2006; García, Landete, & Marín, 2012). From a different viewpoint, Contreras and Fernández (2012) have proposed a unified view, formulations and algorithmic insights of location and network design problems, including the hub location problems as a special case. Also, solution methods like Benders Decomposition (de Camargo, de Miranda, & Luna, 2008), and Branch and Price (Contreras, Diaz, & Fernandez, 2010a), have been proposed.

Several extensions of the original problems have been used successfully. Congestion has been considered by constraining queue length at hubs (Marianov & Serra, 2003; Mohammadi, Jolai, & Rostami, 2011); as well as by adding a non-linear term in the objective and solving the problem either using Lagrangian methods (Elhedhli & Wu, 2010), or evolutionary algorithms, as in Koksalan and Soylu (2010).

In regard to economies of scale, particularly interesting and relevant to all the research in hub location is the observation by Campbell (2012). Through the analysis of a very extensive set of cases, he found that the fundamental hub location models share the following problem: depending on the origin–destination flows, it could happen that the traffic between some hubs is too small for making use of economies of scale, and conversely, the traffic on spokes could be large enough to apply a discounted cost. This shortcoming was also pointed out by Bryan (1998), O’Kelly and Bryan (1998), de Camargo, de Miranda, and Luna (2009). The fundamental hub location models apply a fixed, flow independent discount factor to all inter-hub arcs, and they do not apply any discount on high-traffic spokes. Further, the fundamental hub location models have a fully connected network of discounted arcs between all hubs.

Addressing this issue should become a hot research topic, and some better representations of economies of scale have already been proposed by approximating the non-linear inter-hub discount function with a piece-wise linear function (Bryan, 1998; O’Kelly & Bryan, 1998; Kimms, 2006); by using incomplete inter-hub networks (Alumur, Kara, & Karasan, 2009; Calik, Alumur, Kara, & Karasan, 2009; Contreras, Fernández, & Marín, 2010b); using hub-arc models (Campbell, Ernst, & Krishnamoorthy, 2005a, 2005b; Campbell, 2009); and by forcing a minimum flow on inter-hub links (Podnar, Skorin-Kapov, & Skorin-Kapov, 2002; Campbell et al., 2005a, Campbell, Ernst, & Krishnamoorthy, 2005b). Currently, however, most of the researchers use the fundamental approach of discounting the flow between hubs, independent of its magnitude, (Faharani et al., 2013; Campbell & O’Kelly, 2012), mainly because of the computational atractiveness of such approach, and the fact that the search for a completely successful model is still open. Among these, we use a model in which a constant (flow-independent) discount between hubs and no discount on spokes are considered, and an incomplete inter-hub network is allowed. Although all these models tend to improve the application of economies of scale, they still do not completely solve the problem. We do not use hub-arc models, because they do not apply economies of scale on spokes with large flows, and they tend to locate a number of hubs that is very large, in times disproportionate for the airline industry (Campbell, 2009). Furthermore, deriving a closed form expression for both piecewise linearization models and models that require a minimum flow on inter-hub arcs would require an additional level of iteration of the procedure in this paper, because the cost and existence of different routes depends on the amount of the predicted flow, making the problem close to intractable. Also, piecewise linearization models are more complicated in terms of number of variables and constraints.

Competition between firms that use hub networks has been studied mainly from a sequential location approach, in which an existing firm, called the incumbent or leader, serves the demand in a region, and a new firm, the entrant or follower, wants to enter the market. In the first article on competitive hub location, Marianov, Serra, and ReVelle (1999) model a situation in which the entrant captures a flow if its costs are lower than those of the incumbent’s. This approach was extended to gradual capture by Eiselt and Marianov (2009). A related line of research was followed by Gelareh, Nickel, and Pisinger (2010), where the newcoming company is a liner service provider that maximizes its market share, depending both on service time and transportation cost. The formulation is very hard to solve ‘as is’, and a specialized Lagrangian method is used. Using a game theoretical approach, Sasaki and Fukushima (2001) state the Stackelberg hub location problem, in which the incumbent competes with several entrants to maximize its profit. Only one hub is considered in every origin–destination route. Later, Adler and Smilowitz (2007) introduce a framework to decide the convenience of merging airlines or creating alliances, using a game theory based approach. More recently Sasaki, Campbell, Ernst, and Krishnamoorthy (2009) propose a problem in which two agents locate arcs in order to maximize their respective revenues under the Stackelberg framework, allowing more than one hub in a route.


                     Dobson and Lederer (1993) propose the problem of maximizing profit of an airline for a network with only one hub, given a discrete consumer density as a function of departure time, duration and price of the route to be travelled. This is an operational problem, not including location decisions. Simultaneous location and pricing problems have been proposed and solved by Serra and ReVelle (1999). To the best of our knowledge, there is no literature on hub location problems explicitly including pricing and location decisions. We study a competitive problem, including discrete choice between routes, using a hub location model with incomplete hub-connectivity.

We propose a novel hub location problem, called the Competitive Hub Location and Pricing Problem (CHLPP). An existing company (or group of companies), called the incumbent, utilizes a transportation network with a hub and spoke topology, and charges its costs plus a fixed additional percentage to their customers (mill pricing). A new company, the entrant, wants to offer its services in the same market, using its own hub and spoke network and setting prices so to maximize its profit, rather than its market share – a cherry-picking strategy. The profit comes from the revenues because of captured flows, subtracting the fixed and variable costs. Both the incumbent and the newcomer offer several routes. Customers choose which company and route to patronize by price, and their decision process is modeled using a logit model. The question to be answered is: Can a newcomer obtain profit under these conditions, even with higher operating costs than the incumbent? In order to answer this question, our procedure finds how many hubs to locate, where should they be located, what is the best route network, and the optimal price of the services.

The contributions of this paper are as follows. In the first place, we formulate a hub problem including aspects that were never taken into consideration together, as the optimal pricing decision and a discrete choice by customers. Secondly, we derive a closed form expression for the optimal pricing. Third, we solve the non-linear problem using a genetic algorithm. Finally, we make an extensive analysis of the scenarios that a newcoming company would face, and the best actions it could take, when the objective is profit maximization – as opposed to cost minimization or maximization of market share.

Note that hub location decisions are strategic, while pricing decisions are tactical or even operational. Linking these two levels may seem unusual at first sight. However, location or route opening decisions – or even entrance into a market – can be very dependent on the revenues that a company can obtain by operating these locations and routes. Revenues, in turn, depend on the pricing structure and on the competitive context. In other words, without consideration of the feasible range of prices that the entrant can charge, it is difficult to make good location decisions, and we explore here the relationship between both. Once the firm is established, revenue management techniques can be applied to decide on the day to day prices.

The proposed model is applied to the air passenger industry. However, with slight changes in the discrete choice model, it can be applied to mail and freight transportation industries, or any other industry that benefits from a hub and spoke network structure.

The remainder of this paper is organized as follows. Section 2 describes the problem and the mathematical model. Section 3 describes the genetic algorithm. Section 4 presents the computational results using the CAB dataset. Finally, in Section 5 we provide general conclusions.

Air passenger traffic in a region is served by an existing company (or a set of companies already established in the market, collectively), called the incumbent, that utilizes a transportation network with a hub and spoke topology. We make the assumption, customary in fundamental hub location models, that there are reduced transportation costs (due to economies of scale) in the traffic between hubs, and not on spokes, and the discount factors are constant. We assume that all the incumbent’s hubs are connected, although full interconnection is not required for the entrant’s inter-hub network. The incumbent uses mill pricing, i.e., charges its costs plus a fixed profit percentage. The incumbent’s hubs are located optimally for cost minimization when serving all the demand, though the incumbent may end up serving less than that after the entrant arrives. A new company, the entrant, intends to enter the same market, using its own hub and spoke network and setting prices so to maximize its profit, rather than its market share, i.e., a cherry-picking strategy. The entrant does not share hubs with the incumbent, but could use the same locations (cities) for sitting them. The profit is equal to the revenues from captured flows, once fixed and variable costs are subtracted. Both the incumbent and the newcomer may offer several routes between origins and destinations in the region, i.e. an origin–destination pair may be served by more than one route belonging to the same company. Customers choose which company and route to patronize by price, although the model could trivially accommodate other attributes as travel time or number of legs. Customers’ decision process is modeled using a logit model. The logit model is well validated in the transportation literature (see Ortúzar & Willumsen, 2011). Logit models are currently the most popular models for representing discrete choice, because they provide a closed form expression and because they can accommodate several different attributes of the alternatives as cost, waiting time, travel time, and so on. Logit models serve well in the case of passengers and multiple routes. If mail or package service is to be represented, then, rather than choosing among multiple routes, customers choose among several providers. Again, a situation that can be represented using logit models.

The problem is defined over a graph G
                     =
                     G(N,
                     A), where N is the set of nodes and A is the set of arcs. Each arc has a fixed cost, K
                     
                        ij
                     , and a variable cost c
                     
                        ij
                      per unit of flow. For the formulation we assume that both the incumbent and the entrant have the same arc costs, but this assumption can be trivially relaxed. To model inter-hub discounts, let χ, α and δ be the discount factors due to flow consolidation in collection (origin to hub), transfer (between hubs) and distribution (hub to destination), respectively. Let F
                     
                        k
                      be the cost of locating a hub at node k
                     ∈
                     N, and W
                     
                        ij
                      is the given inelastic demand, in terms of the flow to be transported from origin node i
                     ∈
                     N to destination node j
                     ∈
                     N. All demand is served by either the incumbent or the entrant. The percentage over the cost charged by the incumbent is Δ. This percentage could be easily made different for different arcs or competitors. The logit model has a known sensitivity parameter Θ. Higher values of Θ mean that customers are very sensitive to price and they will mostly choose less expensive routes. Smaller values of Θ mean that the customers are less sensitive to price (or price differences), and there will be a higher customers’ spread among the different routes. For further details on logit models, see Ortúzar and Willumsen (2011). Finally, P is the set of nodes where the incumbent’s hubs are located. The proposed model is the following:
                        
                           (1)
                           
                              Z
                              =
                              
                                 max
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       ,
                                       m
                                       ∈
                                       N
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    ijkm
                                 
                              
                              -
                              
                                 
                                    c
                                 
                                 
                                    ijkm
                                 
                              
                              )
                              
                                 
                                    W
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijkm
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    ij
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       N
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       m
                                       ∈
                                       N
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijkm
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       m
                                       ∈
                                       P
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    ijkm
                                 
                              
                              =
                              1
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ∈
                              N
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    X
                                 
                                 
                                    ijkm
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          ik
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          km
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          mj
                                       
                                    
                                    exp
                                    (
                                    -
                                    Θ
                                    
                                       
                                          p
                                       
                                       
                                          ijkm
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                   ,
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   is
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   st
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   tj
                                                
                                             
                                             exp
                                             (
                                             -
                                             Θ
                                             
                                                
                                                   p
                                                
                                                
                                                   ijst
                                                
                                             
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ,
                              
                              k
                              ,
                              
                              m
                              ∈
                              N
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    Z
                                 
                                 
                                    ijkm
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    -
                                    Θ
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ijkm
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                   ,
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   is
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   st
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   tj
                                                
                                             
                                             exp
                                             (
                                             -
                                             Θ
                                             
                                                
                                                   p
                                                
                                                
                                                   ijst
                                                
                                             
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ,
                              
                              k
                              ,
                              
                              m
                              ∈
                              N
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ijst
                                 
                              
                              =
                              (
                              1
                              +
                              Δ
                              )
                              
                                 
                                    c
                                 
                                 
                                    ijst
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ,
                              
                              s
                              ,
                              
                              t
                              ∈
                              N
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    c
                                 
                                 
                                    ijkm
                                 
                              
                              =
                              χ
                              ·
                              
                                 
                                    c
                                 
                                 
                                    ik
                                 
                              
                              +
                              α
                              ·
                              
                                 
                                    c
                                 
                                 
                                    km
                                 
                              
                              +
                              δ
                              ·
                              
                                 
                                    c
                                 
                                 
                                    mj
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ,
                              
                              k
                              ,
                              
                              m
                              ∈
                              N
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    η
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       ,
                                       t
                                       ∈
                                       P
                                    
                                 
                              
                              exp
                              (
                              -
                              Θ
                              ·
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ijst
                                 
                              
                              )
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ∈
                              N
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              k
                              ∈
                              N
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    H
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    p
                                 
                                 
                                    ijkm
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              i
                              ,
                              
                              j
                              ,
                              
                              k
                              ,
                              
                              m
                              ∈
                              N
                           
                        
                     where
                        
                           •
                           
                              X
                              
                                 ijkm
                               is the fraction of the flow going from i
                              ∈
                              N to j
                              ∈
                              N through entrants’s hubs located at k, m
                              ∈
                              N.


                              Z
                              
                                 ijkm
                               is the fraction of the flow going from i
                              ∈
                              N toj
                              ∈
                              N through incumbent’s hubs located at k, m
                              ∈
                              P.


                              Y
                              
                                 k
                              
                              =1, if the entrant locates a hub at node k
                              ∈
                              N; 0 otherwise.


                              H
                              
                                 ij
                              
                              =1, if the entrant establishes a direct connection between nodes i, j
                              ∈
                              N
                              :(i,
                              j)∈
                              A; 0 otherwise.


                              c
                              
                                 ijkm
                               is the variable cost of the flow between nodes i and j
                              ∈
                              N, using hubs k, m
                              ∈
                              N.


                              p
                              
                                 ijkm
                               is the price charged by the entrant to flows between nodes i and j
                              ∈
                              N, using intermediate hubs k, m
                              ∈
                              N.


                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ijkm
                                       
                                    
                                 
                               is the price charged by the incumbent to flows between nodes i and j
                              ∈
                              N, using intermediate hubs k, m
                              ∈
                              N.

The objective function (1) maximizes the entrant’s profit, i.e. the net revenue minus the fixed and variable costs. Constraints (2) ensure that the flow between nodes i, j
                     ∈
                     N is routed through entrant’s or incumbent’s hubs. Constraints (3) and (4) assign the flows according to a logit model whose argument are the prices charged by the entrant or the incumbent, respectively. Constraints (5) define incumbent’s mill pricing strategy, while (6) is the definition of the transportation costs over a route i
                     →
                     k
                     →
                     m
                     →
                     j. Eq. (7) define the parameters η
                     
                        ij
                     . Finally, (8)–(10) state the domain of the decision variables.

The resulting model is a non-linear mixed integer programming problem. Unfortunately, although the objective might be concave with respect to price, we cannot assure the convexity or concavity of the objective or the constraints with respect to all the variables. For this reason, we cannot guarantee that current commercial software packages for integer programming would find the optimal solution. Furthermore, the size of real instances of the problem is too large for any exact procedure, because of the 4-index formulation required to make the pricing of every route offered by any agent.

Consequently, we propose using an ad hoc metaheuristic that, at each step, finds feasible solutions for the location-network design problem and, for each such solution, solves a pricing problem. Given that the location-network design search space includes only binary variables, any metaheuristic able to solve combinatorial problems could be used. However, in this case, any regular metaheuristic would require evaluating the objective at each step and for every solution in the neighborhood of the current solution, which would make the problem computationally intensive and the progress towards finding a solution extremely slow. We chose a genetic algorithm because of several reasons: it does not require local search procedures, as the genetic operators help the algorithm to explore the solution space; solutions can be represented easily; and genetic algorithms have had good success in previous applications involving hub location problems (Topcuoglu, Corut, Ermis, & Yilmaz, 2005; Cunha & Silva, 2007; Kratica, Stanimirović, Tošić, & Filipović, 2007). Genetic algorithms have been proven to show an optimizing behavior. See, for example, Rudolph (1994). The proposed approach can be stated as follows: the genetic algorithm explores the space of hub locations and connecting arcs, and finds feasible solutions. From every solution, a valid hub and spoke network configuration is derived. Once a valid configuration is found, the pricing problem is solved for this configuration, and the optimal flows and prices are found, for that network configuration. The flows captured and priced by the entrant are used to compute the value of the objective function, after discounting the network costs.

First, a population of n
                        
                           pop
                         random feasible solutions, i.e. valid hub and spoke networks, is created and saved in a solution set S. Then, on every iteration, two solutions, called parents, are selected randomly from S. A crossover operator is applied to parents, generating two solutions called offsprings. With probability p
                        
                           m
                         the algorithm mutates an offspring, favoring population diversity. The objective function is computed and, finally, an offspring is accepted into the set S only if it is better, in terms of the objective function, than the worst solution in S. The algorithm iterates until a stopping condition is met.

The remainder of this section describes the components of the genetic algorithm.

The solution representation is a key issue in the performance of a genetic algorithm. A solution to the location and network design problem can be defined using two elements: a binary vector Y of size ∣N∣, called the hub location vector, in which Y
                           
                              k
                           
                           =1 means that a hub is located at node k; and a binary matrix H, called the arc utilization matrix, of size ∣N∣2, in which H
                           
                              ij
                           
                           =1 means that the arc (i,
                           j)∈
                           A is used by the entrant’s network, for collection, transmission or distribution.

We chose a representation using arcs, as opposed to edges, because it enables the use of classical crossover operators, and it does not bias the search toward edges connecting the low-index nodes. Note that this representation does not preclude infeasible solutions, because it can contain arcs between non-hub nodes. This situation is allowed to keep the diversity of the population; otherwise, there could be a premature convergence. However, these arcs are not considered in the computation of the objective function.

The crossover operator combines two or more solutions from the population, and results in one or more offsprings. We use the 1-point crossover operator, which starts from two parent solutions and returns two offsprings. An integer number b
                           ∈[1,∣N∣−1] is selected randomly, called the cutting point. The location vectors and arcs utilization matrices of the parents are cut after the bth position in the former, and after the bth column (or row) in the latter. The row and column crossover are applied with equal probability. Then, the resulting pairs of pieces of the hub location vectors and arc utilization matrices of the two parents are exchanged. Fig. 1
                           a shows two solutions of this location and network design problem, for a 4-node network. Fig. 1b and c show the new solutions obtained after applying the crossover operator to the solutions shown in Fig. 1a, using b
                           =3 and making column and row exchanges in the arc utilization matrices, respectively.

The mutation operator creates a new solution from an old one as follows. A random integer v
                           ∈[1,∣N∣] is selected. In the hub location vector, the value of Y
                           
                              v
                            is flipped. In the arc utilization matrix, all the elements of either the vth column or the vth row are flipped, choosing at random which it is going to be, with the same probability.

The insertion operator evaluates every solution generated by crossover and mutation, and includes it in the population if its objective value is better than the worst solution currently in the solution set. If that is the case, the worst solution is replaced by the new one.

Hub problems have never included the pricing into consideration together with discrete choice models, since deriving a closed expression for optimal pricing is not straightforward in this case. However, in other research fields, e.g. the field of product bundle pricing (Bitran & Ferrer, 2007), pricing has been studied. We adapt a formula from that field to our case, considering that hubs on a route are bundles, as follows. Once a new solution is found by the genetic algorithm, i.e. the values 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    ∈
                                    N
                                 
                              
                           
                         and 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          ij
                                       
                                    
                                    }
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                 
                              
                           
                         are known, we define S
                        
                           ij
                         as the set of feasible pairs of hubs (k,
                        m) that can connect the origin–destination (OD) pair (i,
                        j), that is:
                           
                              (11)
                              
                                 
                                    
                                       S
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          k
                                          ,
                                          m
                                          )
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                m
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                ik
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                mj
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 N
                              
                           
                        Replacing (3) in (1), and using (11), the objective function of the pricing problem is:
                           
                              (12)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             m
                                             )
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             ijkm
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             ijkm
                                          
                                       
                                       )
                                       exp
                                       (
                                       -
                                       Θ
                                       ·
                                       
                                          
                                             p
                                          
                                          
                                             ijkm
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             m
                                             )
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       exp
                                       (
                                       -
                                       Θ
                                       ·
                                       
                                          
                                             p
                                          
                                          
                                             ijkm
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 -
                                 τ
                              
                           
                        with:
                           
                              (13)
                              
                                 τ
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                     

Optimal prices are derived from the first order conditions, in the next Theorem.
                           Theorem 1
                           
                              The optimal price for every route i
                              →
                              k
                              →
                              m
                              →
                              j is given by the following closed expression.
                              
                                 
                                    (14)
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ijkm
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             ijkm
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             Θ
                                          
                                       
                                       
                                          
                                             
                                                1
                                                +
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  ,
                                                                  t
                                                                  )
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         exp
                                                         (
                                                         -
                                                         Θ
                                                         ·
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ijst
                                                            
                                                         
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where W(·) is the W Lambert function, defined as the inverse function of f(W)
                              
                              =
                              
                              We
                              
                                 W
                              
                              .
                           


                              Bitran and Ferrer (2007) derive a formula for optimal pricing in the case of a single product bundle. Our formula and proof are a generalization for the case of multiple bundles (multiple hub pairs). It is easy to see that the objective function (12) can be decomposed in separate expressions for every OD pair (i,
                              j). Using the first order conditions 
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                Z
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                p
                                             
                                             
                                                ijkm
                                             
                                          
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                    
                                    j
                                    ,
                                    
                                    k
                                    ,
                                    
                                    m
                                    ∈
                                    N
                                 
                              , we obtain the following expression for a particular route i
                              →
                              s
                              →
                              t
                              →
                              j:
                                 
                                    (15)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         m
                                                         )
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                      
                                                   
                                                
                                                exp
                                                (
                                                -
                                                Θ
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       [
                                       1
                                       -
                                       Θ
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             ijst
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             ijst
                                          
                                       
                                       )
                                       ]
                                       +
                                       Θ
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         m
                                                         )
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                -
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                )
                                                exp
                                                (
                                                -
                                                Θ
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                           

Consider now the equivalent expression for a route i
                              →
                              u
                              →
                              v
                              →
                              j of the same OD pair. Divide both this expression and (15) by Θ, and then subtract them, to obtain the following equation:
                                 
                                    (16)
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             ijst
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             ijst
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             ijuv
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             ijuv
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         m
                                                         )
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                      
                                                   
                                                
                                                exp
                                                (
                                                -
                                                Θ
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       =
                                       0
                                    
                                 
                              Since the terms in brackets in Eq. (16) are nonnegative, the expression in parenthesis must be zero. In other words, if there are multiple optimal routes for the OD pair (i,
                              j), the margins p
                              
                                 ij••
                              −
                              c
                              
                                 ij•• will be equal. Let r
                              
                                 ij
                              
                              =
                              p
                              
                                 ijkm
                              
                              −
                              c
                              
                                 ijkm
                              . Replacing in (15), we obtain:
                                 
                                    (17)
                                    
                                       (
                                       1
                                       -
                                       Θ
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         m
                                                         )
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                      
                                                   
                                                
                                                exp
                                                [
                                                -
                                                Θ
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ijkm
                                                   
                                                
                                                )
                                                ]
                                             
                                          
                                       
                                       +
                                       Θ
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                k
                                                ,
                                                m
                                                )
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       exp
                                       [
                                       -
                                       Θ
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             ijkm
                                          
                                       
                                       )
                                       ]
                                       =
                                       0
                                    
                                 
                              Let 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          k
                                          ,
                                          m
                                          )
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                    exp
                                    (
                                    -
                                    Θ
                                    
                                       
                                          c
                                       
                                       
                                          ijkm
                                       
                                    
                                    )
                                 
                              . A reordering of the terms leads to:
                                 
                                    (18)
                                    
                                       (
                                       -
                                       1
                                       +
                                       Θ
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       exp
                                       (
                                       -
                                       1
                                       +
                                       Θ
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ij
                                                
                                             
                                             exp
                                             (
                                             -
                                             1
                                             )
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                 
                              The W(z) Lambert function is defined so that z
                              =
                              W(z) exp[W(z)] holds. Let 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ij
                                             
                                          
                                          exp
                                          (
                                          -
                                          1
                                          )
                                       
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                               and W(z
                              
                                 ij
                              )=−1+
                              Θr
                              
                                 ij
                              . Then, 
                                 
                                    W
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          ij
                                       
                                    
                                    )
                                    =
                                    -
                                    1
                                    +
                                    Θ
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    W
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   exp
                                                   (
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              , and
                                 
                                    (19)
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             Θ
                                          
                                       
                                       
                                          
                                             
                                                1
                                                +
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                               exp
                                                               (
                                                               -
                                                               1
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Replacing back r
                              
                                 ij
                              , the closed expression for the optimal prices is:
                                 
                                    (20)
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ijkm
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             ijkm
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             Θ
                                          
                                       
                                       
                                          
                                             
                                                1
                                                +
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  ,
                                                                  t
                                                                  )
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         exp
                                                         (
                                                         -
                                                         Θ
                                                         ·
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ijst
                                                            
                                                         
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              The second order conditions can be used to show that 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          ^
                                       
                                    
                                 
                               is concave on every p
                              
                                 ijkm
                              
                              □

Note that in this expression, the price is always greater than the operating cost, because Θ
                        >0 and 
                           
                              W
                              (
                              z
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         if 
                           
                              z
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                        . Secondly, a lower factor Θ (users’ sensitivity to price differences) leads to higher optimal prices. This is intuitively correct, since a lower sensitivity means that there are more customers willing to pay higher prices for the service. These customers can be captured by the entrant.

We tested our model on the CAB data set (O’Kelly, 1987). The fixed cost of opening a hub at node k was set to F
                     
                        k
                     
                     =100, ∀k
                     ∈
                     N. The fixed cost of establishing a link between the pair of nodes i and j was computed using the following expression (Calik et al., 2009).
                        
                           (21)
                           
                              
                                 
                                    K
                                 
                                 
                                    ij
                                 
                              
                              =
                              100
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                    
                                    /
                                    
                                       
                                          W
                                       
                                       
                                          ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          (
                                          k
                                          ,
                                          l
                                          )
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          kl
                                       
                                    
                                    /
                                    
                                       
                                          W
                                       
                                       
                                          kl
                                       
                                    
                                 
                              
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                           
                        
                     
                  

For the experiments, we used the following setting: the flows in thousands, δ
                     =
                     χ
                     =1, α
                     ={0.2,0.4,0.6,0.8,1.0}, q
                     =∣P∣={1,…,5}, Δ
                     ={0.05,0.1,0.2,0.3,0.4,0.5}, and Θ
                     ={3.85,5.78,7.70,9.63,11.55,15.39}. These values of Θ correspond to 3σ taking the values {1,0.66,0.5,0.4,0.33,0.25}, where σ is the standard deviation of the users’ perception of the price. The 900 resulting instances were run 10 times each, using different random seeds.

We used a PC with a 2.80GHz Core i7 processor and 6GB of RAM, and operating system Ubuntu 11.10. The genetic algorithm was programmed in C++ and compiled using GCC 4.6 with the vectorization and code optimization options activated.

As the calcultation of the objective function value is separable by origin–destination pairs, we parallelize it using the library GOMP (GNU-OpenMP).

The genetic algorithm was run up to a maximum of 10,000 iterations, with 100 solutions in the set S, and a mutation probability of 1%. However, the preliminary tests shown that after 5000 iterations there was no improvement in the quality of the solutions, and we used this last value in the reported numerical experiments.As we mention before, optimality is not necessarily achieved.

We first study the case in which inter-hub transportation is cheaper, and analyze the effects of these discounted costs or economies of scale on the entrant’s profit.

From the entrant’s point of view, there are three basic situations.
                           
                              1.
                              The incumbent has only one hub located. In this case, the larger the inter-hub discount, the higher the benefit of the entrant.

Both the incumbent and the entrant have two or more hubs. Inter-hub economies of scale are less relevant to the entrant, because both competitors can take advantage of them.

The incumbent operates a large hub and spoke network. The entrant will obtain benefit only if there are low economies of scale or none at all. In this case, the only advantage of the entrant is the a priori knowledge of the incumbent’s network.


                        Fig. 2
                         shows the results for these three scenarios. The profit earned by the entrant is shown on the left vertical axis of each graph, the income perceived by the incumbent on the right vertical axis, and the inter-hub discount factor (α) on the horizontal axis.

We display the incumbent’s income (and not the profit) because the incumbent is supposed to have been in the market for a while, so its investment costs are sunk. Fig. 2a shows the case in which the incumbent has only one hub located (q
                        =1) and charges a low margin (Δ
                        =0.05) over his costs, with customers having an intermediate sensitivity factor (Θ
                        =5.78). In this case, for lower inter-hub costs (lower values of α), the entrant can increase its customer capture and profit by opening more than one hub, taking advantage of the reduced inter-hub costs, which the incumbent, with only one hub, cannot.


                        Fig. 2b and c show what happens when q
                        =2 and q
                        =3 (the incumbent has two and three open hubs, respectively). Please note the different scale for the entrant profit on these Figures, since now the entrant’s profit is significantly smaller than when q
                        =1, because the incumbent can take advantage of the inter-hub discounts, achieving a better competitive position and reducing the entrant’s capability of obtaining a higher profit. Fig. 2c shows how, if the incumbent has a more extensive network, with more than two hubs, it is not convenient for the entrant to start operations in the same market, unless there are no inter-hub economies of scale at all. Our tests show that this situation does not change for different values of Θ.

If the leader’s margin Δ increases, the entrant’s profit potentially grows and becomes less dependent on α, even if the incumbent has a larger network with several hubs. Naturally, the incumbent can easily change its margins, making the entrant’s option of competing in this market very risky. The effect of the margin charged by the incumbent on the entrant’s profit is shown in Fig. 3
                        , for α
                        =0.6 and Θ
                        =15.39. The entrant’s profit Z is shown on the vertical axis, while the margin Δ is shown on the horizontal axis. Each series is associated with a different number of incumbent’s hubs, q. Note that the entrant’s profit increases almost linearly on Δ, especially for low values; but not on q. As before, there are situations in which it is not possible for a new competitor to enter the market (q
                        =5 and small margins, for example).


                        Fig. 4
                         shows how the entrant’s profit varies as a function of the users’ sensitivity to price differences, Θ.

We focus on the case in which the incumbent charges a small margin over its costs (Δ
                        =0.05), for different values of α. When q
                        =1 (Fig. 4a), for high values of Θ, most of the customers choose the least expensive routes. In other words, there is little spread of customers among the different routes. Since the entrant can locate two or more hubs –taking advantage of inter-hub economies of scale– it can offer routes that are cheaper than those offered by the incumbent, obtaining a reasonable profit. As the value of Θ decreases, more customers are willing to pay higher prices, and the entrant’s advantage due to inter-hub economies of scale, as well as its profit, decreases. However, when customers’ sensitivity to price further decreases, the entrant can increase its prices, obtaining a higher profit.

If q
                        =2, the market is more competitive, because the incumbent is already taking advantage of the inter-hub economies of scale. This is shown in Fig. 4b. High and intermediate values of Θ put the entrant in a disadvantageous situation, particularly if the incumbent has optimized its hub locations and network. As Θ continues decreasing, customers are less sensitive and the entrant can increase its prices and profit.

As intuitively expected, the larger the margin charged by the incumbent, the greater the entrant’s potential profit.

Finally, note that curves are not monotonic, and in occasions they intersect each other. This is due to the fact that the genetic algorithm does not guarantee optimality of the solutions.

The pricing problem is decomposable by OD pairs, each pair being an individual market. Every feasible route is a separate product in this market. In this subsection we will not consider the fixed costs of using arcs of the network, to do a fair comparison between both agents. From the entrant’s point of view, there are two possible scenarios: with and without (variable) cost advantage over the incumbent.

If the location and network design decisions allow the entrant to open a route with lower operating costs than the incumbent for a specific OD pair, then it has a competitive advantage in this particular market. An intuitive decision would be to price that particular route just below the incumbent’s cheapest price. However, this is not always the optimal decision. Consider, for example, the situation depicted in Table 1
                           , that shows a solution in which the incumbent has two hubs located at nodes 2 and 5, and the entrant has also two hubs, at nodes 10 and 25, with α
                           =0.2 (strong inter-hub discount), Δ
                           =0.05(low incumbent margin), and Θ
                           =15.39 (customers are very sensitive to price differences). The Table shows all routes and optimal costs for the (8,3) OD pair. The entrant has lower costs than the incumbent, leading to a competitive advantage. The first column shows the possible routes for both the entrant and the incumbent. The remaining columns are the cost, price, likelihood of usage, market share and profit of each route, respectively. The least expensive routes of both the entrant and the incumbent are highlighted.

Note that although the entrant has the cheapest cost for this (O,D) pair (through route 8, 10, 25, 3), and in spite of the high price sensitivity of the customers, the optimal price of this entrant’s route (which implies charging a margin of about 0.112 units) is higher than the incumbent’s lowest price (route 8, 5, 2, 3). As counterintuitive as it seems, this is the optimal decision when the objective of the entrant is profit maximization. Note that this pricing policy does not lead to a maximum market share. Decreasing this price would most likely increase the entrant’s market share to over 50%, but it would decrease its profit. By making this decision, the entrant captures less customers, but the customers that it captures are those willing to pay higher prices (cherry-picking). This behavior is similar to the what Sasaki et al. (2009) found for heterogeneous customers.

Using the same parameter values as in Table 1, Fig. 5
                            shows both competitors’ market share and profit for different values of the margin over cost charged by the entrant. The incumbent’s profit and market share increase as the entrant increases its margin. However, although the entrant’s market share decreases as its margin increases, its profit is not monotonic, achieving a maximum at the point predicted by expression (14), charging a margin of about 0.112 units over its costs.

Consider now the situation in which it is the incumbent who has the least cost for an OD pair, on one of its routes, as shown in Table 2
                           . Still the entrant has some room for capturing the customers that are willing to pay a higher price, provided it charges a low margin over its costs.

We focus on the (4,6) OD pair, with α
                           =0.2, and Δ
                           =0.05, as before. For this example, however, we use Θ
                           =3.85 i.e., customers are less sensitive to price differences. We use this value to illustrate more explicitly the rationale behind the pricing decisions that our model suggests.

As Table 2 shows, in this situation, the entrant, taking advantage of the low sensitivity to price differences (Θ), charges a margin of about 0.065 units, that enables the capture of the customers willing to pay more for the service, achieving some profit, as the rightmost column shows. For higher values of Θ, the margin charged and the total profit are smaller.

We studied three scenarios to understand the resulting entrant’s network structure: (1) intermediate inter-hub discount, high sensitivity to price differences, and a moderate margin charged by the incumbent; (2) intermediate inter-hub discount, intermediate sensitivity to price differences, and a moderate margin charged by the incumbent; and (3) no inter-hub discount, intermediate sensitivity to price differences, and low incumbent margin. Figs. 6 and 7
                        
                         show the entrant’s network structure for scenarios 1 and 3. The narrower arcs connect hubs and non-hub nodes. The thicker arcs connect entrant’s hubs, shown as black circles. The incumbent’s hubs are shown as stars, but for the sake of clarity, the network is not drawn. A gray star shows co-location of entrant’s and incumbent’s hubs.

In this case, α
                           =0.6, Θ
                           =15.39, and Δ
                           =0.3, i.e. there are moderate inter-hub economies of scale; the users are very sensitive to price differences; and the incumbent charges a moderate margin over his costs. Fig. 6 shows the networks for differents values of q.

If q
                           =1 (Fig. 6a), the incumbent cannot use the inter-hub economies of scale, so the entrant has the incentive to locate several hubs, separated from each other by long arcs.

When q
                           =2 (Fig. 6b), both agents can use the inter-hub economies of scale, and the scenario is more competitive. The entrant’s hub interconnection network is less extended; i.e., the number and distance between hubs decreases.

Finally, then q
                           =3 (Fig. 6c), the incumbent is even stronger, allowing the entrant to locate only three hubs and an even smaller network.

Now, we consider the case in which the users are less sensitive to price differences. Let Θ
                           =7.7, with all the other parameters as in the previous scenario. The results for this scenario are very similar to Scenario 1, but with a higher income for the incumbent.

If there are no inter-hub economies of scale (α
                           =1), the incumbent charges a lower margin (Δ
                           =0.2) and there is intermediate sensitivity to price differences, the resulting networks for different values of q, are shown in Fig. 7.

Without inter-hub economies of scale, and if the incumbent’s margin is low, it is harder for the entrant to capture customers in any scenario. If q
                           =1, the resulting entrant’s network is smaller (Fig. 7a). When q
                           =2 (Fig. 7b), the entrant creates a more sparse network, and locates four hubs. Finally, when q
                           =3 (Fig. 7c), the incumbent is even stronger, and the entrant’s network is even smaller. We remark that even though there are no economies of scale, some passengers will choose using routes including inter-hub arcs. This is due to the fact that, as opposed to hub location models with no user choice, there is dispersion in the preferences of the customers.

Note that the networks in Fig. 7 have most (or all) the hubs very close together. This is due to the following possible reasons: Each origin–destination pair uses all possible routes going through one or two hubs (there is multiple-assignment of demands to hubs). Also, the model requires every flow to go through at least one hub. These two conditions, together with the fact that the largest flows and the highest density of cities are on the east coast (on Fig. 7b, half of the flows are either originating or having as a destination the hub nodes), and the low opening cost of hubs, make the east side of the country a good location for several hubs. It is also important to note that the cost structure influences the resulting entrant’s network. For example, with larger fixed hub costs, there would likely be fewer hubs; and using the fixed costs structure in Calik et al., 2009 for arcs could give an incentive to use short links between cities with large flows. Similarly, Table 3
                            summarizes the results of all scenarios. In general, the stronger the incumbent’s position is, i.e. lower margin and larger network, the harder it is for the entrant to obtain any profit. Stronger incumbent’s positions result in a decrease in both profit and the number of hubs open by the entrant. Also, when the incumbent is strong, in terms of the number of located hubs, the entrant’s best option tend to be to concentrate in a small area (if possible) and obtain the highest profit there. Finally, we remark that the objectives of both firms are different: while the incumbent minimizes cost to serve the entire demand, which resembles the profit maximization of a monopolist, the entrant’s objective is profit maximization given the incumbent’s network and prices.

@&#CONCLUSIONS@&#

We present a new approach to analyze a situation in which two firms compete in a transportation market. An existing firm operates a hub and spoke network, and applies mill pricing. A new firm wants to enter the same market, maximizing its profit by building a possibly incomplete hub network, and by making optimal pricing decisions. Customers’ choice of provider and route depends solely on price, as would predict a simple logit model, although including other factors would be very easy.

We formulate a non-linear mixed integer programming model. We derive a closed form expression for the optimal pricing policy, and solve the problem as a location-network design problem (combinatorial) with an embedded pricing problem. We use a genetic algorithm for the location and network design problem. We thoroughly analyze the results of the model using the CAB dataset.

The computational experience shows that considering optimal pricing decisions when solving the hub location-network design problem leads to a better estimation of the maximum profit that the entrant will be able to obtain. Without solving the pricing problem, it is not possible to estimate the demand captured, its behavior and the final profit.

As opposed to Eiselt and Marianov (2009), who studied the hub location problem considering that users choose according to a gravity model, we use a logit model, which enables introducing customers’ sensitivity to prices. The consideration of sensitivity provides new insights about the competitive hub location problem. We show how this sensitivity plays either in favor of the entrant or the incumbent, depending on the incumbent’s margin and network configuration. We show that, if sensitivity to price differences is considered, the optimal pricing policy for the entrant does not necessarily always consist in charging a price that is below the incumbent’s cheapest price for a given OD pair. In fact, for low sensitivities to price, customers will spread among the routes more evenly, so all routes will capture some traffic. This is a conceptual difference with the work by Marianov et al. (1999), who consider that the firm with the cheapest route captures all customers.

Also, we show that, under competition, inter-hub discounted costs strongly influence the decision of entering a market. Inter-hub economies of scale, together with low prices, can be used by a strong operator to block a new agent from entering the market. On the other hand, inter-hub discounted costs can be the key to success for a new agent, who can take advantage of his knowledge of the incumbent’s network and prices, whenever incumbent’s location and network design are not the best, or its prices are high. We remark, though, that the modeling of the economies of scale is still an open question in the hub location literature, as Campbell (2012) pointed out recently, and using inter-hub discount factors of the incurred costs is just an approximation of the actual dynamics in a hub and spoke network.

A scenario analysis like the one presented here can be a valuable tool for a firm that is evaluating its entrance to a market. Furthermore, using this analysis, some situations can be foreseen in which entering the market is not convenient even if customer sensitivity is low.

We also show that, for competitive situations, a formulation that maximizes profit provides different results and insights than a model that seeks market share maximization, while more adapted to situations in which a competitor aims at a higher profit.

Naturally, there are some factors that we did not take into account, which could be relevant in a competitive situation. One of these is the fact that the incumbent could react to the newcomer’s entry to the market, using for example smaller planes in some spokes to increase the service frequency; or decreasing the prices charged on certain routes; improving the benefits offered within frequent-flyer programs, and so on. However, taking all these factors into account is left as a future challenge.

Further analysis could be performed to explore situations in which profit is required to exceed a certain bound and the number of routes opened by the competing firms is limited. Extensions to this work include the analysis of the same scenarios using multinomial logit models, since in the airline hub problem customers choose based on prices, flight time, the number of stops (hubs), and other factors.

Also of interest is the effect of sharing hubs by different companies, as it reduces fixed location costs, but potentially increases congestion. Finally, we leave for future research the analysis of von Stackelberg-type games, in which the incumbent designs the network assuming that a competitor will attempt to enter the market.

@&#ACKNOWLEDGEMENTS@&#

We thank Professor James Campbell and three anonymous reviewers for their insightful comments and suggestions, that significantly improved this paper. This work was in part supported by FONDECYT Grant 1100296, and also by Institute Complex Engineering Systems, through Grants ICM-MIDEPLAN P-05-004-F and CONICYT FBO16.

@&#REFERENCES@&#

