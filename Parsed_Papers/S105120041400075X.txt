@&#MAIN-TITLE@&#Source separation using regularized NMF with MMSE estimates under GMM priors with online learning for the uncertainties

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Single channel source separation using nonnegative matrix factorization (NMF).


                        
                        
                           
                           Using MMSE under GMM for regularizing the NMF gains, online estimation of uncertainty.


                        
                        
                           
                           Less sensitive to the regularization parameter.


                        
                        
                           
                           Efficient update rules for gain parameters.


                        
                        
                           
                           Improved results in speech–music separation experiments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Single channel source separation

Nonnegative matrix factorization

Minimum mean square error estimates

Gaussian mixture models

@&#ABSTRACT@&#


               
               
                  We propose a new method to incorporate priors on the solution of nonnegative matrix factorization (NMF). The NMF solution is guided to follow the minimum mean square error (MMSE) estimates of the weight combinations under a Gaussian mixture model (GMM) prior. The proposed algorithm can be used for denoising or single-channel source separation (SCSS) applications. NMF is used in SCSS in two main stages, the training stage and the separation stage. In the training stage, NMF is used to decompose the training data spectrogram for each source into a multiplication of a trained basis and gains matrices. In the separation stage, the mixed signal spectrogram is decomposed as a weighted linear combination of the trained basis matrices for the source signals. In this work, to improve the separation performance of NMF, the trained gains matrices are used to guide the solution of the NMF weights during the separation stage. The trained gains matrix is used to train a prior GMM that captures the statistics of the valid weight combinations that the columns of the basis matrix can receive for a given source signal. In the separation stage, the prior GMMs are used to guide the NMF solution of the gains/weights matrices using MMSE estimation. The NMF decomposition weights matrix is treated as a distorted image by a distortion operator, which is learned directly from the observed signals. The MMSE estimate of the weights matrix under the trained GMM prior and log-normal distribution for the distortion is then found to improve the NMF decomposition results. The MMSE estimate is embedded within the optimization objective to form a novel regularized NMF cost function. The corresponding update rules for the new objectives are derived in this paper. The proposed MMSE estimates based regularization avoids the problem of computing the hyper-parameters and the regularization parameters. MMSE also provides a better estimate for the valid gains matrix. Experimental results show that the proposed regularized NMF algorithm improves the source separation performance compared with using NMF without a prior or with other prior models.
               
            

@&#INTRODUCTION@&#

Nonnegative matrix factorization [1] is an important tool for source separation applications, especially when only one observation of the mixed signal is available. NMF is used to decompose a nonnegative matrix into a multiplication of two nonnegative matrices, a basis/dictionary matrix and a gains/weights/activities matrix. The basis matrix contains a set of basis vectors and the gains matrix contains the weights corresponding to the basis vectors in the basis matrix. The NMF solutions are found by solving an optimization problem based on minimizing a predefined cost function. As most optimization problems, the main goal in NMF is to find the solutions that minimize the cost function without considering any prior information rather than the nonnegativity constraint. There have been many works which tried to enforce prior information related to the nature of the application on the NMF decomposition results. For audio source separation applications, the continuity and sparsity priors were enforced in the NMF decomposition weights [2]. In [3,4], smoothness and harmonicity priors were enforced on the NMF solution in Bayesian framework and applied to music transcription. In [5,6] the regularized NMF was used to increase the NMF decomposition weights matrix likelihood under a prior Gaussian distribution. In [7], Markov chain prior model for smoothness was used within a Bayesian framework in regularized NMF with Itakura–Saito (IS-NMF) divergence. In [8], the conjugate prior distributions on the NMF weights and basis matrices solutions with the Poisson observation model within Bayesian framework was introduced. The Gamma distribution and the Gamma Markov chain [9] were used as priors for the basis and weights/gains matrices respectively in [8]. A mixture of Gamma prior model was used as a prior for the basis matrix in [10]. The regularized NMF with smoothness and spatial decorrelation constraints was used in [11] for EEG applications. In [11,12], a variety of constrained NMF algorithms were used for different applications.

In supervised single channel source separation (SCSS), NMF is used in two main stages, the training stage and the separation stage [13–17]. In the training stage, NMF is used to decompose the spectrogram of clean training data for the source signals into a multiplication of trained basis and weights/gains matrices for each source. The trained basis matrix is used as a representative model for the training data of each source and the trained gains matrices are usually ignored. In the separation stage, NMF is used to decompose the mixed signal spectrogram as a nonnegative weighted linear combination of the columns in the trained basis matrices. The spectrogram estimate for each source in the mixed signal can be found by summing its corresponding trained basis terms from the NMF decomposition during the separation stage.

One of the main problems of this framework is that, the estimate for each source spectrogram is affected by other sources in the mixed signal. More prior information about the source signals besides their trained basis matrices is usually needed during the separation stage. The trained gains/weights matrix can also be used to incorporate more information about each source signal during the separation stage. The trained weights matrix contains valid weight combinations that their corresponding bases in the basis matrix can jointly receive for a certain source signal. The information in the trained weights matrix can be used to favor solutions with valid weight combinations during the separation stage. The trained weights matrix can be used to train a prior model that captures the statistics of the valid weight combinations for each source signal. The trained prior models can be used to guide the NMF solution of the weights matrix during the separation stage to find a better estimate for the source signals.

In this work, we use the trained weights matrix columns to train a prior multivariate Gaussian mixture model (GMM) for each source signal. The GMM is a rich model which captures the statistics and the correlations of the valid weight combinations for the trained basis vectors for each source signal. GMMs are extensively used in speech processing applications like speech recognition and speaker verification. GMMs are used to model the multi-modal nature in speech feature vectors due to phonetic differences, speaking styles, gender, accents [18]. We are conjecturing that the weight vectors of the NMF gains matrix can be considered as a feature extracted from the signal in a frame so that it can be modeled well with a GMM.

The trained basis matrix and its corresponding trained prior GMM for the weights matrix are used as representative models for the training data for each source signal. In the separation stage, the prior GMMs are used to guide the NMF to find a weights matrix that is more compatible with its corresponding trained weights matrix for each source. Since the prior GMMs are trained using training data for the source signals, we can see these GMMs as source dependent prior models. Using trained prior models is different than incorporating other intuitive priors such as continuity, smoothness, and sparsity [2–4,11], which are valid prior assumptions for a wide range of source signals. Using a powerful model like GMM which can capture the multi-modal structure of training data is better than using single modal prior models [5–8] that cannot capture the multi-modal nature in some source signals such as speech signals due to phonetic differences, speaking styles, gender, and accents.

In [19], the prior GMM that models the valid weight combinations for each source was also used to guide the NMF solution for the gains/weights matrix during the separation stage. The priors in [19] are enforced by maximizing the log-likelihood of the NMF solution with the trained prior GMMs. The priors in [19] are enforced without evaluating how good the NMF solution is without using the priors. For example, if the NMF solution without prior is not satisfactory, we would like to rely more on the priors and vice versa.

In this paper, we introduce a new strategy of applying the priors on the NMF solutions of the weights matrix during the separation stage. The new strategy is based on evaluating how much the solution of the NMF gains matrix needs to lean on the prior GMMs. The prior information about the gains matrix is incorporated on the NMF solution of the gains matrix during the separation stage in three main stages. In the first stage, NMF is used to decompose the mixed signal spectrogram as weighted linear combinations of the trained basis matrices without considering any prior information about the weight combinations in the gains matrix. In the second stage, the NMF solution of the gains matrix is then evaluated by measuring how far the weight combinations in the gains matrix is from the trained prior GMM for each source. The NMF solutions without using priors for the weights matrix for each source during the separation stage can be seen as a deformed image. The deformation operator parameters which measure the uncertainty of the NMF solution of the weights matrix are learned directly from the observed mixed signal. The uncertainty in this work is a measurement of how far the NMF solution of the weights matrix during the separation stage is from being a valid weight pattern that is modeled in the prior GMM. In the third stage, the learned uncertainties are used with the minimum mean square error (MMSE) estimator to find an estimate of the weights matrix. The estimated weights matrix should also consider the minimization of the NMF cost function. To achieve these two goals, a regularized NMF cost function is used. The uncertainties within MMSE estimates of the valid weight combinations are embedded in the regularized NMF cost function. The uncertainty measurements play a very important role in this work as we show in the following sections. If the uncertainty of the NMF solution of the weights matrix is high, that means the regularized NMF needs more support from the prior term. In case of low uncertainty, the regularized NMF needs less support from the prior term. Including the uncertainty measurements in the regularization term using the MMSE estimate makes the proposed regularized NMF algorithm decide automatically how much the solution should rely on the prior GMM term. This is the main advantage of the proposed regularized NMF compared to the regularization using the log-likelihood of the GMM prior or other prior distributions [19–21]. Incorporation of the uncertainties that measure the extent of distortion in the NMF weights in the regularization term is a main novelty of this work, which has not been seen before in the regularization literature.

The remainder of this paper is organized as follows: In Section 2 we give a brief explanation about the SCSS problem, NMF, the conventional use of NMF in the SCSS problem, and our previous work of using GMM as prior model for regularizing the NMF cost function. In Section 3, we introduce the new proposed regularized NMF and how it is used in the SCSS problem, which is the main contribution of this paper. In the remaining sections, we present our observations and the results of our experiments.

In this paper, we apply the proposed MMSE based regularization for the single channel source separation (SCSS) problem using NMF.

In single channel source separation (SCSS) problems, the aim is to find estimates of source signals that are mixed on a single observation channel 
                           y
                           (
                           t
                           )
                        . This problem is usually solved in the short time Fourier transform (STFT) domain. Let 
                           Y
                           (
                           t
                           ,
                           f
                           )
                         be the STFT of 
                           y
                           (
                           t
                           )
                        , where t represents the frame index and f is the frequency-index. Assuming the number of sources is two and due to the linearity of the STFT, we have:
                           
                              (1)
                              
                                 Y
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           (
                           t
                           ,
                           f
                           )
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           (
                           t
                           ,
                           f
                           )
                         are the unknown STFT of the first and second sources in the mixed signal. Assuming independence of the sources, we can write the power spectral density (PSD) of the measured signal as the sum of source signal PSDs as follows:
                           
                              (2)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 σ
                              
                              
                                 y
                              
                              
                                 2
                              
                           
                           (
                           t
                           ,
                           f
                           )
                           =
                           E
                           (
                           
                              
                                 |
                                 Y
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           )
                        . We can write the PSDs for all frames as a spectrogram matrix as follows:
                           
                              (3)
                              
                                 Y
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         are the unknown spectrograms of the source signals, and they need to be estimated using the observed mixed signal and training data for each source. The spectrogram of the measured signal 
                           Y
                         is calculated by taking the squared magnitude of the STFT of the measured signal 
                           y
                           (
                           t
                           )
                         and the rows of the matrix correspond to frequencies and the columns correspond to frames.

Nonnegative matrix factorization is used to decompose any nonnegative matrix 
                           V
                         into a multiplication of a nonnegative basis matrix 
                           B
                         and a nonnegative gains or weights matrix 
                           G
                         as follows:
                           
                              (4)
                              
                                 V
                                 ≈
                                 B
                                 G
                                 .
                              
                           
                         The columns of matrix 
                           B
                         contain nonnegative basis or dictionary vectors that are optimized to allow the data in 
                           V
                         to be approximated as a nonnegative linear combination of its constituent vectors. Each column in the gains/weights matrix 
                           G
                         contains the set of weight combinations that the basis vectors in the basis matrix have for its corresponding column in the 
                           V
                         matrix. To solve for matrix 
                           B
                         and 
                           G
                        , different NMF cost functions can be used. For audio source separation applications, the Itakura–Saito (IS-NMF) divergence cost function [7] is usually used. This cost function is found to be a good measurement for the perceptual differences between different audio signals [7,22,23]. The IS-NMF cost function is defined as:
                           
                              (5)
                              
                                 
                                    min
                                    
                                       B
                                       ,
                                       G
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 (
                                 V
                                 ∥
                                 B
                                 G
                                 )
                                 ,
                              
                           
                         where
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 (
                                 V
                                 ∥
                                 B
                                 G
                                 )
                                 =
                                 
                                    ∑
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             V
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                       
                                          
                                             (
                                             B
                                             G
                                             )
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                    
                                    −
                                    log
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                       
                                          
                                             (
                                             B
                                             G
                                             )
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 .
                              
                           
                         The IS-NMF solutions for Eq. (5) can be computed by alternating multiplicative updates of 
                           B
                         and 
                           G
                         
                        [7,22] as:
                           
                              (6)
                              
                                 B
                                 ←
                                 B
                                 ⊗
                                 
                                    
                                       
                                          V
                                          
                                             
                                                (
                                                B
                                                G
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          1
                                          
                                             B
                                             G
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 G
                                 ←
                                 G
                                 ⊗
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             T
                                          
                                       
                                       
                                          V
                                          
                                             
                                                (
                                                B
                                                G
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             T
                                          
                                       
                                       
                                          1
                                          
                                             B
                                             G
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the operation ⊗ is an element-wise multiplication, all divisions and 
                           
                              
                                 (
                                 .
                                 )
                              
                              
                                 2
                              
                           
                         are element-wise operations. In source separation applications, IS-NMF is used with matrices of power spectral densities of the source signals [7,22].

In conventional single channel source separation using NMF without regularization [15], there are two main stages to find estimates for 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         in Eq. (3). The first stage is the training stage and the second stage is the separation/testing stage. In the training stage, the spectrogram 
                           
                              
                                 S
                              
                              
                                 
                                    train
                                 
                              
                           
                         for each source is calculated by computing the squared magnitude of the STFT of each source training signal. NMF is used to decompose the spectrograms into basis and gains matrices as follows:
                           
                              (8)
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                    
                                       
                                          train
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                    
                                       
                                          train
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                    
                                       
                                          train
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                    
                                       
                                          train
                                       
                                    
                                 
                                 .
                              
                           
                         The multiplicative update rules in Eqs. (6) and (7) are used to solve for 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                              
                                 
                                    train
                                 
                              
                           
                         for both sources. Within each iteration, the columns of 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         are normalized and the matrices 
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                              
                                 
                                    train
                                 
                              
                           
                         are computed accordingly. The initialization of all matrices 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                              
                                 
                                    train
                                 
                              
                           
                         is done using positive random noise. After finding basis and gains matrices for each source training data, the basis matrices are used in the mixed signal decomposition as shown in the following sections. All the basis matrices 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         are kept fixed in the remaining sections in this paper.

In the separation stage after observing the mixed signal 
                           y
                           (
                           t
                           )
                        , NMF is used to decompose the mixed signal spectrogram 
                           Y
                         with the trained bases matrices 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         that were found from solving Eq. (8) as follows:
                           
                              (9)
                              
                                 Y
                                 ≈
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ]
                                 G
                                 ,
                                 
                                 or
                                 
                                 Y
                                 ≈
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Let 
                           
                              
                                 B
                              
                              
                                 
                                    train
                                 
                              
                           
                           =
                           [
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ]
                        . The only unknown here is the gains matrix 
                           G
                         since the matrix 
                           
                              
                                 B
                              
                              
                                 
                                    train
                                 
                              
                           
                         was found during the training stage and it is fixed in the separation stage. The matrix 
                           G
                         is a combination of two submatrices as shown in Eq. (9). NMF is used to solve for 
                           G
                         in (9) using the update rule in Eq. (7) and 
                           G
                         is initialized with positive random numbers.

After computing the gains matrix, the initial spectrogram estimate for each source can be found as:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

The solution of the gains submatrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         in (9) is usually affected by the existence of the second source in the mixed signal. Also, 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         is affected by the first source in the mixed signal. The effect of one source into the gains matrix solution of the other source strongly depends on the energy level of each source in the mixed signal. Therefore, the estimated spectrograms 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                         in Eq. (10) that are found from solving 
                           G
                         using the update rule in (7) may contain residual contribution from each other and other distortions. To fix this problem, more discriminative constraints must be added to the solution of each gains submatrix. The columns of the gains submatrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         (or 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        ) should form a valid/expected weight combination for its corresponding basis matrix of its corresponding source signal. The information about the valid weight combinations that can exist in the gains matrix for a source signal can be found in the gains matrix that was computed from the clean training data of the same source. For example, the information about valid weight combinations that can exist in the gains matrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         in Eq. (9) can be found in its training gains matrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         in Eq. (8). The columns of the trained gains matrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         represent the valid weight combinations that the basis matrix 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         can receive for the first source. Note that, the basis matrix 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         is common in the training and separation stages. The solution of the gains submatrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         in Eq. (9) should consider the prior about the valid combination that is present in its corresponding trained gains matrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                              
                                 
                                    train
                                 
                              
                           
                         in Eq. (8) for the same source.

In our previous work [19], data in the training gains matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         for source i was modeled using a GMM. The NMF solution of the gains matrix during the separation stage was guided by the prior GMM. The GMM was learned using the logarithm of the normalized columns of the training gains matrix.

The gains matrices 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                                 
                                    
                                       train
                                    
                                 
                              
                            and 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                                 
                                    
                                       train
                                    
                                 
                              
                            in Eq. (8) were used in our previous work [19] to train prior models for the expected/valid weight patterns in the gains matrix for each source. For each matrix 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                                 
                                    
                                       train
                                    
                                 
                              
                            and 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                                 
                                    
                                       train
                                    
                                 
                              
                           , we normalized their columns and then calculated their logarithm. The normalization is usually done using the Euclidean norm. The log-normalized columns were then used to train a prior GMM for each source. The GMM for a random variable 
                              x
                            is defined as:
                              
                                 (11)
                                 
                                    p
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                d
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                |
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    exp
                                    
                                    
                                       {
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       x
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    ,
                                 
                              
                            where K is the number of Gaussian mixture components, 
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                            is the mixture weight, d is the vector dimension, 
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                            is the mean vector and 
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                            is the diagonal covariance matrix of the kth Gaussian model. In training GMM, the expectation maximization (EM) algorithm [24] is used to learn the GMM parameters (
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                           , 
                              ∀
                              k
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                              }
                           ) for each source given its trained gain matrix 
                              
                                 
                                    G
                                 
                                 
                                    
                                       train
                                    
                                 
                              
                           . The suitable value for K usually depends on the nature, dimension and the size of the available training data. We used the logarithm because it has been shown that the logarithm of a variable taking values between 0 and 1 can be modeled well by a GMM [25]. Since the main goal of the prior model is to capture the statistics of the patterns in the trained gains matrix, we used normalization to make the prior models insensitive to the energy level of the training data. The normalization makes the same prior models applicable for a wide range of energy levels and avoids the need to train a different prior model for different energy levels. By normalization we are modeling the ratio and correlation between the combination of the weights that the bases can jointly receive.

The NMF solution for the gains matrix during the separation stage was enforced in [19] to increase its log-likelihood with the trained GMM prior using regularized NMF as follows:
                              
                                 (12)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          IS
                                       
                                    
                                    (
                                    Y
                                    ∥
                                    
                                       
                                          B
                                       
                                       
                                          
                                             train
                                          
                                       
                                    
                                    G
                                    )
                                    −
                                    
                                       
                                          R
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    (
                                    G
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    R
                                 
                                 
                                    
                                       old
                                    
                                 
                              
                              (
                              G
                              )
                            is the weighted sum of the log-likelihoods of the log-normalized columns of the gains matrix 
                              G
                           . 
                              
                                 
                                    R
                                 
                                 
                                    
                                       old
                                    
                                 
                              
                              (
                              G
                              )
                            was defined as follows:
                              
                                 (13)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    (
                                    G
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       2
                                    
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          Γ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    Γ
                                 
                                 
                                    
                                       old
                                    
                                 
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                              )
                            is the log-likelihood for the submatrix 
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                           , and 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            is the regularization parameter for source i. The regularization parameter in [19] was playing two important roles. The first role was to match the scale of the IS-NMF divergence term with the scale of the log-likelihood prior term. The second role was to decide how much the regularized NMF cost function needs to rely on the prior term. The results in [19] show that, when the source i has higher energy level than the other sources, the value of its corresponding regularization parameter 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            becomes smaller than the values of other regularization parameters for the other sources. This observation can be stated as follows: when the source has high energy level, the gains matrix solution of the regularized NMF in (12) relies less on the prior model and vice versa. The values of the regularization parameters in [19] were chosen manually for every energy level for each source.

The conjugate prior models usually enforced on NMF solutions using a Bayesian framework [7,8,21]. The conjugate prior models are usually used to make the probabilistic inference tractable. There is no need to learn the parameters (hyper-parameters) of the conjugate prior models during the training stage. The hyper-parameters are usually chosen during the separation/testing stage. These hyper-parameters are usually multi-dimensional parameters and trying all possible combinations for their entries to find the suitable values for the given task is impossible. In the cases when the conjugate prior models of the NMF solutions were used [8,21], the hyper-parameters of the prior models were also chosen manually. In [19], it was also shown that, the hyper-parameter choices for the conjugate prior models can also depend on the energy level differences of the source signals in the mixed signal.

In the following sections, we give the motivation of the proposed MMSE-based regularization. Then, we give more details about our proposed regularized NMF using MMSE estimate to find better solution for the gains matrix in (9). In Section 3.2, we present our proposed regularized NMF in a general manner. In Section 3.2, we assume we have a trained basis matrix 
                        B
                     , a trained prior GMM for a clean gains matrix, and a gains matrix 
                        G
                      that inherited some distortion from the original matrix 
                        V
                      from solving Eq. (5). We introduce our proposed regularized NMF in a general fashion in Section 3.2 to make the idea clearer for different NMF applications like: dimensionality reduction, denoising, and other applications. The update rules that solve the proposed regularized NMF are also derived in Section 3.2 in a general fashion regardless of the application. The GMM in Section 3.2 is the trained prior GMM that captures the statistics of the valid weights combinations that should have been existed in the gains matrix 
                        G
                     . In Section 3.3, we show how we use the proposed regularized NMF to find better solutions for the gain submatrices in Eq. (9) for our single channel source separation problem.

In this work, we use prior GMMs to guide the solution of the gains matrix during the separation stage using regularized NMF as in [19] but following a totally different regularization strategy. We try to find a way to estimate how much the solution of the regularized NMF needs to rely on the prior GMMs automatically, not manually, as in [19]. The way of finding how much the regularized NMF solution of the gains matrix needs to rely on the prior GMM is by measuring how far the statistics of the solution of the gains matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         in (9) is from the statistics of the solution of the valid gains matrix solution 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         in (8) for source i. Recall that, the matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         in (8) contains the valid weight combinations that the columns in the basis matrix 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         can jointly receive for the clean data of source i. The data in 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         can be used as a prior information for what kind of weight combinations that should exist in 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         in (9) since the matrix 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         is the same in (8) and (9). The matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         in (8) is used to train a prior GMM for the expected (valid) weight combinations that can exist in the gains matrix for source i as in [19]. The solution of the gains submatrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         in (9) can be seen as a deformed observation that needs to be restored using MMSE estimate under its corresponding GMM prior for source i. How far the statistics of the solution of the gains matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         is from the statistics of the solution of the valid gains matrix solution 
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 
                                    train
                                 
                              
                           
                         can be seen as how much the gains submatrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         is deformed. How much deformation exists in the gains matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         can be learned directly and the logarithm of this deformation is modeled using a Gaussian distribution with zero mean and a diagonal covariance matrix 
                           
                              
                                 Ψ
                              
                              
                                 i
                              
                           
                        . When the deformation or the uncertainty measurement 
                           
                              
                                 Ψ
                              
                              
                                 i
                              
                           
                         of the gain submatrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         is high, we expect our target regularized NMF cost function to rely more on the prior GMM for source i and vice versa. Based on the measurement 
                           
                              
                                 Ψ
                              
                              
                                 i
                              
                           
                        , the proposed NMF cost function decides automatically how much the solution of the regularized NMF needs to rely on the prior GMMs, which is a main advantage of the proposed regularized NMF over our previous work [19]. Applying the prior information on the gains matrix 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         in (9) using MMSE estimate under a GMM prior using regularized NMF is the new strategy that we introduce in this paper.

In this work, we need the solution of the gains matrix 
                           G
                         to minimize the IS-divergence cost function in Eq. (5), and the columns of the gains matrix 
                           G
                         should form valid weight combinations under a prior GMM model. Gaussian mixture model is a very general prior model where we can see the means of the GMM mixture components as “valid templates” that were observed in the training data. Even, Parzen density priors [26] can be seen under the same framework. In Parzen density prior estimation, training examples are seen as “valid templates” and a fixed variance is assigned to each example. In GMM priors, we learn the templates as cluster means from training data and we can also estimate the cluster variances from the data. We can think of the GMM prior as a way to encourage the use of valid templates or cluster means in the NMF solution during the separation stage. This view of the GMM prior will be helpful in understanding the MMSE estimate method we introduce in this paper.

We can see the solution of the conventional NMF (NMF without prior) as distorted observations of a true/valid template. We can find a way of measuring how far the conventional NMF solution is from the trained templates in the prior GMM and call this the error term. We can learn a probability distribution model for the distortion that captures how far the observations in the conventional gains matrix is from the prior GMM. The distortion or the error model can be seen as a summary of the distortion that exists in all columns in the gains matrix of the NMF solution. Based on this distortion evaluation, the proposed regularized NMF can decide automatically how much the solution of the NMF needs help from the prior model. By deciding automatically how much the regularized NMF needs to rely on the prior we conjecture that, we do not need to manually change the values for the regularization parameter based on the energy differences of the sources in the mixed signal
                           1
                        
                        
                           1
                           In this paper, the regularization parameters are chosen once and kept fixed regardless of the energy differences of the source signals.
                         to improve the performance of NMF as in [19].

Based on the prior GMM and the trained distortion model, we can find a better estimate for the desired observation for each column in the distorted gains matrix. We can mathematically formulate this by seeing the solution matrix 
                           G
                         that only minimizes the cost function in Eq. (5) as a distorted image where its restored image needs to be estimated. The columns of the matrix 
                           G
                         are normalized using the 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         norm and their logarithm is then calculated. Let the log-normalized column n namely (
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        ) of the gains matrix be 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                        . The vector 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         is treated as a distorted observation as:
                           
                              (14)
                              
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 e
                                 ,
                              
                           
                         where 
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                         is the unknown desired pattern that corresponds to the observation 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         and needs to be estimated under a prior GMM, 
                           e
                         is the logarithm of the deformation operator, which is modeled by a Gaussian distribution with zero mean and diagonal covariance matrix 
                           Ψ
                         as 
                           N
                           (
                           e
                           |
                           0
                           ,
                           Ψ
                           )
                        . The GMM prior model for the gains matrix is trained using log-normalized columns of the trained gains matrix from training data as shown for example in Section 2.5.2. The uncertainty 
                           Ψ
                         is trained using maximum likelihood directly from all the log-normalized columns of the gains matrix 
                           q
                           =
                           {
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 N
                              
                           
                           }
                        , where N is the number of columns in the matrix 
                           G
                        . The uncertainty 
                           Ψ
                         can be iteratively learned using the expectation maximization (EM) algorithm. Given the prior GMM parameters which are considered fixed here, the update of 
                           Ψ
                         is found in the M-step based on the sufficient statistics 
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         as follows [27–29] [Appendix A]:
                           
                              (15)
                              
                                 Ψ
                                 =
                                 diag
                                 
                                 
                                    {
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                         where the “diag” operator sets all the off-diagonal elements of a matrix to zero and the sufficient statistics 
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         can be updated in the E-step using 
                           Ψ
                         from the previous iteration as follows:
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              (18)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          Ψ
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                j
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          Ψ
                                          )
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 .
                              
                           
                         
                        
                           Ψ
                         is considered as a general uncertainty measurement over all the observations in matrix 
                           G
                        .

Given the GMM prior parameters and the uncertainty measurement 
                           Ψ
                        , the MMSE estimate of each pattern 
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                         given its observation 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         under the observation model in Eq. (14) can be found similar to [27–29] as in Appendix A as follows:
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 f
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          Ψ
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ]
                                 
                                 ,
                              
                           
                         where
                           
                              (22)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          Ψ
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                j
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          Ψ
                                          )
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         The value of 
                           Ψ
                         in the term 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                           
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Ψ
                                 )
                              
                              
                                 −
                                 1
                              
                           
                         in Eq. (21) plays an important role in this framework. When the entries of the uncertainty 
                           Ψ
                         are very small comparing to their corresponding entries in 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                         for a certain active GMM component k, the term 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                           
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Ψ
                                 )
                              
                              
                                 −
                                 1
                              
                           
                         tends to be the identity matrix, and MMSE estimate in (21) will be the observation 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                        . When the entries of the uncertainty 
                           Ψ
                         are very high comparing to their corresponding entries in 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                         for a certain active GMM component k, the term 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                           
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Ψ
                                 )
                              
                              
                                 −
                                 1
                              
                           
                         tends to be a zeros matrix, and MMSE estimate will be the weighted sum of prior templates 
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                        . In most cases 
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                         tends to be close to one for one Gaussian component, and close to zero for the other components in a large dimensional space. This makes the MMSE estimate in the case of high 
                           Ψ
                         to be one of the mean vectors in the prior GMM, which is considered as a template pattern for the valid observation. We can rephrase this as follows: When the uncertainty of the observations 
                           q
                         is high, the MMSE estimate of 
                           x
                        , relies more on the prior GMM of 
                           x
                        . When the uncertainty of the observations 
                           q
                         is low, the MMSE estimate of 
                           x
                        , relies more on the observation 
                           q
                        . In general, the MMSE solution of 
                           x
                         lies between the observation 
                           q
                         and one of the templates in the prior GMM. The term 
                           
                              
                                 Σ
                              
                              
                                 k
                              
                           
                           
                              
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Ψ
                                 )
                              
                              
                                 −
                                 1
                              
                           
                         controls the distance between 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         and also the distance between 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         and one of the template 
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                         assuming that 
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           ≈
                           1
                         for a Gaussian component k.

The model in Eq. (14) expresses the normalized columns of the gains matrix as a distorted image with a diagonal multiplicative deformation matrix. For the normalized gain columns 
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         of 
                           G
                         there is a deformation matrix 
                           E
                         with log-normal distribution that is applied to the correct pattern to obtain the observation. We need to estimate 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                           
                         which satisfies the following equation:
                           
                              (23)
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ‖
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 .
                              
                           
                         The uncertainty for 
                           E
                         is represented in the covariance matrix 
                           Ψ
                        . For the distorted matrix 
                           G
                         we find the corresponding MMSE estimate for its normalized columns 
                           
                              
                                 G
                              
                              
                                 ˆ
                              
                           
                        . Another reason for working in logarithm domain is that, the gains are constrained to be nonnegative and the MMSE estimate can be negative so the logarithm of the normalized gains is an unconstrained variable that we can work with. The estimated weight patterns in 
                           
                              
                                 G
                              
                              
                                 ˆ
                              
                           
                         that are corresponding to the MMSE estimates for the correct patterns do not consider minimizing the NMF cost function in Eq. (5), which is still the main goal. We need the solution of 
                           G
                         to consider the pattern shape priors on the solution of the gains matrix, and also consider the reconstruction error of the NMF cost function. To consider the combination of the two objectives, we use regularized NMF. We add a penalty term to the NMF cost function. The penalty term tries to minimize the distance between the solution of log-normalized columns of 
                           
                              
                                 g
                              
                              
                                 n
                              
                           
                         with its corresponding MMSE estimate 
                           f
                           (
                           
                              
                                 g
                              
                              
                                 n
                              
                           
                           )
                         as follows:
                           
                              (24)
                              
                                 
                                    log
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    ≈
                                    f
                                    
                                       (
                                       log
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    
                                    or
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    ≈
                                    exp
                                    
                                    
                                       (
                                       f
                                       
                                          (
                                          log
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         The regularized IS-NMF cost function is defined as follows:
                           
                              (25)
                              
                                 C
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 (
                                 V
                                 ∥
                                 B
                                 G
                                 )
                                 +
                                 α
                                 L
                                 (
                                 G
                                 )
                                 ,
                              
                           
                         where
                           
                              (26)
                              
                                 L
                                 (
                                 G
                                 )
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       −
                                       exp
                                       
                                       
                                          (
                                          f
                                          
                                             (
                                             log
                                             
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         
                        
                           f
                           (
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                           )
                         is the MMSE estimate defined in Eq. (21), and α is a regularization parameter. The regularized NMF can be rewritten in more details as
                           
                              (27)
                              
                                 C
                                 =
                                 
                                    ∑
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             V
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                       
                                          
                                             (
                                             B
                                             G
                                             )
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                    
                                    −
                                    log
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                       
                                          
                                             (
                                             B
                                             G
                                             )
                                          
                                          
                                             m
                                             ,
                                             n
                                          
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 +
                                 α
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       −
                                       exp
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                n
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   Σ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   Ψ
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                log
                                                
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ‖
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          )
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         In Eq. (27), the MMSE estimate of the desired patterns of the gains matrix is embedded in the regularized NMF cost function. The first term in (27), decreases the reconstruction error between 
                           V
                         and 
                           B
                           G
                        . Given 
                           Ψ
                        , we can forget for a while the MMSE estimate concept that leaded us to our target regularized NMF cost function in (27) and see Eq. (27) as an optimization problem. We can see from (27) that, if the distortion measurement parameter 
                           Ψ
                         is high, the regularized nonnegative matrix factorization solution for the gains matrix will rely more on the prior GMM for the gains matrix. If the distortion parameter 
                           Ψ
                         is low, the regularized nonnegative matrix factorization solution for the gains matrix will be close to the ordinary NMF solution for the gains matrix without considering any prior. The second term in Eq. (27) is ignored in the case of zero uncertainty 
                           Ψ
                        . In case of high values of 
                           Ψ
                        , the second term encourages to decrease the distance between each normalized column 
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         in 
                           G
                         with a corresponding prior template 
                           exp
                           (
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                           )
                         assuming that 
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           ≈
                           1
                         for a certain Gaussian component k. For different values 
                           Ψ
                        , the penalty term decreases the distance between each 
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         and an estimated pattern that lies between a prior template and 
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        . 
                           Ψ
                         here has the effect of a multi-dimension regularization parameter which regularizes each row in the gains matrix differently. This multi-dimensional regularization parameter makes the idea of using the MMSE estimate based regularization more powerful than the log-likelihood based regularization in [19] where we have only scalar regularization parameters. The term (
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                           −
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                        ) in (27) measures how far each log-normalized column in the gains matrix is from a valid template 
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                        . Under the assumption 
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           ≈
                           1
                         for a certain Gaussian component k, the second term in (27) is also ignored when the observation 
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         form a valid pattern (
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                           =
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                        ). How far each log-normalized column in the gains matrix is from a valid template decides how much influence the MMSE estimate prior term has to the solution of (27) for each observation.

The multiplicative update rule for 
                           B
                         in (27) is still the same as in Eq. (6). The multiplicative update rule for 
                           G
                         can be found by following the same procedures as in [2,4,19]. The gradient with respect to 
                           G
                         of the cost function 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                           
                           C
                         can be expressed as a difference of two positive terms 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           C
                         and 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           C
                         as follows:
                           
                              (28)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 C
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       +
                                    
                                 
                                 C
                                 −
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       −
                                    
                                 
                                 C
                                 .
                              
                           
                         We can apply diagonally weighted gradient descent on the cost function where the diagonal step sizes are chosen such that the result is a multiplicative update of the matrix entries:
                           
                              (29)
                              
                                 G
                                 ←
                                 G
                                 ⊗
                                 
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             −
                                          
                                       
                                       C
                                    
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       C
                                    
                                 
                                 ,
                              
                           
                         where the operations ⊗ and division are element-wise as in Eq. (7). We can write the gradients as:
                           
                              (30)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 C
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 L
                                 (
                                 G
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                           
                           L
                           (
                           G
                           )
                         is a matrix with the same size of 
                           G
                        . The gradient for the IS-NMF and the gradient of the prior term can also be expressed as a difference of two positive terms as follows:
                           
                              (31)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 −
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              (32)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 L
                                 (
                                 G
                                 )
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       +
                                    
                                 
                                 L
                                 (
                                 G
                                 )
                                 −
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       −
                                    
                                 
                                 L
                                 (
                                 G
                                 )
                                 .
                              
                           
                         We can rewrite Eqs. (28), (30) as:
                           
                              (33)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 C
                                 =
                                 
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          +
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          IS
                                       
                                    
                                    +
                                    α
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          +
                                       
                                    
                                    L
                                    (
                                    G
                                    )
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          IS
                                       
                                    
                                    +
                                    α
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          −
                                       
                                    
                                    L
                                    (
                                    G
                                    )
                                    )
                                 
                                 .
                              
                           
                         The final update rule in Eq. (29) can be written as follows:
                           
                              (34)
                              
                                 G
                                 ←
                                 G
                                 ⊗
                                 
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             IS
                                          
                                       
                                       +
                                       α
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             −
                                          
                                       
                                       L
                                       (
                                       G
                                       )
                                    
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             IS
                                          
                                       
                                       +
                                       α
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       L
                                       (
                                       G
                                       )
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              (35)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 
                                    1
                                    
                                       B
                                       G
                                    
                                 
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 
                                    V
                                    
                                       
                                          (
                                          B
                                          G
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 
                                    V
                                    
                                       
                                          (
                                          B
                                          G
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       G
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 
                                    1
                                    
                                       B
                                       G
                                    
                                 
                                 .
                              
                           
                         Note that, in calculating the gradients 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           L
                           (
                           G
                           )
                         and 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           L
                           (
                           G
                           )
                        , the term 
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                         is also a function of 
                           G
                        . The gradients 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           L
                           (
                           G
                           )
                         and 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           L
                           (
                           G
                           )
                         are calculated in Appendix B. Since all the terms in Eq. (34) are nonnegative, then the values of 
                           G
                         of the update rule (34) are nonnegative.

In this section, we are back to the single channel source separation problem to find a better solution to Eq. (9). Fig. 1
                         shows the flow chart that summarizes all stages of applying our proposed regularized NMF method for SCSS problems. Given the trained basis matrices 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         that were computed from solving (8), and the trained gain prior GMM for each source from Section 2.5.2, we try to apply the proposed regularized NMF cost function in Section 3.2 to find a better solution for the gain submatrices in Eq. (9). The bases matrix 
                           
                              
                                 B
                              
                              
                                 
                                    train
                                 
                              
                           
                           =
                           [
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ]
                         is still fixed here, we just need to update the gains matrix 
                           G
                         in (9). The normalized columns of the submatrices 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         in Eq. (9) can be seen as deformed images as in Eq. (23) and their restored images need to be estimated. First, we need to learn the uncertainty parameters 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                         for the deformation operators 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                         respectively for each image as shown in learning the uncertainties stage in Fig. 1. The columns of the submatrix 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         are normalized and their logarithm are calculated and used with the trained GMM prior parameters for the first source to estimate 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         iteratively using the EM algorithm in Eqs. (15) to (20). The log-normalized columns “
                           log
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ‖
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        ” of 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         can be seen as 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         in Eqs. (15) to (20). We repeat the same procedures to calculate 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                         using the log-normalized columns of 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         and the prior GMM for the second source. The uncertainties 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                         can also be seen as measurements of the remaining distortion from one source into another source, which also depends on the mixing ratio between the two sources. For example, if the first source has higher energy than the second source in the mixed signal, we expect the values of 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                         to be higher than the values in 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         and vice versa. After calculating the uncertainty parameters for both sources 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                        , we use the regularized NMF in (25) to solve for 
                           G
                         with the prior GMMs for both sources and the estimated uncertainties 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Ψ
                              
                              
                                 2
                              
                           
                         as follows:
                           
                              (37)
                              
                                 C
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       IS
                                    
                                 
                                 (
                                 Y
                                 ∥
                                 
                                    
                                       B
                                    
                                    
                                       
                                          train
                                       
                                    
                                 
                                 G
                                 )
                                 +
                                 R
                                 (
                                 G
                                 )
                                 ,
                              
                           
                         where
                           
                              (38)
                              
                                 R
                                 (
                                 G
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                         
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                           )
                         is defined as in Eq. (26) for the first source, 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                           )
                         is for the second source, 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                        , and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                         are their corresponding regularization parameters. The update rule in Eq. (34) can be used to solve for 
                           G
                         after modifying it as follows:
                           
                              (39)
                              
                                 G
                                 ←
                                 G
                                 ⊗
                                 
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             IS
                                          
                                       
                                       +
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             −
                                          
                                       
                                       R
                                       (
                                       G
                                       )
                                    
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             IS
                                          
                                       
                                       +
                                       
                                          
                                             ∇
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       R
                                       (
                                       G
                                       )
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           R
                           (
                           G
                           )
                         and 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           R
                           (
                           G
                           )
                         are nonnegative matrices with the same size of 
                           G
                         and they are combinations of two submatrices as follows:
                           
                              (40)
                              
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          −
                                       
                                    
                                    R
                                    (
                                    G
                                    )
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      G
                                                   
                                                   
                                                      −
                                                   
                                                
                                                L
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      G
                                                   
                                                   
                                                      −
                                                   
                                                
                                                L
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          G
                                       
                                       
                                          +
                                       
                                    
                                    R
                                    (
                                    G
                                    )
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      G
                                                   
                                                   
                                                      +
                                                   
                                                
                                                L
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      G
                                                   
                                                   
                                                      +
                                                   
                                                
                                                L
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           L
                           (
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                           )
                           ,
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           L
                           (
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                           )
                           ,
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 +
                              
                           
                           L
                           (
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                           )
                        , and 
                           
                              
                                 ∇
                              
                              
                                 G
                              
                              
                                 −
                              
                           
                           L
                           (
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                           )
                         are calculated as in Section 3.2 for each source.

The normalization of the columns of the gain matrices are used in the prior term 
                           R
                           (
                           G
                           )
                         and its gradient terms only. The general solution for the gains matrix of Eq. (37) at each iteration is not normalized. The normalization is done only in the prior term since the prior models have been trained by normalized data before. Normalization is also useful in cases where the source signals occur with different energy levels from each other in the mixed signal. Normalizing the training and testing gain matrices gives the prior models a chance to work with any energy level that the source signals can take in the mixed signal regardless of the energy levels of the training signals.

The regularization parameters in (38) have only one role. They are chosen to match the scale between the NMF divergence term and the MMSE estimate prior term in the regularized NMF cost function in (37). There is no need to change the values of the regularization parameters according to the energy differences of the source signals in the mixed signal as in [19]. Reasonable values for the regularization parameters are chosen manually and kept fixed in this work. Another main difference between the regularized NMF in [19] that is shown in Eq. (12) and the proposed regularized NMF in this paper is related to the training procedures for the source models. In both works, the main aim of the training stage is to train the basis matrices and the prior GMMs for the gains for the source signals.

In [19], to match between the way the trained models were used during training with the way they were used during separation, the basis matrices and the prior GMM parameters were learned jointly using the regularized NMF cost function in (12). The joint training for the source models was introduced in [19] to improve the separation performance. In joint training, after updating the gains matrix at each NMF iteration using the gain update rule for the regularized NMF in (12), the GMM parameters were then updated (retrained). Since, we needed to update (retrain) the GMM parameters at each NMF iteration, joint training slowed down the training of the source models in [19]. Another problem of using joint training is that, we had other regularization parameters during the training stage that needed to be chosen. Using joint training duplicates the number of the regularization parameters that need to be chosen. Choosing the regularization parameters in [19] was done using validation data. That means, in [19] we had to train many source models (basis matrix and prior GMM) for different regularization parameter values. Then, we chose the best combination for the regularization parameter values in training and separation stages that gave the best results during the separation stage. In the case of using MMSE estimate regularization for NMF, we do not need to use joint training. In this paper, we do not need to consider solving the regularized NMF in (27) during the training stage to solve (8). In the training stage, the training data for each source is assumed to be clean data. Since the spectrogram of each source training data represents clean source data, the NMF solution for the gains matrix cannot be seen as a distorted image. Therefore, the deformation measurement parameter 
                           
                              
                                 Ψ
                              
                              
                                 
                                    train
                                 
                              
                           
                         is a matrix of zeros. When 
                           
                              
                                 Ψ
                              
                              
                                 
                                    train
                                 
                              
                           
                           =
                           0
                        , the MMSE estimates prior term in (27) will disappear because 
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           =
                           1
                        . Then, the regularized NMF (27) becomes just NMF. That means, we do not need to use the regularized NMF during the training stage which is not the case in [19]. Here in the training stage, we just need to use IS-NMF to decompose the spectrogram of the training data into trained basis and gains matrices. After the trained gains matrix is computed, it is used to train the prior GMM as shown in Sections 2.3 and 2.5.2.

After finding the suitable solution for the gains matrix 
                           G
                         in Section 3.3, the initial estimated spectrograms 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                         can be calculated from (10) and then used to build spectral masks as follows:
                           
                              (41)
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the divisions are done element-wise. The final estimate of each source STFT can be obtained as follows:
                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 Y
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 Y
                                 (
                                 t
                                 ,
                                 f
                                 )
                                 ,
                              
                           
                         where 
                           Y
                           (
                           t
                           ,
                           f
                           )
                         is the STFT of the observed mixed signal in Eq. (1), 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           t
                           ,
                           f
                           )
                         and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           (
                           t
                           ,
                           f
                           )
                         are the entries at row f and column t of the spectral masks 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         respectively. The spectral mask entries scale the observed mixed signal STFT entries according to the contribution of each source in the mixed signal. The spectral masks can be seen as the Wiener filter as in [7]. The estimated source signals 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                         and 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           (
                           t
                           )
                         can be found by using inverse STFT of their corresponding STFTs 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           (
                           t
                           ,
                           f
                           )
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           (
                           t
                           ,
                           f
                           )
                        .

We applied the proposed algorithm to separate speech signals from background music signals. We used two different experimental setups. In the first experiment we separate speech signals of male speakers from TIMIT database from background piano signals. In the second experiment, we separate male and female speech signals from TIMIT dataset from general background music signals where different musical instruments are used.

In this experiment, we applied the proposed algorithm to separate a speech signal from a background piano music signal. Our main goal was to get a clean speech signal from a mixture of speech and piano signals. We simulated our algorithm on a collection of speech and piano data at 16 kHz sampling rate. For speech data, we used the training and testing male speech data from the TIMIT database. For music data, we downloaded piano music data from the piano society web site [30]. We used 12 pieces with approximate 50 minutes total duration from different composers but from a single artist for training and left out one piece for testing. The PSD for the speech and music data were calculated by using the STFT: A Hamming window with 480 points length and 
                           60
                           %
                         overlap was used and the FFT was taken at 512 points, the first 257 FFT points only were used since the conjugate of the remaining 255 points are involved in the first points. We trained 128 basis vectors for each source, which makes the size of 
                           
                              
                                 B
                              
                              
                                 speech
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 music
                              
                           
                         matrices to be 
                           257
                           ×
                           128
                        , hence, the vector dimension 
                           d
                           =
                           128
                         in Eq. (11) for both sources. The mixed data was formed by adding random portions of the test music file to 20 speech files from the test data of the TIMIT database at different speech-to-music ratio (SMR) values in dB. The audio power levels of each file were found using the “speech voltmeter” program from the G.191 ITU-T STL software suite [31]. For each SMR value, we obtained 20 mixed utterances this way. We used the first 10 utterances as a validation set to choose reasonable values for the regularization parameters 
                           
                              
                                 α
                              
                              
                                 speech
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 music
                              
                           
                         and the number of Gaussian mixture components K. The other 10 mixed utterances were used for testing.

Performance measurement of the separation algorithm was done using the signal to noise ratio (SNR). The average SNR over the 10 test utterances for each SMR case are reported. We also used signal to interference ratio (SIR), which is defined as the ratio of the target energy to the interference error due to the music signal only [32].


                        Table 1
                         shows SNR and SIR of the separated speech signal using NMF with different values of the number of Gaussian mixture components K and fixed regularization parameters 
                           
                              
                                 α
                              
                              
                                 speech
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 music
                              
                           
                           =
                           1
                        . The first column of the table shows the separation results of using just NMF without any prior.

As we can see from the table, the proposed regularized NMF algorithm improves the separation performance for challenging SMR cases compared with using just NMF without priors. Increasing the number of Gaussian mixture components K improves the separation performance until 
                           K
                           =
                           16
                        . From the shown results, 
                           K
                           =
                           16
                         seems to be a good choice for the given data sets. The best choice for K usually depends on the nature and the size of the training data. For example, for speech signal in general there are variety of phonetic differences, gender, speaking styles, accents, which raises the necessity for using many Gaussian components.

In this section we compared our proposed method of using MMSE estimates under GMM prior on the solution of NMF with two other prior methods. The first prior is the sparsity prior and the second prior is enforced by maximizing the loglikelihood under GMM prior distribution.

In the sparsity prior, the NMF solution of the gains matrix was enforced to be sparse [10,13]. The sparse NMF is defined as
                              
                                 (43)
                                 
                                    C
                                    (
                                    G
                                    )
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          IS
                                       
                                    
                                    (
                                    Y
                                    ∥
                                    B
                                    G
                                    )
                                    +
                                    λ
                                    
                                       ∑
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    ,
                                 
                              
                            where λ is the regularization parameter. The gain update rule of 
                              G
                            can be found as follows:
                              
                                 (44)
                                 
                                    G
                                    ←
                                    G
                                    ⊗
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                T
                                             
                                          
                                          
                                             Y
                                             
                                                
                                                   (
                                                   B
                                                   G
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                T
                                             
                                          
                                          
                                             1
                                             
                                                B
                                                G
                                             
                                          
                                          +
                                          λ
                                       
                                    
                                    .
                                 
                              
                            Enforcing sparsity on the NMF solution of the gains matrix is equivalent to model the prior of the gains matrix using exponential distribution with parameter λ 
                           [10]. The update rule in Eq. (44) is found based on maximizing the likelihood of the gains matrix under the exponential prior distribution.

The second method of enforcing prior on the NMF solution is by using GMM gain prior [19,20]. The NMF solution for the gains matrix is enforced to increase its log-likelihood with the trained GMM prior as follows:
                              
                                 (45)
                                 
                                    C
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          IS
                                       
                                    
                                    (
                                    Y
                                    ∥
                                    B
                                    G
                                    )
                                    −
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    G
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              (
                              G
                              )
                            is the weighted sum of the log-likelihoods of the log-normalized columns of the gains matrix 
                              G
                           . 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              (
                              G
                              )
                            can be written as follows:
                              
                                 (46)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    G
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       2
                                    
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                    Γ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                 
                              
                            where 
                              Γ
                              (
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                              )
                            is the log-likelihood for the submatrix 
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                            for source i.

In sparsity and GMM based log-likelihood prior methods, to match between the used update rule for the gains matrix during training and separation, the priors were enforced during both training and separation stages. In sparse NMF we used sparsity constraints during training and separation stages. In regularized NMF with GMM based log-likelihood prior we trained the NMF bases and the prior GMM parameters jointly as argued in [19].

In the sparse NMF case, we obtained best results when 
                              λ
                              =
                              0.0001
                            for both sources in the training and separation stages. In the case of enforcing the gains matrix to increase the log-likelihood under GMM prior [19] we obtained the best results when 
                              η
                              =
                              1
                            in the training and 
                              η
                              =
                              0.1
                            in the separation stage. The number of Gaussian components was 
                              K
                              =
                              4
                            for both sources. It is important to note that, in the case of using MMSE under GMM prior there is no need to enforce prior during training since the uncertainty measurements during training are assumed to be zeros since the training data are clean signals. When the uncertainty is zero, then the regularized NMF in case of MMSE under GMM prior is the same as the NMF cost function, then the update rule for the gains matrix in the training stage is the same as the update rule in regular NMF.


                           Figs. 2 and 3
                           
                            show the SNR and SIR for the different type of prior models. The black line shows the separation performance when no prior is used. The red line shows the performance for the case of using sparse NMF. The green line shows the performance when enforcing the gains matrix to increase its likelihood with the prior GMM. The blue line shows the separation performance in the case of using MMSE estimate under GMM prior that is proposed in this paper. As we can see, the proposed method of enforcing prior on the gains matrix using MMSE estimate under GMM prior gives the best performance compared with other methods. The used MMSE estimates prior in this work gives better results than the GMM likelihood method [19] because of the measurements of the uncertainties in the MMSE under GMM case. The uncertainties work as feedback measurements that adjust the need to use the prior based on the amount of distortion in the gains matrix during the separation stage.

Comparing the relative improvements in dB that we obtained in this experiment with the achieved improvements in other works [2,5,6,10] we can see that the improvements in this work can be considered to be high.

In this experiment, we used general speech data (male and female speakers) from the TIMIT database. We also used general background music signals where different musical instruments are used. We downloaded these music signals from the website [33], the dataset which was collected for the purposes of music/speech discrimination. We used 20 minutes of these music files which are available at [34] for this experiment. For speech data, we used TIMIT dataset for male and female speakers to train general models for the speech signal. We trained a single basis matrix and a single GMM prior model for male and female speakers of the TIMIT database as general models for the speech signals. For the music signals, we used all the available music files for training. We trained the basis matrix of the speech and music data with 128 basis vectors which makes the size of 
                           
                              
                                 B
                              
                              
                                 speech
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 music
                              
                           
                         matrices to be 
                           257
                           ×
                           128
                        . For training the prior GMMs, we tried with different values for the number of Gaussian mixture components K and we achieved reasonable performance at 
                           K
                           =
                           256
                        . The higher value for K in this experiment is because of the variety of the used speech and music signals.

The mixed data was formed by adding random portions of the available 20 minutes music files to 20 speech files from the test data of the TIMIT database at different speech-to-music ratio (SMR) values in dB. The 20 speech files are 10 files from each gender. The audio power levels of each file were found similar to the first experiment. For each SMR value, we obtained 20 mixed utterances. In this experiment, we chose 
                           
                              
                                 α
                              
                              
                                 speech
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 music
                              
                           
                           =
                           1
                        . We also compared with using different prior models similar to the first experiment.


                        Figs. 4 and 5
                        
                         show the SNR and SIR for the different type of prior models. The first observation is that in general the results are much lower than the first experiment which indicates the hardness of the problem in the general speech + music case. As can be seen, the proposed method of enforcing prior on the gains matrix using MMSE estimate under GMM prior gives the best SIR performance for all SMR cases compared with the other methods. For SNR values, at low SMR the proposed MMSE regularization gives better results but at high SMR it seems that just using NMF without any regularization works slightly better than using regularized NMF. However, we can see that the output SNR is between 4 and 4.5 dB for all methods when the input SMR is 5 dB in this case. This indicates that all the methods are decreasing the SNR a little bit. However, the SIR results indicate that the MMSE method decreases the contribution of the music in the reconstructed signal much more than the other methods. We believe that SIR is a more important performance measure than SNR when the SMR of the input signal is higher than 5 dB.

@&#CONCLUSION@&#

In this work, we introduced a new regularized NMF algorithm. The NMF solution for the gains matrix was guided by the MMSE estimate under a GMM prior where the uncertainty of the observed mixed signal was learned online from the observed data. The proposed MMSE estimate based regularization method was evaluated on speech–music separation and the achieved results outperform other older regularization methods. The proposed algorithm can be extended for better measurements of the distortion in the observed signal by embedding more parameters in Eq. (14) that can be learned online from the observed signal. The proposed method can also be improved by using dynamic models like hidden Markov model to train the prior information about the gains matrix.

@&#ACKNOWLEDGEMENTS@&#

This research is partially supported by Turk Telekom Group Research and Development, project entitled “Single Channel Source Separation”, grant number 3014-06, support year 2012.

In this appendix, we derive the MMSE estimate formula and the learning algorithm for the parameter 
                        Ψ
                      similar to [27–29]. Assume we have a noisy observation 
                        y
                      as shown in the graphical model in Fig. 6
                     , which can be formulated as follows:
                        
                           (47)
                           
                              y
                              =
                              x
                              +
                              e
                              ,
                           
                        
                      where 
                        e
                      is the noise term, and 
                        x
                      is the unknown underlying correct signal which needs to be estimated under a GMM prior distribution:
                        
                           (48)
                           
                              p
                              (
                              x
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              N
                              (
                              x
                              |
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                      the error term 
                        e
                      has a Gaussian distribution with zero mean and diagonal covariance matrix 
                        Ψ
                     :
                        
                           (49)
                           
                              p
                              (
                              e
                              )
                              =
                              N
                              (
                              e
                              |
                              0
                              ,
                              Ψ
                              )
                              .
                           
                        
                      The conditional distribution of 
                        y
                      is a Gaussian with mean 
                        x
                      and diagonal covariance matrix 
                        Ψ
                     :
                        
                           (50)
                           
                              p
                              (
                              y
                              |
                              x
                              ,
                              k
                              )
                              =
                              p
                              (
                              y
                              |
                              x
                              )
                              =
                              N
                              (
                              y
                              |
                              x
                              ,
                              Ψ
                              )
                              .
                           
                        
                      The distribution of 
                        y
                      given the Gaussian component k is a Gaussian with mean 
                        
                           
                              μ
                           
                           
                              k
                           
                        
                      and diagonal covariance matrix 
                        
                           
                              Σ
                           
                           
                              k
                           
                        
                        +
                        Ψ
                     :
                        
                           (51)
                           
                              p
                              (
                              y
                              |
                              k
                              )
                              =
                              N
                              (
                              y
                              |
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              +
                              Ψ
                              )
                              .
                           
                        
                      The marginal probability distribution of 
                        y
                      is a GMM:
                        
                           (52)
                           
                              p
                              (
                              y
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              N
                              (
                              y
                              |
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              +
                              Ψ
                              )
                              ,
                           
                        
                      where the expectations 
                        E
                        (
                        x
                        )
                        =
                        E
                        (
                        y
                        )
                     , and 
                        E
                        (
                        e
                        )
                        =
                        0
                     . Note that, this observation model has some mathematical similarities but different concepts with factor analysis models assuming the load matrix is the identity matrix [27–29].

The MMSE estimate of 
                        x
                      can be found by calculating the conditional expectation of 
                        x
                      given the observation 
                        y
                     . Given the Gaussian component k, the joint distribution of 
                        x
                      and 
                        y
                      is a multivariate Gaussian distribution with conditional expectation and conditional variance as follows [27,35]:
                        
                           (53)
                           
                              E
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          x
                                          y
                                       
                                    
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              y
                              −
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (54)
                           
                              var
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          x
                                          y
                                       
                                    
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          x
                                          y
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      we know that
                        
                           (55)
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              +
                              Ψ
                              ,
                           
                        
                      and
                        
                           (56)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          x
                                          y
                                       
                                    
                                 
                              
                              =
                              cov
                              (
                              x
                              ,
                              y
                              )
                              =
                              E
                              
                                 (
                                 x
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              −
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              E
                              
                                 [
                                 x
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 ]
                              
                              −
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              E
                              
                                 (
                                 x
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              +
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              −
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              var
                              (
                              x
                              )
                              +
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              −
                              E
                              (
                              x
                              )
                              E
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              var
                              (
                              x
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                      The conditional expectation given the Gaussian component k of the prior model is
                        
                           (57)
                           
                              E
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    Ψ
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              y
                              −
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                      We also can find the following conditional expectation given only the observation 
                        y
                      as follows:
                        
                           (58)
                           
                              E
                              (
                              x
                              |
                              y
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              p
                              (
                              k
                              |
                              y
                              )
                              E
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              E
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                           
                        
                      where
                        
                           (59)
                           
                              p
                              (
                              k
                              |
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    y
                                    |
                                    k
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          j
                                       
                                    
                                    p
                                    (
                                    y
                                    |
                                    j
                                    )
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                     
                  

From Eqs. (57), (58), (59) we can write the final MMSE estimate of 
                        x
                      given the model parameters as follows:
                        
                           (60)
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 y
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ]
                              
                              .
                           
                        
                     
                  

We also need to find the following sufficient statistics to be used in estimating the model parameters:
                        
                           (61)
                           
                              var
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    Ψ
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (62)
                           
                              E
                              
                                 (
                                 
                                    x
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    |
                                 
                                 y
                                 ,
                                 k
                                 )
                              
                              =
                              var
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              +
                              E
                              (
                              x
                              |
                              y
                              ,
                              k
                              )
                              E
                              (
                              x
                              
                                 
                                    |
                                    y
                                    ,
                                    k
                                    )
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    Ψ
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                      and
                        
                           (63)
                           
                              E
                              
                                 (
                                 
                                    x
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    |
                                 
                                 y
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              p
                              (
                              k
                              |
                              y
                              )
                              E
                              
                                 (
                                 
                                    x
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    |
                                 
                                 y
                                 ,
                                 k
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              E
                              
                                 (
                                 
                                    x
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    |
                                 
                                 y
                                 ,
                                 k
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    ˆ
                                 
                              
                              .
                           
                        
                     
                  

In the training stage, we assume we have clean data with 
                           e
                           =
                           0
                        . The prior GMM parameters 
                           ω
                           ,
                           μ
                           ,
                           Σ
                         are learned as regular GMM models. The only parameter that needs to be estimated is 
                           Ψ
                        , which is learned from the deformed signal “
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                        ” in Section 3.2. The parameter 
                           Ψ
                         is learned iteratively using maximum likelihood estimation. Given the data points 
                           q
                           =
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 N
                              
                           
                        , and the GMM parameters, we need to find an estimate for 
                           Ψ
                        . We follow the same procedures as in [27–29].

Let us rewrite the sufficient statistics in Eqs. (59), (57), (60), (62), (63) after replacing 
                           x
                         with 
                           z
                         (to avoid confusion between calculating the MMSE estimate and training the model parameters) as follows:
                           
                              (64)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             j
                                          
                                       
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (65)
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (66)
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (67)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    )
                                 
                                 =
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              (68)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 .
                              
                           
                         We define 
                           q
                           =
                           {
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 N
                              
                           
                           }
                        , 
                           z
                           =
                           {
                           
                              
                                 z
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 z
                              
                              
                                 N
                              
                           
                           }
                        , and 
                           K
                           =
                           {
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 k
                              
                              
                                 N
                              
                           
                           }
                        . Given the generative model in Fig. 7
                        , the complete log-likelihood can be written in a product form as follows:
                           
                              (69)
                              
                                 l
                                 (
                                 q
                                 ,
                                 z
                                 ,
                                 K
                                 |
                                 θ
                                 )
                                 =
                                 log
                                 
                                 
                                    ∏
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 p
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 log
                                 
                                 
                                    ∏
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       [
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       k
                                       )
                                       p
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       )
                                       ]
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 log
                                 
                                 
                                    ∏
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       [
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       N
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       Ψ
                                       )
                                       ]
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           θ
                           =
                           {
                           μ
                           ,
                           Σ
                           ,
                           ω
                           ,
                           Ψ
                           }
                        , 
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       else
                                    
                                 
                              
                              }
                           
                        ,
                           
                              (70)
                              
                                 l
                                 (
                                 q
                                 ,
                                 z
                                 ,
                                 K
                                 |
                                 θ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 log
                                 
                                 N
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 log
                                 
                                 N
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 Ψ
                                 )
                                 .
                              
                           
                        
                     

The conditional expectation of the complete log likelihood, which is conditioned on the observed data 
                           q
                         can be written as:
                           
                              (71)
                              
                                 Q
                                 
                                    (
                                    
                                       θ
                                       |
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       z
                                       ,
                                       K
                                       |
                                       q
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       l
                                       (
                                       q
                                       ,
                                       z
                                       ,
                                       K
                                       |
                                       θ
                                       )
                                       |
                                    
                                    q
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We can show that:
                           
                              (72)
                              
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                    K
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 δ
                                 (
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 p
                                 
                                    (
                                    
                                       k
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We define:
                           
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 p
                                 
                                    (
                                    
                                       k
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             j
                                          
                                       
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

We can also show that, for any function 
                           F
                           (
                           
                              
                                 z
                              
                              
                                 n
                              
                           
                           )
                        :
                           
                              (73)
                              
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       F
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          z
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                    K
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 δ
                                 (
                                 k
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 F
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       k
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    F
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

We can write the conditional expectation of the complete log-likelihood as follows:
                           
                              (74)
                              
                                 Q
                                 
                                    (
                                    
                                       θ
                                       |
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       log
                                       N
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       log
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       Ψ
                                       )
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

For the parameter 
                           Ψ
                        , we need to maximize the third part of Eq. (74) with respect to 
                           Ψ
                        :
                           
                              (75)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       log
                                       N
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       Ψ
                                       )
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    log
                                    
                                    
                                       1
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                
                                                   d
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                |
                                                Ψ
                                                |
                                             
                                             
                                                
                                                   1
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                    
                                       
                                          {
                                          
                                             
                                                −
                                                1
                                             
                                             2
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          }
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          −
                                          d
                                       
                                       2
                                    
                                    log
                                    (
                                    2
                                    π
                                    )
                                    −
                                    
                                       1
                                       2
                                    
                                    log
                                    |
                                    Ψ
                                    |
                                    −
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          Ψ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         the derivative of 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                         with respect to 
                           
                              
                                 Ψ
                              
                              
                                 −
                                 1
                              
                           
                         is set to zero:
                           
                              (76)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             Ψ
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    Ψ
                                    −
                                    
                                       1
                                       2
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          z
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (77)
                              
                                 Ψ
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                z
                                             
                                             
                                                n
                                             
                                          
                                          |
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             k
                                             n
                                          
                                       
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                
                                             
                                             |
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             k
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      old
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             k
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      old
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       k
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                old
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       |
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          
                                             old
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         we know that
                           
                              
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 N
                                 
                                 and
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         then
                           
                              
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and
                           
                              
                                 Ψ
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       n
                                    
                                 
                                 =
                                 N
                                 Ψ
                                 .
                              
                           
                         We can use the values of 
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           
                              
                                 E
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 k
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          old
                                       
                                    
                                 
                              
                           
                           (
                           
                              
                                 z
                              
                              
                                 n
                              
                           
                           |
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           ,
                           k
                           ,
                           
                              
                                 θ
                              
                              
                                 
                                    old
                                 
                              
                           
                           )
                         and 
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 γ
                              
                              
                                 k
                                 n
                              
                           
                           
                              
                                 E
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 k
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          old
                                       
                                    
                                 
                              
                           
                           (
                           
                              
                                 z
                              
                              
                                 n
                              
                           
                           
                              
                                 z
                              
                              
                                 n
                              
                              
                                 T
                              
                           
                           |
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           ,
                           k
                           ,
                           
                              
                                 θ
                              
                              
                                 
                                    old
                                 
                              
                           
                           )
                         from Eqs. (66), (68) to update the estimate of 
                           Ψ
                         as follows:
                           
                              (78)
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 diag
                                 
                                 
                                    {
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                         where the “diag” operator sets all the off-diagonal elements of a matrix to zero.

In this appendix, we show the gradients of the penalty term in the regularized NMF cost function in Section 3.2. To calculate the update rule for the gains matrix 
                        G
                     , the gradients 
                        
                           
                              ∇
                           
                           
                              G
                           
                           
                              +
                           
                        
                        L
                        (
                        G
                        )
                      and 
                        
                           
                              ∇
                           
                           
                              G
                           
                           
                              −
                           
                        
                        L
                        (
                        G
                        )
                      are needed to be calculated. Lets recall the regularized NMF cost function
                        
                           (79)
                           
                              C
                              (
                              G
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    IS
                                 
                              
                              (
                              V
                              ∥
                              B
                              G
                              )
                              +
                              α
                              L
                              (
                              G
                              )
                              ,
                           
                        
                      where
                        
                           (80)
                           
                              L
                              (
                              G
                              )
                              =
                              
                                 ∑
                                 n
                                 N
                              
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    −
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       )
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (81)
                           
                              f
                              (
                              
                                 
                                    g
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    log
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ]
                              
                              ,
                           
                        
                      and
                        
                           (82)
                           
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       N
                                       (
                                       log
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             j
                                          
                                       
                                       N
                                       (
                                       log
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Since the training data for the GMM models are the logarithm of the normalized vectors, then the mean vectors of the GMM are always not positive, also the values of 
                        log
                        
                        
                           
                              
                                 g
                              
                              
                                 n
                              
                           
                           
                              
                                 ‖
                                 
                                    
                                       g
                                    
                                    
                                       n
                                    
                                 
                                 ‖
                              
                              
                                 2
                              
                           
                        
                      are also not positive, and 
                        
                           
                              g
                           
                           
                              n
                           
                        
                      is always nonnegative.

Let 
                        
                           
                              g
                           
                           
                              n
                           
                        
                        =
                        x
                     , and its component a is 
                        
                           
                              g
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    a
                                 
                              
                           
                        
                        =
                        
                           
                              x
                           
                           
                              a
                           
                        
                     , and 
                        f
                        (
                        
                           
                              g
                           
                           
                              n
                           
                        
                        )
                        =
                        f
                        (
                        x
                        )
                     . We can write the constraint in Eq. (80) as:
                        
                           (83)
                           
                              L
                              (
                              x
                              )
                              =
                              
                                 
                                    ‖
                                    
                                       x
                                       
                                          
                                             ‖
                                             x
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    −
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       x
                                       )
                                       )
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      The a component of the gradient of 
                        L
                        (
                        x
                        )
                      is
                        
                           (84)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    x
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                              =
                              2
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 −
                                 exp
                                 
                                 
                                    (
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 )
                              
                              
                                 (
                                 
                                    1
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                 
                                 −
                                 ∇
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 exp
                                 
                                 
                                    (
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 )
                              
                              =
                              ∇
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              ,
                           
                        
                      which can be written as a difference of two positive terms
                        
                           (85)
                           
                              ∇
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              .
                           
                        
                      The component a of the gradient of 
                        f
                        (
                        x
                        )
                      can be written as a difference of two positive terms:
                        
                           (86)
                           
                              
                                 
                                    ∂
                                    f
                                    (
                                    x
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              .
                           
                        
                      The component a of the gradient of 
                        L
                        (
                        x
                        )
                      in Eq. (85) can be written as:
                        
                           (87)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              2
                              
                                 {
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       
                                          
                                             ‖
                                             x
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    +
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          −
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 +
                                 exp
                                 
                                 
                                    (
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ‖
                                             x
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                    
                                    +
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          +
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 }
                              
                              ,
                           
                        
                      and
                        
                           (88)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              L
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              2
                              
                                 {
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ‖
                                             x
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                    
                                    +
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          +
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 +
                                 exp
                                 
                                 
                                    (
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       
                                          
                                             ‖
                                             x
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    +
                                    exp
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          −
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    )
                                 
                                 }
                              
                              .
                           
                        
                     
                  

We need to find the values of 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                        f
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                        f
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                     . Note that, the term 
                        
                           
                              Σ
                           
                           
                              k
                           
                        
                        
                           
                              (
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                              +
                              Ψ
                              )
                           
                           
                              −
                              1
                           
                        
                      forms a diagonal matrix.

Let
                        
                           (89)
                           
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    μ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                          a
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 log
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      then 
                        f
                        (
                        x
                        )
                      in Eq. (81) can be written as:
                        
                           (90)
                           
                              f
                              (
                              x
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              x
                              )
                              H
                              (
                              x
                              )
                              .
                           
                        
                      The gradient of 
                        f
                        (
                        x
                        )
                      in Eq. (90) can be written as:
                        
                           (91)
                           
                              ∇
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 [
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 ∇
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 +
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ∇
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ]
                              
                              ,
                           
                        
                      where
                        
                           (92)
                           
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       N
                                       (
                                       log
                                       
                                       
                                          x
                                          
                                             
                                                ‖
                                                x
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             j
                                          
                                       
                                       N
                                       (
                                       log
                                       
                                       
                                          x
                                          
                                             
                                                ‖
                                                x
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       Ψ
                                       )
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              .
                           
                        
                      We can also write the gradient components of 
                        H
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      and 
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                      as a difference of two positive terms
                        
                           (93)
                           
                              ∇
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              ,
                           
                        
                      and
                        
                           (94)
                           
                              ∇
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              .
                           
                        
                     
                  

The gradient of 
                        f
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      in Eqs. (86), (91) can be written as:
                        
                           (95)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 [
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       +
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       H
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       H
                                    
                                    
                                       −
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ]
                              
                              ,
                           
                        
                     
                     
                        
                           (96)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 [
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       −
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       H
                                    
                                    
                                       −
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       H
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    
                                       ∇
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ]
                              
                              ,
                           
                        
                      where
                        
                           (97)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                          a
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 1
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (98)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                          a
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       ‖
                                       x
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                              ,
                           
                        
                      and 
                        H
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      can be written as a difference of two positive terms:
                        
                           (99)
                           
                              H
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    H
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    H
                                 
                                 
                                    −
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              ,
                           
                        
                      where
                        
                           (100)
                           
                              
                                 
                                    H
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              −
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                          a
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                              ,
                           
                        
                      and
                        
                           (101)
                           
                              
                                 
                                    H
                                 
                                 
                                    −
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              −
                              
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             a
                                             a
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   a
                                                   a
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             Ψ
                                          
                                          
                                             a
                                             a
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 log
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      We can rewrite 
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                      in Eq. (92) as:
                        
                           (102)
                           
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              ,
                           
                        
                      note that 
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                        ,
                        
                           
                              M
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                        ,
                        
                           
                              N
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                        ⩾
                        0
                     .

The component a of the gradient of 
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                      can be written as:
                        
                           (103)
                           
                              ∇
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    ∇
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    ∇
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              .
                           
                        
                      We can write the gradients of 
                        
                           
                              M
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                      and 
                        
                           
                              N
                           
                           
                              k
                           
                        
                        (
                        x
                        )
                      as a difference of two positive terms
                        
                           (104)
                           
                              ∇
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              ,
                           
                        
                      and
                        
                           (105)
                           
                              ∇
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              −
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 K
                              
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              .
                           
                        
                      The gradient of 
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      in Eq. (94) can be written as:
                        
                           (106)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    ∇
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (107)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    ∇
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                       
                                          −
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          +
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              ,
                           
                        
                      where
                        
                           (108)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              x
                              )
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 [
                                 
                                    
                                       −
                                       1
                                    
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                 
                                 log
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             a
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      and
                        
                           (109)
                           
                              
                                 
                                    ∇
                                 
                                 
                                    −
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              (
                              x
                              )
                              
                                 
                                    (
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                a
                                                a
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Ψ
                                       
                                       
                                          a
                                          a
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 [
                                 
                                    
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                                 log
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      After finding 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                     , and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                        
                           
                              γ
                           
                           
                              k
                           
                        
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      from Eqs. (106), (107), and 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                        H
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                     , and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                        H
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      from Eqs. (97), (98), we can find the gradients 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                        f
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                     , and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                        f
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      in Eqs. (95), (96), which complete our solution for 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                        L
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                     , and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                        L
                        (
                        
                           
                              x
                           
                           
                              a
                           
                        
                        )
                      in Eqs. (87), (88).

@&#REFERENCES@&#

