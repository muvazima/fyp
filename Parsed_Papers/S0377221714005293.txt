@&#MAIN-TITLE@&#Minmax regret 1-facility location on uncertain path networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose an algorithm to compute the minmax regret.


                        
                        
                           
                           We solve the minmax 1-facility location problem on uncertain path network.


                        
                        
                           
                           Our algorithm improves the previous work.


                        
                        
                           
                           We discover new observations on the problem.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Algorithms

Path networks

Uncertainty

Facility location

Minmax regret

@&#ABSTRACT@&#


               
               
                  Let P be an undirected path graph of n vertices. Each edge of P has a positive length and a constant capacity. Every vertex has a nonnegative supply, which is an unknown value but is known to be in a given interval. The goal is to find a point on P to build a facility and move all vertex supplies to the facility such that the maximum regret is minimized. The previous best algorithm solves the problem in 
                        
                           O
                           (
                           n
                           
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      space. In this paper, we present an 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           )
                        
                      space algorithm, and our approach is based on new observations and algorithmic techniques.
               
            

@&#INTRODUCTION@&#

Facility location problems on networks have received considerable attention over a few decades. The problems are normally concerned with networks where the information (e.g., the vertex and the edge weights) are known precisely. However, data in practice often involve uncertainty and may change with the time. Recently facility locations problems in uncertain environments have been studied, e.g., Averbakh and Bereg (2005), Averbakh and Berman (1997, 2000a, 2000b, 2003), Bhattacharya and Kameda (2012), Bhattacharya, Kameda, and Song (2012a, 2012b), Chen and Lin (1998), Cheng et al. (2013), Conde (2007, 2008), Kouvelis and Yu (1997), Puerto, Rodríguez-Chía, and Tamir (2009) and Yu, Lin, and Wang (2008). One approach that is often used to model the uncertainty is the worst-case analysis in which one is looking for a solution that performs reasonably well for all possible scenarios (where a scenario is a specific realization of all uncertain parameters of the problem). There are many optimization criteria in the worst-case analysis. In particular, the minmax regret optimization aims at obtaining a solution that minimizes the maximum deviation, over all possible scenarios, between the value of the solution and the optimal value of the corresponding scenario, e.g., Averbakh and Berman (1997, 2000b), Bhattacharya and Kameda (2012), Bhattacharya et al. (2012a, 2012b), Cheng et al. (2013), Kouvelis and Yu (1997) and Yu et al. (2008). In other words, the minmax regret optimization seeks to minimize the worst-case loss in the objective function value that may occur because the solution is chosen without knowing which scenario will take place.

In this paper, we consider the minmax regret 1-facility location problem on uncertain path networks where the vertex weights are uncertain. The problem was proposed recently by Cheng et al. (2013) and an 
                        
                           O
                           (
                           n
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      space algorithm was given in Cheng et al. (2013). By discovering more observations, we present an 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           )
                        
                      space algorithm in this paper. Shortly after the preliminary version of this paper appeared in Wang (2013), Cheng et al.’s algorithm (Cheng et al., 2013) was independently improved to 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      space in their journal paper (Higashikawa et al., 2014).

As discussed in Cheng et al. (2013), the problem is motivated by an earthquake evacuation problem due to the Tohoku-Pacific Ocean Earthquake that happened in Japan on March 11th, 2011. For example, suppose we have a highway that connects many cities and we want to find a location on the highway to build an evacuation facility such that when earthquake happens we can evacuate people in all these cities to the facility as soon as possible. The number of people in each city is uncertain due to different time periods (e.g., weekdays, weekends, days, nights, holidays). We formally introduce the problem below, and some notations are borrowed from Cheng et al. (2013).

Let 
                           
                              P
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         be a path graph, with the vertex set 
                           
                              V
                              =
                              {
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              }
                           
                         and the edge set 
                           
                              E
                              =
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              }
                           
                        , such that 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           
                         connects 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         for each 
                           
                              1
                              ⩽
                              i
                              ⩽
                              n
                              -
                              1
                           
                        . Each edge 
                           
                              e
                              ∈
                              E
                           
                         has a positive weight 
                           
                              l
                              (
                              e
                              )
                           
                        . Each vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ∈
                              V
                           
                         has a weight 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         (e.g., the number of evacuees), which is unknown but is known in a given interval 
                           
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             -
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                           
                         with 
                           
                              0
                              ⩽
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    -
                                 
                              
                              ⩽
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           
                        . Let c be a constant representing the capacity of each edge, which is the maximum number of evacuees passing any point in any unit time. Let 
                           
                              τ
                           
                         be a positive constant representing the time required for traversing a unit distance of every evacuee. Let 
                           
                              Σ
                           
                         be the Cartesian product of all intervals 
                           
                              [
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                              ]
                           
                         for 
                           
                              1
                              ⩽
                              i
                              ⩽
                              n
                           
                        . Every element 
                           
                              s
                              ∈
                              Σ
                           
                         is called a scenario that is a feasible assignment of weights to the vertices of P. For any scenario 
                           
                              s
                              ∈
                              Σ
                           
                        , for each 
                           
                              1
                              ⩽
                              i
                              ⩽
                              n
                           
                        , we denote by 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              s
                              )
                           
                         the weight of the vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         in the scenario s, and 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    -
                                 
                              
                              ⩽
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              s
                              )
                              ⩽
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           
                        .

As in Cheng et al. (2013), we embed the path P on a real line L (e.g., the x-axis) such that each vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ∈
                              V
                           
                         is associated with the coordinate 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              l
                              (
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         for each 
                           
                              2
                              ⩽
                              i
                              ⩽
                              n
                           
                        . For each point 
                           
                              x
                              ∈
                              L
                           
                        , with a little abuse of notation, we also use x to denote the coordinate of the point. We use P to denote the set of points x on L with 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ⩽
                              x
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                        . For any point 
                           
                              x
                              ∈
                              P
                           
                        , let 
                           
                              
                                 
                                    P
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              t
                              ∈
                              P
                              
                              |
                              
                              t
                              <
                              x
                              }
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              t
                              ∈
                              P
                              
                              |
                              
                              t
                              >
                              x
                              }
                           
                        . Suppose we build a facility at a location 
                           
                              x
                              ∈
                              P
                           
                        . Consider any scenario 
                           
                              s
                              ∈
                              Σ
                           
                        . We use 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         to denote the minimum time for the evacuees on 
                           
                              
                                 
                                    P
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              )
                           
                         to move to x; similarly, let 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         denote the minimum time for the evacuees on 
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                           
                         to move to x. Note that if x is at a vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ∈
                              V
                           
                        , then we assume the evacuees at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         can complete evacuation in no time. As discussed in Cheng et al. (2013), by Kamiyama, Katoh, and Takizawa (2006), 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         can be expressed as follows.
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   L
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      x
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ·
                                                      τ
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      x
                                                      )
                                                      ·
                                                      τ
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        j
                                                                        =
                                                                        i
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that if 
                           
                              
                                 
                                    P
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              )
                              =
                              ∅
                              ,
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              =
                              0
                           
                        , and if 
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              =
                              ∅
                              ,
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              =
                              0
                           
                        .

As in Cheng et al. (2013) and Higashikawa et al. (2014), in this paper we consider the case where 
                           
                              c
                              =
                              1
                           
                        . We should point out that Cheng et al. (2013) claimed that any algorithm works for 
                           
                              c
                              =
                              1
                           
                         can also work for any other values of c (our preliminary version (Wang, 2013) cited their claim). However, it was found that the claim was not correct (Higashikawa et al., 2014), and therefore, their algorithms (Cheng et al., 2013; Higashikawa et al., 2014) only work for the case 
                           
                              c
                              =
                              1
                           
                         and so does the algorithm in this paper.

But we can ignore the 
                           
                              -
                              1
                           
                         from the above formulas when designing the algorithm. Hence, as in Cheng et al. (2013), we simply use the following definitions for 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                        .
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   L
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      x
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ·
                                                      τ
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      x
                                                      )
                                                      ·
                                                      τ
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               =
                                                               i
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As in Cheng et al. (2013), for convenience of discussion, for each 
                           
                              1
                              ⩽
                              i
                              ⩽
                              n
                           
                        , we define a function 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         on 
                           
                              x
                              >
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         and a function 
                           
                              
                                 
                                    f
                                 
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              s
                              ,
                              x
                              )
                           
                         on 
                           
                              x
                              <
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         as follows.
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             (
                                             x
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ·
                                             τ
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             s
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             =
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             x
                                             )
                                             ·
                                             τ
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      i
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             s
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Hence, we have 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          L
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                        .

Let 
                           
                              T
                              (
                              x
                              ,
                              s
                              )
                           
                         denote the minimum time for all evacuees on P to move to x. Thus, 
                           
                              T
                              (
                              x
                              ,
                              s
                              )
                              =
                              max
                              {
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              ,
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                              }
                           
                        . Denote by 
                           
                              
                                 
                                    x
                                 
                                 
                                    opt
                                 
                              
                              (
                              s
                              )
                           
                         a point on P such that 
                           
                              T
                              (
                              x
                              ,
                              s
                              )
                           
                         is minimized when 
                           
                              x
                              =
                              
                                 
                                    x
                                 
                                 
                                    opt
                                 
                              
                              (
                              s
                              )
                           
                        , and one may consider 
                           
                              
                                 
                                    x
                                 
                                 
                                    opt
                                 
                              
                              (
                              s
                              )
                           
                         as an optimal location for the scenario s. For any point x on L, let 
                           
                              R
                              (
                              x
                              ,
                              s
                              )
                              =
                              T
                              (
                              x
                              ,
                              s
                              )
                              -
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    opt
                                 
                              
                              (
                              s
                              )
                              ,
                              s
                              )
                           
                        , and we call 
                           
                              R
                              (
                              x
                              ,
                              s
                              )
                           
                         the regret of x in the scenario s. Intuitively, 
                           
                              R
                              (
                              x
                              ,
                              s
                              )
                           
                         is the regret (i.e., the opportunity loss) caused by choosing the location x instead of the optimal location 
                           
                              
                                 
                                    x
                                 
                                 
                                    opt
                                 
                              
                              (
                              s
                              )
                           
                        . Finally, the maximum regret of x is defined as 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    s
                                    ∈
                                    Σ
                                 
                              
                              R
                              (
                              x
                              ,
                              s
                              )
                           
                        . In other words, 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                           
                         is the worst-case opportunity loss for choosing the location x.

Our minmax regret problem is to choose a location x on L such that the maximum regret 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                           
                         is minimized, and the minimized 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                           
                         is called the minmax regret.

In this paper we present an algorithm of 
                           
                              O
                              (
                              n
                              log
                              n
                              )
                           
                         time and 
                           
                              O
                              (
                              n
                              )
                           
                         space for the problem, which improves the 
                           
                              O
                              (
                              n
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              n
                              )
                           
                         time and 
                           
                              O
                              (
                              n
                              log
                              n
                              )
                           
                         space algorithm (Cheng et al., 2013).

Our algorithm makes use of the critical observation given in Cheng et al. (2013) that there are a set S of 
                           
                              2
                              n
                           
                         scenarios such that for any point x on L, the “worst-case” scenario for 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                           
                         must be in S. This implies that instead of considering the infinitely many scenarios of 
                           
                              Σ
                           
                         for computing 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              )
                           
                        , we only need to consider the scenarios in S. The algorithm has two main steps. The first step is to compute the optimal positions for all scenarios in S. An 
                           
                              O
                              (
                              n
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              n
                              )
                           
                         time algorithm is given in Cheng et al. (2013) for the step. By finding new properties on the optimal solutions of these scenarios, we are able to compute all optimal solutions in 
                           
                              O
                              (
                              n
                              log
                              n
                              )
                           
                         time by an even simpler algorithm. The second step is to compute the minmax regret. This step also takes 
                           
                              O
                              (
                              n
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              n
                              )
                           
                         time in Cheng et al. (2013). Our algorithm runs in 
                           
                              O
                              (
                              n
                              log
                              n
                              )
                           
                         time and 
                           
                              O
                              (
                              n
                              )
                           
                         space. The high level scheme of our approach is binary search, whose efficiency hinges on solving the following sub-problem in linear time: Given any point x on L, compute the values 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         for all scenarios 
                           
                              s
                              ∈
                              S
                           
                        . A straightforward method can compute 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time for each scenario s, and thus solves the sub-problem in 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         time. By discovering some interesting observations, we present an 
                           
                              O
                              (
                              n
                              )
                           
                         time algorithm for the sub-problem. It should be noted that our algorithm itself is very simple but it is more challenging to observe the crucial properties behind the scene.

In the following, we discuss some basic observations in Section 2. In Section 3, we compute the optimal locations for all scenarios in S. Section 4 computes the minmax regret. Section 5 concludes the paper and discusses some possible future work.

We discuss some observations that will be useful for our algorithm. Most of these observations have been discovered in Cheng et al. (2013) and we sketch them in this section for completeness of this paper.

Our goal is to find a location x to minimize the maximum regret 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 max
                              
                              
                                 s
                                 ∈
                                 Σ
                              
                           
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     . Consider any point x on P and any scenario 
                        
                           s
                           ∈
                           Σ
                        
                     . To compute 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     , we need to known 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      first. Recall that 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      is the value of x such that 
                        
                           T
                           (
                           x
                           ,
                           s
                           )
                           =
                           max
                           {
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                           ,
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                           }
                        
                      is minimized when 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                     . To determine 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                     , we discuss some properties of 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                     .

Recall that 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                           =
                           
                              
                                 max
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 )
                              
                           
                           
                              
                                 f
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                     . For each 
                        
                           1
                           ⩽
                           i
                           ⩽
                           n
                        
                     , the function 
                        
                           
                              
                                 f
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      defines in the plane an open half-line of slope 
                        
                           τ
                        
                      with (but excluding) the (left) endpoint 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           (
                           s
                           )
                           )
                        
                      (e.g., see Fig. 1
                     ). 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      is the upper envelope of the n half-lines defined by the functions 
                        
                           
                              
                                 f
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Since 
                        
                           τ
                           >
                           0
                        
                     , 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      is a strictly increasing function of x (e.g., see Fig. 1). Similarly, each 
                        
                           
                              
                                 f
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      defines an open half-line of slope 
                        
                           -
                           τ
                        
                      with (but excluding) the (right) endpoint 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 i
                              
                              
                                 n
                              
                           
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           (
                           s
                           )
                           )
                        
                     , and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      is the corresponding upper envelope, which is strictly decreasing. Since 
                        
                           T
                           (
                           x
                           ,
                           s
                           )
                           =
                           max
                           {
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                           ,
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                           }
                        
                     , 
                        
                           T
                           (
                           x
                           ,
                           s
                           )
                        
                      is a unimodal function of x in the sense that there exists a value 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      such that 
                        
                           T
                           (
                           x
                           ,
                           s
                           )
                        
                      is strictly decreasing on 
                        
                           (
                           -
                           ∞
                           ,
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           ]
                        
                      and increasing on 
                        
                           [
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           ,
                           +
                           ∞
                           )
                        
                      (e.g., see Fig. 2
                     ). Note that the above 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      is 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                     . These properties are already given in Cheng et al. (2013). We also have the following observation.
                        Observation 1
                        For any scenario 
                              
                                 s
                                 ∈
                                 Σ
                              
                           , 
                              
                                 T
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            is the upper envelope of the functions 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           .

For any point x, to compute the maximum regret 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                     , a straightforward approach is to enumerate all scenarios in 
                        
                           Σ
                        
                      to compute 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                      for every scenario 
                        
                           s
                           ∈
                           Σ
                        
                     . However, since there are infinitely many scenarios in 
                        
                           Σ
                        
                     , the approach does not work. Below, we use a difference approach.

A scenario s is the worst-case scenario for the location x if 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     , and we denote it by 
                        
                           s
                           (
                           x
                           )
                        
                     . Clearly, if we know 
                        
                           s
                           (
                           x
                           )
                        
                     , then we can compute 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           R
                           (
                           x
                           ,
                           s
                           (
                           x
                           )
                           )
                        
                     . Cheng et al. (2013) provided a way to determine a set S of at most 
                        
                           2
                           n
                        
                      scenarios such that 
                        
                           s
                           (
                           x
                           )
                        
                      must be in S for any x, as follows.

For each 
                        
                           1
                           ⩽
                           i
                           ⩽
                           n
                        
                     , let 
                        
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                        
                      be the scenario where the weight 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                           )
                        
                      of the vertex 
                        
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                        
                      is 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                              
                                 +
                              
                           
                        
                      for each j with 
                        
                           1
                           ⩽
                           j
                           ⩽
                           i
                        
                     , and 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 w
                              
                              
                                 j
                              
                              
                                 -
                              
                           
                        
                      for each j with 
                        
                           i
                           +
                           1
                           ⩽
                           j
                           ⩽
                           n
                        
                      if 
                        
                           i
                           <
                           n
                        
                     . Symmetrically, for each 
                        
                           1
                           ⩽
                           i
                           ⩽
                           n
                        
                     , let 
                        
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                        
                      be the scenario where 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 j
                              
                              
                                 -
                              
                           
                        
                      for each j with 
                        
                           1
                           ⩽
                           j
                           ⩽
                           i
                        
                     , and 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 w
                              
                              
                                 j
                              
                              
                                 +
                              
                           
                        
                      for each j with 
                        
                           i
                           +
                           1
                           ⩽
                           j
                           ⩽
                           n
                        
                      if 
                        
                           i
                           <
                           n
                        
                     . Let 
                        
                           
                              
                                 S
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                    
                                    |
                                    
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    n
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 R
                              
                           
                           =
                           {
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           
                           |
                           
                           1
                           ⩽
                           i
                           ⩽
                           n
                           }
                        
                     . Let 
                        
                           S
                           =
                           
                              
                                 S
                              
                              
                                 L
                              
                           
                           ∪
                           
                              
                                 S
                              
                              
                                 R
                              
                           
                        
                     . The following lemma has been proved in Cheng et al. (2013).
                        Lemma 1
                        
                           Cheng et al. (2013)
                        


                        
                           For any point x on L, there exists a worst-case scenario for x in S.
                        

In light of Lemma 1, we have 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 max
                              
                              
                                 s
                                 ∈
                                 S
                              
                           
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     . Hence, to compute 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                     , instead of considering all scenarios of 
                        
                           Σ
                        
                     , we only need to consider the 
                        
                           2
                           n
                        
                      scenarios in S. For each 
                        
                           s
                           ∈
                           S
                        
                     , to compute 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     , we need to know the optimal location 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                     . Cheng et al. (2013) presented an 
                        
                           O
                           (
                           n
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           n
                           )
                        
                      time algorithm for computing 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all scenarios 
                        
                           s
                           ∈
                           S
                        
                     , and in Section 3 we describe an 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time algorithm.

In this section, we present an 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           )
                        
                      space algorithm for computing 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all scenarios 
                        
                           s
                           ∈
                           S
                        
                     , which improves the 
                        
                           O
                           (
                           n
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           n
                           )
                        
                      time algorithm in Cheng et al. (2013). Our improvement is due in a large part to certain monotonicity properties of the values 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      given in Lemma 2.
                        Lemma 2
                        
                           For any two scenarios 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            
                           of 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                              
                            
                           with 
                           
                              
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 -
                                 1
                              
                           
                           , if 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                           , then 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                           ; otherwise, 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           
                           .
                        

We only prove the case where 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            since the proof for the other case where 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            is very similar.

According to the definitions of the two scenarios 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           , for each vertex 
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                              
                           , if 
                              
                                 j
                                 
                                 ≠
                                 
                                 i
                                 +
                                 1
                              
                           , the weights of 
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                              
                            in the two scenarios are the same, but for the vertex 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       -
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       +
                                    
                                 
                              
                           . By Corollary 1 in Cheng et al. (2013), 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            holds. Below, we prove 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           . To this end, it is sufficient to show that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            for any 
                              
                                 x
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           . The details are given below.

Consider any value 
                              
                                 x
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           . Since 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            is strictly increasing and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            is strictly decreasing for any scenario s, according to the definition of 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           , we have 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           .

According to the definitions of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for any 
                              
                                 j
                                 ⩾
                                 i
                                 +
                                 1
                              
                            and any 
                              
                                 t
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            (more precisely, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       -
                                    
                                 
                              
                           ), and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for any 
                              
                                 j
                                 ⩽
                                 i
                              
                            and any 
                              
                                 t
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            (e.g., see Fig. 3
                           ). Due to 
                              
                                 x
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           , we obtain 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           .

Similarly, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for any 
                              
                                 j
                                 ⩽
                                 i
                                 +
                                 1
                              
                            and any 
                              
                                 t
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for any 
                              
                                 j
                                 ⩾
                                 i
                                 +
                                 2
                              
                            and any 
                              
                                 t
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            (e.g., see Fig. 3). Since 
                              
                                 x
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           , none of the functions 
                              
                                 
                                    
                                       f
                                    
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            for 
                              
                                 j
                                 ⩽
                                 i
                                 +
                                 1
                              
                            is defined on 
                              
                                 t
                                 =
                                 x
                              
                           . Therefore, we obtain 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           .

The above shows that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           . Hence, we conclude that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           .□


                     Lemma 2 implies the following monotonicity property of 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     . Suppose initially 
                        
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                     ; as the index i increases, 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                      moves monotonically “backward” to the left until at some moment 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           >
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                      happens, after which 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                      moves monotonically “forward” to the right. This monotonicity property turns out to be quite useful to our algorithm.

Similarly, we have the following lemma for 
                        
                           
                              
                                 S
                              
                              
                                 R
                              
                           
                        
                     , which implies a monotonicity property of 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           )
                        
                      (the indices are considered from right to left).
                        Lemma 3
                        
                           For any two scenarios 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       R
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            
                           of 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       R
                                    
                                 
                              
                            
                           with 
                           
                              
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 -
                                 1
                              
                           
                           , if 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                R
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                           , then 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                R
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                           ; otherwise, 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                R
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           .
                        

The proof is symmetric to that for Lemma 2 by considering the indices from right to left, and we omit the details.□

Based on Lemmas 2 and 3, we present our algorithm for computing 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all 
                        
                           s
                           ∈
                           S
                        
                      as follows. We first compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all 
                        
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 L
                              
                           
                        
                     , by using Lemma 2.

Our algorithm will compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                      in the index order 
                        
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        
                     . We assume we already have a data structure D that can compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      whenever needed for any x and 
                        
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 L
                              
                           
                        
                     . Initially, to determine 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                     , we compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                      for 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                        
                      in the (forward) order to find the smallest index 
                        
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                        
                      such that 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                           ⩾
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . As discussed in Cheng et al. (2013), 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                           ∈
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ]
                        
                      and can be determined in constant time. Next, we compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     . Assume 
                        
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     . By Lemma 2, 
                        
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 L
                              
                              
                                 1
                              
                           
                           )
                        
                     , we only need to search the portions of 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      for 
                        
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ⩽
                           x
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . To this end, we compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      by using D for 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           …
                        
                      in the (backward) order to find the first index 
                        
                           
                              
                                 i
                              
                              
                                 2
                              
                           
                        
                      such that 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 2
                              
                           
                           )
                           ⩾
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 2
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           <
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     . As discussed in Cheng et al. (2013), 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           ∈
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ]
                        
                      and can be determined in constant time.

In general, assume 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                      has been computed and 
                        
                           
                              
                                 x
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                     . Further, assume 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                      is known in the interval 
                        
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           ]
                        
                     . To compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     , by Lemma 2, we have 
                        
                           
                              
                                 x
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                     . We compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      by D for 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           …
                        
                      in the (backward) order to find the first index 
                        
                           
                              
                                 i
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        
                      such that 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ⩾
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           )
                           <
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           )
                        
                     . Again, 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ∈
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                              
                           
                           ]
                        
                      and can be determined in constant time.

We continue the same procedure until the first time we have computed 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                      with 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        
                      for an index k. We also have the interval 
                        
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           ]
                        
                      that contains 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                     . By Lemma 2, 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        
                     . Hence, to compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     , we need to search the portions of 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      for 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                           ⩽
                           x
                        
                     . To this end, we compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      by D for 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           ,
                           …
                        
                      in the (forward) order to find the first index 
                        
                           
                              
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        
                      such that 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ⩾
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           <
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . Again, 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           ∈
                           [
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                           ]
                        
                      and can be determined in constant time. Next, we compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                 
                              
                           
                        
                     . We have the following observation.
                        Observation 2
                        
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                              
                            holds.

By Lemma 2, we have 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           . Due to 
                              
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                              
                           , the observation simply follows.□

Due to the above observation, we can compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          2
                                       
                                    
                                 
                              
                           
                        
                      in the similar way as 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . We continue this procedure to compute 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 j
                              
                           
                           )
                        
                      for 
                        
                           j
                           =
                           k
                           +
                           2
                           ,
                           k
                           +
                           3
                           ,
                           …
                           ,
                           n
                        
                     . Note that similar observation as Observation 2 always holds (i.e., 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 j
                              
                           
                           )
                           <
                           
                              
                                 x
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        
                      for any j with 
                        
                           k
                           +
                           1
                           ⩽
                           j
                           ⩽
                           n
                           -
                           1
                        
                     ). The algorithm stops when 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           
                              
                                 s
                              
                              
                                 L
                              
                              
                                 n
                              
                           
                           )
                        
                      is computed.

To analyze the running time, suppose any needed values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      in the above algorithm can be computed in 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 D
                              
                           
                           )
                        
                      time by using the data structure D; then we have the following lemma.
                        Lemma 4
                        
                           The values 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 s
                                 )
                              
                            
                           for all scenarios 
                           
                              
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                              
                            
                           can be computed in 
                           
                              
                                 O
                                 (
                                 n
                                 ·
                                 
                                    
                                       T
                                    
                                    
                                       D
                                    
                                 
                                 )
                              
                            
                           time.
                        

It is sufficient to show that the number of calls to D is 
                              
                                 O
                                 (
                                 n
                                 )
                              
                            in the entire algorithm.

We still use k to denote the smallest index with 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           . By the monotonicity property in Lemma 2, 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            is moving monotonically to the left for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 k
                              
                           , and 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            is moving monotonically to the right for 
                              
                                 i
                                 =
                                 k
                                 +
                                 1
                                 ,
                                 k
                                 +
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           . When we compute 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              
                           , the x values for computing 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            are monotone decreasing. Therefore, when computing the values 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           ’s for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              
                           , the total number of calls on D is 
                              
                                 O
                                 (
                                 n
                                 )
                              
                           . Analogously, when computing the values 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           ’s for 
                              
                                 i
                                 =
                                 k
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           , the total number of calls on D is also 
                              
                                 O
                                 (
                                 n
                                 )
                              
                           . The lemma thus follows.□

It remains to design the data structure D, which is given in the following lemma.
                        Lemma 5
                        
                           In 
                           
                              
                                 O
                                 (
                                 n
                                 )
                              
                            
                           time and 
                           
                              
                                 O
                                 (
                                 n
                                 )
                              
                            
                           space, we can build a data structure D that can compute in 
                           
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            
                           time (i.e., 
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                           
                           ) any value 
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            
                           or 
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            
                           needed in our algorithm for computing 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 s
                                 )
                              
                            
                           for all 
                           
                              
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                              
                           
                           .
                        

With 
                              
                                 O
                                 (
                                 n
                                 log
                                 n
                                 )
                              
                            time preprocessing, Cheng et al. (2013) propose a data structure that can compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            for any x and 
                              
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time, by using persistent data structures (Driscoll, Sarnak, Sleator, & Tarjan, 1989). Below, we give a simple solution with only 
                              
                                 O
                                 (
                                 n
                                 )
                              
                            preprocessing time, without using the persistent data structures.

We first discuss an observation on our algorithm that makes the design of our data structure easier. In our algorithm for computing 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 s
                                 )
                              
                            for all 
                              
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                              
                           , when we are computing 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           , for any 
                              
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                              
                           , we need to compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            for certain values of x. After 
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            is computed, we will never need to compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            for the scenario 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            again. Note that the corresponding algorithm in Cheng et al. (2013) does not have such a property.

Our data structure D has two parts 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       R
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                 
                              
                            is for computing 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       R
                                    
                                 
                              
                            is for computing 
                              
                                 
                                    
                                       T
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                           . Below, we only discuss 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                 
                              
                            since 
                              
                                 
                                    
                                       D
                                    
                                    
                                       R
                                    
                                 
                              
                            is very similar.


                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                 
                              
                            consists of a sequence of trees 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           , where 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            is used for computing 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            for any x. Thanks to the observation discussed above, at any moment during the algorithm, we only need to maintain one tree in the above sequence (in contrast, because the corresponding algorithm in Cheng et al. (2013) does not have such a property, they have to maintain all these trees in a persistent data structure). Specifically, initially we construct the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                           . Then, for each 
                              
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 -
                                 1
                              
                           , the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            is obtained by updating the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time (
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            is thus destroyed). Below, we first describe the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            and then show how to update 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            to obtain 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           . The tree is similar to that given in Cheng et al. (2013) (without being made persistent). We briefly discuss it here to make the paper self-contained.

We first discuss some observations on how to compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                           . Consider any scenario s and any value x with 
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       -
                                       1
                                    
                                 
                                 <
                                 x
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            for certain j. Recall that the functions 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            are defined on x while 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            are not, and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ⩽
                                       t
                                       ⩽
                                       j
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                           . Also recall that 
                              
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 =
                                 (
                                 x
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ·
                                 τ
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 s
                                 )
                              
                           . Hence, we can obtain the following 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 =
                                 x
                                 ·
                                 τ
                                 +
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ⩽
                                       t
                                       ⩽
                                       j
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 s
                                 )
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                                 )
                              
                           .


                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            is a balanced binary search tree in which the leaves of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                 
                              
                            from left to right store the values 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                            for 
                              
                                 t
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           . For each 
                              
                                 1
                                 ⩽
                                 t
                                 ⩽
                                 n
                              
                           , let 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                           , which is stored in the t-th leaf. For each node v (either a leaf or an internal node), it also stores a value 
                              
                                 max
                                 (
                                 v
                                 )
                              
                           , which is equal to the maximum value stored in the leaves of the subtree rooted at v. The tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            can be easily constructed in 
                              
                                 O
                                 (
                                 n
                                 )
                              
                            time in a bottom-up manner. Given any value 
                              
                                 x
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            can be computed in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time, as follows. According to our above discussion, we have 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ·
                                 τ
                                 +
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ⩽
                                       t
                                       ⩽
                                       j
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                              
                           . With standard techniques, by following the path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            from the root to the j-th leaf, we find a minimum set V of nodes whose subtrees contain the leaves exactly from the first leaf to the 
                              
                                 (
                                 j
                                 -
                                 1
                                 )
                              
                           -th one. Specifically, 
                              
                                 V
                                 =
                                 
                                    
                                       
                                          v
                                          
                                          |
                                          
                                          v
                                          
                                          ∉
                                          
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                            and v is the left child of a node in P
                           
                              j
                           } (e.g., see Fig. 4
                           ). Clearly, 
                              
                                 |
                                 V
                                 |
                                 =
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            and can be found in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time. An easy observation is that the largest value 
                              
                                 max
                                 (
                                 v
                                 )
                              
                            among all nodes 
                              
                                 v
                                 ∈
                                 V
                              
                            is exactly 
                              
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ⩽
                                       t
                                       ⩽
                                       j
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                              
                           . Hence, 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            is equal to 
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ·
                                 τ
                              
                            plus the above largest value 
                              
                                 max
                                 (
                                 v
                                 )
                              
                            of 
                              
                                 v
                                 ∈
                                 V
                              
                           . Thus, we can compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time.

Next, we show how to update 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time to obtain the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           , which is for computing 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            for the scenario 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           . According to the definitions of the two scenarios 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           , comparing with 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                           , the weight of the vertex 
                              
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       s
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            increases by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                              
                            while the weights of all other vertices are the same. Hence, all the values 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                            for 
                              
                                 t
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 ,
                                 n
                              
                            stored in the leaves of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            except the leftmost leaf should increase by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                              
                           . We cannot afford to change each of these values explicitly since that would need 
                              
                                 Ω
                                 (
                                 n
                                 )
                              
                            time. To obtain an 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time performance, we use the following approach. For each node v in the tree, we maintain an additional value, called the supplement value and denoted by 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                           . In 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 sup
                                 (
                                 v
                                 )
                                 =
                                 0
                              
                            for each node v. Hence, in 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                           , for any 
                              
                                 1
                                 ⩽
                                 t
                                 ⩽
                                 n
                              
                           , it holds that 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 sup
                                 (
                                 v
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                           , where 
                              
                                 
                                    
                                       P
                                    
                                    
                                       t
                                    
                                 
                              
                            is the path from the root of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            to the t-th leaf.

We update 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            to obtain 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            in the following way. Let 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            be the path from the root of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            to the second leaf. First, for the second leaf v, we increase 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                            by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                              
                           . Then, for each node v that is not in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            but is a right child of a node of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           , we increase 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                            by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                              
                           . Note that the above can be done in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time. Now consider the t-th leaf of the new tree, for any 
                              
                                 1
                                 ⩽
                                 t
                                 ⩽
                                 n
                              
                           , and let 
                              
                                 
                                    
                                       P
                                    
                                    
                                       t
                                    
                                 
                              
                            be the path from the root to the leaf. It is easy to see that 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 sup
                                 (
                                 v
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                           . In other words, if we follow 
                              
                                 
                                    
                                       P
                                    
                                    
                                       t
                                    
                                 
                              
                            from the root to aggregate the supplement value 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                           , once we arrive the t-th leaf, we have the value 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                              
                            ready. Next, we update the values 
                              
                                 max
                                 (
                                 v
                                 )
                              
                            for certain nodes v as follows. If a node v has a child whose supplement value has been increased above (note that v is necessarily on 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           ), then its 
                              
                                 max
                                 (
                                 v
                                 )
                              
                            may also need to be updated. To this end, for each internal node 
                              
                                 v
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           , we simply set 
                              
                                 max
                                 (
                                 v
                                 )
                              
                            to be 
                              
                                 max
                                 {
                                 max
                                 (
                                 u
                                 )
                                 +
                                 sup
                                 (
                                 u
                                 )
                                 ,
                                 max
                                 (
                                 w
                                 )
                                 +
                                 sup
                                 (
                                 w
                                 )
                                 }
                              
                           , where u and w are the two children of v. Note that we do not need to update the max value of the second leaf. This finishes our update on 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            and the new tree is 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           . Clearly, 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            can be obtained in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time.

Consider any internal node u on 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            and suppose the leftmost (resp., rightmost) leaf in the subtree rooted at v is the l-th (resp., r-th) leaf. Let 
                              
                                 
                                    
                                       P
                                    
                                    
                                       u
                                    
                                 
                              
                            be the path from the root to the node u. Based on our construction, 
                              
                                 max
                                 {
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                                 
                                 |
                                 
                                 l
                                 ⩽
                                 t
                                 ⩽
                                 r
                                 }
                              
                            is exactly equal to the value 
                              
                                 max
                                 (
                                 u
                                 )
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 sup
                                 (
                                 v
                                 )
                              
                           . Hence, given any 
                              
                                 x
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           , by using 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           , we can compute the value 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            in a similar way as before, and the only difference is that we need to aggregate the supplement values 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                            during traversing the tree from the root. Specifically, to compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            for any 
                              
                                 x
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           , let 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                            be the path of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            from the root to the j-th leaf. We start from the root and traverse the path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                            to the j-th leaf. During the traversal, consider any node 
                              
                                 v
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                           . We maintain a value 
                              
                                 A
                                 (
                                 v
                                 )
                              
                           , which is equal to 
                              
                                 sup
                                 (
                                 v
                                 )
                              
                            if v is the root and 
                              
                                 A
                                 (
                                 v
                                 .
                                 parent
                                 )
                                 +
                                 sup
                                 (
                                 v
                                 )
                              
                            otherwise (where 
                              
                                 v
                                 .
                                 parent
                              
                            is the parent of v in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                           ). If v has a left child u that is not in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                              
                           , we let the value 
                              
                                 max
                                 (
                                 u
                                 )
                                 +
                                 sup
                                 (
                                 u
                                 )
                                 +
                                 A
                                 (
                                 v
                                 )
                              
                            be in a set M (
                              
                                 M
                                 =
                                 ∅
                              
                            initially). If v is the j-th leaf, then we put the value 
                              
                                 A
                                 (
                                 v
                                 )
                                 +
                                 max
                                 (
                                 v
                                 )
                              
                            in M and finish the traversal. After the traversal, M has 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            values, and the maximum value of M is equal to 
                              
                                 max
                                 {
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 τ
                                 
                                 |
                                 
                                 1
                                 ⩽
                                 t
                                 ⩽
                                 j
                                 -
                                 1
                                 }
                              
                           . Therefore, 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            is equal to the maximum value of M plus 
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ·
                                 τ
                              
                           . Hence, 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            can be computed in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time.

Similarly, we can obtain the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       3
                                    
                                 
                              
                            by updating 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time. In general, for any 
                              
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 -
                                 1
                              
                           , if we already have the tree 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                           , we can obtain 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time by updating 
                              
                                 
                                    
                                       D
                                    
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                              
                            such that we can compute 
                              
                                 
                                    
                                       T
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                L
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            for any 
                              
                                 x
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            in 
                              
                                 O
                                 (
                                 log
                                 n
                                 )
                              
                            time.

The lemma thus follows.□

Combining Lemmas 4 and 5, the values 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all scenarios 
                        
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 L
                              
                           
                        
                      can be computed in 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time. Using the similar algorithm and Lemma 3, we can also compute the values 
                        
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                        
                      for all scenarios 
                        
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 R
                              
                           
                        
                      in 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time. We conclude this section with the following theorem.
                        Theorem 1
                        
                           The values 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 s
                                 )
                              
                            
                           and 
                           
                              
                                 T
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 s
                                 )
                                 ,
                                 s
                                 )
                              
                            
                           for all scenarios 
                           
                              
                                 s
                                 ∈
                                 S
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       L
                                    
                                 
                                 ∪
                                 
                                    
                                       S
                                    
                                    
                                       R
                                    
                                 
                              
                            
                           can be computed in 
                           
                              
                                 O
                                 (
                                 n
                                 log
                                 n
                                 )
                              
                            
                           time and 
                           
                              
                                 O
                                 (
                                 n
                                 )
                              
                            
                           space.
                        

Our goal is to determine an optimal location 
                     
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      such that 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 max
                              
                              
                                 s
                                 ∈
                                 Σ
                              
                           
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                      is minimized at 
                        
                           x
                           =
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                     , where 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                           =
                           T
                           (
                           x
                           ,
                           s
                           )
                           -
                           T
                           (
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                           ,
                           s
                           )
                        
                     . Again, by Lemma 1, 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 max
                              
                              
                                 s
                                 ∈
                                 S
                              
                           
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                     , which also implies that 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                      is the upper envelope of the functions 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                      for all 
                        
                           s
                           ∈
                           S
                        
                     .

Consider any scenario s. Since 
                        
                           T
                           (
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                           ,
                           s
                           )
                        
                      is a constant value and 
                        
                           T
                           (
                           x
                           ,
                           s
                           )
                        
                      is a unimodal function, 
                        
                           R
                           (
                           x
                           ,
                           s
                           )
                        
                      is also a unimodal function. Therefore, 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                      is the upper envelope of a set of unimodal functions, which is also unimodal. To determine an optimal solution 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                     , it is sufficient to determine the lowest point of the unimodal function 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                     . Due to the unimodality of 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           x
                           )
                        
                     , we will use binary search to find its lowest point.

The high-level scheme of our algorithm for finding 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      is a binary search on the values 
                        
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                        
                     . For each value 
                        
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                      considered in the binary search, we compute the value 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                        
                     . To this end, we present an 
                        
                           O
                           (
                           n
                           )
                        
                      time algorithm in Section 4.1 that can compute the values 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           s
                           )
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           s
                           )
                        
                      for all 
                        
                           s
                           ∈
                           S
                        
                     , for any 
                        
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                        
                     , after which we can determine the value 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           )
                        
                      in additional 
                        
                           O
                           (
                           n
                           )
                        
                      time since we already know the values 
                        
                           T
                           (
                           
                              
                                 x
                              
                              
                                 opt
                              
                           
                           (
                           s
                           )
                           ,
                           s
                           )
                        
                      for all 
                        
                           s
                           ∈
                           S
                        
                      by Theorem 1. Based on the function that gives the value 
                        
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                        
                     , we can also determine which direction to do binary search in a standard way (Megiddo, 1983, 1984). The binary search will end up with either 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      for some 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      or an interval 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      such that 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           ∈
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                     . In the latter case, we finally determine 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      in additional 
                        
                           O
                           (
                           n
                           )
                        
                      time by linear programming (Megiddo, 1983, 1984) as follows. Note that for any scenario s, the value 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      for 
                        
                           x
                           ∈
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      are given by the same function 
                        
                           
                              
                                 f
                              
                              
                                 L
                              
                              
                                 j
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                      for some j, and similar observation holds for 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           s
                           )
                        
                     . We find the functions giving the values in the interval 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      for 
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           
                              
                                 
                                    x
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                           (
                           x
                           ,
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           )
                        
                     , and 
                        
                           
                              
                                 T
                              
                              
                                 R
                              
                           
                           (
                           x
                           ,
                           
                              
                                 s
                              
                              
                                 R
                              
                              
                                 i
                              
                           
                           )
                        
                     , for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . This can be done in 
                        
                           O
                           (
                           n
                           )
                        
                      time by the same algorithm in Section 4.1. Denote by F the 
                        
                           O
                           (
                           n
                           )
                        
                      functions computed above. Hence, 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                        
                      is the x-coordinate of the lowest point 
                        
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                        
                      of the upper envelope of the functions in F. Note that every function of F defines a half-line that spans the interval 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                     . Hence, although each function of F is a half-line, 
                        
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                        
                      is also the lowest point of the upper envelope of the lines that contain the half-lines of F, and thus 
                        
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                        
                      can be computed in 
                        
                           O
                           (
                           n
                           )
                        
                      time by linear programming (Megiddo, 1983, 1984).

In this section, we present an 
                           
                              O
                              (
                              n
                              )
                           
                         time algorithm for computing 
                           
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              s
                              )
                           
                         for all 
                           
                              s
                              ∈
                              S
                           
                        , for any 
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                        . In other words, our goal is to compute the values 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        , for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        . We only discuss our algorithm for computing 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         since the algorithms for the other three cases are quite similar. Further, for each 
                           
                              1
                              ⩽
                              i
                              ⩽
                              n
                           
                        , the function 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         that gives the value 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         is also determined by the algorithm.

For any 
                           
                              1
                              ⩽
                              i
                              ⩽
                              j
                              ⩽
                              n
                           
                        , we define 
                           
                              α
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    i
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                           
                        . After 
                           
                              O
                              (
                              n
                              )
                           
                         time preprocessing, given any i and j with 
                           
                              1
                              ⩽
                              i
                              ⩽
                              j
                              ⩽
                              n
                           
                        , we can obtain the value 
                           
                              α
                              (
                              i
                              ,
                              j
                              )
                           
                         in constant time. We omit the preprocessing details and below we assume we have done the preprocessing. For convenience, we let 
                           
                              α
                              (
                              i
                              ,
                              j
                              )
                              =
                              0
                           
                         if 
                           
                              i
                              >
                              j
                           
                        .

Let 
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                         be any value with 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                        . We first determine the index i such that 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              <
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        . Thus, for any scenario s, only functions 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              s
                              )
                           
                         with 
                           
                              1
                              ⩽
                              t
                              ⩽
                              i
                              -
                              1
                           
                         are defined on 
                           
                              x
                              =
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                        , and any function 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              (
                              x
                              ,
                              s
                              )
                           
                         with 
                           
                              i
                              ⩽
                              t
                              ⩽
                              n
                           
                         does not define on 
                           
                              x
                              =
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                        . We compute the value 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       x
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        , which can be done in 
                           
                              O
                              (
                              n
                              )
                           
                         time, e.g., by computing 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         for each j with 
                           
                              1
                              ⩽
                              j
                              ⩽
                              i
                              -
                              1
                           
                        .

Let k be the index such that 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         is given by the function 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        , e.g., 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        . Hence, 
                           
                              k
                              ⩽
                              i
                              -
                              1
                           
                        . The following lemma will be useful later.
                           Lemma 6
                           
                              Consider a function 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    ,
                                    s
                                    )
                                 
                               
                              and a scenario 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              . If 
                              
                                 
                                    1
                                    ⩽
                                    t
                                    ,
                                    j
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              
                              , then 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    m
                                    )
                                 
                               
                              with 
                              
                                 
                                    m
                                    =
                                    min
                                    {
                                    t
                                    ,
                                    j
                                    }
                                 
                              
                              . This implies 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              if 
                              
                                 
                                    t
                                    ⩽
                                    j
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              
                              .
                           

Consider any t and j with 
                                 
                                    1
                                    ⩽
                                    t
                                    ,
                                    j
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . First of all, since 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              , and 
                                 
                                    j
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              , both functions 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             x
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             x
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               are defined on 
                                 
                                    x
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Comparing with the scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                              , the weight of each vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                 
                               for 
                                 
                                    2
                                    ⩽
                                    h
                                    ⩽
                                    j
                                 
                               increase by 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                       
                                          +
                                       
                                    
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                       
                                          -
                                       
                                    
                                 
                               in the scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              , and the weights of all other vertices are the same as before. According to their definitions, we obtain that 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    t
                                    )
                                 
                               if 
                                 
                                    t
                                    ⩽
                                    j
                                 
                              , and 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    j
                                    )
                                 
                               if 
                                 
                                    t
                                    ⩾
                                    j
                                 
                              . The lemma thus follows.□

With the value 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        , the following lemma shows how to compute 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              2
                              ⩽
                              j
                              ⩽
                              k
                           
                        .
                           Lemma 7
                           
                              If 
                              
                                 
                                    k
                                    ⩾
                                    2
                                 
                              
                              , for any scenario 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                               
                              with 
                              
                                 
                                    2
                                    ⩽
                                    j
                                    ⩽
                                    k
                                 
                              
                              , 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    j
                                    )
                                 
                              
                              .
                           

Assume 
                                 
                                    k
                                    ⩾
                                    2
                                 
                              . Consider any scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                               with 
                                 
                                    2
                                    ⩽
                                    j
                                    ⩽
                                    k
                                 
                              . We first prove a claim that 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               for any 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              .

Due to 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              , it holds that 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               for any 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . Consider any t with 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . By Lemma 6, we have 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    m
                                    )
                                 
                              , where 
                                 
                                    m
                                    =
                                    min
                                    {
                                    j
                                    ,
                                    t
                                    }
                                 
                              . Since 
                                 
                                    j
                                    ⩽
                                    k
                                 
                              , 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    j
                                    )
                                 
                               holds by Lemma 6. Clearly, 
                                 
                                    α
                                    (
                                    2
                                    ,
                                    j
                                    )
                                    ⩾
                                    α
                                    (
                                    2
                                    ,
                                    m
                                    )
                                    ⩾
                                    0
                                 
                               due to 
                                 
                                    m
                                    ⩽
                                    j
                                 
                              . Therefore, we obtain that 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              .

The above claim implies that 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              . Since 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    α
                                    (
                                    2
                                    ,
                                    j
                                    )
                                 
                               by Lemma 6 and 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              , the lemma follows.□

Suppose the value 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         has already been computed; the following lemma shows how to obtain 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              i
                              ⩽
                              j
                              ⩽
                              n
                           
                        .
                           Lemma 8
                           
                              For any scenario 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                               
                              with 
                              
                                 
                                    i
                                    ⩽
                                    j
                                    ⩽
                                    n
                                 
                              
                              , 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           

Recall that for any scenario s only the functions 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    ,
                                    s
                                    )
                                 
                               with 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                               are defined on 
                                 
                                    x
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Consider any scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                               with 
                                 
                                    i
                                    ⩽
                                    j
                                    ⩽
                                    n
                                 
                              . Comparing with 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                              , the weight of each vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          t
                                       
                                    
                                 
                               in 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                               increases by 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          t
                                       
                                       
                                          +
                                       
                                    
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          t
                                       
                                       
                                          -
                                       
                                    
                                 
                               for any 
                                 
                                    i
                                    ⩽
                                    t
                                    ⩽
                                    j
                                 
                              , and all other vertex weights do not change. Since the above vertex weight increase only affect the functions 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             x
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               for 
                                 
                                    t
                                    ⩾
                                    i
                                 
                               and none of these functions is defined on 
                                 
                                    x
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              , the value 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    s
                                    )
                                 
                               does not change for 
                                 
                                    s
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    s
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              . A more formal proof is given below.

Let 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                               be the index such that the value 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               is given by 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              , i.e., 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              . Note that 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . Hence, 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               for any 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . In the scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                 
                              , the weights of the vertices 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          t
                                       
                                    
                                 
                               for 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                               are the same as those in 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                              . Therefore, 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               for any 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . Thus, 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                               for any 
                                 
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . We obtain that 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              . Due to 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              , we have 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              .□

Based on the preceding two lemmas, we can easily compute 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              j
                              =
                              2
                              ,
                              …
                              ,
                              k
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time, and compute 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              j
                              =
                              i
                              ,
                              …
                              ,
                              n
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time provided that we know the value 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        .

It remains to compute 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              t
                              =
                              k
                              +
                              1
                              ,
                              …
                              ,
                              i
                              -
                              1
                           
                        , for which we present an 
                           
                              O
                              (
                              n
                              )
                           
                         time algorithm below. Note that our algorithm itself is simple (see the pseudocode Algorithm 1), but it is not easy to discover the observations behind the scene. Our algorithm will compute a solution index list 
                        
                           
                              K
                              =
                              {
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    d
                                 
                              
                              }
                           
                         with the following properties:
                           Property 1
                           
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    k
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ⩽
                                    ⋯
                                    ⩽
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              
                              .
                           


                              For any j with 
                              
                                 
                                    1
                                    ⩽
                                    j
                                    ⩽
                                    d
                                    -
                                    1
                                 
                              
                              , 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    <
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           


                              For any j with 
                              
                                 
                                    1
                                    ⩽
                                    j
                                    ⩽
                                    d
                                    -
                                    1
                                 
                              
                              , for any t with 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    t
                                    <
                                    
                                       
                                          k
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                              , either 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              or 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    <
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              . If 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    
                                    ≠
                                    
                                    i
                                    -
                                    1
                                 
                              
                              , then for any t with 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           

If we already have such a solution index list K, the lemma below provides a way to compute the values 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              k
                              +
                              1
                              ⩽
                              t
                              ⩽
                              i
                              -
                              1
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time.
                           Lemma 9
                           
                              For any scenario 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                 
                               
                              with 
                              
                                 
                                    k
                                    +
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              
                              , if 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    <
                                    t
                                    ⩽
                                    
                                       
                                          k
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                               
                              for some 
                              
                                 
                                    1
                                    ⩽
                                    j
                                    ⩽
                                    d
                                    -
                                    1
                                 
                              
                              , then 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    =
                                    max
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ; if 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    
                                    ≠
                                    
                                    i
                                    -
                                    1
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    <
                                    t
                                 
                              
                              , then 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           

Consider any scenario 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                 
                               with 
                                 
                                    k
                                    +
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . Recall that 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          1
                                          ⩽
                                          m
                                          ⩽
                                          i
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              . To simplify the notation, we use 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                               to represent 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              . Hence, 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          1
                                          ⩽
                                          m
                                          ⩽
                                          i
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              .

We assume 
                                 
                                    t
                                    ⩽
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                 
                               since the case 
                                 
                                    t
                                    >
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                 
                               can be proved in a much simpler way by the same techniques. Let j be the integer such that 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    <
                                    t
                                    ⩽
                                    
                                       
                                          k
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              . To prove the lemma, it is sufficient to show that 
                                 
                                    max
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    }
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                               for any m with 
                                 
                                    1
                                    ⩽
                                    m
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . To this end, there are three cases depending on the value of 
                                 
                                    m
                                    :
                                    1
                                    ⩽
                                    m
                                    <
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    m
                                    <
                                    
                                       
                                          k
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              , and 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ⩽
                                    m
                                    ⩽
                                    i
                                    -
                                    1
                                 
                              . Below, in each case, we will show that either 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                               or 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                               holds.

First of all, due to 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    <
                                    t
                                 
                               and by Lemma 6, the following holds
                                 
                                    (1)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                              
                                 
                                    1.
                                    If 
                                          
                                             1
                                             ⩽
                                             m
                                             <
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       , we assume 
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                
                                             
                                             ⩽
                                             m
                                             <
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                   +
                                                   1
                                                
                                             
                                          
                                        for some 
                                          
                                             h
                                             <
                                             j
                                          
                                       . Note that 
                                          
                                             m
                                             <
                                             t
                                          
                                        holds in this case. See Fig. 5
                                       . By Lemma 6, we have 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   L
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                       . By Property 3 of the solution index list K, we have either 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                        or 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             <
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       .
                                          
                                             (a)
                                             If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                , then by Property 2 of K, since 
                                                   
                                                      h
                                                      <
                                                      j
                                                   
                                                , we can obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      <
                                                      ⋯
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                . Thus, we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                . Since 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                 by Eq. (1), we obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                .

If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                , then since 
                                                   
                                                      m
                                                      <
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                , we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      m
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      m
                                                      )
                                                   
                                                , and thus 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                . Note that 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                . Further, due to 
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                            +
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                 holds by Property 2 of K. Recall that 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                . Hence, we obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                 by Eq. (1).

If 
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                             ⩽
                                             m
                                             <
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                       , then by Property 3 of K, either 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                        or 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             <
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       .
                                          
                                             (a)
                                             If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                , then since 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                 always holds by Lemma 6 regardless of whether 
                                                   
                                                      m
                                                      ⩽
                                                      t
                                                   
                                                 or 
                                                   
                                                      m
                                                      >
                                                      t
                                                   
                                                , we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                 by Eq. (1).

If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                , then since 
                                                   
                                                      t
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                , we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                 by Lemma 6. Also, 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      min
                                                      {
                                                      t
                                                      ,
                                                      m
                                                      }
                                                      )
                                                   
                                                . Since 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      min
                                                      {
                                                      t
                                                      ,
                                                      m
                                                      }
                                                      )
                                                      ⩽
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                , we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                .

If 
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ⩽
                                             m
                                             ⩽
                                             i
                                             -
                                             1
                                          
                                       , for simplicity of discussion, we assume 
                                          
                                             m
                                             <
                                             
                                                
                                                   k
                                                
                                                
                                                   d
                                                
                                             
                                          
                                        and the case 
                                          
                                             m
                                             ⩾
                                             
                                                
                                                   k
                                                
                                                
                                                   d
                                                
                                             
                                          
                                        can be proved very similarly but in a much simpler way. Let 
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                
                                             
                                             ⩽
                                             m
                                             <
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                   +
                                                   1
                                                
                                             
                                          
                                        for some 
                                          
                                             h
                                             >
                                             j
                                          
                                       . Note that 
                                          
                                             t
                                             ⩽
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ⩽
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                
                                             
                                             ⩽
                                             m
                                          
                                       . See Fig. 6
                                       .

First of all, we claim that 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       . We prove the claim below.

Indeed, by Lemma 6, we can obtain 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             +
                                             α
                                             (
                                             t
                                             +
                                             1
                                             ,
                                             m
                                             )
                                          
                                        and 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             +
                                             α
                                             (
                                             t
                                             +
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       . According to Property 3 of K, either 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                        or 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             <
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       .
                                          
                                             (a)
                                             If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                , then since 
                                                   
                                                      α
                                                      (
                                                      t
                                                      +
                                                      1
                                                      ,
                                                      m
                                                      )
                                                      ⩾
                                                      α
                                                      (
                                                      t
                                                      +
                                                      1
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      )
                                                   
                                                 (due to 
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      ⩽
                                                      m
                                                   
                                                ), we obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                .

If 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                , then by Property 2 of K, 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                . Thus, we obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                . Due to 
                                                   
                                                      t
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      ⩽
                                                      m
                                                   
                                                , we have 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                . Hence, 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                 holds.

Therefore, the claim 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                        is proved.
                                          
                                             (a)
                                             If 
                                                   
                                                      j
                                                      +
                                                      1
                                                      =
                                                      h
                                                   
                                                , the above proves 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                .

If 
                                                   
                                                      j
                                                      +
                                                      1
                                                      <
                                                      h
                                                   
                                                , we claim that 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                . Indeed, since 
                                                   
                                                      t
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                 in this case, by Lemma 6, 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                . By Property 2 of 
                                                   
                                                      K
                                                      ,
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                . Therefore, 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                 and the claim is proved. Since 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                , we obtain 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                .

In any case above, we have shown that 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ⩽
                                    max
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    }
                                 
                               holds. The lemma thus follows.□

Suppose we have a solution index list K. After we compute the values 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              d
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time, by Lemma 9 we can compute the values 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         for all 
                           
                              k
                              +
                              1
                              ⩽
                              t
                              ⩽
                              i
                              -
                              1
                           
                         in 
                           
                              O
                              (
                              n
                              )
                           
                         time (with the help of Lemma 6).

It remains to compute the solution index list K, for which we present a simple linear time algorithm as follows. We assume the values 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              i
                              -
                              1
                           
                         have been computed in 
                           
                              O
                              (
                              n
                              )
                           
                         time.

Our algorithm will consider the indices incrementally from 
                           
                              t
                              =
                              k
                              +
                              1
                           
                         to 
                           
                              t
                              =
                              i
                              -
                              1
                           
                        . A stack A is maintained during the algorithm to store a sequence of indices. Initially A contains only one index k, and after the algorithm finishes the index list in A from bottom to top is exactly K. Algorithm 1 summarizes the pseudocode. For each t with 
                           
                              k
                              +
                              1
                              ⩽
                              t
                              ⩽
                              i
                              -
                              1
                           
                        , the algorithm proceeds as follows. Let 
                           
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                           
                         be the index on the top of the current stack A. We first compare the two values 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        . Note that both values have been computed. If 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              >
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        , then we pop 
                           
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                           
                         out of A and consider the next top index on A (this is consistent with Property 3 of K and we ignore the detailed discussion on this). We claim that the stack A will never be empty because the index k is at the bottom of A. Indeed, recall that 
                           
                              
                                 
                                    T
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         by the definition of k. Hence, 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ⩾
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         for any 
                           
                              1
                              ⩽
                              m
                              ⩽
                              i
                              -
                              1
                           
                        , and in particular, 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        . Therefore, k will never be popped out of A. If 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        , we further compare the two values 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . By Lemma 6, 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              +
                              α
                              (
                              2
                              ,
                              t
                              )
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              +
                              α
                              (
                              2
                              ,
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . Hence, both 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         can be computed in constant time. If 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              >
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             L
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , then we push t on the top of A and set 
                           
                              
                                 
                                    k
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              =
                              t
                           
                         (this is consistent with Property 2 of K); otherwise, we ignore t (this is consistent with Property 3 of K) and proceed on 
                           
                              t
                              +
                              1
                           
                        . After 
                           
                              t
                              =
                              i
                              -
                              1
                           
                         is considered, we terminate the algorithm and the index list in the stack A is our solution index list K. The running time of the algorithm is 
                           
                              O
                              (
                              n
                              )
                           
                         because once an index is popped out of A it will never be considered again.
                           Algorithm 1
                           Computing the solution index list 
                                 
                                    K
                                    =
                                    {
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: The index k, the value 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                , the scenario 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                , the weight intervals 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: The solution index list 
                                                   
                                                      K
                                                      =
                                                      {
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                          
                                          
                                             
                                                
                                                1 do preprocessing for answering 
                                                   
                                                      α
                                                      (
                                                      ·
                                                      ,
                                                      ·
                                                      )
                                                   
                                                 queries;
                                          
                                          
                                             
                                                
                                                2 for 
                                                
                                                   
                                                      t
                                                      ←
                                                      1
                                                   
                                                 
                                                to 
                                                
                                                   
                                                      i
                                                      -
                                                      1
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                3 
                                                determine the function 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                 and compute the value 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                
                                                4 end
                                             
                                          
                                          
                                             
                                                
                                                5 initialize a stack A and push k into A;
                                          
                                          
                                             
                                                
                                                6 for 
                                                
                                                   
                                                      t
                                                      ←
                                                      k
                                                      +
                                                      1
                                                   
                                                 
                                                to 
                                                
                                                   
                                                      i
                                                      -
                                                      1
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                7 
                                                
                                                
                                                   
                                                      m
                                                      ←
                                                      the top index in
                                                   
                                                
                                                
                                                A;
                                          
                                          
                                             
                                                
                                                8 
                                                
                                                while 
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                9 
                                                pop m out of A;
                                          
                                          
                                             
                                                10 
                                                
                                                
                                                   
                                                      m
                                                      ←
                                                      the top index in
                                                   
                                                
                                                
                                                A;
                                          
                                          
                                             
                                                11 
                                                
                                                end
                                             
                                          
                                          
                                             
                                                12 
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      t
                                                      )
                                                   
                                                ;
                                          
                                          
                                             
                                                13 
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      α
                                                      (
                                                      2
                                                      ,
                                                      m
                                                      )
                                                   
                                                ;
                                          
                                          
                                             
                                                14 
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            L
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                15 
                                                push t on the top of A;
                                          
                                          
                                             
                                                16 
                                                
                                                end
                                             
                                          
                                          
                                             
                                                17 end
                                             
                                          
                                          
                                             
                                                18 return the index list in A from bottom to top as K;
                                          
                                       
                                    
                                 
                              
                           

We conclude this section with the following theorem.
                           Theorem 2
                           
                              The optimal position 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               
                              for the minmax regret problem and the optimal maximum regret 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          max
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               
                              can be computed in 
                              
                                 
                                    O
                                    (
                                    n
                                    log
                                    n
                                    )
                                 
                               
                              time and 
                              
                                 
                                    O
                                    (
                                    n
                                    )
                                 
                               
                              space.
                           

In this paper, we presented an 
                        
                           O
                           (
                           n
                           log
                           n
                           )
                        
                      time and 
                        
                           O
                           (
                           n
                           )
                        
                      space algorithm for the minmax regret 1-facility location problem on uncertain path networks. Very recently some other problem variations have been introduced and algorithms for them have been proposed. Li, Xu, and Ni (2014) studied the problem for finding two facilities and gave an 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           log
                           n
                           )
                        
                      time algorithm. Ni, Xu, and Dong (2014) developed an 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 1
                                 +
                                 k
                              
                           
                           
                              
                                 log
                              
                              
                                 1
                                 +
                                 log
                                 k
                              
                           
                           n
                           )
                        
                      time algorithm for finding k facilities for a general value of k, and Arumugam, Augustine, Golin, and Srikanthan (2014) gave two algorithms for the same problem with time complexities 
                        
                           O
                           (
                           
                              
                                 kn
                              
                              
                                 2
                              
                           
                           
                              
                                 log
                              
                              
                                 k
                              
                           
                           n
                           )
                        
                      and 
                        
                           O
                           (
                           
                              
                                 kn
                              
                              
                                 3
                              
                           
                           log
                           n
                           )
                        
                     , respectively. Higashikawa, Golin, and Katoh (2014) investigated the problem for finding a 1-facility on a tree network and proposed an 
                        
                           O
                           (
                           n
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           n
                           )
                        
                      time algorithm. It would be interesting to see whether the techniques presented in this paper can be used for solving these problem variations.

@&#ACKNOWLEDGMENT@&#

The author wishes to thank the anonymous referees for their helpful comments leading to the improvement of the paper. This work was supported in part by NSF under Grant CCF-1317143.

@&#REFERENCES@&#

