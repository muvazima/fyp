@&#MAIN-TITLE@&#Reversible data hiding in medical images with enhanced contrast in texture area

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Explain the reason for PSNR metric can't consistent with human visual system.


                        
                        
                           
                           Embed the message into texture area preferentially for helping accurate diagnosis.


                        
                        
                           
                           Propose message sparse representation method for decreasing embedding distortion.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Medical images

Privacy protection

Reversible data hiding

Local contrast enhancement

Message sparse representation

@&#ABSTRACT@&#


               
               
                  In order to realize the patient privacy protection in medical image, opposite to traditional reversible data hiding (RDH) methods which prior to embed message into the smooth area for pursuing high PSNR value, the proposed method priors to embed message into the texture area of the medical images for improving the quality of the details information and helping accurate diagnosis. Furthermore, in order to decrease the embedding distortion while enhancing the contrast of the texture area, this paper also proposes a message sparse representation method. Experiments implemented on medical images showed that the proposed method enhances the contrast of texture area when compared with previous methods.
               
            

@&#INTRODUCTION@&#

Reversible data hiding (RDH) is one kind of information hiding techniques with the characteristics such that not only the secret message needs to be precisely extracted, but also the cover image itself should be restored lossless [1–5]. This reversibility is important in some special scenarios such as medical imagery [6,7], military imagery and law forensics. In these applications, the cover is too precious or too important to be damaged.

Most of the state-of-the-art RDH methods are aim to providing a good performance in higher data embedding capacity and lower the distortion of the marked image [8]. Based on this purpose, many RDH methods on images have been proposed. All these methods are realized through a process of semantic lossless compression [1,9], in which some space is saved for embedding extra data by lossless compressing the image. This compressed image should be “close” to the original image, so one can get a marked image with good visual quality. The residual part of images, e.g., the prediction errors (PE), has small entropy and thus can be easily compressed. Therefore, almost all recent RDH methods first generate PEs as the host sequence [10–15], and then reversibly embed the message into the host sequence by modifying its histogram with methods like histogram shifting (HS) [16,17] or difference expansion (DE) [18]. Usually the prediction errors histogram (PEH) has a sharp distribution centered at zero. Another typical technique to get a good host sequence for RDH is sorting [11,19,20] or pixel selection [15], which gives priority of modifications to PEs in smooth regions. Because the pixels in smooth areas can be accurately predicted, so a sharper histogram can be obtained in such areas. In a word, the existing RDH methods used two techniques for pursuing high PSNR value, one is give priority of modifications to PEs in smooth regions, the other one is sort pixels based on smooth degree.

In most literatures on RDH, the quality of the marked image is assessed by peak signal-to-noise ratio (PSNR), with which a modification in smooth region is equally risk as a modification in noisy region. Hence, most state-of-the-art RDH schemes prefer to embed data into smooth area, which corresponded to middle region of PEH for pursuing high PSNR value. However, PSNR only depends on the quadratic sum of difference between original image and distortion image and had proved inconsistent with human visual perception in image quality assessment research [21]. Recently, instead of pursuing high PSNR value, Wu et al. [22] and Gao et al. [23] proposed reversible image data hiding with contrast enhancement, they all improved image visual quality through enhancing contrast of cover image. Wu et al.'s method applied HS scheme to select two highest bins of image histogram for data hiding and repeated this process until embedded all secret data, which in essence is a histogram equalization scheme for contrast enhancement. However, it enhances contrast in the global spatial domain but cannot restore the details of the image. In some applications, we need enhance the contrast of local area, such as in medical image enhancement. Gao et al.'s method embedded the data into spatial domain and IWT domain respectively, in which embedding procedure in spatial domain is same with Wu et al.'s method by adding the controlled threshold denoted by 
                        
                           
                              T
                           
                           
                              rce
                           
                        
                        =
                        0.55
                      and then embedded the other data into the detail subbands. However, due to the most of medical images includes a lot of smooth area, so the results in Gao et al.'s method are same as Wu et al.'s method for 
                        
                           
                              T
                           
                           
                              rce
                           
                        
                      less than 0.55.

In addition, in order to avoid hackers or attackers duplicated or revised medical information through the internet and to keep the medical image quality for accurate diagnosis, reversible data hiding plays an important role in medical images. As lot literatures shown, most of the RDH in medical images are all aim to achieving high capacity and pursuing high PSNR value, which less considered the characteristics of the medical images. Due to existing large smooth regions in medical images, Osamah et al. [24] divided medical image into smooth region and non-smooth region and applied a high embedding capacity scheme for the smooth region while applied traditional DE method for the non-smooth region. Similarity, Pai et al. [25] proposed an “region of interest” (ROI) based image hiding method which embeds secret data into non-ROI by an irreversible image hiding method and in ROIs by a reversible image hiding method. For some special medical image, Bao et al. [6] proposed tailored reversible data hiding schemes for the electronic clinical atlas by exploiting its inherent characteristics, and Huang et al. [26] proposed a histogram shifting method for image reversible data hiding for high bit depth (16 bit) medical images.

For medical image processing, many literatures have pointed out that the change places and profiles are the interesting area in the medical image [27], namely, restoring the details information can improve image quality and help for accurate diagnosis. Motivated by this idea, this paper aims to enhancing contrast of texture area while embedding data reversibly. Based on this goal, opposite to traditional RDH methods, the proposed method use two techniques for improving image visual quality. One is give priority of modifications to PEs in texture regions by reversibly embedding data into two side bins of the PEH, the other one is sort pixels in a descending order based on texture degree. In addition, this paper also proposed a message sparse representation method which inspirits from the decompression idea, to code the message for decreasing the embedding distortion. This work makes two contributions: (1) Propose a message sparse representation method to code the message for improving hiding efficiency; (2) Propose a novel RDH scheme in medical images that not only can embed data reversibly but also can improve the details information of texture area in subjective perception.

This paper is organized as follows. Section 2 analyzes traditional image quality assess metric PSNR. In section 3, we elaborate the RDH scheme with enhanced contrast of texture area. The performance of the proposed method is evaluated and compared with the other methods in Section 4, and conclusion is finally presented in Section 5.

Peak signal-to-noise ratio (PSNR) is a traditional standard in image quality assessment (IQA). It assesses the quality of distortion image through calculating the pixel difference of the original image and distortion image, such as
                        
                           (1)
                           
                              
                                 
                                    PSNR
                                 
                                 =
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             max
                                          
                                          
                                             2
                                          
                                       
                                       ×
                                       M
                                       ×
                                       N
                                    
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   L
                                                
                                                
                                                   in
                                                
                                             
                                             
                                                (
                                                m
                                                ,
                                                n
                                                )
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   out
                                                
                                             
                                             
                                                (
                                                m
                                                ,
                                                n
                                                )
                                             
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              L
                           
                           
                              in
                           
                        
                      is the intensity of original image; 
                        
                           
                              L
                           
                           
                              out
                           
                        
                      is the intensity of distortion image; 
                        
                           
                              L
                           
                           
                              max
                           
                        
                      is the maximum possible pixel intensity of the image, normally 
                        
                           
                              L
                           
                           
                              max
                           
                        
                        =
                        255
                     .

As mentioned in Section 1, PSNR is often utilized as assessing metric in RDH method. However, it can't consistent with human visual system that has been proved in the research area of IQA [21]. An example is shown in Fig. 1
                     , which includes one original image and three distortion images, three distortion images are added with original image's similarity information, spatial information and frequency information respectively based on original image [21]. The subjective visual perceptions of three distortion images are good, bad and neutral respectively. However, their PSNR values are almost same. The reason is PSNR only calculates the pixel difference between two images, and it lacks considering the structure information between neighbor pixels.

@&#PROPOSED METHOD@&#

As we know, subjective perception is the final standard for assessing image quality. In addition, image processing research had indicated that contrast enhancement is one of method for improving image quality, in which histogram stretching and histogram equalization are the two most common methods. In the present paper, we propose a RDH method in medical images with texture area enhancement based on the idea of histogram stretching. The proposed method consists of four parts: 1) rhombus prediction and texture-based sorting; 2) embedding scheme and enhancing contrast of texture area; 3) message sparse representation; 4) message extraction and cover image recovery.

As mentioned in Section 1, many prediction methods have been applied to RDH. In order to sort the pixel according to the texture, this paper uses rhombus prediction pattern [11] to generate PEs, which divides all pixels of the cover image into two sets denoted as “Cross” and “Dot” as shown in Fig. 2
                        . Two sets in rhombus prediction pattern are independent of each other, so it is a twice-layered embedding scheme. In the first layer, we use the pixels of “Dot” set to predict the pixels of “Cross” set, and then embed data into the PEs; in the second layer, we predict the “Dot” set with the modified “Cross” set and embed data into the PEs. Since the two layers' embedding processes are similar, we only take the Cross layer for illustration. The prediction value 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is computed using its four nearest Dot pixels 
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                                 ,
                                 j
                              
                           
                           )
                         as
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       ⌊
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                          
                                          4
                                       
                                       ⌋
                                    
                                    .
                                 
                              
                           
                         Based on the prediction value 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and original value 
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , the PEs 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is computed as
                           
                              (3)
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Opposite to most state-of-the-art RDH methods which usually embed data into smooth area for pursuing high PSNR values, we aim to improving details information of texture area in subjective visual perception. Hence, we prior to embed data into two side PEH bins which correspond to texture area. We utilize a parameter to estimate the texture degree of each pixel, regarded as local variance (LV). The LV for pixel 
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         can be computed from the neighboring pixels 
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                                 ,
                                 j
                              
                           
                           )
                         such that
                           
                              (4)
                              
                                 
                                    
                                       LV
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       4
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       4
                                    
                                    
                                       
                                          (
                                          Δ
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          Δ
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           Δ
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           =
                           |
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 −
                                 1
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                                 ,
                                 j
                              
                           
                           |
                        , 
                           Δ
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           =
                           |
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                                 ,
                                 j
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           |
                        , 
                           Δ
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           =
                           |
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           |
                        , 
                           Δ
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                           =
                           |
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                                 −
                                 1
                              
                           
                           |
                         and 
                           Δ
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 k
                              
                           
                           =
                           (
                           Δ
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           +
                           Δ
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           +
                           Δ
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           +
                           Δ
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                           )
                           /
                           4
                        . Here, smaller LV value means the smoother area and vice versa. The state-of-the-art RDH schemes sorted pixels in ascending order of LV values for achieving high PSNR, but proposed method sorts pixels in descending order of LV values for improving visual quality.

In general, PEH can reflect the smooth and texture area of the image, in which smooth and texture area correspond to the middle and two side bins of the PEH respectively. Hence, we prior to select bins at two sides of the PEH for accommodate data by histogram shifting (HS) [17] and thus enhance the contrast of texture area. There are two key points for selecting bins: the location of bins must be close to two sides, and the capacity of bins must enough to hide all the message bits. The embedding procedure is summarized as five steps as follows.

1) Calculate the PEH. Prediction value 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         are obtained by using Eq. (2), PE is Calculated by using Eq. (3), and PEH is generated by enumerating the numbers of PEs. Denote the number of PE equal to ‘E’ as 
                           
                              hist
                           
                           (
                           E
                           )
                        , which is just the height of the bin ‘E’.

2) Select the initial bins. We select the bin 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                         that has the smallest absolute as the initial bin, such that
                           
                              (5)
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    min
                                    ⁡
                                    (
                                    |
                                    min
                                    ⁡
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                    |
                                    ,
                                    max
                                    ⁡
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                           
                        
                     

3) Select the last bins. The last bins 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                         is adaptively selected according to the length of the message such that
                           
                              (6)
                              
                                 
                                    
                                       
                                          minimize
                                          
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                p
                                             
                                          
                                          ∈
                                          (
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          subject to
                                          
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                E
                                                =
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          (
                                          E
                                          )
                                          +
                                          
                                             ∑
                                             
                                                E
                                                =
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          (
                                          E
                                          )
                                          )
                                          >
                                          L
                                       
                                    
                                 
                              
                           
                         where L is the number of bits to be embedded. Note that we set 
                           
                              hist
                           
                           (
                           E
                           )
                           =
                           0
                         if E does not appear.

4) Embed all data into selected bins. All selected bins 
                           ±
                           E
                           ∈
                           
                              [
                              ±
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              ,
                              ±
                              
                                 
                                    T
                                 
                                 
                                    m
                                 
                              
                              ]
                           
                         are vacated and employed for data hiding in descending order of 
                           L
                           V
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        , in which PEs belonging to 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           >
                           E
                         (or 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           <
                           −
                           E
                        ) are shifted to right (or left) by a shifting distance s, then data are embedded into the bin ±E with keeping other bins unchanged as follows:
                           
                              (7)
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                s
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                >
                                                E
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                s
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                <
                                                −
                                                E
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                d
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                E
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                d
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                −
                                                E
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                             
                                             
                                                Otherwise
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where s is shifting distance (equal to 1 or 2), 
                           
                              
                                 D
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is the modified PEs, and d is the message bit (equal to 0 or 1).

5) Calculate marked image 
                           
                              
                                 U
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         as 
                           
                              
                                 U
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 D
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        .

In order to demonstrate the embedding processing, an example is given in Fig. 3
                        . Assume that there are 160 bits to be hidden, and the probability of bit ‘1’ or ‘0’ are all 1/2 because the message usually is encrypted before being embedded. We set the shifting distance as 1. Firstly, PEH is generated according to Eqs. (2)–(3) as shown in Fig. 3(a); Secondly, the initial and last bins 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           =
                           6
                        , 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                           =
                           5
                         are obtained according to Eqs. (5)–(6); Thirdly, 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           7
                         are vacated so that 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           6
                         bins can be employed for data hiding as shown in Fig. 3(b); Fourthly, 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           6
                         bins are shifted by one or zero when hiding data d is ‘1’ or '0' as shown in Fig. 3(c); Lastly, the progress is repeated for 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           5
                         bins, 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           6
                         are vacated and the other data are embedded by shifting 
                           
                              
                                 PE
                              
                              
                                 s
                              
                           
                           =
                           ±
                           5
                         bins by one or zero as shown in Figs. 3(d) and (e). Fig. 3(f) shows modified PEH after shifting two rounds, in which maximum shifting times is 
                           
                              
                                 f
                              
                              
                                 max
                              
                           
                           =
                           2
                        . Thus data are hidden and selected bins are stretched and equalized simultaneously.

As previous RDH schemes, the overflow/underflow problem of the histogram shifting method should be taken into account. Here, we define location map like this: if original pixel value is 0/255, we label it with ‘0’; if one pixel is modified to 0/255, we label it with ‘1’ and we use 4 bits to record the number of shifting rounds. The location map is compressed and its size denoted as 
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                        . In addition, in order to extract data and recover cover image conveniently, the proposed method replaces LSB of the first 
                           55
                           +
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         pixels by the following auxiliary information: selected initialization bin 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                         and last bin 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                        , the maximum number of shifting rounds 
                           
                              
                                 f
                              
                              
                                 max
                              
                           
                        , the shifting distance s, payload size of the original message that be embedded, size of compressed location map 
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         and compressed location map. The LSB of the first 
                           55
                           +
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         pixels 
                           
                              
                                 S
                              
                              
                                 LSB
                              
                           
                         is also embedded as one part of the payload.

The RDH scheme with enhanced contrast of texture area method described in section 3.2 aims to embedding data reversibly while restoring the details information of the texture area. In order to both enhance contrast of texture area and decrease the embedding distortion (ED), we propose a message sparse representation method in this section. The message sparse representation will reduces the ED by preprocessing the secret message, in which it decreases the number of ‘1’s and increases the number of ‘0’s in the message.

In general, when L-length binary message 
                           m
                           =
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    m
                                 
                                 
                                    L
                                 
                              
                              )
                           
                         are reversibly embedded into binary cover 
                           x
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              )
                           
                         and marked cover are regarded as 
                           y
                           =
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                         with d modifications on average, then embedding rate is defined as 
                           R
                           =
                           L
                           /
                           N
                         and the change rate is defined as 
                           Δ
                           =
                           d
                           /
                           N
                         
                        [28]. Furthermore, we define the embedding efficiency as 
                           
                              ee
                           
                           =
                           R
                           /
                           Δ
                        , which means the average number of embedded bits in unit distortion. In general, we hope to achieve high embedding efficiency for various given embedding rates, so when embedding rate R is fixed, change rate Δ is smaller, embedding efficiency is higher. In the proposed PHE method, only bit ‘1’ in message causes the change of pixel value while bit ‘0’ dose not introduce any change. Hence, change rate Δ determined by the probability of bits ‘1”s that embedded into covers. Without loss of generality, the change rate belongs to 
                           0
                           ≤
                           Δ
                           ≤
                           1
                           /
                           2
                        .

Now we analyze the influence of Δ on the embedding distortion (ED) of the proposed method. Assume we embed messages into three bins 
                           (
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           −
                           1
                           ,
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           −
                           2
                           )
                         by 3 rounds. The ED in the ith round is labeled as 
                           
                              ED
                           
                           (
                           i
                           )
                         for 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , and then we have
                           
                              
                                 
                                    
                                       
                                          
                                             ED
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          ×
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ED
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          ×
                                          
                                             
                                                (
                                                1
                                                +
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             (
                                             1
                                             −
                                             Δ
                                             )
                                          
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                       
                                          ×
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          1
                                          )
                                          ×
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ED
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          ×
                                          
                                             
                                                (
                                                1
                                                +
                                                2
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             (
                                             1
                                             −
                                             Δ
                                             )
                                          
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                       
                                          ×
                                          
                                             
                                                (
                                                2
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          1
                                          )
                                          ×
                                          
                                             
                                                (
                                                1
                                                +
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             (
                                             1
                                             −
                                             Δ
                                             )
                                          
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          1
                                          )
                                          ×
                                          
                                             
                                                (
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Δ
                                          ⋅
                                          
                                             hist
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          2
                                          )
                                          ×
                                          1
                                       
                                    
                                 
                              
                           
                         where s is shifting distance. In general, the ED caused by embedding messages into positive bins belonging to 
                           [
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                           ]
                         can be formulated as
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             ED
                                          
                                          
                                             (
                                             P
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          Δ
                                          ⋅
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          ×
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   (
                                                   i
                                                   −
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   )
                                                
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             (
                                             1
                                             −
                                             Δ
                                             )
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          ×
                                          
                                             
                                                (
                                                
                                                   (
                                                   i
                                                   −
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   )
                                                
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that the selected bins in the proposed method include positive bins and negative bins. Then, the ED in negative bins belonging to 
                           [
                           −
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           ,
                           −
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                           ]
                         also can be formulated as
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             ED
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          Δ
                                          ⋅
                                          
                                             ∑
                                             
                                                i
                                                =
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          ×
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   (
                                                   
                                                      |
                                                      i
                                                      |
                                                   
                                                   −
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   )
                                                
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             (
                                             1
                                             −
                                             Δ
                                             )
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             hist
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          ×
                                          
                                             
                                                (
                                                
                                                   (
                                                   
                                                      |
                                                      i
                                                      |
                                                   
                                                   −
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   )
                                                
                                                s
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, the total ED in selected bins of the PEH 
                           [
                           ±
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           ,
                           ±
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                           ]
                         in terms of 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                           −
                           
                              error
                           
                         can be formulated as
                           
                              (10)
                              
                                 
                                    
                                       ED
                                    
                                    =
                                    
                                       ED
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                    +
                                    
                                       ED
                                    
                                    
                                       (
                                       N
                                       )
                                    
                                 
                              
                           
                        
                     

Here, we use section 3.2's example to explain the relationship between change rate Δ and ED in the proposed method. As shown as Fig. 4
                        , with the increase of the Δ, the ED is increased accordingly. Hence, we can decrease the ED by decreasing the Δ. As mentioned before, the distortion in RDH mainly caused by the ‘1’ in message. In general, original message are encrypted before embedded into covers, namely, it is a pseudo random sequence, so the probabilities of ‘1’ or ‘0’ in message are all 1/2, so we can decrease the ED by decreasing the probability of ‘1’s in secret message before embedding it into cover image. Inspirit from the decomposition idea, this paper proposes a message sparse representation method to reduce the number of ‘1’s, which will leads extension of the original message. Hence, it needs more covers to accommodate the message. We define sparse rate as
                           
                              (11)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    L
                                    /
                                    
                                       CL
                                    
                                    ,
                                 
                              
                           
                         where L is the length of the original message, CL is the length of the sparse representation message. In order to avoid using extra bins of PEH, we set CL equal to the cover length of the selected bins, such as
                           
                              (12)
                              
                                 
                                    
                                       CL
                                    
                                    =
                                    
                                       ∑
                                       
                                          E
                                          =
                                          −
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          −
                                          
                                             
                                                T
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       hist
                                    
                                    (
                                    E
                                    )
                                    +
                                    
                                       ∑
                                       
                                          E
                                          =
                                          
                                             
                                                T
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       hist
                                    
                                    (
                                    E
                                    )
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                         is the initialization selected bin and the 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                         is the last selected bin.

The proposed sparse representation consists of two layers: one is outer layer which is only code one bit, the other is inner layer which is depends on coded bit in the outer layer, when coded bit ‘1’ in the outer layer, coded another k bits with reverse zero-run length (RZL); otherwise skip 
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                         zeros. Assume there is a CL-length all-zero cover sequence 
                           x
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    x
                                 
                                 
                                    CL
                                 
                              
                              )
                           
                         and to be coded message sequence 
                           m
                           =
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    m
                                 
                                 
                                    L
                                 
                              
                              ⋯
                              )
                           
                        , and then there are two pointers P1 and P2 are defined in coding process, P1 is used to label the last cover symbol that has been coded and P2 is used to count the number of message bits that has been coded. The following coding construction is an rate-variable coding method, in which the sparse rate is determined by a parameter k, in general 
                           k
                           ≥
                           0
                        . First set 
                           P
                           1
                           =
                           0
                         and 
                           P
                           2
                           =
                           0
                        . The encoder reads the message bit 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                        , and there are two coding cases according to the value of 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                        .


                        Case 1. If 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                           =
                           0
                        , set 
                           P
                           1
                           =
                           P
                           1
                           +
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                        , 
                           P
                           2
                           =
                           P
                           2
                           +
                           1
                         and one bit 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                         is coded. In this case, no cover symbol is modified.


                        Case 2. If 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                           =
                           1
                        , read the next k bits 
                           (
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 2
                              
                           
                           ,
                           ⋯
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 k
                                 +
                                 1
                              
                           
                           )
                        , which can be represented by a decimal integer belonging to 
                           [
                           0
                           ,
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           −
                           1
                           ]
                        , denoted by 
                           
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       2
                                    
                                 
                                 ,
                                 ⋯
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                              
                              
                                 int
                              
                           
                        . Set 
                           P
                           1
                           =
                           P
                           1
                           +
                           
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       2
                                    
                                 
                                 ,
                                 ⋯
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                              
                              
                                 int
                              
                           
                           +
                           1
                           ,
                           P
                           2
                           =
                           P
                           2
                           +
                           k
                           +
                           1
                        , and flip 
                           
                              
                                 x
                              
                              
                                 P
                                 1
                              
                           
                         from ‘0’ to ‘1’. Thus, 
                           k
                           +
                           1
                         bits 
                           (
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 2
                              
                           
                           ,
                           ⋯
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 k
                                 +
                                 1
                              
                           
                           )
                         are coded, and only one cover symbol 
                           
                              
                                 x
                              
                              
                                 P
                                 1
                              
                           
                         is modified.

Now we use a simple example to show the sparse representation process of the method above. Example: Take the parameter 
                           k
                           =
                           2
                        . Assume the cover length of the selected bins is a 9-length all-zero cover, i.e. 
                           
                              CL
                           
                           =
                           9
                        , and the message consists of 7 bits, i.e. 
                           L
                           =
                           7
                        , 
                           m
                           =
                           [
                           0
                           ,
                           1
                           ,
                           0
                           ,
                           1
                           ,
                           1
                           ,
                           1
                           ,
                           0
                           ]
                        . To sparse represent the message, first set pointers 
                           P
                           1
                           =
                           0
                         and 
                           P
                           2
                           =
                           0
                        , and then do the following three steps.
                           
                              1.
                              Read 
                                    
                                       
                                          m
                                       
                                       
                                          P
                                          2
                                          +
                                          1
                                       
                                    
                                    =
                                    0
                                 , thus set 
                                    P
                                    1
                                    =
                                    P
                                    1
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    4
                                 , and 
                                    P
                                    2
                                    =
                                    P
                                    2
                                    +
                                    1
                                    =
                                    1
                                 .

Read 
                                    
                                       
                                          m
                                       
                                       
                                          P
                                          2
                                          +
                                          1
                                       
                                    
                                    =
                                    1
                                 . Read the next 
                                    k
                                    =
                                    2
                                  message bits 
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    =
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 , which is interpreted as a decimal integer 
                                    
                                       
                                          (
                                          0
                                          ,
                                          1
                                          )
                                       
                                       
                                          int
                                       
                                    
                                    =
                                    1
                                 . Set 
                                    P
                                    1
                                    =
                                    P
                                    1
                                    +
                                    
                                       
                                          (
                                          0
                                          ,
                                          1
                                          )
                                       
                                       
                                          int
                                       
                                    
                                    +
                                    1
                                    =
                                    6
                                 , 
                                    P
                                    2
                                    =
                                    P
                                    2
                                    +
                                    k
                                    +
                                    1
                                    =
                                    4
                                 , and flip 
                                    
                                       
                                          x
                                       
                                       
                                          P
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          6
                                       
                                    
                                  to “1”.

Read 
                                    
                                       
                                          m
                                       
                                       
                                          P
                                          2
                                          +
                                          1
                                       
                                    
                                    =
                                    1
                                 . Read the next 
                                    k
                                    =
                                    2
                                  message bits 
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          7
                                       
                                    
                                    )
                                    =
                                    (
                                    1
                                    ,
                                    0
                                    )
                                 , which is interpreted as a decimal integer 
                                    
                                       
                                          (
                                          1
                                          ,
                                          0
                                          )
                                       
                                       
                                          int
                                       
                                    
                                    =
                                    2
                                 . Set 
                                    P
                                    1
                                    =
                                    P
                                    1
                                    +
                                    
                                       
                                          (
                                          1
                                          ,
                                          0
                                          )
                                       
                                       
                                          int
                                       
                                    
                                    +
                                    1
                                    =
                                    9
                                 , 
                                    P
                                    2
                                    =
                                    P
                                    2
                                    +
                                    k
                                    +
                                    1
                                    =
                                    7
                                 , and flip 
                                    
                                       
                                          x
                                       
                                       
                                          P
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          9
                                       
                                    
                                  to “1”.

Now we analyze the coding rate and distortion in two cases of the coding process. In Case 1, we code one bit into a 
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                        -length cover without making any modification; in Case 2, we code 
                           k
                           +
                           1
                         bits of messages by expending 
                           n
                           =
                           
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       2
                                    
                                 
                                 ,
                                 ⋯
                                 
                                    
                                       m
                                    
                                    
                                       P
                                       2
                                       +
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                              
                              
                                 int
                              
                           
                           +
                           1
                         cover symbols and one modification. Because the message block 
                           (
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 2
                              
                           
                           ,
                           ⋯
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 k
                                 +
                                 1
                              
                           
                           )
                         is random, the probability 
                           P
                           
                              (
                              n
                              =
                              j
                              )
                           
                           =
                           1
                           /
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                         for any 
                           j
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              ⋯
                              ,
                              
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , and thus the expectation of n is equal to 
                           (
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           +
                           1
                           )
                           /
                           2
                        . Therefore in Case 2, average 
                           k
                           +
                           1
                         bits are coded into 
                           (
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           +
                           1
                           )
                           /
                           2
                         cover symbols with one modification. Because probabilities of ‘1’s and ‘0’s in message are all 1/2, so the two cases occur with equal probability. For one coding step, the average number of coded bits is equal to 
                           
                              
                                 N
                              
                              
                                 mess
                              
                           
                           =
                           
                              
                                 k
                                 +
                                 2
                              
                              2
                           
                        , the average number of expended cover symbols is equal to 
                           
                              
                                 N
                              
                              
                                 cover
                              
                           
                           =
                           
                              
                                 3
                                 ⋅
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 1
                              
                              4
                           
                         and the average number of modifications is equal to 
                           
                              
                                 N
                              
                              
                                 mod
                              
                           
                           =
                           
                              1
                              2
                           
                        . Therefore, the coding rate R of the proposed sparse representation can be calculated as follows
                           
                              (13)
                              
                                 
                                    R
                                    =
                                    
                                       
                                          
                                             N
                                          
                                          
                                             mess
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             cover
                                          
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          k
                                          +
                                          4
                                       
                                       
                                          3
                                          ⋅
                                          
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Eq. (13) shows that coding rate R is determined by the parameter k, in general 
                           k
                           ≥
                           0
                        . Fig. 5
                         shows the inverse relationship between the parameter k and coding rate R. Here, the parameter k must be an integer 
                           k
                           =
                           [
                           0
                           ,
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           4
                           ,
                           5
                           ,
                           6
                           ⋯
                           ]
                        , namely, it corresponds to the coding rate 
                           R
                           =
                           [
                           1.0000
                           ,
                           0.8571
                           ,
                           0.6154
                           ,
                           0.4000
                           ,
                           0.2449
                           ,
                           0.1443
                           ⋯
                           ]
                        . To realize sparse rate 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                        , we choose two coding rates 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         separately, satisfying 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           <
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           >
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                        . The message is divided into two sets according to two weighted coefficients α and β, in which α and β satisfied following equation
                           
                              (14)
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                α
                                                ⋅
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                β
                                                ⋅
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                α
                                                +
                                                β
                                                =
                                                1
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

And then length of one part message is 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           =
                           α
                           ⋅
                           L
                        , the other part is 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           =
                           β
                           ⋅
                           L
                        , where L is the length of the original message. Two parts message 
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                         are coded into 
                           
                              
                                 dm
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 dm
                              
                              
                                 2
                              
                           
                         according to coding rates 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         by using sparse representation respectively, in which sum of length of 
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                         is L and sum of length of 
                           
                              
                                 dm
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 dm
                              
                              
                                 2
                              
                           
                         is CL. Finally, sparse representation message dm is obtained by combining 
                           
                              
                                 dm
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 dm
                              
                              
                                 2
                              
                           
                        .

In order to discuss the effect of the message sparse representation method, we compare the change rate Δ between non-used and used message sparse representation method. As shown in Fig. 6
                        , with the change of the coding rate(R), the change rate in non-used message sparse representation method is always equal to 0.5 because original secret message is a pseudo random sequence and probabilities of '1' or '0' in message are all 1/2. However, the change rate of used message sparse representation method is below than 0.5 and different in all coding rate. In addition, Fig. 6 also shows that the message sparse representation method proposed in section 3.3 is very close to the upper bound, which means it has a good coding performance.

Section 3.2 illustrates the embedding procedure of Cross layer, Dot layer's embedding scheme uses the modified pixels from the Cross set of computing predicted values and original pixels from the Dot set for embedding data. The marked image is the modified Dot and Cross sets. Double decoding scheme is the inverse of the double encoding scheme. Here, we only describe the Cross decoding scheme which similar to Dot set. Based on this, we first summarize five steps for extracting sparse representation message and recovering cover image, and then original message are decoded by the reverse processing of section 3.3.

1) Read LSB of first 
                           55
                           +
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         pixels in marked image to get the values of 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                        , the maximum shift times 
                           
                              
                                 f
                              
                              
                                 max
                              
                           
                        , the shifting distance s, payload size of the original message that be embedded, size of compressed location map 
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         and compressed location map.

2) Calculate prediction value 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and local variance (LV) from Eq. (2) and Eq. (4), and sort pixels in descending order of LV values.

3) Calculate modified prediction error 
                           
                              
                                 D
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           −
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . Search the scope of modified prediction error H from 
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                         to 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                        , every time decreases one. Meanwhile, there is also a register f changes from 0 to 
                           
                              
                                 f
                              
                              
                                 max
                              
                           
                           −
                           1
                        , every time increasing one, such as
                           
                              (15)
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                f
                                                ×
                                                s
                                                ,
                                                
                                                   dm
                                                
                                                =
                                                0
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                H
                                                +
                                                f
                                                ×
                                                s
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                f
                                                ×
                                                s
                                                ,
                                                
                                                   dm
                                                
                                                =
                                                0
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                −
                                                H
                                                −
                                                f
                                                ×
                                                s
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                f
                                                ×
                                                s
                                                −
                                                1
                                                ,
                                                
                                                   dm
                                                
                                                =
                                                1
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                H
                                                +
                                                f
                                                ×
                                                s
                                                +
                                                1
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                f
                                                ×
                                                s
                                                +
                                                1
                                                ,
                                                
                                                   dm
                                                
                                                =
                                                1
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                −
                                                H
                                                −
                                                f
                                                ×
                                                s
                                                −
                                                1
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                             
                                             
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                <
                                                H
                                                +
                                                f
                                                ×
                                                s
                                                )
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                &
                                                
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                >
                                                −
                                                H
                                                −
                                                f
                                                ×
                                                s
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

After looping 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           −
                           
                              
                                 T
                              
                              
                                 p
                              
                           
                           +
                           1
                         times, all sparse representation message dm are extracted. In order to recover cover image losslessly, prediction errors that larger than 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                         or less than 
                           −
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                         should also be recovered as
                           
                              (16)
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ×
                                                s
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                >
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                ×
                                                s
                                                +
                                                1
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ×
                                                s
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                <
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      m
                                                   
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                ×
                                                s
                                                −
                                                1
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

4) Recover the cover image as 
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 ′
                              
                           
                        .

5) Replace the LSB of first 
                           55
                           +
                           
                              
                                 N
                              
                              
                                 flow
                              
                           
                         pixels by the 
                           
                              
                                 S
                              
                              
                                 LSB
                              
                           
                         that extracted by step 3.

After extracted all sparse representation message dm, we need decode dm into original message m. Due to the cover image are recovered and payload size of the original message that be embedded is extracted in step 1, so the two coding rates 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , two weighted coefficients α and β are all obtained by repeating section 3.3. Hence, sparse representation message dm is divided into two sets as 
                           
                              
                                 dm
                              
                              
                                 1
                              
                           
                           =
                           α
                           ⋅
                           
                              dm
                           
                         with parameter 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 dm
                              
                              
                                 2
                              
                           
                           =
                           β
                           ⋅
                           
                              dm
                           
                         with parameter 
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                        . Here, we just take one set as illustration, in which set 
                           
                              
                                 dm
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 dm
                              
                              
                                 1
                              
                           
                            
                           o
                           r
                            
                           
                              
                                 dm
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                            
                           o
                           r
                            
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                        . In fact, the procedure from dm to m is also first initialize pointers P1 and P2 all as 0, and then read 
                           
                              
                                 2
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         length block from 
                           
                              
                                 dm
                              
                              
                                 ′
                              
                           
                         as 
                           (
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           ⋯
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                        . We still use two cases to judge whether include ‘1’ in block.


                        Case 1 If symbols in block 
                           (
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           ⋯
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                         are all ‘0’, so the original message 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                           =
                           0
                        , and then pointers come to 
                           P
                           1
                           =
                           P
                           1
                           +
                           
                              
                                 2
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        , 
                           P
                           2
                           =
                           P
                           2
                           +
                           1
                        .


                        Case 2 If existing ‘1’ symbol in block 
                           (
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           ⋯
                           d
                           
                              
                                 m
                              
                              
                                 P
                                 1
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                        , count the number of consecutive ‘0’ symbols until search for first ‘1’ symbol, regarded as i. Converting i into 
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                         bits binary sequence regarded as 
                           
                              
                                 i
                              
                              
                                 bin
                              
                           
                        , so the original message 
                           
                              
                                 m
                              
                              
                                 P
                                 2
                                 +
                                 1
                              
                           
                           =
                           1
                         and next 
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                         bits is 
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    P
                                    2
                                    +
                                    2
                                 
                              
                              ,
                              ⋯
                              
                                 
                                    m
                                 
                                 
                                    P
                                    2
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    1
                                 
                              
                              )
                           
                           =
                           
                              
                                 i
                              
                              
                                 bin
                              
                           
                        , and then pointers come to 
                           P
                           1
                           =
                           P
                           1
                           +
                           i
                           +
                           1
                        , 
                           P
                           2
                           =
                           P
                           2
                           +
                           
                              
                                 k
                              
                              
                                 ′
                              
                           
                           +
                           1
                        .

After repeated two times procedure from above two cased, all original message m are all decoded from sparse representation message dm.

@&#EXPERIMENTS AND RESULTS@&#

In order to illustrate the characteristic of the proposed method, we first do experiment on image ‘baboon’ by respectively using the proposed's and Sachnev et al.'s [11] methods as shown in Fig. 7
                     . The embedding rate is chosen as 0.5 bpp and shifting distance s is empirically determined as 1 and 2. Compared with original image in Fig. 7(a), Fig. 7(b) shows that marked image by used Sachnev et al.'s method [11] is almost unchanged, Figs. 7(c,d) improve the details information of texture area in subjective perception by used the proposed method, such as in fur. That is because Sachnev et al.'s method is a typical smooth-priority RDH method, but the proposed method is a texture-priority method and can enhance contrast of the texture area. In addition, experiment also calculates the PSNR, SSIM and RCE values by each methods, in which SSIM is an image quality assessment (IQA) method that considers the structural characteristic of the image and includes structure, luminance, and contrast comparison functions [29] and RCE indicates the degree of contrast enhancement between original and enhanced images, and is in the range of 
                        [
                        0
                        ,
                        1
                        ]
                      
                     [30]. The equation to compute RCE is given by 
                        
                           RCE
                        
                        =
                        (
                        
                           
                              std
                           
                           
                              e
                           
                        
                        −
                        
                           
                              std
                           
                           
                              o
                           
                        
                        )
                        /
                        (
                        R
                        −
                        1
                        )
                        +
                        0.5
                     , where 
                        
                           
                              std
                           
                           
                              e
                           
                        
                     , 
                        
                           
                              std
                           
                           
                              o
                           
                        
                      indicate the standard deviations of original and enhanced images, respectively, and for a given 8-bit gray level image. Due to the definition of the RCE, standard deviations depend on the whole image, but the proposed method preferentially modifies the two sides bins of PEH and keeps the most of bins unchanged, so the proposed method enhances the contrast of local area and can't achieve a high RCE value in whole image.

The proposed method aims at enhancing details information of texture area by shifting and embedding data into two side bins of PEH. Here, we take Cross set as example which similar to Dot set, to describe the changing of PEH with different embedding rate when shifting distance 
                        s
                        =
                        1
                     . As shown in Fig. 8
                     , Fig. 8(a) shows the original PEH and Figs. 8(b,c,d) show the modified PEH by the proposed method when embedding rates are 0.3 bpp, 0.6 bpp, 0.99 bpp respectively. Due to the proposed method prior to select two side bins of PEH, two side bins are stretched and equalized at first. With the increase of embedding rate, the middle bins also be selected for stretching and equalizing. When embedding rate close to 1, almost all of PEH's bins are equalized half and stretched double.

In practice application, contrast enhancement of texture areas is crucial in medical image processing. Hence, we do a series experiments on magnetic resonance medical images that derived from National Cancer Imaging Archive (NCIA) [31]. However, due to the limitation of the space, we only randomly choose three medical images which are named as ‘Margo interior hepatis’, ‘Brain’ and ‘Pelvic cavity’ to show the experiment results and subjective perception. Three cover test images are shown in Fig. 9
                     . In order to demonstrate the performance, we do experiment on three test medical images by the proposed method with 
                        s
                        =
                        1
                      and 
                        s
                        =
                        2
                     , Sachnev et al.'s method [11], Wu et al.'s method [22] and Gao et al.'s method [23] when embedding rates are 0.1 bpp, 0.3 bpp, 0.6 bpp and 0.8 bpp respectively, in which Sachnev et al.'s method is a typical smooth-priority RDH method, Wu et al.'s and Gao et al.'s methods are all contrast-based RDH methods. The marked images of three medical images are shown in Figs. 10–12
                     
                     
                      and corresponding parameters are shown in Tables 1–3
                     
                     
                     .

As we know, the quality of an image strongly depends upon subjective experiments to provide calibration data. The Mean Opinion Score (MOS) which is between 
                        [
                        0
                        ,
                        100
                        ]
                      can be used to reflect the perceived quality of the image. The higher the MOS value, the better of the image quality. Hence, we invited 10 doctors from the medical imaging profession in Anhui medical University and recruited 10 graduates from the CAS Key Laboratory of Electro-magnetic Space Information in University of Science and Technology of China to score the quality of each marked images. Before the experiment, a short training showing the approximate range of quality of the images was also presented to each subject. Subjects were shown images in a random order and the randomization was different for each subject. Then subjects reported their judgments of quality according to each images number. Due to the subjective experiments are cumbersome to design and the time is constraint, we do our best to ensure that the testing environment was as close to the “real-world” as possible. All 20 subjects test 60 images in Figs. 10–12. Here, we give the average MOS score by 20 subjects in each image as shown in Tables 1–3. The MOS values prove that the proposed method appropriate improve the quality of the medical images when compared with other RDH methods. From the point of subjective perception and MOS values, we can see that with the increment of embedding rate, marked image's texture areas that used Sachnev et al.'s, Wu et al.'s and Gao et al.'s methods are almost unchanged, but the proposed method restores the details information of texture areas by enhancing contrast. That is because most of medical images includes a lot of smooth area, such as background, the Sachnev et al.'s method embeds data into smooth area (background) priority, so the marked images are not perceived by subjective visual. In addition, Wu et al.'s method selects two highest bins of image's gray histogram to embed data, which means enhancing the contrast of background region priority. Due to Gao et al.'s method embed the data into spatial domain and IWT domain respectively, in which embedding procedure in spatial domain is same with Wu et al.'s method by adding the controlled threshold denoted by 
                        
                           
                              T
                           
                           
                              rce
                           
                        
                        =
                        0.55
                     . Hence, due to the RCE is smaller than 
                        
                           
                              T
                           
                           
                              rce
                           
                        
                      in embedding rates 0.1 bpp, 0.3 bpp, 0.6 bpp and 0.8 bpp by the Gao et al.'s method, so the results in Gao et al.'s method are same as Wu et al.'s method. Different from the above three RDH methods, the proposed method uses PEH to select two side bins which corresponds to texture areas, and embeds data into it by adaptive stretching and equalizing the contrast, so the proposed method can restore the details information of texture areas.

If we compared with results between the proposed method with 
                        s
                        =
                        1
                      and 
                        s
                        =
                        2
                      as shown in Figs. 10(m–p) and Figs. 10(q–t), Figs. 11(m–p) and Figs. 11(q–t), Figs. 12(m–p) and Figs. 12(q–t), we can see that texture area's contrast with shifting distance 
                        s
                        =
                        2
                      is enhanced more than with 
                        s
                        =
                        1
                     . However, when embedding rate is high, such as in 0.8 bpp, since two side bins of PEH had used, we have to use smooth area that corresponds to middle bins, so two side bins are shifted to sides further. If shifting distance s is larger, some pixels on the edge sides bins of PEH may be become extreme points that often appeared in contrast enhancement algorithms. Hence, in order to keep quality of the amplifying marked image, when embedding rate below than 0.6 bpp, we prefer to choose 
                        s
                        =
                        2
                      or higher, otherwise choose 
                        s
                        =
                        1
                     .

We also calculate the PSNR, SSIM and RCE parameters for all marked images as shown in Tables 1–3, in which PSNR and SSIM are used to assess marked image's quality and RCE indicates the degree of contrast enhancement between original and enhanced images. With the increment of embedding rate, PSNR, SSIM and RCE values by four RDH methods are all decreased. When embedding rate is small, such as 0.1 bpp, the difference of PSNR between the proposed method and the other three RDH methods is very large, which is opposite to the subjective perception in Figs. 10–12. That is because most medical images include lot of smooth area, so the PEH has a sharper Laplace distribution, but the proposed method prior to select two side bins of PEH to hide data, so it makes large difference in two side's pixels. As PSNR largely depends on the quadratic sum of difference between original image and distortion image, this large PSNR difference proves PSNR is not a strict metric for assessing image quality. In addition, the essence of the structural comparison function in SSIM is the cosine value of the angle between two images, which reflects the image structure characteristic. Hence, SSIM can't completely reflect the quality of contrast enhanced images.

At last, in order to demonstrate the overall performance of the proposed method with more experiment samples, we do experiment on twenty medical images that derived from NCIA medical image set [31] and calculate the mean results by compared with Sachnev et al.'s method [11], Wu et al.'s method [22], Gao et al.'s method [23] and proposed method when embedding rates between 
                        [
                        0.1
                        ,
                        1
                        ]
                     . Original twenty test medical images are shown in Fig. 13
                      and corresponding calculating parameters are shown in Fig. 14
                     , in which Figs. 14(a–c) are the comparison results of embedding rate versus PSNR, SSIM and RCE respectively. Please note that the results parameters in Fig. 14 are calculated from the mean results of twenty medical images. We can see that the change trend in Fig. 14 is similar to Tables 1–3. Due to the RCE is smaller than 
                        
                           
                              T
                           
                           
                              rce
                           
                        
                      in all embedding rates by the Gao et al.'s method, so the results in Gao et al.'s method are same with Wu et al.'s method. In addition, we note that the PSNR, SSIM values are almost unchanged when embedding rate is higher than 0.6 bpp, that is because we propose a message sparse representation method to code the message for decreasing the distortion of the marked images in this paper and this strategy is effective in higher embedding rate obviously.

@&#CONCLUSION@&#

In this paper, a novel RDH method in medical image with enhanced contrast in texture area is proposed. The proposed method not only enhances contrast of texture area but also hides secret data into cover image reversibly. In addition, in order to further decrease the embedding distortion, this paper also proposes a message sparse representation algorithm that inspirited from the decomposition idea, to code the secret message firstly. The main strategies employed by the proposed method is prior modifying two sides bins of PEH by using HS method. Experimental results confirmed that the marked medical image by the proposed method looks more clearly in texture area than other typical smooth-priority RDH method and global contrast enhancement RDH method, in which the details information are restored clearly even in low embedding rate. Experimental also verifies that in some cases PSNR value can't consistent with subjective visual perception and it is not a strict standard for assessing image quality.

As future work, the hiding efficiency of the proposed method will be further investigated for improvement. Message sparse representation method may be improved by utilizing other coding scheme for further improve performance. In addition, the proposed method will be applied to the frequency domain after further considering other efficient image enhancement method.

@&#REFERENCES@&#

