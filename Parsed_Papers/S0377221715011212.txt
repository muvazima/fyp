@&#MAIN-TITLE@&#A practical finite difference method for the three-dimensional Black–Scholes equation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop the numerical method for pricing of the three-asset ELS options.


                        
                        
                           
                           We use the operator splitting method (OSM) on non-equidistant grid.


                        
                        
                           
                           We compare the OSM with the Monte Carlo simulation (MCS).


                        
                        
                           
                           The OSM is more efficient and stable than MCS for calculating the Greeks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Option pricing

Equity–linked securities

Black–Scholes partial differential equation

Operator splitting method

Non–uniform grid

@&#ABSTRACT@&#


               
               
                  In this paper, we develop a fast and accurate numerical method for pricing of the three-asset equity-linked securities options. The option pricing model is based on the Black–Scholes partial differential equation. The model is discretized by using a non-uniform finite difference method and the resulting discrete equations are solved by using an operator splitting method. For fast and accurate calculation, we put more grid points near the singularity of the nonsmooth payoff function. To demonstrate the accuracy and efficiency of the proposed numerical method, we compare the results of the method with those from Monte Carlo simulation in terms of computational cost and accuracy. The numerical results show that the cost of the proposed method is comparable to that of the Monte Carlo simulation and it provides more stable hedging parameters such as the Greeks.
               
            

@&#INTRODUCTION@&#

Equity-linked securities (ELS) is one of the most popular investment products whose return is linked to the performance of an underlying equity such as a single stock, a group of stocks, or an equity-based index. The ELS option pricing model is based on the Black–Scholes (BS) partial differential equation (PDE) (Black & Scholes, 1973). For some cases, there exist closed-form solutions of pricing derivatives (Capiński, 2015; Pun, Chung, & Wong, 2015). However, in most cases with complex structures (e.g., ELS), it is inefficient or impossible to derive the exact solutions. To solve the problem, an alternative way is a numerical approach (see, for example, Bandi & Bertsimas, 2014; Han & Wu, 2003; Jeong, Kim, & Wee, 2009; Wilmott, Dewynne, & Howison, 1993; Zvan, Vetzal, & Forsyth, 2000). In numerical approaches, there are several ways such as Monte Carlo simulation (MCS), binomial method, finite difference method, etc.

Among these, MCS is the most commonly used method for pricing complex derivatives because of its simplicity to use. However, it should be run with a large number of random samples to get a reliable option value or calculate its sensitivities which are called by the Greeks (Choi & Song, 2008; González-Parra, Arenas, & Chen-Charpentier, 2013; Marroquı & Moreno, 2013). The Greeks, which play a key role in hedging, are defined as changes in option value relative to changes in each independent variable. It is important to calculate the Greeks accurately for hedging an option. For example, Delta is the rate of change in option price relative to the underlying asset. Therefore, in hedging, the Delta provides the number of short units of the underlying asset which is combined with a call option to offset immediate market risk. That is, the accurate value of the Delta can give a dynamical strategy for hedging against risk. For more details about the Greeks, we refer the reader to Haug (2007).

Finite difference methods (FDM) such as alternating direction implicit (ADI) and operator splitting method (OSM) have been widely used in practice. The reason is that the numerical solution from FDM quickly converges to a stable value unlike MCS. Nevertheless, when pricing ELS with more than three underlying assets, FDM is not practical because it needs a lot of computational resources. Therefore, MCS is the only practical choice for three-asset ELS even though there are drawbacks such as slow convergence and non-deterministic values due to its randomness.

The main purpose of this paper is to develop a fast and accurate FDM for pricing three-asset ELS options and computing its Greeks. In this study, the mathematical model is discretized by using a non-uniform FDM and the resulting discrete equations are solved by means of OSM on adaptive grids with more grid points near nonsmooth position of payoff. To show the superiority of the proposed numerical method, we compare the numerical results with those from MCS. We obtain more stable results with our proposed method than MCS in pricing and computing the Greeks of the three-asset ELS option.

The rest of the paper is organized as follows. Section 2 describes the Black–Scholes equation of European options with three underlying assets. Section 3 contains the finite difference discretizations for the BS PDE and a numerical solution algorithm using OSM on adaptive grids. We present the numerical experiments in Section 4. Finally, we conclude our study by summarizing the computational results in Section 5.

The pricing of options on multi-underlying assets is of great interest in the financial industry (Persson & von Persson, 2007; Rambeerich, Tangman, Lollchund, & Bhuruth, 2013). In this paper, we focus on fast and accurate calculations of the three-asset option value and its Greeks.

Let x, y, and z be three underlying assets’ prices and t be a time variable. For (x, y, z) ∈ Ω and t ∈ T, the option price u(x, y, z, t) follows the BS PDE:

                        
                           (1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          
                                             u
                                             t
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          r
                                          x
                                          
                                             u
                                             x
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          r
                                          y
                                          
                                             u
                                             y
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          r
                                          z
                                          
                                             u
                                             z
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             x
                                             2
                                          
                                          
                                             x
                                             2
                                          
                                          
                                             u
                                             
                                                x
                                                x
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             y
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          
                                             u
                                             
                                                y
                                                y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             z
                                             2
                                          
                                          
                                             z
                                             2
                                          
                                          
                                             u
                                             
                                                z
                                                z
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          x
                                          y
                                          
                                             u
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          y
                                          z
                                          
                                             u
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             z
                                          
                                          x
                                          z
                                          
                                             u
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          −
                                          r
                                          u
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             t
                                             )
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                     with the terminal condition 
                        
                           u
                           (
                           x
                           ,
                           y
                           ,
                           z
                           ,
                           T
                           )
                           =
                           Φ
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                           ,
                        
                      where Φ is the payoff function at the expiration time T (Reisinger & Wittum, 2004). Subscripts x, y, z, and t of u denote the partial derivatives with respect to those variables. σx, σy
                     , and σz
                      are volatilities of underlying assets x, y, and z, respectively. ρxy, ρyz
                     , and ρzx
                      represent the correlation values between two subscript asset variables. r is the constant risk-free interest rate. After we transform the backward-in-time PDE (1) into the forward-in-time PDE by using 
                        
                           τ
                           =
                           T
                           −
                           t
                           ,
                        
                      we have the initial value problem

                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                             τ
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          r
                                          x
                                          
                                             u
                                             x
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                          +
                                          r
                                          y
                                          
                                             u
                                             y
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                          +
                                          r
                                          z
                                          
                                             u
                                             z
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             x
                                             2
                                          
                                          
                                             x
                                             2
                                          
                                          
                                             u
                                             
                                                x
                                                x
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             y
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          
                                             u
                                             
                                                y
                                                y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             z
                                             2
                                          
                                          
                                             z
                                             2
                                          
                                          
                                             u
                                             
                                                z
                                                z
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                          +
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          x
                                          y
                                          
                                             u
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          y
                                          z
                                          
                                             u
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                          +
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             z
                                          
                                          x
                                          z
                                          
                                             u
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             τ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          r
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          ,
                                          τ
                                          )
                                          ,
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          ,
                                          τ
                                          )
                                          ∈
                                          Ω
                                          ×
                                          (
                                          0
                                          ,
                                          T
                                          ]
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 u
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 ,
                                 0
                                 )
                                 =
                                 Φ
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 .
                              
                           
                        
                     
                  

Let us first discretize the computational domain 
                        
                           Ω
                           =
                           [
                           0
                           ,
                           L
                           ]
                           ×
                           [
                           0
                           ,
                           M
                           ]
                           ×
                           [
                           0
                           ,
                           N
                           ]
                        
                      with positive non-uniform space steps 
                        
                           
                              h
                              
                                 i
                                 −
                                 1
                              
                              x
                           
                           =
                           
                              x
                              i
                           
                           −
                           
                              x
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              h
                              
                                 j
                                 −
                                 1
                              
                              y
                           
                           =
                           
                              y
                              j
                           
                           −
                           
                              y
                              
                                 j
                                 −
                                 1
                              
                           
                           ,
                        
                      and 
                        
                           
                              h
                              
                                 k
                                 −
                                 1
                              
                              z
                           
                           =
                           
                              z
                              k
                           
                           −
                           
                              z
                              
                                 k
                                 −
                                 1
                              
                           
                        
                     . Here, 
                        
                           
                              x
                              0
                           
                           =
                           
                              y
                              0
                           
                           =
                           
                              z
                              0
                           
                           =
                           0
                           ,
                        
                     
                     
                        
                           
                              x
                              
                                 N
                                 x
                              
                           
                           =
                           L
                           ,
                        
                     
                     
                        
                           
                              y
                              
                                 N
                                 y
                              
                           
                           =
                           M
                           ,
                        
                      and 
                        
                           
                              z
                              
                                 N
                                 z
                              
                           
                           =
                           N
                        
                     . A time step size is defined as 
                        
                           Δ
                           τ
                           =
                           T
                           /
                           
                              N
                              τ
                           
                        
                     . The numbers of grid points in the x-, y-, z-, and τ-directions are denoted by Nx, Ny, Nz
                     , and Nτ
                     , respectively. Fig. 1 represents a schematic illustration of the non-equidistant grid on x-axis. Here, we define the ghost point 
                        
                           x
                           
                              
                                 N
                                 x
                              
                              +
                              1
                           
                        
                      as 
                        
                           
                              x
                              
                                 N
                                 x
                              
                           
                           +
                           
                              h
                              
                                 
                                    N
                                    x
                                 
                                 −
                                 1
                              
                           
                        
                      to apply the linear boundary condition conveniently.


                     Fig. 2
                      shows a schematic illustration of three-dimensional non-uniform grid structure which will be used in this paper.

Let us denote the numerical approximation of the solution by 
                        
                           
                              u
                              
                                 i
                                 j
                                 k
                              
                              n
                           
                           
                              ≡
                              u
                              (
                           
                           
                              x
                              i
                           
                           ,
                           
                              y
                              j
                           
                           ,
                        
                      
                     zk, nΔτ), where 
                        
                           i
                           =
                           0
                           ,
                           …
                           ,
                           
                              N
                              x
                           
                           ,
                        
                     
                     
                        
                           j
                           =
                           0
                           ,
                           …
                           ,
                           
                              N
                              y
                           
                           ,
                        
                     
                     
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           
                              N
                              z
                           
                           ,
                        
                      and 
                        
                           n
                           =
                           0
                           ,
                           …
                           ,
                           
                              N
                              τ
                           
                        
                     . We use the zero Dirichlet boundary conditions at 
                        
                           x
                           =
                           0
                           ,
                        
                     
                     
                        
                           y
                           =
                           0
                           ,
                        
                      and 
                        
                           z
                           =
                           0
                        
                      and the linear boundary conditions at 
                        
                           x
                           =
                           L
                           ,
                        
                     
                     
                        
                           y
                           =
                           M
                           ,
                        
                      and 
                        
                           z
                           =
                           N
                        
                     . Now, we apply OSM (Duffy, 2006; Jeong & Kim, 2013) in order to solve Eq. (2). OSM has been used extensively in mathematical finance for solving numerically multi-asset option pricing models. The basic idea of OSM is to divide each time step into fractional time steps with simpler operators.

We consider the following semi-implicit scheme:

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   u
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   n
                                                
                                             
                                             
                                                Δ
                                                τ
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   x
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   y
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   z
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the discrete difference operators 
                        
                           
                              L
                              
                                 B
                                 S
                              
                              x
                           
                           ,
                        
                     
                     
                        
                           
                              L
                              
                                 B
                                 S
                              
                              y
                           
                           ,
                        
                      and 
                        
                           L
                           
                              B
                              S
                           
                           z
                        
                      are defined by


                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   x
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      x
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                             2
                                          
                                          
                                             D
                                             
                                                x
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          r
                                          
                                             x
                                             i
                                          
                                          
                                             D
                                             x
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             D
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             D
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             1
                                             3
                                          
                                          r
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   y
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      y
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   )
                                                
                                                2
                                             
                                             2
                                          
                                          
                                             D
                                             
                                                y
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          +
                                          r
                                          
                                             y
                                             j
                                          
                                          
                                             D
                                             y
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             D
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             D
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          −
                                          
                                             1
                                             3
                                          
                                          r
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   z
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      z
                                                   
                                                   
                                                      z
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                             2
                                          
                                          
                                             D
                                             
                                                z
                                                z
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          +
                                          r
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             z
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             D
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             D
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          −
                                          
                                             1
                                             3
                                          
                                          r
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

For the discretization of the spatial variables in Eq. (3), we employ the following difference equations:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                             x
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             
                                                h
                                                i
                                                x
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                −
                                                1
                                                ,
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                −
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   i
                                                   x
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             
                                                h
                                                
                                                   i
                                                   −
                                                   1
                                                
                                                x
                                             
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                             
                                                x
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                             2
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                −
                                                1
                                                ,
                                                j
                                                k
                                             
                                          
                                          
                                          −
                                          
                                          
                                             2
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   i
                                                   x
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                          +
                                          
                                          
                                             2
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      +
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                                −
                                                
                                                   u
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      j
                                                      +
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                                −
                                                
                                                   u
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      −
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                                +
                                                
                                                   u
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      j
                                                      −
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   h
                                                   j
                                                   y
                                                
                                                +
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   j
                                                   y
                                                
                                                +
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   h
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                   y
                                                
                                                +
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                   y
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Then, OSM consists of the following three discrete equations

                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                
                                                   n
                                                   +
                                                   
                                                      1
                                                      3
                                                   
                                                
                                             
                                             −
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                n
                                             
                                          
                                          
                                             Δ
                                             τ
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   x
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                
                                                   n
                                                   +
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                             −
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                
                                                   n
                                                   +
                                                   
                                                      1
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             Δ
                                             τ
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   y
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   2
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                
                                                   n
                                                   +
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             Δ
                                             τ
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                   
                                                      B
                                                      S
                                                   
                                                   z
                                                
                                                u
                                                )
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Now, we describe the numerical algorithm for Eqs. (4)–(6). Given 
                        
                           
                              u
                              
                                 i
                                 j
                                 k
                              
                              n
                           
                           ,
                        
                      
                     Eq. (4)
is rewritten as follows:

                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                             i
                                          
                                          
                                             u
                                             
                                                i
                                                −
                                                1
                                                ,
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             β
                                             i
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          +
                                          
                                             γ
                                             i
                                          
                                          
                                             u
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                          for
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             N
                                             x
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          α
                                          i
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      x
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          +
                                          r
                                          
                                             x
                                             i
                                          
                                          
                                             
                                                h
                                                i
                                                x
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          β
                                          i
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      x
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   i
                                                   x
                                                
                                             
                                          
                                          −
                                          r
                                          
                                             x
                                             i
                                          
                                          
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                −
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                             
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   x
                                                
                                                
                                                   h
                                                   i
                                                   x
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                Δ
                                                τ
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          γ
                                          i
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      x
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          −
                                          r
                                          
                                             x
                                             i
                                          
                                          
                                             
                                                h
                                                
                                                   i
                                                   −
                                                   1
                                                
                                                x
                                             
                                             
                                                
                                                   h
                                                   i
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      x
                                                   
                                                   +
                                                   
                                                      h
                                                      i
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          f
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             ρ
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             D
                                             
                                                x
                                                y
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             y
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             ρ
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             
                                                y
                                                z
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                             σ
                                             x
                                          
                                          
                                             σ
                                             z
                                          
                                          
                                             ρ
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          
                                             z
                                             k
                                          
                                          
                                             D
                                             
                                                z
                                                x
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                          −
                                          
                                             1
                                             
                                                Δ
                                                τ
                                             
                                          
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                             n
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     For fixed index j and k, the solution vector 
                        
                           
                              u
                              
                                 1
                                 :
                                 
                                    N
                                    x
                                 
                                 ,
                                 j
                                 k
                              
                              
                                 n
                                 +
                                 
                                    1
                                    3
                                 
                              
                           
                           =
                           
                              
                                 [
                                 
                                    u
                                    
                                       1
                                       j
                                       k
                                    
                                    
                                       n
                                       +
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 
                                 
                                    u
                                    
                                       2
                                       j
                                       k
                                    
                                    
                                       n
                                       +
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 
                                 ⋯
                                 
                                 
                                    u
                                    
                                       
                                          N
                                          x
                                       
                                       j
                                       k
                                    
                                    
                                       n
                                       +
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 ]
                              
                              T
                           
                        
                      can be found by solving the tridiagonal system

                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                             x
                                          
                                          
                                             u
                                             
                                                1
                                                :
                                                
                                                   N
                                                   x
                                                
                                                ,
                                                j
                                                k
                                             
                                             
                                                n
                                                +
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                1
                                                :
                                                
                                                   N
                                                   x
                                                
                                                ,
                                                j
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where Ax
                      is a tridiagonal matrix constructed from Eq. (7) with the zero Dirichlet (
                        
                           
                              u
                              
                                 0
                                 j
                                 k
                              
                              
                                 n
                                 +
                                 
                                    1
                                    3
                                 
                              
                           
                           =
                           0
                        
                      at 
                        
                           x
                           =
                           0
                        
                     ) and linear boundary (
                        
                           
                              u
                              
                                 
                                    N
                                    x
                                 
                                 +
                                 1
                                 ,
                                 j
                                 k
                              
                              
                                 n
                                 +
                                 
                                    1
                                    3
                                 
                              
                           
                           =
                           2
                           
                              u
                              
                                 
                                    N
                                    x
                                 
                                 j
                                 k
                              
                              
                                 n
                                 +
                                 
                                    1
                                    3
                                 
                              
                           
                           −
                           
                              u
                              
                                 
                                    N
                                    x
                                 
                                 −
                                 1
                                 ,
                                 j
                                 k
                              
                              
                                 n
                                 +
                                 
                                    1
                                    3
                                 
                              
                           
                        
                      at 
                        
                           x
                           =
                           L
                        
                     ) conditions, i.e.,

                        
                           
                              
                                 
                                    
                                       
                                          A
                                          x
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         β
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                         2
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         α
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                         3
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋱
                                                   
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         β
                                                         
                                                            
                                                               N
                                                               x
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                         
                                                            
                                                               N
                                                               x
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                            
                                                               N
                                                               x
                                                            
                                                         
                                                         −
                                                         
                                                            γ
                                                            
                                                               N
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                            
                                                               N
                                                               x
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            γ
                                                            
                                                               N
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then, Eq. (4) is implemented in a loop over the y- and z- directions with the following Algorithm 1
                     .

Similarly, Eqs. (5) and (6) are solved. Note that one execution from Eqs. (4)–(6) advances the numerical solution with a Δτ-step in time. For more details about the solution algorithm, see references (Jeong & Kim, 2013; Jeong, Wee, & Kim, 2010).

In order to demonstrate the efficiency and accuracy of the proposed method, we perform the numerical experiments such as convergence test, domain size effect, non-uniform grid size effect, comparison with MCS, computation of the Greeks, and pricing three-asset step-down ELS. In all numerical tests, unless otherwise stated, we use the same parameters 
                        
                           r
                           =
                           0.03
                           ,
                        
                     
                     
                        
                           
                              σ
                              x
                           
                           =
                           
                              σ
                              y
                           
                           =
                           
                              σ
                              z
                           
                           =
                           0.3
                           ,
                        
                      and 
                        
                           
                              ρ
                              
                                 x
                                 y
                              
                           
                           =
                           
                              ρ
                              
                                 y
                                 z
                              
                           
                           =
                           
                              ρ
                              
                                 z
                                 x
                              
                           
                           =
                           0.5
                        
                     . OSM and MCS algorithms are implemented using MATLAB (Mathworks Inc., Natick, MA, USA) and closed-form solutions are obtained using Mathematcia (Wolfram, 1999). Especially, in MCS, we use the antithetic variates technique (Hammersley & Morton, 1956) among the variance reduction methods. The programs are executed on Intel(R) Core(TM) Duo CPU @3.00 GHz desktop PC.

We perform a convergence test in order to verify the accuracy of OSM. We consider the cash-or-nothing option with three underlying assets. The payoff is given as

                           
                              
                                 
                                    
                                       
                                          
                                             u
                                             
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                ,
                                                0
                                                )
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         100
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            ≥
                                                            
                                                               K
                                                               1
                                                            
                                                            ,
                                                            y
                                                            ≥
                                                            
                                                               K
                                                               2
                                                            
                                                            ,
                                                            z
                                                            ≥
                                                            
                                                               K
                                                               3
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         otherwise.
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Here, we take 
                           
                              
                                 K
                                 1
                              
                              =
                              
                                 K
                                 2
                              
                              =
                              
                                 K
                                 3
                              
                              =
                              100
                           
                        . For this test, we use 
                           
                              Ω
                              =
                              [
                              0
                              ,
                              200
                              ]
                              ×
                              [
                              0
                              ,
                              200
                              ]
                              ×
                              [
                              0
                              ,
                              200
                              ]
                           
                         and 
                           
                              T
                              =
                              1
                              /
                              12
                           
                        . We discretize each direction of the domain as 
                           
                              [
                              0
                              ,
                              100
                              −
                              (
                              m
                              +
                              0.5
                              )
                              h
                              ,
                              …
                              ,
                              100
                              −
                              1.5
                              h
                              ,
                              100
                              −
                              0.5
                              h
                              ,
                              100
                              +
                              0.5
                              h
                              ,
                              100
                              +
                              1.5
                              h
                              ,
                              …
                              ,
                              100
                              +
                              (
                              m
                              +
                              0.5
                              )
                              h
                              ,
                              200
                              ]
                              ,
                           
                         where 
                           
                              m
                              =
                              round
                              [
                              100
                              /
                              h
                              −
                              0.5
                              ]
                              −
                              1
                           
                        . The order of accuracy is defined as the ratio of successive errors: log2(eh
                         /e
                        
                           h/2), where eh
                         is the difference of the numerical solution using the space step size h and the exact solution ue
                        . Exact solution for the cash-or-nothing option is obtained from the formula which is described in Appendix.

First, we compute the numerical solutions u(100, 100, 100, T) with 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              1440
                           
                         and a set of increasingly finer grids, i.e., 
                           
                              h
                              =
                              8
                              ,
                              4
                              ,
                              2
                              ,
                           
                         to test the convergence rate for the spatial discretization. To get the option value by OSM at a point 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                              =
                              (
                              100
                              ,
                              100
                              ,
                              100
                              )
                              ,
                           
                         we use trilinear interpolation from the eight neighborhood points. The exact solution is calculated as 
                           
                              
                                 u
                                 e
                              
                              =
                              24.41647
                           
                         at 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                              =
                              (
                              100
                              ,
                              100
                              ,
                              100
                              )
                           
                        . Table 1
                         shows that this method has the second order accuracy in space.

To show the convergence rate for the temporal discretization, we fix the space step size as 
                           
                              h
                              =
                              1
                           
                         and choose a set of decreasing time steps, 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              90
                              ,
                              1
                              /
                              180
                              ,
                              1
                              /
                              360
                           
                        . All other parameters are the same as before. As expected from the discretization, first-order accuracy with respect to time is observed in Table 2
                        .

We investigate the effect of domain size 
                           
                              Ω
                              =
                              
                                 
                                    [
                                    0
                                    ,
                                    L
                                    ]
                                 
                                 3
                              
                           
                         for the numerical solution u(100, 100, 100, T). We take 
                           
                              L
                              =
                              125
                              ,
                              150
                              ,
                              175
                              ,
                              200
                              ,
                              225
                              ,
                           
                         and 250 with 
                           
                              h
                              =
                              1
                              ,
                           
                        
                        
                           
                              T
                              =
                              1
                              /
                              2
                              ,
                           
                         and 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              360
                           
                        . For each x-, y-, and z-directions, we set the mesh as 
                           
                              [
                              0
                              ,
                              0.5
                              ,
                              1.5
                              ,
                              …
                              ,
                              L
                              −
                              1.5
                              ,
                              L
                              −
                              0.5
                              ,
                              L
                              ]
                           
                        . From Table 3
                        , we can observe that if L is larger than 200, the values do not change significantly. Therefore, 
                           
                              L
                              =
                              200
                           
                         is large enough to be used for calculating option values when the strike price is 100.

In this test, we find an optimal non-uniform grid structure which gives the smallest number of grid points with equivalent accuracy of uniform mesh. Table 4
                         shows the value of u(100, 100, 100, T) calculated by using non-uniform grids on 
                           
                              Ω
                              =
                              
                                 
                                    [
                                    0
                                    ,
                                    200
                                    ]
                                 
                                 3
                              
                           
                         with 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              360
                           
                         and 
                           
                              T
                              =
                              1
                              /
                              12
                           
                        . In Table 4, a: h: b denotes that mesh is 
                           
                              [
                              0
                              ,
                              
                              a
                              ,
                              
                              a
                              +
                              h
                              ,
                              
                              a
                              +
                              2
                              h
                              ,
                              …
                              ,
                              
                              b
                              −
                              h
                              ,
                              
                              b
                              ,
                              
                              (
                              b
                              +
                              200
                              )
                              /
                              2
                              ,
                              
                              200
                              ]
                           
                         for all three x-, y-, and z-directions. As shown in Table 4, the values at the top five lines are almost the same. This result suggests that we can use smaller number of grid points with equivalent accuracy. Next to the values, we also put CPU times. By using non-uniform grid, we can substantially reduce the calculation time.

We compare the results from MCS and OSM with equivalent computational costs. MCS is tested with a temporal step size 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              360
                           
                         and 104, 105, and 106 samples until 
                           
                              T
                              =
                              1
                              /
                              12
                           
                        . In OSM simulations, non-uniform meshes [0 69.5:1:130.5 165.25 200], [0 74.5:1:125.5 162.75 200], and [0 79.5:1:120.5 160.25 200] for each direction are used with 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              1440
                           
                         until 
                           
                              T
                              =
                              1
                              /
                              12
                           
                        . In Fig. 3
                        , the open circles are the results of u(100, 100, 100, T) from MCS with varying number of samples. For each number of samples, we plot the results obtained from 10 trials. In the legend in Fig. 3, 69.5: 130.5 denotes the numerical solution (solid symbol) from OSM on a non-uniform grid [0 69.5: 1: 130.5 165.25 200]. The other notations represent non-uniform grids in the same manner. The solid line is the analytic solution. This simulation result indicates that OSM converges to the analytic solution faster than MCS does with the same computational cost.

In this section, the temporal step sizes 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              720
                              ,
                           
                        
                        
                           
                              Δ
                              τ
                              =
                              1
                              /
                              360
                           
                         are used for OSM and MCS, respectively. We get the values of the Greeks at a point 
                           
                              x
                              =
                              (
                              100
                              ,
                              100
                              ,
                              100
                              )
                           
                         and compare the two numerical results calculated by MCS and OSM.

Delta (Δ) is the rate of change of the option price with respect to the price of the underlying asset. We calculate the Delta Δx
                            at 
                              
                                 x
                                 =
                                 (
                                 100
                                 ,
                                 100
                                 ,
                                 100
                                 )
                                 ,
                              
                            which is defined as

                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                   x
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                :
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                                ≈
                                                
                                                   
                                                      u
                                                      (
                                                      x
                                                      +
                                                      0.5
                                                      h
                                                      e
                                                      ,
                                                      T
                                                      )
                                                      −
                                                      u
                                                      (
                                                      x
                                                      −
                                                      0.5
                                                      h
                                                      e
                                                      ,
                                                      T
                                                      )
                                                   
                                                   h
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where e denotes (1, 0, 0). Therefore, we need two simulations to obtain two values 
                              
                                 u
                                 (
                                 x
                                 +
                                 0.5
                                 h
                                 e
                                 ,
                                 T
                                 )
                              
                            and 
                              
                                 u
                                 (
                                 x
                                 −
                                 0.5
                                 h
                                 e
                                 ,
                                 T
                                 )
                              
                            when we use MCS. However, in OSM, we can get the Delta from only one simulation. Fig. 4
                            shows the results by a closed-form solution, MCS, and OSM. Here, the closed-form solution of the Delta is derived by the formula in Appendix and its value is 
                              
                                 
                                    Δ
                                    x
                                 
                                 
                                    (
                                    x
                                    ,
                                    T
                                    )
                                 
                                 =
                                 1.38192
                              
                           . In MCS, the values of the Delta converge as the number of samples increases. With OSM, we obtain the Delta on three different non-uniform grids. In the legend in Fig. 4, 69.5: 130.5 represents a non-uniform grid [0 69.5: 1: 130.5 165.25 200]. The other legends represent non-uniform grids in the same manner. We need 4.15 seconds for one MCS trial with 105 samples. This means that 10 MCS trials with 106 samples takes 415 seconds. However, the numerical solution by OSM on [0 69.5: 1: 130.5 165.25 200] is calculated in 24.99 seconds. As shown in Fig. 4, we can confirm that OSM is more stable and fast method than MCS.

In this section, we consider the Gamma (Γ). Gamma represents the change in the Delta of an option relative to the change in the underlying assets. Therefore, in hedging, traders need to measure Gamma as large moves in an underlying asset could change the risks they hold in option positions dramatically.

For comparison, we calculate the Gamma Γx
                            at a point 
                              
                                 x
                                 =
                                 (
                                 100
                                 ,
                                 100
                                 ,
                                 100
                                 )
                              
                           . Since Γx
                            is the second derivative of u with respect to x, we can express the Gamma Γx
                            as follows:

                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Γ
                                                   x
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                                :
                                                =
                                                
                                                   u
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                                ≈
                                                
                                                   
                                                      u
                                                      (
                                                      x
                                                      −
                                                      h
                                                      e
                                                      ,
                                                      T
                                                      )
                                                      −
                                                      2
                                                      u
                                                      (
                                                      x
                                                      ,
                                                      T
                                                      )
                                                      +
                                                      u
                                                      (
                                                      x
                                                      +
                                                      h
                                                      e
                                                      ,
                                                      T
                                                      )
                                                   
                                                   
                                                      h
                                                      2
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           In order to evaluate the Gamma Γx
                            with MCS by the formula (13), we need three different simulations. However, we can get the Gamma from OSM through only one simulation. Therefore, we can save the computational time by using OSM on a non-uniform grid. Fig. 5
                            represents the Gamma Γx
                            from a closed-form solution, MCS, and OSM. The Gamma from a closed-form solution is 
                              
                                 
                                    Γ
                                    x
                                 
                                 
                                    (
                                    x
                                    ,
                                    T
                                    )
                                 
                                 =
                                 −
                                 0.133136
                              
                           . In MCS, the Gamma with 105 samples is obtained in about 5.88 seconds. To get a reliable result with MCS, we have to perform the simulation with more than 106 samples. It means that the computational time takes more than 588 seconds. However, with OSM, we can obtain a comparable value of the Gamma to closed-form solution within only 25.02 seconds. This shows that OSM is more efficient than MCS for calculating the Gamma.

Vega is the option’s sensitivity to changes in the volatility. This value is a number that tells in direction and extent the option price will move if there is a positive change in the volatility.

In this section, we compare the Vega from MCS and OSM. Since the Vega is the derivative of the option price u with respect to the volatility σx
                           , we can calculate the Vega at a point 
                              
                                 x
                                 =
                                 (
                                 100
                                 ,
                                 100
                                 ,
                                 100
                                 )
                              
                            and 
                              
                                 
                                    σ
                                    x
                                 
                                 =
                                 0.35
                              
                            with 
                              
                                 Δ
                                 
                                    σ
                                    x
                                 
                                 =
                                 0.1
                                 ,
                              
                            i.e.,

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Vega
                                                   
                                                      (
                                                      x
                                                      ,
                                                      T
                                                      )
                                                   
                                                   |
                                                
                                                
                                                   
                                                      σ
                                                      x
                                                   
                                                   =
                                                   0.35
                                                
                                             
                                          
                                          
                                             
                                                :
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                   
                                                      σ
                                                      x
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         ,
                                                         T
                                                         )
                                                      
                                                      |
                                                   
                                                   
                                                      
                                                         σ
                                                         x
                                                      
                                                      =
                                                      0.35
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≈
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            
                                                               (
                                                               x
                                                               ,
                                                               T
                                                               )
                                                            
                                                            |
                                                         
                                                         
                                                            
                                                               σ
                                                               x
                                                            
                                                            =
                                                            0.4
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            u
                                                            
                                                               (
                                                               x
                                                               ,
                                                               T
                                                               )
                                                            
                                                            |
                                                         
                                                         
                                                            
                                                               σ
                                                               x
                                                            
                                                            =
                                                            0.3
                                                         
                                                      
                                                   
                                                   
                                                      0.1
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Fig. 6
                            shows the numerical results of the Vega from a closed-form solution, MCS, and OSM. Here, the Vega from closed-form formula is 
                              
                                 −
                                 2.59518
                              
                           . As shown in Fig. 6, the numerical result of OSM is more closer to exact solution than MCS. Also, the values of Vega by OSM is stable and deterministic while those of MCS slowly converge.

As the sensitivity of the option value to interest rate, Rho is defined the first derivative of the option value with respect to the interest rate r. In this section, we evaluate the Rho at a point 
                              
                                 x
                                 =
                                 (
                                 100
                                 ,
                                 100
                                 ,
                                 100
                                 )
                              
                            and 
                              
                                 r
                                 =
                                 0.03
                              
                            as follows.

                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Rho
                                                   
                                                      (
                                                      x
                                                      ,
                                                      T
                                                      )
                                                   
                                                   |
                                                
                                                
                                                   r
                                                   =
                                                   0.03
                                                
                                             
                                          
                                          
                                             
                                                :
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                   r
                                                
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         ,
                                                         T
                                                         )
                                                      
                                                      |
                                                   
                                                   
                                                      r
                                                      =
                                                      0.03
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≈
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            
                                                               (
                                                               x
                                                               ,
                                                               T
                                                               )
                                                            
                                                            |
                                                         
                                                         
                                                            r
                                                            =
                                                            0.03
                                                            +
                                                            0.00015
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            u
                                                            
                                                               (
                                                               x
                                                               ,
                                                               T
                                                               )
                                                            
                                                            |
                                                         
                                                         
                                                            r
                                                            =
                                                            0.03
                                                            −
                                                            0.00015
                                                         
                                                      
                                                   
                                                   
                                                      0.0003
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Here, the Rho means the rate of change in the option value per 1% change in the risk-free interest rate 
                              
                                 r
                                 =
                                 0.03
                              
                           . Fig. 7 represents the Rho from a closed-form solution, MCS, and OSM.

In Fig. 7, the numerical results by OSM are closer to the closed-form solution. However, the results by MCS have a big deviation from the exact solution. Therefore, OSM is more efficient to evaluate the Rho than MCS.

Theta (θ) is the sensitivity of an option’s value to change in time. This indicates an absolute change in option value for one-unit reduction in time. We can calculate this
                           
                            value though the following formula:

                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                θ
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                                :
                                                =
                                                
                                                   u
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   T
                                                   )
                                                
                                                ≈
                                                
                                                   
                                                      u
                                                      (
                                                      x
                                                      ,
                                                      T
                                                      )
                                                      −
                                                      u
                                                      (
                                                      x
                                                      ,
                                                      T
                                                      −
                                                      Δ
                                                      t
                                                      )
                                                   
                                                   
                                                      Δ
                                                      t
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By Eq. (16), we obtain the value of θ from closed-form solution, MCS, and OSM. These results are shown in Fig. 8. One of the notable points is that the value of θ from OSM is more quickly evaluated than MCS. The θ can be calculated with two option values 
                              
                                 u
                                 (
                                 x
                                 ,
                                 T
                                 −
                                 Δ
                                 t
                                 )
                              
                            and u(x, T). Therefore, MCS needs two calculations unlike OSM which needs only one calculation.

From these simulation results for computing the values of the Greeks, we can confirm that the numerical results from OSM converge to the analytic solutions faster than MCS with the same computational cost.

As a practical example, let us consider a three-asset step-down ELS which is the most popular kind of ELS structure in Korean financial market. The three-asset step-down ELS is a derivative securities whose payoff is determined by three underlying equity prices. This option is automatically exercised at each validation date before or at maturity if the price of underlying asset is above a pre-defined exercise level. The validation date is called the early redemption date. In step-down ELS, the pre-specified exercise levels are lowered from previous validation date to next date (Lee, 2013). If the price of underlying asset is below those levels on each validation date, the payoff will be deferred maturity (Kim, Bae, & Koo, 2014).


                        Fig. 9(a) and (b) show the pay-off function at maturity and early redemption date for the step-down ELS, respectively. Here, the early redemption value denotes the pre-specified interim evolution date which has early redemption chances (Kim et al., 2014).

Let x(t), y(t), z(t) be linearly scaled underlying assets’ prices at time t with (x(0), 
                           
                              y
                              (
                              0
                              )
                              ,
                              z
                              (
                              0
                              )
                              )
                              =
                              (
                              100
                              ,
                              100
                              ,
                              100
                              )
                           
                        . Let T be maturity, F be face value, and ti
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         be early obligatory redemption observation dates. Ki
                         and ci
                         are corresponding exercise prices and rates of return, respectively. Let D denote the knock-in barrier level and d denote a dummy. Let 
                           
                              
                                 S
                                 t
                              
                              =
                              min
                              
                                 {
                                 x
                                 (
                                 t
                                 )
                                 ,
                                 y
                                 (
                                 t
                                 )
                                 ,
                                 z
                                 (
                                 t
                                 )
                                 }
                              
                           
                         be the minimum of three underlying assets at t. By definition of τ, we have 
                           
                              
                                 S
                                 τ
                              
                              =
                              min
                              
                                 {
                                 x
                                 (
                                 T
                                 −
                                 τ
                                 )
                                 ,
                                 y
                                 (
                                 T
                                 −
                                 τ
                                 )
                                 ,
                                 z
                                 (
                                 T
                                 −
                                 τ
                                 )
                                 }
                              
                           
                        . Let u(x, y, z, τ) and v(x, y, z, τ) be the solutions with and without knock-in event, respectively. A knock-in event happens when min{St
                        ∣0 ≤ t ≤ T} < D. The initial conditions are given as

                           
                              (17)
                              
                                 
                                    u
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       τ
                                       =
                                       0
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   F
                                                   
                                                      S
                                                      T
                                                   
                                                   /
                                                   100
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      S
                                                      T
                                                   
                                                   <
                                                   
                                                      K
                                                      6
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      c
                                                      6
                                                   
                                                   )
                                                   F
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    v
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       τ
                                       =
                                       0
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      c
                                                      6
                                                   
                                                   )
                                                   F
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      S
                                                      T
                                                   
                                                   ≥
                                                   
                                                      K
                                                      6
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   d
                                                   )
                                                   F
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   D
                                                   <
                                                   
                                                      S
                                                      T
                                                   
                                                   <
                                                   
                                                      K
                                                      6
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                   
                                                      S
                                                      T
                                                   
                                                   /
                                                   100
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and 
                        Fig. 9(b) shows the diagonal plots of the early obligatory redemption conditions along the line 
                           
                              x
                              =
                              y
                              =
                              z
                           
                        .

The solution algorithm is as follows: First, we update u and v by solving Eqs. (4)–(6) with the initial conditions (17) and (18). After that we replace the values of v by u in the region which is bounded by the knock-in barrier D, i.e., 
                           
                              
                                 v
                                 
                                    i
                                    j
                                    k
                                 
                                 1
                              
                              =
                              
                                 u
                                 
                                    i
                                    j
                                    k
                                 
                                 1
                              
                           
                         for 
                           
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 ,
                                 
                                    z
                                    k
                                 
                                 )
                              
                              ∈
                              
                                 Ω
                                 
                                    k
                                    i
                                 
                              
                              =
                              
                                 {
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 |
                                 x
                                 <
                                 D
                                 ,
                                 y
                                 <
                                 D
                                 ,
                                 z
                                 <
                                 D
                                 }
                              
                           
                        . We apply this replacement after every time step until 
                           
                              τ
                              =
                              T
                              ,
                           
                         i.e., 
                           
                              
                                 v
                                 
                                    i
                                    j
                                    k
                                 
                                 n
                              
                              =
                              
                                 u
                                 
                                    i
                                    j
                                    k
                                 
                                 n
                              
                           
                         for (xi, yj, zk
                        ) ∈ Ωki
                         and 
                           
                              n
                              =
                              1
                              ,
                              …
                              ,
                              
                                 N
                                 t
                              
                           
                        . Let 
                           
                              
                                 Ω
                                 m
                              
                              =
                              
                                 {
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 |
                                 x
                                 ≥
                                 
                                    K
                                    m
                                 
                                 ,
                                 y
                                 ≥
                                 
                                    K
                                    m
                                 
                                 ,
                                 z
                                 ≥
                                 
                                    K
                                    m
                                 
                                 }
                              
                           
                        . At the first observation date 
                           
                              
                                 τ
                                 1
                              
                              =
                              T
                              /
                              6
                              ,
                           
                         we reset values of u and v as 
                           
                              
                                 u
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                    1
                                 
                              
                              =
                              
                                 v
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                    1
                                 
                              
                              =
                              
                                 (
                                 1
                                 +
                                 
                                    c
                                    1
                                 
                                 )
                              
                              F
                           
                         for (xi, yj, zk
                        ) ∈ Ω
                        1. Likewise, at the intermediate observation dates τn
                        , we reset values of u and v as 
                           
                              
                                 u
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                    m
                                 
                              
                              =
                              
                                 v
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                    m
                                 
                              
                              =
                              
                                 (
                                 1
                                 +
                                 
                                    c
                                    m
                                 
                                 )
                              
                              F
                           
                         for (xi, yj, zk
                        ) ∈ Ωm
                         for 
                           
                              m
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                              ,
                           
                         and 5. The parameters are listed in Table 5
                        .

In this section, we chose the following parameters: the reference price 
                           
                              
                                 K
                                 0
                              
                              =
                              100
                              ,
                           
                         the interest rate 
                           
                              r
                              =
                              0.03
                              ,
                           
                         the volatilities of the underlying assets 
                           
                              
                                 σ
                                 x
                              
                              =
                              
                                 σ
                                 y
                              
                              =
                              
                                 σ
                                 z
                              
                              =
                              0.3
                              ,
                           
                         the total time 
                           
                              T
                              =
                              3
                           
                         years, the face price 
                           
                              F
                              =
                              100
                              ,
                           
                         the knock-in barrier level 
                           
                              D
                              =
                              0.65
                              
                                 K
                                 0
                              
                              ,
                           
                         the dummy rate 
                           
                              d
                              =
                              0.3
                              ,
                           
                         the correlation 
                           
                              
                                 ρ
                                 
                                    x
                                    y
                                 
                              
                              =
                              
                                 ρ
                                 
                                    y
                                    z
                                 
                              
                              =
                              
                                 ρ
                                 
                                    z
                                    x
                                 
                              
                              =
                              0.5
                              ,
                           
                         and the computational domain 
                           
                              Ω
                              =
                              [
                              0
                              ,
                              200
                              ]
                              ×
                              [
                              0
                              ,
                              200
                              ]
                              ×
                              [
                              0
                              ,
                              200
                              ]
                           
                        . We compare the results from MCS and OSM for the step-down ELS option (see Fig. 9). As a reference solution value, we run MCS with 107 samples and 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              360
                           
                        . The option value obtained from this MCS is 84.4431 and it takes 5035.73 seconds. For OSM simulation, 
                           
                              Δ
                              τ
                              =
                              1
                              /
                              30
                           
                         and a non-uniform mesh [0 60:2.5:130 160 180 200 220] for each direction are used. Fig. 10(a and b) show payoff functions of u and v at 
                           
                              z
                              =
                              100
                              ,
                           
                         respectively. Fig. 10(c) is the final solution of v at 
                           
                              z
                              =
                              100
                           
                         and 
                           
                              τ
                              =
                              3
                           
                        . We get its numerical value as 84.6347 and it takes only 12.0938 seconds. The relative percent error is 
                           
                              (
                              84.4431
                              −
                              84.6347
                              )
                              /
                              84.4431
                              ×
                              100
                              
                              %
                              =
                              −
                              0.2269
                              
                              %
                           
                        . This percent error demonstrates the efficiency and accuracy of the non-uniform OSM.

@&#CONCLUSIONS@&#

To price the three-asset equity-linked securities (ELS) options, a fast and accurate numerical method is developed. In this paper, we use the Black–Scholes partial differential equation for the option pricing. The model is discretized by using a non-uniform finite difference method and the resulting discrete equations are solved by means of the operator splitting method. In particular, in order to do fast and accurate calculation, we use non-uniform grid structures which put more grid points near the singularity of the nonsmooth payoff function. The numerical results show that the cost of the proposed method is comparable to that of Monte Carlo simulation and it provides more stable hedging parameters such as the Greeks.

@&#ACKNOWLEDGMENTS@&#

The first author (J.S. Kim) was supported by a subproject of project Research for Applications of Mathematical Principles (No C21501) and supported by the National Institute of Mathematics Sciences (NIMS). The corresponding author (D. Jeong) was supported by a Korea University Grant. The authors are grateful to the anonymous referees whose valuable suggestions and comments significantly improved the quality of this paper.

The closed-form solution u(x
                     1, x
                     2, x
                     3, t) of Eq. (1) is given by

                        
                           
                              
                                 
                                    
                                       
                                          u
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          ,
                                          
                                             x
                                             3
                                          
                                          ,
                                          t
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             E
                                             
                                                e
                                                
                                                   −
                                                   r
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                σ
                                                1
                                             
                                             
                                                σ
                                                2
                                             
                                             
                                                σ
                                                3
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         2
                                                         π
                                                         
                                                            (
                                                            T
                                                            −
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      3
                                                   
                                                   det
                                                   Σ
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             ∫
                                             
                                                
                                                   K
                                                   3
                                                
                                             
                                             ∞
                                          
                                          
                                             ∫
                                             
                                                
                                                   K
                                                   2
                                                
                                             
                                             ∞
                                          
                                          
                                             ∫
                                             
                                                
                                                   K
                                                   1
                                                
                                             
                                             ∞
                                          
                                          
                                             
                                                exp
                                                
                                                   (
                                                   −
                                                   0.5
                                                   α
                                                   
                                                      Σ
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      T
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ξ
                                                   1
                                                
                                                
                                                   ξ
                                                   2
                                                
                                                
                                                   ξ
                                                   3
                                                
                                             
                                          
                                          d
                                          
                                             ξ
                                             1
                                          
                                          d
                                          
                                             ξ
                                             2
                                          
                                          d
                                          
                                             ξ
                                             3
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the payoff function is

                        
                           
                              
                                 
                                    
                                       
                                          u
                                          
                                             (
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             ,
                                             
                                                x
                                                3
                                             
                                             ,
                                             0
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         
                                                            x
                                                            1
                                                         
                                                         ≥
                                                         
                                                            K
                                                            1
                                                         
                                                         ,
                                                         
                                                            x
                                                            2
                                                         
                                                         ≥
                                                         
                                                            K
                                                            2
                                                         
                                                         ,
                                                         
                                                            x
                                                            3
                                                         
                                                         ≥
                                                         
                                                            K
                                                            3
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and the correlation matrix Σ is

                        
                           
                              
                                 
                                    
                                       
                                          Σ
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         ρ
                                                         12
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                         21
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         ρ
                                                         23
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                         31
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                         32
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     which is symmetric for the correlation coefficients ρij
                      and 
                        
                           α
                           =
                           (
                           
                              α
                              1
                           
                           ,
                           
                              α
                              2
                           
                           ,
                           
                              α
                              3
                           
                           )
                        
                      where αi
                      is defined by 
                        
                           
                              α
                              i
                           
                           =
                           
                              [
                              ln
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 /
                                 
                                    ξ
                                    i
                                 
                                 )
                              
                              +
                              
                                 (
                                 r
                                 −
                                 0.5
                                 
                                    σ
                                    i
                                    2
                                 
                                 )
                              
                              
                                 (
                                 T
                                 −
                                 t
                                 )
                              
                              ]
                           
                           /
                           
                              (
                              
                                 σ
                                 i
                              
                              
                                 
                                    T
                                    −
                                    t
                                 
                              
                              )
                           
                           .
                        
                      We evaluate the closed-form option price and the Greeks by using 
                        Mathematica
                      (Wolfram, 1999).

@&#REFERENCES@&#

