@&#MAIN-TITLE@&#A Markov modulated Poisson model for software reliability

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new model for software reliability is proposed.


                        
                        
                           
                           Proposed model enables us to infer performance of the debugging process.


                        
                        
                           
                           Bayesian inference is developed.


                        
                        
                           
                           An approach is introduced to assess dimension of the Markov process.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Software reliability

Hidden Markov model

Bayesian inference

@&#ABSTRACT@&#


               
               
                  In this paper, we consider a latent Markov process governing the intensity rate of a Poisson process model for software failures. The latent process enables us to infer performance of the debugging operations over time and allows us to deal with the imperfect debugging scenario. We develop the Bayesian inference for the model and also introduce a method to infer the unknown dimension of the Markov process. We illustrate the implementation of our model and the Bayesian approach by using actual software failure data.
               
            

@&#INTRODUCTION@&#

Poisson process and its extensions are widely used in software reliability modeling; see for example, Pham and Zhang (2003). These Poisson process models are generated by the interfailure times of the software. One of the original Poisson process models is the time-dependent error detection model of Goel and Okumoto (1980). Most other Poisson process models are extensions of the Goel-Okumoto model. Such extensions and Kuo and Yang’s (1996) unification of the Poisson process models via general order and record value statistics are discussed in the recent review by Soyer (2011).

A Markov-modulated Poisson process (MMPP) is a Poisson process whose intensity depends on the current state of an independently evolving continuous-time Markov process. Özekici and Soyer (2006) discuss probabilistic and statistical issues related to these processes in a rather general setting. These processes are used in a variety of applications in queueing, inventory, and reliability. Use of modulating processes in these applications have gained a lot of attention because they make the models more realistic. The customer arrival process in queueing and inventory models are often affected by an external environmental process that represents economic, financial, social or other factors in which the system operates. The arrival rate of customers depend on the state of the environment as well as other stochastic or deterministic parameters. Prabhu and Zhu (1989) discuss Markov modulated queues, and Arifog̃lu and Özekici (2010) analyze an inventory model operating in a partially observable random environment.

First consideration of MMPPs in software reliability applications is due to Özekici and Soyer (2003) who assume that the failures of the software depend on its operational profile. Musa (1993) defines the operational profile as the set of all operations that a software system is designed to perform and their occurrence probabilities. The modulating process represents how the software is used and, thus, the failure process depends on it. Özekici and Soyer (2003) consider a setting where there is perfect debugging during the testing of software and the state of the environmental process is observed. In this paper, we relax both of these assumptions. More specifically, in our setup we consider software that goes through a debugging process, but we do not assume that debugging is perfect [see Aktekin and Caglar (2013) for a similar treatment]. Instead, we assume that the failure rate of the software is nonhomogeneous and modulated by the environmental process and this enables us to consider both improvements and deteriorations in the software as a result of the debugging.

Unlike Özekici and Soyer (2003), in our setup the environmental process is latent and it represents the state of the debugging process as well as the operations that the software goes through during the process. Our objective is to provide a computationally tractable Bayesian procedure to make inference on the software failure rates and the parameters of the modulating Markov process based on observed data. In our setting, since the state of the modulating process is latent or hidden, we only have information on the failure times. An interesting problem then is to make statistical inferences on the hidden process based on failure data. Our model extends the discrete time hidden Markov model considered by Durand and Gaudoin (2005) to continuous time and develops its Bayesian analysis. Applications of our model in reliability also include hardware reliability where a device performs a stochastic mission and its failure rate depends on the stage of the mission. Çekyay and Özekici (2010) discuss issues related to mean time to failure and availability when the mission or environmental process is semi-Markovian.

The details of our model will be presented in Section 2 where the stochastic structures of the modulating and failure processes are described. In Section 3 we will assume that the number of states of the hidden process is known, and show how we can estimate the software failure rates as well as the transition rates of the Markov process. Then, in Section 4 we will assume that we do not know the number of states of the hidden Markov process, and will present an approach to obtain the marginal likelihood based on Chib (1995) that will enable us to infer the unknown number of states. Finally, our results will be demonstrated using actual software failure data in Section 5. Conclusions follow in Section 6.

Let N
                     ={N
                     
                        t
                     ; t
                     ⩾0} be a modulated Poisson process such that N
                     
                        t
                      depicts the total number of software failures until time t. There is an environmental process that modulates the software failure rates. In other words, the software failure rate is random at any time depending on the state of this environmental process. In software reliability, the environmental process can have several different interpretations. In Özekici and Soyer (2003), for example, it is used to represent the operational profile or process which depicts the operations that the software performs randomly after it is released. It may also be used to represent the state of the software during testing and debugging with respect to its failure properties. At any time, the software can be classified to be in “excellent”, “good”, or “bad” state depending on the number of faults or other failure properties. Although our analysis applies to both of these cases, we motivate it by the latter so that the environmental process represents the state of the software during testing and debugging. This state is not necessarily observed and the software failure rate depends on the unobserved state.

The environmental process is Y
                     ={Y
                     
                        t
                     ; t
                     ⩾0} where Y
                     
                        t
                      represents the state of the software during testing and debugging at time t. Since the effect of the changes made to the software during the debugging process is not necessarily observable, Y is a latent or hidden process. We assume that Y
                     ={Y
                     
                        t
                     ; t
                     ⩾0} is a continuous-time Markov process with a finite state space E
                     ={1, 2, …, K} where K is the number of states. We further assume that when the state of the software is i
                     ∈
                     E, failures occur according to an ordinary Poisson process with rate λ
                     
                        i
                     . Therefore, the rate of failures at time t is 
                        
                           
                              
                                 λ
                              
                              
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        
                     . To be more precise,
                        
                           (1)
                           
                              P
                              [
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              =
                              k
                              |
                              Y
                              ]
                              =
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    k
                                    !
                                 
                              
                           
                        
                     where
                        
                           (2)
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    t
                                 
                              
                              λ
                              (
                              
                                 
                                    Y
                                 
                                 
                                    s
                                 
                              
                              )
                              ds
                           
                        
                     for all k
                     =0, 1, … and t
                     ⩾0.

It follows from the above that, given Y, N is a nonstationary Poisson process with mean value function E[N
                     
                        t
                     ∣Y]=
                     A
                     
                        t
                     . Letting T
                     ={T
                     
                        n
                     ; n
                     =0, 1, 2, …} denote the software failure process so that T
                     
                        n
                      is the time of the nth failure, we have the conditional distribution
                        
                           (3)
                           
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    T
                                 
                                 
                                    n
                                 
                              
                              >
                              t
                              |
                              Y
                              ,
                              
                                 
                                    T
                                 
                                 
                                    n
                                 
                              
                              ]
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                n
                                             
                                          
                                          +
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     The modulated process reduces to the ordinary Poisson process with rate λ if the failure rate vector is λ
                     
                        i
                     
                     =
                     λ independent of the state of Y. In this case, A
                     
                        t
                     
                     =
                     λt deterministically.

The failure process N can be studied via the additive functional A of Y. In particular, (1) and (3) directly yield
                        
                           (4)
                           
                              P
                              [
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              =
                              k
                              ]
                              =
                              E
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   -
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             k
                                             !
                                          
                                       
                                    
                                 
                              
                           
                        
                     and
                        
                           (5)
                           
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    T
                                 
                                 
                                    n
                                 
                              
                              >
                              t
                              |
                              
                                 
                                    T
                                 
                                 
                                    n
                                 
                              
                              ]
                              =
                              E
                              [
                              
                                 
                                    e
                                 
                                 
                                    -
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                n
                                             
                                          
                                          +
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                              ]
                           
                        
                     Therefore, the probability law of A, thus that of the environmental process Y, plays an important role in our analysis of N and T.

Let X
                     
                        n
                      be the nth state of the environmental process and U
                     
                        n
                      denote the time when the process enters the nth state so that Y
                     
                        t
                     
                     =
                     X
                     
                        n
                      whenever U
                     
                        n
                     
                     ⩽
                     t
                     <
                     U
                     
                        n+1. Since Y is a Markov process, it is well-known that the sequence of states X
                     ={X
                     
                        n
                     ; n
                     =0, 1, 2, …} is a Markov chain with state space E and some transition matrix P
                     
                        ij
                     
                     =
                     P[X
                     
                        n+1
                     =
                     j∣X
                     
                        n
                     
                     =
                     i] with P
                     
                        ii
                     
                     =0 for all i,
                     j
                     ∈
                     E. Moreover, the duration of any state is exponentially distributed so that 
                        
                           P
                           [
                           
                              
                                 U
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           -
                           
                              
                                 U
                              
                              
                                 n
                              
                           
                           >
                           t
                           |
                           
                              
                                 X
                              
                              
                                 n
                              
                           
                           =
                           i
                           ]
                           =
                           
                              
                                 e
                              
                              
                                 -
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 t
                              
                           
                        
                      where ρ
                     
                        i
                      is the holding rate for state i. The transition rate matrix or generator of the Markov process Y is
                        
                           (6)
                           
                              
                                 
                                    G
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                j
                                                =
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                j
                                                
                                                ≠
                                                
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     or G
                     
                        ij
                     
                     =
                     ρ
                     
                        i
                     (P
                     
                        ij
                     
                     −
                     I
                     
                        ij
                     ) where I is the identity matrix.

Following Özekici and Soyer (2006), we define another process Y
                     
                        λ
                      such that
                        
                           (7)
                           
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                t
                                                <
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Δ
                                                ,
                                             
                                             
                                                if
                                                
                                                t
                                                ⩾
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where T
                     1 is the time of the first failure. While the process is in state i, the time to failure has the exponential distribution with rate λ
                     
                        i
                     . It is clear that Y
                     
                        λ
                      is also a Markov process on the extended state space E
                     
                        Δ
                     
                     =
                     E
                     ∪{Δ} and it is obtained by “stopping” the Markov process Y as soon as a failure occurs. Here, Δ is an absorbing state where the process is dumped to as soon as it is stopped. The transition matrix of the embedded Markov chain is now extended as
                        
                           (8)
                           
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                i
                                                ,
                                                j
                                                ∈
                                                E
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                i
                                                ∈
                                                E
                                                ,
                                                
                                                j
                                                =
                                                Δ
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                i
                                                ,
                                                j
                                                =
                                                Δ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and the transition rate vector is
                        
                           (9)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                i
                                                ∈
                                                E
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                i
                                                =
                                                Δ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

If we let the matrix 
                        
                           
                              
                                 G
                              
                              
                                 ij
                              
                              
                                 λ
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 i
                              
                              
                                 λ
                              
                           
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ij
                                       
                                       
                                          λ
                                       
                                    
                                    -
                                    
                                       
                                          I
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                           
                        
                      denote the generator of Y
                     
                        λ
                     , then it is well known that the transition function 
                        
                           
                              
                                 P
                              
                              
                                 ij
                              
                              
                                 λ
                              
                           
                           (
                           t
                           )
                           =
                           P
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                       
                                          λ
                                       
                                    
                                    =
                                    j
                                    |
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                       
                                          λ
                                       
                                    
                                    =
                                    i
                                 
                              
                           
                        
                      for all i,
                     j
                     ∈
                     E
                     
                        Δ
                      is given by the matrix-exponential solution
                        
                           (10)
                           
                              
                                 
                                    P
                                 
                                 
                                    λ
                                 
                              
                              (
                              t
                              )
                              =
                              exp
                              (
                              
                                 
                                    G
                                 
                                 
                                    λ
                                 
                              
                              t
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    n
                                    !
                                 
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    λ
                                 
                              
                              
                                 
                                    )
                                 
                                 
                                    n
                                 
                              
                           
                        
                     A further simplification is obtained by noting that
                        
                           (11)
                           
                              
                                 
                                    G
                                 
                                 
                                    ij
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    ij
                                 
                              
                              -
                              
                                 
                                    Λ
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     for all i,
                     j
                     ∈
                     E where Λ is a diagonal matrix defined as
                        
                           (12)
                           
                              
                                 
                                    Λ
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                j
                                                =
                                                i
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                j
                                                
                                                ≠
                                                
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Since 
                        
                           
                              
                                 G
                              
                              
                                 Δ
                                 j
                              
                              
                                 λ
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              
                                 G
                              
                              
                                 i
                                 Δ
                              
                              
                                 λ
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        
                      for all i
                     ∈
                     E and j
                     ∈
                     E
                     
                        Δ
                     , we can rewrite (10) as
                        
                           (13)
                           
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    λ
                                 
                              
                              (
                              t
                              )
                              =
                              exp
                              (
                              
                                 
                                    G
                                 
                                 
                                    λ
                                 
                              
                              t
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                              =
                              exp
                              (
                              (
                              G
                              -
                              Λ
                              )
                              t
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     for all i,
                     j
                     ∈
                     E.

Now, note that our construction of Y
                     
                        λ
                      implies
                        
                           (14)
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 inf
                              
                              
                                 
                                    
                                       t
                                       ⩾
                                       0
                                       ;
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                          
                                             λ
                                          
                                       
                                       =
                                       Δ
                                    
                                 
                              
                           
                        
                     and T
                     1 is the first-passage-time to the absorbing state Δ. So, it has a phase-type distribution and, in particular,
                        
                           (15)
                           
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              >
                              t
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              P
                              [
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                                 
                                    λ
                                 
                              
                              ∈
                              E
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    λ
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              exp
                              (
                              (
                              G
                              -
                              Λ
                              )
                              t
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     Note that in reliability applications where failures occur exponentially with a rate that depends on the randomly changing environmental process, (15) gives the survival function. In this case, the mean time to failure is another quantity of interest. Using the Markov property, it can be computed by solving the system of linear equations
                        
                           (16)
                           
                              E
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    λ
                                 
                              
                              E
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              j
                              ]
                           
                        
                     for i
                     ∈
                     E so that the explicit solution is
                        
                           (17)
                           
                              E
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              [
                              I
                              -
                              
                                 
                                    P
                                 
                                 
                                    λ
                                 
                              
                              
                                 
                                    ]
                                 
                                 
                                    ij
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   j
                                                
                                                
                                                   λ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Following Özekici and Soyer (2006) an ergodic analysis can also be developed. Suppose that both X and Y are ergodic processes with limiting distributions ν
                     
                        j
                     
                     =lim
                        n→+∞
                     P[X
                     
                        n
                     
                     =
                     j] and π
                     
                        j
                     
                     =lim
                        t→+∞
                     P[Y
                     
                        t
                     
                     =
                     j]. This implies that ν is the unique solution of ν
                     =
                     ν
                     P with the normalizing condition 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 E
                              
                           
                           
                              
                                 ν
                              
                              
                                 i
                              
                           
                           =
                           1
                        
                     . It can be shown that
                        
                           (18)
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          j
                                       
                                    
                                    /
                                    
                                       
                                          ρ
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          E
                                       
                                    
                                    (
                                    
                                       
                                          ν
                                       
                                       
                                          k
                                       
                                    
                                    /
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                     Using Theorem 1 of Özekici and Soyer (2006), we can obtain
                        
                           (19)
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       t
                                       →
                                       +
                                       ∞
                                    
                                 
                              
                              E
                              [
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                              t
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           (20)
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       t
                                       →
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    E
                                    [
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    |
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    i
                                    ]
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                           
                        
                     is the average failure rate. It follows from Fischer and Meier-Hellstern (1992) that the expected number of arrivals until time t is
                        
                           (21)
                           
                              E
                              [
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ]
                              =
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                              t
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              (
                              [
                              exp
                              (
                              Gt
                              )
                              -
                              I
                              ]
                              [
                              G
                              +
                              Π
                              
                                 
                                    ]
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                           
                        
                     where the matrix Π
                     
                        ij
                     
                     =
                     π
                     
                        j
                      has identical entries in each column.

Our primary objective is to develop statistical inference for the MMPP model using a Bayesian framework. It is important to note that in our model the Y process is latent and therefore in addition to the unknown parameters we also need to make inference about the latent states.

In this section, we will illustrate how we can estimate all the parameters as well as the latent states in the MMPP model. The approach is based on the Markov Chain Monte Carlo (MCMC) method given in Fearnhead and Sherlock (2006). This method is based on a Gibbs sampler and requires a three-stage process. We first introduce some notation that will be used in describing the three stages. We define the software failure rates as λ
                     ={λ
                     
                        i
                     ; i
                     ∈
                     E}, holding rates of the Y process as ρ
                     ={ρ
                     
                        i
                     ; i
                     ∈
                     E}, and transition probabilities as P
                     ={P
                     
                        ij
                     ; i,
                     j
                     ∈
                     E}. Since there are K states in E and P
                     
                        ii
                     
                     =0 the total number of parameters to be estimated is K
                     2. For example, when K
                     =3, the transition matrix for the three-state Markov chain is
                        
                           (22)
                           
                              P
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      12
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      31
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      32
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where the sum of the probabilities in each row is one. Therefore, we only need to estimate one probability in each row, say p
                     12, p
                     21 and p
                     31, when estimating P. We assume that the system is observed until some time t
                     
                        obs
                      and n failures are observed at times t
                     1, t
                     2, …, t
                     
                        n
                      during the observation interval [0, t
                     
                        obs
                     ].

In Stage 1, we will simulate the state of the hidden Markov process at each of the failure times given by our data set 
                        
                           D
                           =
                           {
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           }
                        
                     . Thus, all the results are conditional on the parameters λ, ρ and P. In Stage 2, we will simulate the entire hidden Markov process, and in Stage 3 we will simulate a new set of parameter values using the Gibbs sampler. In what follows, we will outline what each of the three stage involves.


                     Stage 1
                  

Since Y is a Markov process, the states 
                        
                           {
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           }
                        
                      at times 0=
                     t
                     0
                     ⩽
                     t
                     1
                     ⩽
                     t
                     2
                     ⩽⋯⩽
                     t
                     
                        n
                     
                     ⩽
                     t
                     
                        n+1
                     =
                     t
                     obs form a Markov chain with transition probabilities
                        
                           (23)
                           
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              P
                              [
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    S
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ]
                           
                        
                     during the kth interval with duration t
                     
                        k
                     
                     −
                     t
                     
                        k−1. It is well-known that T
                     (k) is the matrix exponential
                        
                           (24)
                           
                              
                                 
                                    T
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              exp
                              [
                              (
                              G
                              -
                              Λ
                              )
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    t
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              )
                              ]
                           
                        
                     
                  

We recursively define the matrices
                        
                           (25)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                T
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                T
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          Λ
                                          
                                             
                                                A
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     for k
                     =
                     n, n
                     −1, …, 1 giving us the likelihoods
                        
                           (26)
                           
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              P
                              [
                              {
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              }
                              ,
                              
                                 
                                    S
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              |
                              
                                 
                                    S
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ]
                           
                        
                     We first calculate {T
                     (k)} using (24), and then we calculate {A
                     (k)} using (25), starting with A
                     (n+1), and going backwards until we have
                        
                           (27)
                           
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              =
                              P
                              [
                              D
                              ,
                              
                                 
                                    S
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              |
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              ]
                           
                        
                     
                  

We will assume that we know S
                     0
                     =
                     s
                     0 and S
                     
                        n+1
                     =
                     s
                     
                        n+1, the states of the Markov process at times 0 and t
                     obs, respectively. If they are unknown then we can adjust this algorithm slightly by putting a prior distribution on the state of the process at these times, but in our example we will assume that these states are known. Then, the state S
                     
                        k
                      of the Markov chain at time t
                     
                        k
                      can be simulated using the conditional distributions
                        
                           (28)
                           
                              P
                              [
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                              =
                              s
                              |
                              D
                              ,
                              
                                 
                                    S
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                -
                                                1
                                                ,
                                                s
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                              
                           
                        
                     recursively by proceeding forwards through the observation times t
                     1, t
                     2, …, t
                     
                        n
                     .


                     Stage 2
                  

After completing Stage 1, we will have our simulated states of the hidden Markov process {S
                     
                        k
                     } at each of our observation times {t
                     
                        k
                     }. We will now use these to simulate the entire hidden Markov process Y. In so doing, we first simulate the process over the interval (t
                     0, t
                     1), then over (t
                     1, t
                     2) and so on until (t
                     
                        n
                     , t
                     
                        n+1). The simulation over each interval is done using the uniformization of the Markov process Y supposing that ρ
                     =max
                        i∈E
                     
                     ρ
                     
                        i
                      is finite. It is well-known (see, for example, Ross (1996)) that the Markov process Y can be represented as a Markov chain 
                        
                           
                              
                                 X
                              
                              
                                 ^
                              
                           
                        
                      subordinated to a Poisson process 
                        
                           
                              
                                 N
                              
                              
                                 ^
                              
                           
                        
                      with arrival rate ρ so that 
                        
                           
                              
                                 Y
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        
                      and
                        
                           (29)
                           
                              P
                              [
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              ]
                              =
                              P
                              [
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              P
                              [
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              n
                              ]
                              ×
                              P
                              [
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          -
                                          ρ
                                          t
                                       
                                    
                                    (
                                    ρ
                                    t
                                    
                                       
                                          )
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    n
                                    !
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                           
                        
                     where
                        
                           (30)
                           
                              M
                              =
                              
                                 
                                    1
                                 
                                 
                                    ρ
                                 
                              
                              G
                              +
                              I
                           
                        
                     is the transition matrix corresponding to the Markov chain 
                        
                           
                              
                                 X
                              
                              
                                 ^
                              
                           
                        
                     . Over any interval (t
                     
                        k−1, t
                     
                        k
                     ), we already obtained the simulated states 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       tk
                                    
                                 
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        
                      in Stage 1. Therefore, the conditional distribution of the number failures of 
                        
                           
                              
                                 N
                              
                              
                                 ^
                              
                           
                        
                      during (t
                     
                        k−1, t
                     
                        k
                     ) is
                        
                           (31)
                           
                              P
                              [
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                              
                              =
                              n
                              |
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          tk
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   -
                                                   ρ
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             n
                                             !
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    exp
                                    [
                                    G
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          ]
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     since
                        
                           (32)
                           
                              P
                              [
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ]
                              =
                              exp
                              [
                              G
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    t
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              )
                              
                                 
                                    ]
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                     Therefore, the number of failures 
                        
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           -
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                           
                        
                      can be simulated using (31). If simulation yields 
                        
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           -
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                           
                           =
                           r
                        
                     , then the r arrival times 
                        
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 r
                              
                           
                        
                      of 
                        
                           
                              
                                 N
                              
                              
                                 ^
                              
                           
                        
                      over the interval (t
                     
                        k−1, t
                     
                        k
                     ) are simulated by generating r uniform variates over (t
                     
                        k−1, t
                     
                        k
                     ) and ordering them. Now, we know that 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        
                      and the states of hidden Markov process at 
                        
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ⩽
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                           ⩽
                           ⋯
                           ⩽
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 r
                              
                           
                        
                      are simulated recursively by using the conditional distributions
                        
                           (33)
                           
                              P
                              [
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              =
                              s
                              |
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          j
                                          -
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                                -
                                                1
                                                ,
                                             
                                          
                                          s
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          s
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                          -
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                                -
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                          -
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     for j
                     =1, 2, …, r. For j
                     =1, one should set 
                        
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                                 -
                                 1
                              
                           
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                                 -
                                 1
                              
                           
                           =
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                     . It also follows from the conditional distribution (33) that 
                        
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        
                      at the last time point when j
                     =
                     r since M
                     0 is the identity matrix.


                     Stage 3
                  

Having completed Stages 1 and 2, we should now have the entire simulated hidden Markov process, as well as our data, the observed times of the failures. Let 
                        
                           F
                           =
                           {
                           
                              
                                 Y
                              
                              
                                 t
                              
                           
                           ;
                           0
                           ⩽
                           t
                           ⩽
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           }
                        
                      denote the environmental process generated using the procedure in Stage 2. Thus, we can write the conditional likelihood function of the parameters and then obtain the full conditionals to generate a new set of values for our parameters at each step of the Gibbs sampler. Let τ
                     
                        i
                      be the total time that the hidden Markov process spends in state i, let n
                     
                        i
                      be the total number of failures that occur while the process is in state i, and let r
                     
                        ij
                      be the number of times the process makes a transition from state i to state j. It is clear that τ
                     
                        i
                     , n
                     
                        i
                     , and r
                     
                        ij
                      are in 
                        
                           F
                        
                      for all i,
                     j
                     ∈
                     E. Given data 
                        
                           D
                        
                      and the entire history 
                        
                           F
                        
                      of the Markov process, the conditional likelihood function of the parameters ρ
                     
                        i
                     ’s, λ
                     
                        i
                     ’s and P
                     
                        ij
                     ’s is given by
                        
                           (34)
                           
                              L
                              (
                              ρ
                              ,
                              λ
                              ,
                              P
                              ;
                              F
                              ,
                              D
                              )
                              ∝
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             E
                                          
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              exp
                              (
                              -
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              exp
                              (
                              -
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                           
                        
                     
                  

Assuming conjugate independent priors for the unknown parameters the full conditional distributions can be easily obtained. More specifically, for a given state i
                     =1, …, K, we assume independent gamma priors for ρ
                     
                        i
                     ’s and λ
                     
                        i
                     ’s, denoted as 
                        
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           ∼
                           G
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                       
                                          ρ
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          ρ
                                       
                                    
                                 
                              
                           
                        
                     , and 
                        
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           ∼
                           G
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                       
                                          λ
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                           
                        
                     , respectively. For the i-th row of the transition matrix P, we assume a Dirichlet prior, independent of the other rows, as 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ∼
                           D
                           ir
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 iK
                              
                           
                           )
                        
                      where P
                     
                        i
                     
                     =(P
                     
                        i1, …, P
                     
                        iK
                     ). Note that in P
                     
                        i
                      we have P
                     
                        ii
                     
                     =0 and the corresponding parameter α
                     
                        ii
                     
                     =0. Using standard Bayesian results we can show that given the full history of the hidden Markov process, the full conditional distributions of the parameters can be obtained as
                        
                           (35)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    -
                                    i
                                 
                              
                              ∼
                              G
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                          
                                             ρ
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                E
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                          
                                             ρ
                                          
                                       
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                              and
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                                 
                                    -
                                    i
                                 
                              
                              ∼
                              G
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                          
                                             λ
                                          
                                       
                                       +
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                          
                                             λ
                                          
                                       
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (36)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    -
                                    i
                                 
                              
                              ∼
                              D
                              ir
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                    1
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    α
                                 
                                 
                                    iK
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    iK
                                 
                              
                              )
                           
                        
                     where α
                     
                        ii
                     
                     =
                     r
                     
                        ii
                     
                     =0.

We then generate new values for these parameters from their posterior distributions and then repeat the whole process again, starting with Stage 1.

Our analysis in Section 3 assumed that the number of states K in the hidden Markov process was known. However, in general, the actual number of states may be unknown. Thus, it is important to be able to determine the number of states. The problem of determining K can be considered as a model selection problem in the Bayesian approach where the model choice is made using Bayes factors; see Kass and Raftery (1995) for a review. The computation of the Bayes factors requires the evaluation of marginal likelihood for a given model, that is, for given value of K in our case. More specifically, if we let 
                        
                           D
                           =
                           {
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           }
                        
                      denote our observed data, we want to obtain the marginal likelihood 
                        
                           p
                           (
                           D
                           |
                           K
                           )
                        
                     . The model with the highest value of 
                        
                           p
                           (
                           D
                           |
                           K
                           )
                        
                      is the one most supported by the data and this can be used as the criterion for determining the value of K. Alternatively, assuming a support for K and specifying prior probabilities P[K
                     =
                     k] for different models such that 
                        
                           
                              
                                 ∑
                              
                              
                                 k
                              
                           
                           P
                           [
                           K
                           =
                           k
                           ]
                           =
                           1
                        
                      we can obtain posterior model probabilities 
                        
                           P
                           [
                           K
                           =
                           k
                           |
                           D
                           ]
                        
                      using the marginal likelihood.

Evaluation of the marginal likelihood 
                        
                           p
                           (
                           D
                           |
                           K
                           )
                        
                      analytically is not possible in many problems since it requires integrating out the unknown parameters. Since draws from prior distributions of the parameters result in unstable estimation, it is more desirable to use Monte Carlo samples from the posterior distributions to evaluate 
                        
                           p
                           (
                           D
                           |
                           K
                           )
                        
                     . Although this is not straightforward in many cases, when the full posterior conditional distributions are known forms, the marginal likelihood terms can be approximated using the approach proposed by Chib (1995). Since the Bayesian analysis of the MMPP in Section 3 is based on known full conditionals, we can adopt Chib’s procedure to our problem as will be discussed in the sequel.

In our case, the marginal likelihood for a specific model with dimension K is given by
                        
                           (37)
                           
                              p
                              (
                              D
                              )
                              =
                              
                                 
                                    p
                                    (
                                    D
                                    |
                                    ρ
                                    ,
                                    λ
                                    ,
                                    P
                                    ,
                                    F
                                    )
                                    
                                    p
                                    (
                                    ρ
                                    ,
                                    λ
                                    ,
                                    P
                                    ,
                                    F
                                    )
                                 
                                 
                                    p
                                    (
                                    ρ
                                    ,
                                    λ
                                    ,
                                    P
                                    ,
                                    F
                                    |
                                    D
                                    )
                                 
                              
                           
                        
                     where ρ and λ are K-dimensional vectors of ρ
                     
                        i
                     ’s and λ
                     
                        i
                     ’s and P is the transition probability matrix of dimension K with zeros on the diagonal. We can rewrite (37) as
                        
                           (38)
                           
                              p
                              (
                              D
                              )
                              =
                              
                                 
                                    p
                                    (
                                    D
                                    |
                                    ρ
                                    ,
                                    λ
                                    ,
                                    P
                                    ,
                                    F
                                    )
                                    
                                    p
                                    (
                                    F
                                    |
                                    ρ
                                    ,
                                    P
                                    )
                                    p
                                    (
                                    ρ
                                    ,
                                    λ
                                    )
                                    p
                                    (
                                    P
                                    )
                                 
                                 
                                    p
                                    (
                                    ρ
                                    ,
                                    λ
                                    ,
                                    P
                                    |
                                    F
                                    ,
                                    D
                                    )
                                    p
                                    (
                                    F
                                    |
                                    D
                                    )
                                 
                              
                           
                        
                     Eq. (38) holds for any values of 
                        
                           (
                           ρ
                           ,
                           λ
                           ,
                           P
                           ,
                           F
                           )
                        
                      such as 
                        
                           (
                           
                              
                                 ρ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           )
                        
                      which is typically chosen as the mean or mode values of the posterior distributions. We note that all the terms in the numerator are available to us analytically and therefore can be evaluated at 
                        
                           (
                           
                              
                                 ρ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           )
                        
                     . The tricky part to evaluate is the denominator term
                        
                           (39)
                           
                              p
                              (
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              |
                              D
                              )
                              =
                              ∫
                              p
                              (
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              |
                              D
                              ,
                              λ
                              ,
                              ρ
                              ,
                              P
                              )
                              p
                              (
                              λ
                              ,
                              ρ
                              ,
                              P
                              |
                              D
                              )
                              d
                              (
                              λ
                              ,
                              ρ
                              ,
                              P
                              )
                           
                        
                     which can be evaluated using G samples from the posterior distribution 
                        
                           p
                           (
                           λ
                           ,
                           ρ
                           ,
                           P
                           |
                           D
                           )
                        
                      via
                        
                           (40)
                           
                              p
                              (
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              |
                              D
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       g
                                    
                                 
                              
                              p
                              (
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              |
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              ,
                              D
                              )
                           
                        
                     The first term 
                        
                           p
                           (
                           
                              
                                 ρ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 ∗
                              
                           
                           |
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           ,
                           D
                           )
                        
                      can easily be written down as
                        
                           (41)
                           
                              p
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ∗
                                 
                              
                              |
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              D
                              )
                              =
                              p
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    ∗
                                 
                              
                              |
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              D
                              )
                              p
                              (
                              
                                 
                                    λ
                                 
                                 
                                    ∗
                                 
                              
                              |
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              D
                              )
                              p
                              (
                              
                                 
                                    P
                                 
                                 
                                    ∗
                                 
                              
                              |
                              
                                 
                                    F
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              D
                              )
                           
                        
                     where 
                        
                           p
                           (
                           
                              
                                 ρ
                              
                              
                                 ∗
                              
                           
                           |
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           ,
                           D
                           )
                        
                      and 
                        
                           p
                           (
                           
                              
                                 λ
                              
                              
                                 ∗
                              
                           
                           |
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           ,
                           D
                           )
                        
                      are obtained as the product of gamma densities given by (35) and 
                        
                           p
                           (
                           
                              
                                 P
                              
                              
                                 ∗
                              
                           
                           |
                           
                              
                                 F
                              
                              
                                 ∗
                              
                           
                           ,
                           D
                           )
                        
                      is the product of the Dirichlet densities in (36). Thus, for each value of K, we can approximate (38) and determine the model with the highest support of the data. As previously mentioned, using the marginal likelihood we can also compute posterior model probabilities 
                        
                           P
                           [
                           K
                           =
                           k
                           |
                           D
                           ]
                        
                      to infer the value of K.

In this section we consider Musa’s System I data (see for example, Singpurwalla and Soyer (1992)) to illustrate our model and to discuss what type of additional insights can be obtained from the MMPP model. The data was observed over a period of t
                     obs
                     =90,000 units, and n
                     =136 failures were observed during this time. A plot of the time between failures is shown in Fig. 1
                      below.

The failure times will be labeled t
                     1, …, t
                     136. All the numbers from Musa’s System I data have been divided by 1000. We also set t
                     0
                     =0 and t
                     
                        n+1
                     =
                     t
                     137
                     =
                     t
                     obs
                     =90. So the data we are using is t
                     0
                     =0, t
                     1
                     =0.003, …, t
                     136
                     =88.682, t
                     137
                     =90. In our analysis, we will use the standard homogeneous Poisson process model as a benchmark to assess the performance of the MMPP model. Note that the marginal likelihood for the homogeneous Poisson process can be easily obtained as a negative binomial model by using the conjugate gamma prior for failure rate λ.

In our development we will present results from the analysis of the two-state MMPP. Note that in this case the transition matrix for the embedded Markov chain of the environmental process is given by
                        
                           (42)
                           
                              P
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and therefore we only need inference on parameters ρ
                     1, ρ
                     2, λ
                     1, and λ
                     2, as well as on latent states s
                     1, …, s
                     
                        n
                     . In our analysis we use diffused but proper priors for these parameters by setting 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                              
                                 λ
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 i
                              
                              
                                 λ
                              
                           
                           =
                           0.01
                        
                      for i
                     =1, 2. Similarly, we use 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                              
                                 ρ
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 i
                              
                              
                                 ρ
                              
                           
                           =
                           0.01
                        
                      for the priors of ρ
                     1 and ρ
                     2. After a small burn-in sample, we collected 1000 simulations to obtain the posterior distributions for our four parameters. We have not witnessed any convergence problems in running the Gibbs sampler. Trace plots for posterior samples from the distributions of λ
                     1, and λ
                     2 are shown in Figs. 2 and 3
                     
                     .

The posterior distributions of λ
                     1 and λ
                     2 that are shown in Figs. 4 and 5
                     
                      imply that the failure rate in state 1 is higher than the failure rate in state 2. The posterior distribution of the holding rate ρ
                     1 in state 1 is given in Fig. 6
                     . The posterior mean of ρ
                     1 is 0.0532 implying that the expected holding time in state 1 is about 18.795 time units. Our analysis has shown that state 2 is acting like an absorbing state, that is, expected holding time is infinite. Similarly, when we look at the posterior distributions of the long-run probabilities π
                     1 and π
                     2 of (18), we can see that the posterior expected values for π
                     1 and π
                     2 are 0.997 and 0.003, respectively. We can also infer this behavior by looking at the posterior distributions of the states at the failure times t
                     
                        i
                     ’s of the software.


                     Table 1
                      shows the posterior mean values of the states at each failure time. These values seem to suggest that the hidden Markov process remains in state 1 approximately until between t
                     78 and t
                     79. Looking at the data, we can see that t
                     78
                     =18.728 and t
                     79
                     =19.556. Comparing this to the posterior distribution of ρ
                     1, the mean of this distribution is 0.0532, which means that the expected holding time in state 1 before changing to state 2 is 1/0.0532=18.795, which also seems to suggest that, on average, the hidden Markov process remains in state 1 until between the 78th and 79th failure. Our simulated posterior density of ρ
                     2 is of no use to us at all. It basically just looks like a point mass at some number very close to zero. Thus, once the environmental process enters state 2 it stays there forever. This implies that during the debugging process the reliability improvement in the software is initially limited as reflected by shorter failure times and the higher failure rate λ
                     1. As the debugging process continues to later periods, failure rate decreases and the time between failures get larger. Thus, based on this we can conclude that as a result of the debugging process reliability of the software has improved. Fig. 7
                      shows both the data and the posterior means of the states of the hidden Markov process on the same graph.

Furhermore, using the posterior samples of parameters (ρ, λ) we can obtain the posterior predictive reliability using (15). We note that (15) is a function of (ρ, λ) and therefore we need to evaluate the integral
                        
                           (43)
                           
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              >
                              t
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ,
                              D
                              ]
                              =
                              ∫
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              >
                              t
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ,
                              ρ
                              ,
                              λ
                              ]
                              
                              p
                              (
                              ρ
                              ,
                              λ
                              |
                              D
                              )
                              =
                              ∫
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              exp
                              (
                              (
                              G
                              -
                              Λ
                              )
                              t
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                              
                              p
                              (
                              ρ
                              ,
                              λ
                              |
                              D
                              )
                              
                              d
                              ρ
                              
                              d
                              λ
                           
                        
                     
                  

The above can be approximated by the Monte Carlo average
                        
                           (44)
                           
                              P
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              >
                              t
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ,
                              D
                              ]
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              exp
                              (
                              (
                              
                                 
                                    G
                                 
                                 
                                    s
                                 
                              
                              -
                              
                                 
                                    Λ
                                 
                                 
                                    s
                                 
                              
                              )
                              t
                              
                                 
                                    )
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     using posterior samples 
                        
                           {
                           ρ
                           ,
                           λ
                           
                              
                                 }
                              
                              
                                 s
                                 =
                                 1
                              
                              
                                 S
                              
                           
                        
                      from 
                        
                           p
                           (
                           ρ
                           ,
                           λ
                           |
                           D
                           )
                        
                     . In Figs. 8 and 9
                     
                      we present the posterior predictive reliability functions for Y
                     0
                     =1 and Y
                     0
                     =2, respectively. Since environmental state 1 has a higher failure rate, if testing starts in state 1, then the posterior predictive reliability goes to 0 around t
                     =2000 time units. On the other hand, if the initial state is state 2, the reliability reaches to 0 around 6000 time units.

We can reach the same conclusion by computing the posterior expected time to failure (17). Again we note that (17) is a function of unknown parameters and it can be approximated as a Monte Carlo average given by
                        
                           (45)
                           
                              E
                              [
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    0
                                 
                              
                              =
                              i
                              ,
                              D
                              ]
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       E
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          [
                                          I
                                          -
                                          
                                             
                                                P
                                             
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                ]
                                             
                                             
                                                ij
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      λ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                           
                        
                     using posterior samples 
                        
                           {
                           ρ
                           ,
                           λ
                           
                              
                                 }
                              
                              
                                 s
                                 =
                                 1
                              
                              
                                 S
                              
                           
                        
                      from 
                        
                           p
                           (
                           ρ
                           ,
                           λ
                           |
                           D
                           )
                        
                     . Note that P
                     
                        λ
                      is given by (8) which also depends on P and therefore in general one needs to use the posterior samples of P to evaluate (45). But since P is known for the two dimensional case, we do not need it in our calculations. It can be shown that the posterior expected time to failure can be obtained as 
                        
                           E
                           [
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                           |
                           
                              
                                 Y
                              
                              
                                 0
                              
                           
                           =
                           1
                           ,
                           D
                           ]
                           =
                           0.83
                        
                      and 
                        
                           E
                           [
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                           |
                           
                              
                                 Y
                              
                              
                                 0
                              
                           
                           =
                           2
                           ,
                           D
                           ]
                           =
                           4.15
                        
                      when testing starts at states 1 and 2, respectively.

We have repeated a similar analysis for the MMPP with K
                     =3 states. Finally, we computed the marginal likelihoods using the approach introduced in Section 4. The comparison of the marginal likelihoods indicate that the model with K
                     =2 is preferred over the others.

In this paper we introduced a Markov modulated Poisson process to describe the failure of a software that goes through a debugging process. The model can capture imperfect debugging and allows us to make inferences about the performance of the debugging process at each stage of testing. We presented a Bayesian analysis of the model and illustrated how Bayesian inferences can be made about reliability of the software. Furthermore, we introduced an approach to assess the dimension of the hidden Markov process of the model by using the marginal likelihood. In doing so, we showed how the marginal likelihood can be computed using the approach proposed by Chib (1995). We illustrated the implementation of our approach using actual software failure data and discussed the additional insights that can be obtained from our model.

@&#REFERENCES@&#

