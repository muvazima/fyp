@&#MAIN-TITLE@&#A kinetic model-based algorithm to classify NGS short reads by their allele origin

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We implemented a new algorithm to cluster NGS reads based on allele origin which relies on distance geometry approach.


                        
                        
                           
                           The algorithm is a new type of clustering methods.


                        
                        
                           
                           The algorithm allows to genotype genomic variants without any prior assumption.


                        
                        
                           
                           We tested the algorithm on 1000 genome project data.


                        
                        
                           
                           The algorithm can be used for other studies, such as to assemble genomic haplotype.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Sequencing

Allele

Genotyping

Cluster

Reads

Variants

@&#ABSTRACT@&#


               
               
                  Genotyping Next Generation Sequencing (NGS) data of a diploid genome aims to assign the zygosity of identified variants through comparison with a reference genome. Current methods typically employ probabilistic models that rely on the pileup of bases at each locus and on a priori knowledge.
                  We present a new algorithm, called Kimimila (KInetic Modeling based on InforMation theory to Infer Labels of Alleles), which is able to assign reads to alleles by using a distance geometry approach and to infer the variant genotypes accurately, without any kind of assumption. The performance of the model has been assessed on simulated and real data of the 1000 Genomes Project and the results have been compared with several commonly used genotyping methods, i.e., GATK, Samtools, VarScan, FreeBayes and Atlas2. Despite our algorithm does not make use of a priori knowledge, the percentage of correctly genotyped variants is comparable to these algorithms. Furthermore, our method allows the user to split the reads pool depending on the inferred allele origin.
               
            

@&#INTRODUCTION@&#

Since the first release of the human genome consensus sequence, the impact of next generation sequencing (NGS) technologies is getting every day stronger and it is rewriting the rules of genomic research.

Current high-throughput DNA sequencing technologies can generate billions of short sequences (reads) whose length range from 50 to 400 bases.

Once available, these reads are mapped onto their corresponding reference genome to extract useful genomic information as known and/or novel variants. However, while the human genome sequence assembly for a chromosome is an arbitrary mix of the two haploid chromosomes, the DNA fragment library is usually derived from a diploid genome. This requires determining the zygosity of each variant detected by the variant calling process: genotype calling is aimed at classifying these variants as heterozygous or homozygous.

Several genotyping methods have been proposed both for human and non-human genomes [1–4]. Early methods rely on counting the number of times each allele of a single genomic locus (pileup) is observed. For example, VarScan [5] is based on an heuristic method that uses the number of aligned reads supporting each allele.

The most recent methods are often based on a probabilistic framework. Tools such as GATK UnifiedGenotyper (UG) [2] or Samtools [3] compute a genotype likelihood p(D|G) for each genotype G, where D represents all the read data for an individual at a particular site.

These genotype likelihoods incorporate errors that may have been introduced in base calling, alignment and assembly and are coupled with prior information, such as allele frequencies in a reference population (e.g. The 1000 Genome Project [6]) or databases of polymorphisms (e.g. dbSNP [7]). The genotype with the highest posterior probability is chosen and it is associated with a measure of uncertainty.

Another recent method, Atlas2 [8] is based on a logistic regression model trained on validated whole-exome capture sequencing and uses features such as the ratio of the variant base to the reference sequence and the quality scores of the base calls in order to discriminate between true variants and sequencing, mapping, or alignment errors.

These strategies rely on the single base pileup information derived from the aligned reads and are based on the assumption of variant locus and reads independence.

Haplotype-based methods are based on a different genotyping strategy. They make use of short haplotypes directly inferred from sequencing reads mapped to the reference. FreeBayes [9] is an algorithm that uses haplotype informative reads (i.e. reads spanning two or more variants) in combination with a Bayesian statistical method [10] to improve genotyping accuracy.

Due to the promise of third generation sequencing technologies to increase reads length up to thousands of sequenced bases [11], we can expect haplotype-based methods to increase their accuracy and importance as well.

In this scenario, we have developed a new algorithm, called Kimimila (KInetic Modeling based on InforMation theory to Infer Labels of Alleles), that exploits a kinetic model approach relying on distance geometry. Kimimila, starting from a set of variant loci, infers the allele origin of each overlapping read by looking at reads similarity in terms of a non-euclidean distance and, as a consequence, can infer the zygosity of a variant through reads rather than through the single base pileup.

Notably, our approach has been conceived to be fully data-driven. Therefore, it does not make use of a priori information and it does not rely on a statistical model. Furthermore, this algorithm provides a novel methodological contribution able to perform clustering with a non-euclidean metric.

We run Kimimila on simulated data to evaluate the accuracy in classifying (or labeling) reads by the origin allele and on a sample of the 1000 Genomes Project in order to evaluate the genotyping and reads labeling accuracy as well, by using the relative genotype-chip data as validation set. We compared our algorithm with several genotyping algorithms, namely GATK UG, VarScan, Samtools, Atlas2 and FreeBayes, and we found that the percentage of correctly genotyped variants was comparable to the aforementioned tools. Furthermore, our method allowed the user to split the reads pool depending on the inferred allele origin. Such results can be further used for other interesting applications, such as haplotype reconstruction and to detect subclonal heterogeneity in tumor samples.

@&#METHODS@&#

Labeling reads in NGS can be easily seen as a clustering problem. Standard clustering methods are typically based on some sort of Euclidean distance among the reads. Since mutation calling and base estimation are affected by noise and uncertain sequencing, the distance computation must take into account the reliability and the quality of the processed signals.

In this paper we propose a new definition of the similarity metric able to cope with all these issues and to reach the desired clustering performance. It is worth noting that, in order to leverage the stress on the computational complexity, in this paper the bases that are considered are provided by the variant calling algorithm. The availability of a reliable variant calling algorithm is therefore assumed.

The next subsection reports the notations and definitions that are used throughout the paper.

Reliability can be identified as the likelihood of the given base over the whole dataset in a given locus. Therefore, let M(i) be the set of the reads that map on the ith base of the dataset and |M(i)| the number of such reads. Let α(ti
                        )=
                        αi
                         be the nucleotide base that read α exhibits at the ith position of the dataset, being α
                        ∊
                        M(i). For sake of simplicity, let us assume that each nucleotide base is univocally mapped onto a natural integer in the set {1,2,3,4}. Then, the aforesaid likelihood associated with the base at the ith position for read α, 
                           
                              
                                 
                                    m
                                 
                                 
                                    α
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         is defined as the fraction of reads in M(i) that show the same base αi
                         in the same position, i.e., 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          M
                                          (
                                          i
                                          )
                                       
                                    
                                    χ
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    |
                                    M
                                    (
                                    i
                                    )
                                    |
                                 
                              
                           
                        , where χ(⋅) is the indicator function. In other terms, 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         measures the reliability (i.e., the probability of “noiseless” calls) of a given base for each read.

Furthermore, let 
                           
                              
                                 
                                    φ
                                 
                                 
                                    α
                                 
                                 
                                    b
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    φ
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                         be the quality of the base b over read α in the ith position as provided by the base caller. Then, 
                           
                              
                                 
                                    φ
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                         can be written as a function of the probability of a base calling error for b (Pwrong
                        (αi
                        ,
                        b)) set by the base caller, i.e. 
                           
                              
                                 
                                    φ
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                              =
                              -
                              10
                              
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              [
                              
                                 
                                    P
                                 
                                 
                                    wrong
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ,
                              b
                              )
                              ]
                              ,
                           
                         that is the quality score value given by the base caller in Phred scale [12]. Then, let us set 
                           
                              
                                 
                                    v
                                 
                                 
                                    α
                                 
                                 
                                    b
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                              =
                              1
                              -
                              
                                 
                                    P
                                 
                                 
                                    wrong
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ,
                              b
                              )
                           
                        . The quantity 
                           
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                         is a function of the quality of the given DNA base in the given read and it measures the likelihood (i.e., the probability of a correct call) of a given base for each read. By computing 
                           
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                         for each b, it is possible to arrange a vector 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    α
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          b
                                       
                                    
                                    ]
                                 
                                 
                                    b
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    4
                                    }
                                 
                              
                           
                        .

Indeed, inferring allele labels over reads can be strongly affected by misalignment and error in base estimation algorithms, i.e., by the reliability and the quality of the information provided by the considered dataset. Hence, according to the aforementioned definitions, we can derive a properly designed distance geometry-based approach to improve the labeling method. The next subsection introduces the distance geometry-based approach.

A reasonable metric to jointly consider the reliability and the quality of the given read over the given position is represented by the product of 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                        . Therefore, in order to compute the distance dαβ
                         between two reads α and β in the set M(i), we propose to use the following formula:
                           
                              (1)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          
                                             
                                                Δ
                                             
                                             
                                                α
                                                β
                                             
                                          
                                       
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             α
                                          
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             β
                                          
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 |
                                 |
                              
                           
                        where Δαβ
                         is the overlap interval between the compared reads and 
                           lτ
                           
                        (ti
                        )=
                        mτ
                        (ti
                        )
                           vτ
                           
                        (ti
                        ). It is important to note that the aforementioned definition of dαβ
                         highlights the difference in variant calls among the reads, weighted according to their reliability degree.

A physics-based interpretation of such quantities is to assume them as the result of a kinetic process in the four dimensional space determined by the nucleotides bases. Specifically, each read can be seen as a time record of the movements of a particle over a given period. Each particle is characterized at each sampling time (ti
                        ) by its mass (
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ) as well as by its velocity (
                           
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    b
                                 
                              
                           
                        ) in each direction [13]. Furthermore, each particle at each time sample changes its mass and velocity as a result of an unknown collision. Thus, the global linear momentum of this hypothetical particle over a time interval Δη
                         is:
                           
                              (2)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Δ
                                             
                                             
                                                η
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             η
                                          
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Δ
                                             
                                             
                                                η
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             η
                                          
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             η
                                          
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                        This quantity depends on the reliability and the quality of the information provided by the dataset that has been taken into account. Hence, the distance dαβ
                         between two reads α and β is defined as the difference of their linear momenta over the “time interval” (i.e. the genome region) in which they overlap.

The basic idea of our method is to label the ith base of the data set with a strategy that relies on the distances dαβ
                         computed between all the reads of the set M(i). The quantity dαβ
                         can be actually considered as a distance since dαβ
                        
                        ⩾0 and dαβ
                        
                        =
                        dβα
                        . However, since the couples of reads typically have distinct supports (i.e., overlap on different intervals which can be affected by dissimilar kind of noise and mutations), the triangle inequality might not hold. Therefore, from our definition, the distance among the read set is non-Euclidean [14]. Supplementary Section 2 reports an example of this case.

Let us now consider the reads α and β that are the points at maximum distance (i.e., dαβ
                        
                        =
                        dmax
                        ), such as the ones in Fig. 1
                        . In this case we can cluster the other reads on the basis of their similarity with either α or β. Comparisons using Euclidean distances basically rely on the paradigm that states that the probability of a given point γ of the set to belong to the cluster identified by β is a function of the ratio dγβ
                        /dmax
                        . Unfortunately, when the distance metric is non-Euclidean, this ratio can lead to inaccurate clustering performance, which may lead to wrong assignments. Therefore, it is necessary to set up a scheme that allows overcoming this issue.

Then, let us take another look to Fig. 1. Introducing a point (O) outside the space spanned by α,
                        β and γ we can collect more information to get to a stable and reliable clustering metric.

The use of point O allows considering triangles instead of distances and in general correspond to the use of the so-called “distance geometry” [15], which works on non-coordinate systems, delivering excellent performance in clustering and classification.

Specifically, it is possible to think that the similarity metric is a function of the areas induced by the triangles composed by O, γ and one between α and β (i.e., VαγO
                         and VβγO
                         in Fig. 1, which are the green and orange areas, respectively). In other terms, the angles 
                           
                              β
                              
                                 
                                    O
                                 
                                 
                                    ^
                                 
                              
                              γ
                           
                         and 
                           
                              α
                              
                                 
                                    O
                                 
                                 
                                    ^
                                 
                              
                              γ
                           
                         may replace the distances dαγ
                         and dβγ
                         and play a key-role in the definition of the similarity score.

The identification of the similarity metric as a function of the aforesaid areas implicitly relies on the simplicial decomposition paradigm, for which each point in a given simplex can be seen as a combination of its vertices [16]. In our case the simplex is a triangle (3-simplex), so that any point (i.e. read) γ lying within the triangle αOβ can be written as a linear combination of the three vertices as long as such triangle contains them all, i.e. each read γ can be written as
                           
                              (3)
                              
                                 γ
                                 =
                                 
                                    
                                       ζ
                                    
                                    
                                       α
                                    
                                 
                                 α
                                 +
                                 
                                    
                                       ζ
                                    
                                    
                                       β
                                    
                                 
                                 β
                                 +
                                 
                                    
                                       ζ
                                    
                                    
                                       o
                                    
                                 
                                 O
                              
                           
                        
                        
                           
                              
                                 where
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       α
                                    
                                 
                                 +
                                 
                                    
                                       ζ
                                    
                                    
                                       β
                                    
                                 
                                 +
                                 
                                    
                                       ζ
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                        The weights (or abundances in the distance geometry literature) identify a reliable set of similarity metrics, so that if ζα
                        
                        >
                        ζβ
                         the read γ can be clustered to α and viceversa. For this reason, O must be defined as the point that together with α and β spans the largest simplex. Specifically, the distances dαO
                         and dβO
                         have to been set in order to fulfill this condition. Supplementary Section 3 provides the motivations and the actual setting for the aforesaid distances. Further, the next subsection introduces the proposed distance geometry-based labeling scheme.

As previously mentioned, the angles in the triangle αOβ can play a key-role in read labeling. Specifically, the angle 
                           
                              α
                              
                                 
                                    O
                                 
                                 
                                    ^
                                 
                              
                              β
                              =
                              Γ
                           
                         can be used to discriminate the maximum distance reads. According to Carnot’s theorem, it is possible to draw an upper bound and a lower bound for Γ. Supplementary Section 3 provide a detailed description of their derivation. Briefly, we set the maximum value of Γ to Γ
                        max
                        =60°, whilst its minimum value Γ
                        min can be derived by the following equation:
                           
                              (4)
                              
                                 cos
                                 
                                    
                                       Γ
                                    
                                    
                                       min
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       |
                                       
                                          
                                             Δ
                                          
                                          
                                             α
                                             β
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        Thus, if Γ
                        <
                        Γ
                        min, there is no reliable separation between the maximum distance reads, so that all the reads under analysis can be labeled uniformly. This implies that the two alleles are homologous or that only one allele has been processed.

Thus, let two reads α and β be the points at maximum distance, as in Fig. 1. Then, the likelihood L(γ
                        ∼
                        α) that a given read γ belongs to the allele represented by read α is:
                           
                              (5)
                              
                                 L
                                 (
                                 γ
                                 ∼
                                 α
                                 )
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             α
                                             γ
                                             O
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             α
                                             γ
                                             O
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             V
                                          
                                          
                                             β
                                             γ
                                             O
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    V
                                 
                                 
                                    ABC
                                 
                                 
                                    2
                                 
                              
                           
                         identifies the squared area of the triangle defined by vertices A, B, and C. Computing this area requires to first compute the matrix of the distances
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ABC
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         AB
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         AC
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         AB
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         BC
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         AC
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         BC
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 Then
                                 
                                 
                                 
                                    
                                       V
                                    
                                    
                                       ABC
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 -
                                 16
                                 det
                                 (
                                 
                                    
                                       CM
                                    
                                    
                                       ABC
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 where
                                 
                                 
                                    
                                       CM
                                    
                                    
                                       ABC
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         ABC
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 (
                                 see additional material for details
                                 )
                                 .
                              
                           
                        It is important to note that the computed likelihoods must be normalized to the sum 
                           
                              
                                 
                                    V
                                 
                                 
                                    α
                                    γ
                                    O
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    β
                                    γ
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         in order to fulfill the sum-to-one constraint, i.e., to make L(γ
                        ∼
                        α)+
                        L(γ
                        ∼
                        β)=1. L(γ
                        ∼
                        α) and L(γ
                        ∼
                        β) are proportional to the weights ζα
                        ,
                        ζβ
                         (see Eq. (3)) and can be then used to cluster γ with α or β.

Taking into account the process that has been introduced in the previous subsections, it is possible to efficiently perform genotyping of NGS reads by properly managing the outcomes of the distance geometry approach, summarized by the flowchart of Fig. 2
                        .

The first step of the algorithm involves applying Eq. (4). The ith mutation is called as homozygous if the following property holds:
                           
                              
                                 α
                                 
                                    
                                       O
                                    
                                    
                                       ^
                                    
                                 
                                 β
                                 <
                                 
                                    
                                       Γ
                                    
                                    
                                       min
                                    
                                 
                                 =
                                 arcos
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                |
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      α
                                                      β
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Otherwise, genotyping is performed taking into account the labeling process. Specifically, labeling splits M(i) into two disjoint sets, L
                        1(i) and L
                        2(i). L
                        1(i)(L
                        2(i)) is defined as the set of the reads that are most likely belonging to the allele represented by read α (β). Then, we define B
                        1(i)(B
                        2(i)) as the base in the ith position given by the reads in L
                        1(i)(L
                        2(i)). A majority rule is employed if the reads in L
                        1(i)(L
                        2(i)) show different bases on the ith position.

The coverage of each variant plays a key-role in the genotyping procedure. Indeed, let us define Θ as the threshold value for the number of reads that map onto each variant. Thus, when genotyping the ith variant, we check |M(i)| w.r.t. Θ. Thus, if |M(i)|<
                        Θ, the ith mutation is called as heterozygous as B
                        1(i)≠
                        B
                        2(i): otherwise, a homozygosity is declared.

On the other hand, if |M(i)|⩾
                        Θ, further investigations on L
                        1(i) and L
                        2(i) have to be performed. Specifically, we consider the most represented base between B
                        1(i) and B
                        2(i) over L
                        1(i) and L
                        2(i), respectively. Then, we check whether the number of reads which show the most represented base over the ith variant is less than a fraction ψ of the total reads mapping onto variant i. In case this condition is fulfilled and B
                        1(i)≠
                        B
                        2(i), a heterozygosity is declared. Otherwise, a homozygosity is called. Supplementary Section 5 reports a detailed description of the aforesaid procedure.

Taking a look back to the genotyping process, we can say that the parameter Θ can be seen as the limit of the informativity associated with the reads in 
                           
                              
                                 
                                    b
                                 
                                 
                                    ¯
                                 
                              
                           
                        . In other terms, each read in M(i) can provide useful information as it represents at least 1/Θ of the global information delivered by M(i). If this condition is not fulfilled, its informativity will not be discarded as 
                           
                              |
                              
                                 
                                    B
                                 
                                 
                                    ‾
                                 
                              
                              |
                              <
                              ψ
                              ·
                              |
                              M
                              (
                              i
                              )
                              |
                           
                        . Throughout this paper we assume Θ
                        =20 and ψ
                        =0.8 in order to achieve confident genotypes at moderate or high coverage (>20), as shown by literature [17].

Finally, the computational complexity of the proposed scheme is strongly dependent on the labeling process computational cost and on the steps needed to compute and compare weights (Eq. (3)). Thus, it is possible to draw an upper bound of the computational cost required by Kimimila for each variant as a function of the operations required by labeling and variant coverage: the upper bound can be written as 
                           
                              |
                              M
                              (
                              i
                              )
                              |
                              ·
                              N
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                |
                                                M
                                                
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , where N is the maximum number of variants two reads in M(i) overlap on.

The proposed method has been tested over in silico and real dataset to exploit its performance in terms of read labeling and genotyping accuracy. The aforementioned datasets are described in the following sections.

Simulated dataset consisted of a pool of sequence reads along with their base qualities and the mapping position on the genomic reference (GRCh37). The allele origin of each read was known.

The dataset was built according to the following procedure:
                           
                              1.
                              Two copies of the human genomic reference GRCh37 corresponding to the same genomic region were taken to simulate the two possible alleles.

The two alleles sequences were modified according to a phased variation set on the above genomic region.

In order to simulate the allelic reads unbalance, the genomic region of interest was split in five intervals weighted in accordance to a pre-established allele frequency.

Sequence reads were generated by randomly choosing sequence snippets from the modified allele sequences. Snippets were generated from one of the two alleles according to the allele frequency of the interval.

For each read, base qualities were assigned following a linear function Q
                                 
                                 =
                                 ((m
                                 −
                                 M
                                 +2r)/L)x
                                 +(M
                                 −
                                 r) where x is the current base, m and M are the minimum and maximum quality scores (respectively set to 20 and 41 in Phred scale), L is the read sequence length and r is an integer random variable between 0 and 5.

To simulate next generation sequencing reads and alignment artifacts, we introduced noise by randomly choosing for each variant locus a set of overlapping reads (S) for which the corresponding base at the variant site within its quality Phred scores (Q) had to be changed.

We distinguished between three combinations of S and Q to build the resulting datasets corresponding to:
                           
                              (a)
                              Low noise dataset (S
                                 =[0,2], Q
                                 =[1,10]).

Medium noise dataset (S
                                 =[0,3], Q
                                 =[1,20]).

High noise dataset (S
                                 =[0,3], Q
                                 =[20,41]).

A total of 960 reads were generated. Each read was 101 bases in length and mapped to one of the five genomic intervals taken under consideration and spanning 11 variations. The number of generated reads allowed an average coverage of about 30-fold.

A dataset was downloaded from the 1000 Genome Project public resource.

In particular, the test of the algorithm was performed on Illumina alignment sequencing data (BAM files) of the HG00096 exome-sequenced sample belonging to the 2nd phase release.

HG00096 SNPs array data obtained from the Illumina Omni 2.5M Chip, phased by SHAPEIT software [18] were used as validation set.

By the intersection of above two data sources we obtained the set of reliable variants within their overlapping reads. Therefore, for each read we were able to infer the allele origin basing on the presence or absence of a reliable variant on it, except for those reads covering only one homozygous variant.

@&#RESULTS@&#

The algorithm was tested on the simulated dataset in order to evaluate the performances of the algorithm in labeling reads according to their allele origin and on the real dataset to evaluate reads labeling and variant genotyping. In both cases Kimimila showed accurate results.

We finally compared Kimimila genotyping performances on the real dataset to GATK UG, VarScan, Samtools, Atlas2 and FreeBayes tools.

For the simulated dataset, the proposed method shows a reads labeling accuracy greater than 85% over 91% of the variants in case of low noise condition, 83% of the variants in case of medium noise condition and 81% of the variants in case of high noise condition (see Fig. 3
                        ). It is worth noting that the labeling accuracy is computed as the fraction of reads that have been correctly clustered w.r.t. their allele origin.

As the real dataset is concerned, we tested the algorithm on a subset of 1094 reads overlapping 76 variants randomly chosen. The labeling accuracy results are shown in Fig. 4
                           .

We compared Kimimila against the performance of a standard clustering method such as the K-means algorithm. In order to get a fair comparison, the K-means algorithm has been fed with the distances that have been computed for each variant over the interval for which the maximum distance reads overlap.

The performance of K-means and Kimimila are shown in Fig. 4 as a red solid line and a blue solid line, respectively. As previously mentioned, the labeling accuracy is computed as the fraction of reads that have been correctly clustered w.r.t. their allele origin. The labeling performance of K-means algorithm stands in the interval between 52% and 70%. On the other hand, Kimimila performs optimal labeling (i.e., is able to perfectly identify the allele origin) over 92% of the variants. Moreover, the proposed method shows a labeling accuracy greater than 85% over 97% of the variants.

Genotyping accuracy was tested on all 69834 Omni Chip variants of HG00096 sample on all autosomes for which overlapping reads occurred. Results on genotyping were compared to those achieved by GATK UG, VarScan, Samtools, Atlas2 and FreeBayes. Table 1
                            shows the genotyping results over each chromosome for every level of coverage. Specifically, in Table 1 the percentages of variants that have been correctly genotyped by Kimimila and the other tools are provided. VarScan is not included here because it does not genotype variants with few supporting reads, therefore a comparison on the whole data set regardless of the coverage threshold would not have been fair.

As a result Table 1 shows that the five considered methods provide approximately the same accuracy in genotyping throughout the chromosomes. The computational time required by Kimimila to perform genotyping can be estimated in an average of 6.7ms/variant over a 8GB RAM Intel i5 processor.

Moreover, it is worth to note that a fraction of variants have been incorrectly genotyped because of insufficient coverage from one of the two alleles. As shown in Table 2
                           , we stratified genotyping accuracy by reads coverage and we found that below a threshold of 10, the accuracy on heterozygous calls decrease to 50% or less for each tool, reflecting their tendency to easily call for homozygous variants in case of a low allele ratio. Indeed we observed a high accuracy (above 99%) on homozygous calls independently from the coverage. These results are compliant with previous literature findings in this field [19,20] and to the recommendations that for diagnostic purposes an average coverage above 50-fold with at least 10 reads covering more than 90% of the genomic region of interest should be assured for quality assessment.

@&#DISCUSSION@&#

As reported in the results section, thanks to its original approach, Kimimila is able to assign and report the allelic origin for each read overlapping a variant locus, while keeping high genotyping performance. We argue that the increasing in length of reads produced by third generation sequencers will increase the number of haplotype informative reads as well, leading our approach to more accurate reads labeling and genotyping. Finally, it is important to note that we reached high accuracy in genotyping without making use of prior knowledge, suggesting that our method can be suitable when the knowledge available is not enough to specify informative priors (i.e. genomes of other species).

Variant genotyping is only one of the possible applications of our method: further potential research directions are presented in the following.

Haplotyping, which aims to link together (phase) two or more variants belonging to the same alleles, is one possible application. The majority of haplotype phasing algorithms are based on the correlation between alleles at specific SNPs in a population (so called linkage disequilibrium) [18,21–23]. However, these approaches are usually less accurate if compared to other methods that make use of heterozygous variants on mapped reads for haplotype phasing [24,25].

Although our method was aimed at defining the zygosity of a variant, the approach we use to classify sample fragments could be easily reused to reconstruct the haplotype as well.

If the overlapping rate between fragments is adequate and these fragments are long enough to encompass multiple variant sites (as expected by sequence technology improvement), a future development that aims to assemble these fragments to reconstruct long and reliable haplotype-blocks will be possible.

Another potential research direction is related to polyploid domains as in the case with somatic samples. In order to fulfill this goal, the distance geometry approach would need to be adapted to a generic N-dimensional space, where N is the number of alleles of the sequenced sample. After this adaptation it will be possible to (a) infer the number of sub-population genomes in the sample and (b) genotype and phase variants belonging to each genome within the mixture.

@&#CONCLUSIONS@&#

We presented a novel algorithm, Kimimila, able to classify reads that are mapped to a reference genome by their allele origin; as a consequence the algorithm can be used to assign the genotype of the genomic variant loci overlapped by the reads. The algorithm is based on an original clustering technique based on a distance geometry approach for reads comparison; it makes use of both the nucleotide frequency for a single variant locus across the overlapping reads and the sequenced base qualities assigned by the base caller. We integrated these two sources of information into a single model that, dealing with reads rather than only single base pileup, is able to combine more variant loci when present on the same read.

We tested the algorithm on a simulated dataset in order to evaluate both the reads classification and variant genotyping. We showed that Kimimila is able to reach high performances despite high levels of noise. We compared Kimimila to several algorithms for variant genotyping: GATK UG, Samtools, Atlas2, FreeBayes and VarScan. We showed that these methods are comparable in terms of performances and that they suffer from the same limitations for shallow genome coverage.

@&#ACKNOWLEDGMENTS@&#

The activity has been supported by the ITALBIONET project, funded by the Italian Ministry of Education, University and Research, and by the RELAB project, funded by the Fondazione Cariplo and Region of Lumbardy, Italy.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.jbi.2014.10.001.


                     
                        
                           Supplementary data 1
                           
                        
                     
                  

@&#REFERENCES@&#

