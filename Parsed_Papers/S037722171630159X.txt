@&#MAIN-TITLE@&#Lower bounding procedure for the asymmetric quadratic traveling salesman problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Present different reformulations for the quadratic traveling salesman problem.


                        
                        
                           
                           Develop new bound based on reformulation-linearization technique.


                        
                        
                           
                           Propose a cycle based model and solve it by column generation approach.


                        
                        
                           
                           Develop a stabilized column generation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Traveling salesman

Reformulation-linearization technique

Cycle cover

Column generation

Lower bound

@&#ABSTRACT@&#


               
               
                  In this paper we consider the Asymmetric Quadratic Traveling Salesman Problem (AQTSP). Given a directed graph and a function that maps every pair of consecutive arcs to a cost, the problem consists in finding a cycle that visits every vertex exactly once and such that the sum of the costs is minimal. We propose an extended Linear Programming formulation that has a variable for each cycle in the graph. Since the number of cycles is exponential in the graph size, we propose a column generation approach. Moreover, we apply a particular reformulation-linearization technique on a compact representation of the problem, and compute lower bounds based on Lagrangian relaxation. We compare our new bounds with those obtained by some linearization models proposed in the literature. Computational results on some set of benchmarks used in the literature show that our lower bounding procedures are very promising.
               
            

@&#INTRODUCTION@&#

The Traveling Salesman Problem (TSP) is one of the most studied optimization problems. Given a graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      with costs ce, e ∈ A, the problem consists in finding a cycle C that visits each vertex in V exactly once (i.e., a Hamiltonian cycle), and such that the total cycle cost is minimal. In its most common form, the TSP has a linear cost function, equal to the sum of the costs ce
                      of each arc in C. Now, consider a variant of the TSP having a non-negative interaction cost Qef
                      for every pair of consecutive arcs e, f ∈ A. Because the cost of a cycle can be computed as a quadratic function, this problem is called Quadratic Traveling Salesman Problem (QTSP) and is NP-hard as shown in Fischer et al. (2014). As for the linear counterpart, the QTSP has a symmetric and an asymmetric variant. In this paper we focus on the Asymmetric Quadratic Traveling Salesman Problem (AQTSP) which appears to be more challenging. A preliminary version of the results presented here together with the study of the Symmetric Quadratic Traveling Salesman Problem (SQTSP) have been published as conference proceedings in Rostami, Malucelli, Belotti, and Gualandi (2013).

The QTSP was introduced as an application of bioinformatics by Jäger and Molitor (2008) but it can also be applied in robotics and telecommunications. In robotics, a variant of QTSP called Angle-TSP can be used for the optimization of robot paths in terms of energy consumption. The Angle-TSP problem seeks to minimize the total angle of a TSP tour for a set of points in the Euclidean space where the angle of a tour is the sum of the direction changes at all points (Aggarwal, Coppersmith, Khanna, Motwani, & Schieber, 2000). Also, the QTSP can be viewed as a generalization of the Reload Cost TSP (RTSP) introduced by Amaldi, Galbiati, and Maffioli (2011). In the RTSP, one is given a graph whose each arc is assigned a color and there is a reload cost when passing through a node on two arcs that have different colors.

The QTSP has been introduced quite recently and its literature is rather limited. In particular, the QTSP has been tackled by Fischer et al. (2014) with heuristic algorithms based on well-known heuristics for the TSP, with an ad-hoc branch-and-bound, and with a branch-and-cut approach based on a linearization of a 0-1 Quadratic Programming formulation of the problem. In Fischer and Helmberg (2013) and Fischer (2014) used the polyhedral structure of linearized integer programming formulations to develop a branch-and-cut algorithm for the SQTSP and AQTSP, respectively, that are the current state-of-the-art for QTSP.

In this paper we study lower bounding procedures for the AQTSP. Considering the special structure of the quadratic costs of the AQTSP, we present an extended Linear Programming formulation of the problem with an exponential number of variables that is solved via Column Generation (CG). The basic idea is to have a variable for each cycle of G. This yields a pricing subproblem that consists in finding a cycle of minimum quadratic cost. We formulate the pricing subproblem as a 0–1 Quadratic Program, which is linearized and solved with standard techniques. We resort to stabilization techniques to overcome the tailing-off effect of the CG approach. We also present the linearized integer programming formulation proposed by Fischer (2014). This formulation is, in fact, based on the standard Asymmetric Traveling Salesman Problem (ATSP) formulation of Dantzig, Fulkerson, and Johnson (1954) which has an exponential number of constraints. In order to avoid this complication we modified the proposed model by using the compact formulation of Miller, Tucker, and Zemlin (1960) with a polynomial number of variables and constraints. To generate a tighter representation of the problem, we develop a Mixed Integer Linear Programming (MILP) formulation that make use of a particular application of the Reformulation-linearization technique (RLT) (Adams & Sherali, 1986; 1990). We develop an effective Lagrangian relaxation scheme to compute the associated lower bound.

Consider a complete directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      with vertex set 
                        
                           V
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           
                           ,
                           n
                           }
                           ,
                        
                      arc set A, and cost function Q that maps every pair of consecutive arcs 
                        
                           e
                           =
                           (
                           i
                           ,
                           j
                           )
                           ,
                           f
                           =
                           (
                           j
                           ,
                           k
                           )
                           ∈
                           A
                        
                      to a non-negative integer cost 
                        
                           
                              Q
                              
                                 e
                                 f
                              
                           
                           =
                           
                              Q
                              
                                 i
                                 j
                                 k
                              
                           
                        
                     . The AQTSP seeks a directed tour (i.e., a directed cycle passing through every vertex exactly once) of minimum cost. Let the binary variable xij
                      be equal to 1 if the arc (i, j) ∈ A belongs to the minimum cost tour, and zero otherwise. A formulation for the AQTSP is then given by

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          AQTSP:
                                          
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ,
                                                (
                                                j
                                                ,
                                                k
                                                )
                                                ∈
                                                A
                                                :
                                                
                                                k
                                                ≠
                                                i
                                             
                                          
                                          
                                             Q
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          i
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          j
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ∈
                                                         S
                                                         ,
                                                         j
                                                         ∉
                                                         S
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          1
                                          
                                          S
                                          ⊂
                                          V
                                          ,
                                          
                                          2
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          ≤
                                          n
                                          −
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          .
                                       
                                    
                                 
                              
                           
                        
                     where constraints (1) and (2) force to select a single outgoing arc and a single incoming arc for each node, respectively, and constraints (3) are the well known subtour elimination constraints (Dantzig et al., 1954). To ease the argumentation, we define the new set 
                        A
                      as follows:

                        
                           
                              
                                 A
                                 =
                                 {
                                 (
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 )
                                 :
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 (
                                 j
                                 ,
                                 k
                                 )
                                 ∈
                                 A
                                 ,
                                 i
                                 ≠
                                 k
                                 }
                                 .
                              
                           
                        
                     
                  

The AQTSP formulation presented here is based on the ATSP formulation of Dantzig et al. (1954) which has an exponential number of constraints. Since, further on, we will need a more compact formulation we adapt the MTZ formulation of Miller et al. (1960) to the quadratic case. That formulation fixes node 1 as a “depot”, which the salesman must leave at the start of the tour and return to at the end of the tour. Let uj
                      be a continuous variable representing the position of node j in the tour. Then the MTZ type formulation for the AQTSP is given by

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             AQTSP
                                             MTZ
                                          
                                          :
                                          
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             Q
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                             i
                                          
                                          −
                                          
                                             u
                                             j
                                          
                                          +
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ⩽
                                          n
                                          −
                                          2
                                       
                                    
                                    
                                       
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                          ;
                                          
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          1
                                          ⩽
                                          
                                             u
                                             j
                                          
                                          ⩽
                                          n
                                          −
                                          1
                                          
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          )
                                          ,
                                          (
                                          2
                                          )
                                          ,
                                          (
                                          4
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     where constraints (5) ensure that, if the salesman travels from node i to node j, then the position of node j is one more than that of node i, and constraints (5) together with the bounds (6) ensure that each non-depot node is in a unique position.

The main difficulty of the AQTSP and AQTSPMTZ, in addition to the TSP problem structure, lies in the quadratic structure of the objective function. One of the most natural ways for solving the problem is to linearize the quadratic terms xijxjk
                         for all 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                              ∈
                              A
                           
                         using the standard linearization technique of Glover and Woolsey (1974). The approach is based on the introduction of new non-negative binary variables 
                           
                              
                                 y
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 
                                    j
                                    k
                                 
                              
                           
                         which satisfy the following set of constraints:

                           
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       x
                                       
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                    
                                    and
                                    
                                    
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≥
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       x
                                       
                                          j
                                          k
                                       
                                    
                                    −
                                    1
                                    .
                                 
                              
                           
                        
                     

The main disadvantage of the standard linearization is that it does not take the problem structure into account. Taking into account the problem structure to connect the x and y variables, Fischer (2014) introduced a mixed integer linear programming with continuous variables yijk
                         such that

                           
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       
                                          j
                                          k
                                       
                                    
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       )
                                    
                                    ∈
                                    A
                                    .
                                 
                              
                           
                        The formulation has the following form:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             LPF:
                                             
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                Q
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   :
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   :
                                                   (
                                                   k
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≥
                                             0
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             A
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             1
                                             )
                                             −
                                             (
                                             4
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where constraints (7) and (8) enforce 
                           
                              
                                 y
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 
                                    j
                                    k
                                 
                              
                           
                        .

Using the AQTSPMTZ compact formulation discussed above, we define a compact formulation of LPF, called LPFMTZ as follows:

                           
                              
                                 
                                    
                                       LPF
                                       MTZ
                                    
                                    :
                                    
                                    min
                                    
                                       {
                                       
                                          ∑
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                             ∈
                                             A
                                          
                                       
                                       
                                          Q
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                          y
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                       :
                                       
                                          (
                                          1
                                          )
                                       
                                       ,
                                       
                                          (
                                          2
                                          )
                                       
                                       ,
                                       
                                          (
                                          4
                                          )
                                       
                                       −
                                       
                                          (
                                          9
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     


                        Padberg and Sung (1991) showed that the LP relaxation of the MTZ formulation yields an extremely weak lower bound for the ATSP. However, our computational results show that this is not always true for the AQTSP.

To obtain an MILP formulation for the AQTSP, we apply a scheme based on the Reformulation-linearization technique (RLT). As far as the tightness of the bounds is concerned, the RLT base approaches are among the most successful lower bounding approaches for many combinatorial optimization problems (Adams, Guignard, Hahn, & Hightower, 2007; Adams & Johnson, 1994; Rostami & Malucelli, 2015; Sherali & Driscoll, 2002). The full application of the RLT for general zero-one polynomial programs (Adams & Sherali, 1986; 1990), transforms the original problem into an MILP via two basic steps of reformulation and linearization. In the reformulation step, the constraints are multiplied by the binary variables and their complements to construct redundant nonlinear constraints. In the linearization step, the objective and constraints of the reformulated problem are linearized by substituting each distinct nonlinear term with a new continuous variable. Depending on how many times this process is applied, different levels of RLT can be obtained.

Let us consider the AQTSPMTZ formulation of the AQTSP proposed in Section 2. Following the idea of Sherali and Driscoll (2002) for the MTZ formulation of the ATSP, we replace constraints (5) with the nonlinear constraints (10) to obtain the following revised compact formulation

                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             AQTSP
                                             RMTZ
                                          
                                          :
                                          
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             Q
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                u
                                                i
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                          ;
                                          
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          )
                                          ,
                                          (
                                          2
                                          )
                                          ,
                                          (
                                          4
                                          )
                                          ,
                                          (
                                          6
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     where constraints (10) enforce that if the salesman travels from node i to node j (i.e., 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           =
                           1
                        
                     ) for all i, j ≥ 2, then 
                        
                           
                              u
                              j
                           
                           =
                           
                              u
                              i
                           
                           +
                           1
                        
                     .

To linearize the non-linear terms xijxjk
                     , 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           A
                        
                      and ujxij, i, j ≥ 2, i ≠ j we apply a scheme based on the RLT. For ease of notation let us first define a new set 
                        B
                      as:

                        
                           
                              
                                 B
                                 =
                                 {
                                 (
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 )
                                 :
                                 (
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 )
                                 ∈
                                 A
                                 ,
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ⩾
                                 2
                                 }
                                 .
                              
                           
                        
                     Then, the RLT based representation of AQTSPRMTZ is generated via the following two steps:


                     Reformulation step:

1– We multiply Eq. (1), for each i ∈ V, by each of the 
                        
                           (
                           n
                           −
                           1
                           )
                        
                      variables xki
                     , ∀k ≠ i. Then, we multiply Eq. (1), for each i ≥ 2 by each of uk
                     , ∀k ≥ 2 and by each pairwise product of uixki
                     , ∀k ≥ 2, k ≠ i. Moreover, for each j ∈ V, we multiply Eq. (2) by each of the 
                        
                           (
                           n
                           −
                           1
                           )
                        
                      variables xjk
                     , ∀k ≠ j. In addition, for each j ≥ 2 we multiply Eq. (2) by each of uk
                     , ∀k ≥ 2 and by each pairwise product of ujxjk
                     , ∀k ≥ 2, k ≠ j. All 
                        
                           4
                           n
                           (
                           n
                           −
                           1
                           )
                        
                      such quadratic equations and 
                        
                           2
                           (
                           n
                           −
                           1
                           )
                           (
                           n
                           −
                           2
                           )
                        
                      such cubic equations are included within the formulation. We then set 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 i
                              
                           
                           =
                           0
                        
                      for all (i, j) ∈ A to eliminate the two-vertex subtours.

2– For each i, j ≥ 2; i ≠ j, we multiply Eq. (10) by each of the 
                        
                           (
                           n
                           −
                           2
                           )
                        
                      variables xjk
                      and xki
                     , ∀k ≥ 2, k ≠ i, j. All 
                        
                           
                              (
                              n
                              −
                              1
                              )
                           
                           
                              
                                 (
                                 n
                                 −
                                 2
                                 )
                              
                              2
                           
                        
                      such cubic equations are then included within the formulation.

3– Consider constraints (6). For each j ≥ 2, we multiply 
                        
                           
                              u
                              j
                           
                           −
                           1
                           ⩾
                           0
                        
                      by (i) each of the 
                        
                           (
                           n
                           −
                           1
                           )
                        
                      variables xji
                      with i ≠ j, i ≥ 2, and each of the 
                        
                           (
                           n
                           −
                           1
                           )
                           (
                           n
                           −
                           2
                           )
                        
                      pairwise product of xjixik
                      with 
                        
                           (
                           j
                           ,
                           i
                           ,
                           k
                           )
                           ∈
                           B
                        
                     ; and by (ii) 
                        
                           (
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 i
                              
                           
                           )
                        
                      with i ≠ j, i ≥ 2, and by 
                        
                           (
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 k
                              
                           
                           −
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 k
                              
                           
                           +
                           
                              x
                              
                                 j
                                 k
                              
                           
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 k
                                 i
                              
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           )
                        
                      with 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           B
                        
                     .

4– Consider again constraints (6). For each j ≥ 2, we multiply 
                        
                           n
                           −
                           1
                           −
                           
                              u
                              j
                           
                           ⩾
                           0
                        
                      by (i) each of the 
                        
                           (
                           n
                           −
                           1
                           )
                        
                      variables xij
                      with i ≠ j, i ≥ 2, and each of the 
                        
                           (
                           n
                           −
                           1
                           )
                           (
                           n
                           −
                           2
                           )
                        
                      pairwise products of xkixij
                      with 
                        
                           (
                           k
                           ,
                           i
                           ,
                           j
                           )
                           ∈
                           B
                        
                     ; and by (ii) 
                        
                           (
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 i
                              
                           
                           )
                        
                      with i ≠ j, i ≥ 2, and by 
                        
                           (
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 k
                              
                           
                           −
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 k
                              
                           
                           +
                           
                              x
                              
                                 j
                                 k
                              
                           
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 k
                                 i
                              
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           )
                        
                      with 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           B
                        
                     .

We should note here that the inequalities used as multipliers of constraints (6) in the step (ii) of the third and fourth phase of the above reformulation generate the valid inequalities for the AQTSP. This is because the inequalities 
                        
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 i
                              
                           
                           ≥
                           0
                        
                      with i ≠ j are the two-vertex subtour elimination constraints, while the inequalities 
                        
                           1
                           −
                           
                              x
                              
                                 i
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 k
                              
                           
                           −
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 k
                              
                           
                           +
                           
                              x
                              
                                 j
                                 k
                              
                           
                           
                              x
                              
                                 k
                                 i
                              
                           
                           +
                           
                              x
                              
                                 k
                                 i
                              
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           ⩾
                           0
                           ,
                        
                      for all 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           A
                           ,
                        
                      are triangle inequalities that are valid for the general Boolean Quadric polytope (Padberg, 1989).


                     Linearization step:

The linearization step makes the following substitutions:

                        
                           (11)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             u
                                             i
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                          and
                                          
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                             ′
                                          
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                          ,
                                          
                                          
                                          i
                                          ≠
                                          j
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             x
                                             
                                                j
                                                1
                                             
                                          
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                j
                                                1
                                             
                                          
                                          ,
                                          
                                          and
                                          
                                          
                                             x
                                             
                                                1
                                                j
                                             
                                          
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                1
                                                j
                                             
                                          
                                          
                                          j
                                          ⩾
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             v
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             u
                                             k
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          
                                          
                                          k
                                          ⩾
                                          2
                                          ,
                                          
                                          
                                          i
                                          ≠
                                          j
                                          ≠
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          =
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          =
                                          
                                             u
                                             i
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                             ′
                                          
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                                ′
                                             
                                          
                                          =
                                          
                                             u
                                             k
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             (
                                             n
                                             −
                                             2
                                             )
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                                1
                                             
                                          
                                          =
                                          
                                             u
                                             i
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                j
                                                1
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             1
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    
                                    
                                       
                                          2
                                          
                                             y
                                             
                                                1
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                             x
                                             
                                                1
                                                i
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             1
                                             ,
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Observe that, for any j ≥ 2, Eq. (12) enforce that 
                        
                           
                              u
                              j
                           
                           =
                           
                              (
                              n
                              −
                              1
                              )
                           
                        
                      if 
                        
                           
                              x
                              
                                 j
                                 1
                              
                           
                           =
                           1
                           ,
                        
                      and 
                        
                           
                              u
                              j
                           
                           =
                           1
                        
                      if 
                        
                           
                              x
                              
                                 1
                                 j
                              
                           
                           =
                           1
                        
                     . Moreover, for any 
                        
                           (
                           1
                           ,
                           i
                           ,
                           j
                           )
                           ∈
                           A
                           ,
                           
                           i
                           ,
                           j
                           ⩾
                           2
                           ,
                        
                      
                     Eqs. (18) and (19) enforce that 
                        
                           
                              u
                              i
                           
                           =
                           
                              (
                              n
                              −
                              2
                              )
                           
                        
                      if 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           =
                           
                              x
                              
                                 j
                                 1
                              
                           
                           =
                           1
                           ,
                        
                      and 
                        
                           
                              u
                              j
                           
                           =
                           2
                        
                      if 
                        
                           
                              x
                              
                                 1
                                 i
                              
                           
                           =
                           
                              x
                              
                                 i
                                 j
                              
                           
                           =
                           1
                        
                     .

Using (10) and Eq. (12) we have:

                        
                           (20)
                           
                              
                                 
                                    w
                                    
                                       i
                                       j
                                    
                                    ′
                                 
                                 =
                                 
                                    w
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 A
                                 ,
                              
                           
                        
                     
                  

Moreover, Eq. (14) to (17) together with the nonlinear constraints generated in the second phase of the reformulation step yield the following relationships:

                        
                           (21)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                             ′
                                          
                                          =
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (22)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                                ′
                                             
                                          
                                          =
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                             ′
                                          
                                          +
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

This allows us to eliminate all variables 
                        
                           w
                           
                              i
                              j
                           
                           ′
                        
                      for all (i, j) ∈ A, and variables 
                        
                           z
                           
                              i
                              j
                              k
                           
                           ′
                        
                      and 
                        
                           z
                           
                              i
                              j
                              k
                           
                           
                              ′
                              ′
                           
                        
                      for all 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           B
                        
                      from the resulting model. This leads to the following MILP formulation:

PRLT:

                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             Q
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                ≠
                                                1
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                1
                                             
                                          
                                          =
                                          
                                             u
                                             i
                                          
                                          
                                          i
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (24)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ≠
                                                1
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          1
                                          =
                                          
                                             u
                                             j
                                          
                                          
                                          i
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (25)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                :
                                                (
                                                j
                                                ,
                                                k
                                                )
                                                ∈
                                                A
                                                ,
                                                k
                                                ≠
                                                i
                                                ,
                                                1
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             (
                                             n
                                             −
                                             2
                                             )
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                                1
                                             
                                          
                                          =
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                :
                                                (
                                                k
                                                ,
                                                i
                                                )
                                                ∈
                                                A
                                                :
                                                k
                                                ≠
                                                j
                                                ,
                                                1
                                             
                                          
                                          
                                             z
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (27)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             v
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             u
                                             k
                                          
                                          
                                          i
                                          ,
                                          k
                                          ,
                                          
                                          i
                                          ≠
                                          k
                                          ,
                                          
                                          k
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (28)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                :
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             v
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          +
                                          1
                                          =
                                          
                                             u
                                             k
                                          
                                          
                                          j
                                          ,
                                          k
                                          ,
                                          
                                          j
                                          ≠
                                          k
                                          ,
                                          
                                          k
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (29)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             (
                                             n
                                             −
                                             2
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (30)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             w
                                             
                                                j
                                                i
                                             
                                          
                                          ≥
                                          
                                             u
                                             j
                                          
                                          +
                                          
                                             (
                                             n
                                             −
                                             2
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                x
                                                
                                                   j
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          ,
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             w
                                             
                                                j
                                                i
                                             
                                          
                                          ≤
                                          
                                             u
                                             j
                                          
                                          −
                                          
                                             (
                                             1
                                             −
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          ,
                                          
                                          i
                                          ,
                                          j
                                          ⩾
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (32)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ≤
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ≤
                                          
                                             (
                                             n
                                             −
                                             3
                                             )
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (33)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             z
                                             
                                                j
                                                k
                                                i
                                             
                                          
                                          +
                                          
                                             z
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             (
                                             1
                                             −
                                             
                                                u
                                                j
                                             
                                             )
                                          
                                          +
                                          
                                             (
                                             
                                                v
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   j
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                          
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   k
                                                   i
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             (
                                             n
                                             −
                                             2
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                          
                                             (
                                             n
                                             −
                                             3
                                             )
                                          
                                          
                                             y
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (34)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             z
                                             
                                                j
                                                k
                                                i
                                             
                                          
                                          +
                                          
                                             z
                                             
                                                k
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             (
                                             1
                                             −
                                             
                                                u
                                                j
                                             
                                             )
                                          
                                          +
                                          
                                             (
                                             
                                                v
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   j
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             −
                                             
                                                y
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   k
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          B
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (35)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ≥
                                          0
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          )
                                          ,
                                          (
                                          2
                                          )
                                          ,
                                          (
                                          4
                                          )
                                          ,
                                          (
                                          7
                                          )
                                          ,
                                          (
                                          8
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     where constraints (7), (8), and (23) to (28) are the results of the first phase of the reformulation step, Linearizations (11) to (19), and Substitutions (20) to (22). The lower and upper bounding restrictions in (29) and (32) are the results of step (i) of the third and the fourth phase of the reformulation step, respectively. Finally, step (ii) of the third and the fourth phase of the reformulation step yield constraints (30) to (34).

Observe that, following the idea proposed by Sherali and Driscoll (2002) for the ATSP, we could also do the reformulation steps 3 and 4 for the depot 1 to construct new valid inequalities, i.e., multiply for each j ≥ 2, the inequalities 
                        
                           
                              u
                              j
                           
                           −
                           2
                           ⩾
                           0
                        
                      and 
                        
                           n
                           −
                           
                              u
                              j
                           
                           −
                           2
                           ⩾
                           0
                        
                      by x
                     
                        j1, x
                     
                        j1
                     x
                     1k
                      with 
                        
                           (
                           j
                           ,
                           1
                           ,
                           k
                           )
                           ∈
                           A
                           ,
                           
                           j
                           ,
                           k
                           ⩾
                           2
                           ,
                        
                     
                     
                        
                           (
                           1
                           −
                           
                              x
                              
                                 1
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 1
                              
                           
                           )
                        
                      with i ≠ j, i ≥ 2, and 
                        
                           (
                           1
                           −
                           
                              x
                              
                                 1
                                 j
                              
                           
                           −
                           
                              x
                              
                                 j
                                 k
                              
                           
                           −
                           
                              x
                              
                                 k
                                 1
                              
                           
                           +
                           
                              x
                              
                                 1
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 k
                              
                           
                           +
                           
                              x
                              
                                 j
                                 k
                              
                           
                           
                              x
                              
                                 k
                                 1
                              
                           
                           +
                           
                              x
                              
                                 k
                                 1
                              
                           
                           
                              x
                              
                                 1
                                 j
                              
                           
                           )
                        
                      with 
                        
                           (
                           i
                           ,
                           j
                           ,
                           k
                           )
                           ∈
                           B
                        
                     . However, our preliminary computational experiments indicated that adding these new generated valid inequalities to PRLT does not tighten the LP relaxation of PRLT significantly, while increases the running time for the evaluation of the associated lower bound. For this reason, we do not consider them in PRLT formulation.

We should also note that, with the intent of strengthening the problem representation, we applied a different RLT (Adams & Sherali, 1986; 1990) for the AQTSPMTZ formulation. In the reformulation step, we multiplied each constraints (1), (2), (5), and (6) by each of the |A|2 binary variables xkl
                     , and append these new constraints to the formulation. Then we substituted 
                        
                           x
                           
                              k
                              l
                           
                           2
                        
                      with xkl
                      throughout the constraints and set 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 k
                                 l
                              
                           
                           =
                           0
                        
                      if 
                        
                           i
                           =
                           k
                        
                      and j ≠ l or i ≠ k and 
                        
                           j
                           =
                           l
                        
                     . Moreover we set 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           
                              x
                              
                                 j
                                 i
                              
                           
                           =
                           0
                        
                      to eliminate subtours involving only two nodes. In the linearization step, we substituted each product xijxkl
                      with tijkl
                      and enforced the following equations to the problem:

                        
                           
                              
                                 
                                    t
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 =
                                 
                                    t
                                    
                                       k
                                       l
                                       i
                                       j
                                    
                                 
                                 
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ,
                                 
                                    (
                                    k
                                    ,
                                    l
                                    )
                                 
                                 ∈
                                 A
                                 ,
                                 
                                 i
                                 <
                                 k
                                 ,
                                 j
                                 ≠
                                 l
                                 ,
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ≠
                                 
                                    (
                                    l
                                    ,
                                    k
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Due to the large number of variables and constraints of the resulting model, solving its linear programming relaxation is not practical. Instead, we constructed a Lagrangian dual by placing constraints (3) into the objective function as proposed by Adams and Johnson (1994) for the Level-1 RLT representation of the Quadratic Assignment Problem (QAP), and solved the Lagrangian dual using a dual-ascent strategy similar to those proposed by Hahn and Grant (1998), Adams et al. (2007) for the QAP. However, the dual-ascent algorithm did not provide a good lower bound on the optimal objective function value and, accordingly, the bounds were not much better than those of the compact linearized formulation LPFMTZ. For this reason, we decided to neither report its details here nor report the computational results.

Consider the LP relaxation of PRLT. Following the idea proposed by Rostami and Malucelli (2014) for reducing the size of the RLT representations of the QAP, we can remove constraints (1) from the PRLT. This is because it can be computed as a linear combinations of the constraints (2), (7), and (8). However, due to the large number of variables and constraints of the resulting model, solving this relaxation is still too much time consuming for large instances. Therefore, we construct a Lagrangian function which similar to the LPF and LPFMTZ formulations, has only O(n
                        2) constraints. We relax and dualize constraints (32) to (34) using a set of Lagrangian multipliers αijk, βijk, γijk
                        , and θijk
                         for all 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                              ∈
                              B
                              ,
                           
                         respectively. Note that αijk, βijk
                         are the Lagrangian multipliers corresponding to the lower and upper bounding restrictions in (32), respectively. The resulting Lagrangian function is as follows:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             L
                                             (
                                             
                                                α
                                             
                                             ,
                                             
                                                β
                                             
                                             ,
                                             
                                                γ
                                             
                                             ,
                                             
                                                θ
                                             
                                             )
                                             =
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             min
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                (
                                                
                                                   B
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   D
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             +
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ⩾
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   E
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   w
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ⩾
                                                   2
                                                
                                             
                                             
                                                P
                                                j
                                             
                                             
                                                u
                                                j
                                             
                                             +
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                             
                                             (
                                             2
                                             )
                                             ,
                                             (
                                             7
                                             )
                                             ,
                                             (
                                             8
                                             )
                                             ,
                                             (
                                             24
                                             )
                                             −
                                             (
                                             31
                                             )
                                             ,
                                             (
                                             35
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                α
                                             
                                             ,
                                             
                                                β
                                             
                                             ,
                                             
                                                γ
                                             
                                             ,
                                             
                                                θ
                                             
                                             ⩾
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          Q
                                          ¯
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      θ
                                                      
                                                         j
                                                         k
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      θ
                                                      
                                                         k
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      α
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      n
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      γ
                                                      
                                                         k
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      (
                                                      n
                                                      −
                                                      2
                                                      )
                                                   
                                                   
                                                      γ
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      n
                                                      −
                                                      3
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            j
                                                            k
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         β
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Q
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                   ∖
                                                   B
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                B
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                α
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                θ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                θ
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                θ
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                β
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             −
                                             
                                                γ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                             ∈
                                             B
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                D
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                γ
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                θ
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                             ∈
                                             B
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                E
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   :
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                (
                                             
                                             
                                                θ
                                                
                                                   j
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                θ
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                (
                                                1
                                                −
                                                n
                                                )
                                             
                                             
                                                (
                                                
                                                   γ
                                                   
                                                      j
                                                      k
                                                      i
                                                   
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      k
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                2
                                                −
                                                n
                                                )
                                             
                                             
                                                γ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                )
                                             
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             ,
                                             i
                                             ,
                                             j
                                             ⩾
                                             2
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                F
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   :
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                (
                                                
                                                   γ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      k
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      k
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             ,
                                             i
                                             ,
                                             j
                                             ⩾
                                             2
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                P
                                                j
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   k
                                                   :
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                (
                                                
                                                   θ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   γ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             j
                                             ⩾
                                             2
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             K
                                             =
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   n
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To obtain the optimal (near-optimal) Lagrangian multipliers (
                           α, β, γ, θ
                        ) we use the subgradient optimization technique (Held & Karp, 1971). We perform at most 1,000 iterations of the subgradient method. This number was chosen because preliminary experiments showed that after 1,000 iterations, the improvement of the lower bound stops or becomes very slow. The usual parameter that controls the step size in subgradient methods is initialized at value 1 and then halved whenever 50 iterations have passed without improving the best lower bound.

In this section we present a formulation of the AQTSP that considers an exponential number of variables, one for each cycle of the given graph. Let C be a cycle of G described as set of arcs. The cost of cycle C is the sum of the costs of the pairs of consecutive arcs contained in the cycle, i.e.,

                        
                           
                              
                                 q
                                 
                                    (
                                    C
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       (
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       )
                                       ∈
                                       A
                                       :
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ,
                                       (
                                       j
                                       ,
                                       k
                                       )
                                       ∈
                                       C
                                    
                                 
                                 
                                    Q
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Let 
                        C
                      and 
                        T
                      denote the collection of all cycles and all tours of G, respectively. Clearly, we have that 
                        
                           T
                           ⊆
                           C
                           ,
                        
                      and hence

                        
                           
                              
                                 
                                    min
                                    
                                       C
                                       ∈
                                       C
                                    
                                 
                                 q
                                 
                                    (
                                    C
                                    )
                                 
                                 ≤
                                 
                                    min
                                    
                                       T
                                       ∈
                                       T
                                    
                                 
                                 q
                                 
                                    (
                                    T
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Following the approach of Held and Karp to the TSP (Held & Karp, 1970), we associate a penalty πi
                      with every vertex i in V, and define 
                        
                           π
                           
                              (
                              C
                              )
                           
                           =
                           
                              ∑
                              
                                 i
                                 ∈
                                 C
                              
                           
                           
                              π
                              i
                           
                        
                     . Although C is a set of arcs, here we extend the notation so that i ∈ C means i ∈ V and ∃j ∈ V: (i, j) ∈ C. Let us consider a new cost function defined as follows: 
                        
                           d
                           (
                           C
                           )
                           =
                           q
                           (
                           C
                           )
                           +
                           π
                           (
                           C
                           )
                        
                     . Let T
                     * denote an optimal tour of G, i.e., 
                        
                           q
                           
                              (
                              
                                 T
                                 *
                              
                              )
                           
                           =
                           
                              min
                              
                                 T
                                 ∈
                                 T
                              
                           
                           q
                           
                              (
                              T
                              )
                           
                        
                     . Then, the following relations hold:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                C
                                                ∈
                                                C
                                             
                                          
                                          d
                                          
                                             (
                                             C
                                             )
                                          
                                          =
                                          
                                             min
                                             
                                                C
                                                ∈
                                                C
                                             
                                          
                                          
                                             {
                                             q
                                             
                                                (
                                                C
                                                )
                                             
                                             +
                                             π
                                             
                                                (
                                                C
                                                )
                                             
                                             }
                                          
                                          ≤
                                          d
                                          
                                             (
                                             
                                                T
                                                *
                                             
                                             )
                                          
                                          =
                                          q
                                          
                                             (
                                             
                                                T
                                                *
                                             
                                             )
                                          
                                          +
                                          π
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             min
                                             
                                                C
                                                ∈
                                                C
                                             
                                          
                                          
                                             {
                                             q
                                             
                                                (
                                                C
                                                )
                                             
                                             −
                                             π
                                             
                                                (
                                                V
                                                ∖
                                                C
                                                )
                                             
                                             }
                                          
                                          ≤
                                          q
                                          
                                             (
                                             
                                                T
                                                *
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     For any vector of penalty terms π we get a lower bound. However, we are interested in finding π that maximizes the lower bound:

                        
                           (36)
                           
                              
                                 
                                    max
                                    
                                       π
                                       ∈
                                       
                                          R
                                          n
                                       
                                    
                                 
                                 
                                 
                                 
                                    min
                                    
                                       C
                                       ∈
                                       C
                                    
                                 
                                 
                                 
                                    {
                                    q
                                    
                                       (
                                       C
                                       )
                                    
                                    −
                                    π
                                    
                                       (
                                       V
                                       ∖
                                       C
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     which is linearized by introducing a variable ρ as follows:

                        
                           (37)
                           
                              
                                 
                                    
                                       
                                          P:
                                          
                                          max
                                          
                                       
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                          +
                                          π
                                          (
                                          V
                                          ∖
                                          C
                                          )
                                          ≤
                                          q
                                          (
                                          C
                                          )
                                          
                                          C
                                          ∈
                                          C
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ρ
                                          ,
                                          π
                                          
                                          unrestricted
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Let λC
                      be the dual multipliers of constraints (37). We can write the dual of problem P as follows:

                        
                           (38)
                           
                              
                                 
                                    
                                       
                                          MP:
                                          
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                C
                                                ∈
                                                C
                                             
                                          
                                          q
                                          
                                             (
                                             C
                                             )
                                          
                                          
                                             λ
                                             C
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                C
                                                ∈
                                                C
                                                :
                                                i
                                                ∉
                                                C
                                             
                                          
                                          
                                             λ
                                             C
                                          
                                          =
                                          0
                                          
                                          i
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (39)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                C
                                                ∈
                                                C
                                             
                                          
                                          
                                             λ
                                             C
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (40)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             λ
                                             C
                                          
                                          ≥
                                          0
                                          
                                          C
                                          ∈
                                          C
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Since all multipliers in (38) are non-negative, an optimal solution must satisfy 
                        
                           
                              λ
                              C
                              *
                           
                           =
                           1
                        
                      for some 
                        
                           
                              C
                              *
                           
                           ∈
                           C
                        
                      and 
                        
                           
                              λ
                              C
                              *
                           
                           =
                           0
                        
                      for all 
                        
                           C
                           ∈
                           C
                           ∖
                           
                              C
                              *
                           
                        
                     . It follows that the cycle C
                     * is optimal with the cost q(C
                     *) for the AQTSP.

In this section we develop a column generation approach to solve the cycle based formulation MP presented in Section 4. Since the number of cycles in 
                        C
                      is exponential with respect to the number of vertices, we first consider a restricted master problem with a feasible subset of cycles, 
                        
                           
                              C
                              ¯
                           
                           ⊆
                           C
                        
                     . Let 
                        
                           π
                           =
                           (
                           
                              π
                              1
                           
                           ,
                           
                              π
                              2
                           
                           ,
                           …
                           
                           ,
                           
                              π
                              n
                           
                           )
                        
                      and ρ be the dual variables corresponding to constraints (38) and (39), respectively. The reduced cost of the variable λC
                      for each 
                        
                           C
                           ∈
                           C
                        
                      is

                        
                           
                              
                                 
                                    
                                       q
                                       (
                                       C
                                       )
                                    
                                    ¯
                                 
                                 =
                                 q
                                 
                                    (
                                    C
                                    )
                                 
                                 −
                                 π
                                 
                                    (
                                    V
                                    ∖
                                    C
                                    )
                                 
                                 −
                                 ρ
                                 .
                              
                           
                        
                     
                  

A column entering the basis can be found by computing a minimum cost cycle with respect to 
                        
                           
                              Q
                              
                                 i
                                 j
                                 k
                              
                           
                           +
                           
                              π
                              j
                           
                        
                      for each (i, j) ∈ A, (j, k) ∈ A. Let 
                        
                           
                              
                                 q
                                 (
                                 
                                    C
                                    p
                                 
                                 )
                              
                              ¯
                           
                           =
                           
                              min
                              
                                 C
                                 ∈
                                 C
                              
                           
                           
                              
                                 q
                                 (
                                 C
                                 )
                              
                              ¯
                           
                        
                     . If 
                        
                           
                              
                                 q
                                 (
                                 
                                    C
                                    p
                                 
                                 )
                              
                              ¯
                           
                           ≥
                           0
                        
                      then the current solution is optimal. Otherwise we select column Cp
                      to enter the basis.

                        Theorem 1
                        
                           If the column Cp entering the basis corresponds to a tour, then it is an optimal tour.
                        

Consider any cycle C. Since column Cp
                            is the selected column to enter the basis we have

                              
                                 
                                    
                                       
                                          
                                             q
                                             (
                                             
                                                C
                                                p
                                             
                                             )
                                          
                                          ¯
                                       
                                       =
                                       q
                                       
                                          (
                                          
                                             C
                                             p
                                          
                                          )
                                       
                                       −
                                       π
                                       
                                          (
                                          V
                                          ∖
                                          
                                             C
                                             p
                                          
                                          )
                                       
                                       −
                                       ρ
                                       ≤
                                       q
                                       
                                          (
                                          C
                                          )
                                       
                                       −
                                       π
                                       
                                          (
                                          V
                                          ∖
                                          C
                                          )
                                       
                                       −
                                       ρ
                                       .
                                    
                                 
                              
                           If cycle C is also a tour, then q(Cp
                           ) ≤ q(C).□

As we mentioned in the previous section, a column entering the basis can be found by computing a minimum cost cycle in G with respect to the new cost 
                           
                              
                                 Q
                                 
                                    i
                                    j
                                    k
                                 
                              
                              +
                              
                                 π
                                 j
                              
                           
                        . Looking for a cycle having minimum negative cost with respect to a quadratic objective is itself an interesting combinatorial optimization problem, which is NP-hard (Aggarwal et al., 2000; Galbiati, Gualandi, & Maffioli, 2014). In this section we explain how to update the linearized models, presented in Section 2, to solve the pricing problems.

Consider the AQTSP formulation. Following Fischer et al. (2014) we transform the problem to an Asymmetric Generalized TSP (AGTSP) on a new graph 
                           
                              G
                              ¯
                           
                        . The AGTSP is an extension of the ATSP where we are given a partition of nodes into groups and we are required to find a minimum length tour that includes exactly one node from each group (Karapetyan & Gutin, 2012). In our transformation, the set of arcs in G are considered as a set of nodes in 
                           
                              
                                 G
                                 ¯
                              
                              ,
                           
                         and then are partitioned into n clusters 
                           
                              
                                 V
                                 i
                              
                              =
                              
                                 {
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 A
                                 :
                                 j
                                 ≠
                                 i
                                 }
                              
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              
                              ,
                              n
                           
                        . Moreover, for each pair of arcs (i, j), (j, k) with i ≠ k, a new arc 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                              ∈
                              A
                           
                         is introduced with the cost 
                           
                              
                                 Q
                                 
                                    i
                                    j
                                    k
                                 
                                 ′
                              
                              =
                              
                                 Q
                                 
                                    i
                                    j
                                    k
                                 
                              
                           
                         if Qijk
                         > 0. The only difference of this transformation with the one proposed by Fischer et al. (2014) is that in their model infeasible arcs are also created, though penalized by big costs. The resulting formulation is as follows:

                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                Q
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ,
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             1
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ,
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            k
                                                            ,
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            k
                                                            ,
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             =
                                             0
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∉
                                                            S
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                            ∈
                                                            
                                                               V
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               j
                                                               ,
                                                               k
                                                               )
                                                            
                                                            ∈
                                                            
                                                               V
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∅
                                             ≠
                                             S
                                             ⊊
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             A
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where variables yijk
                         indicate whether arc 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                              ∈
                              A
                           
                         is selected or not in the optimal solution. Constraints (41) require a solution to include exactly one of the arcs leaving a cluster, while constraints (42) require a solution to include exactly one of the arcs entering a cluster. Constraints (43) are equivalent to network flow conservation constraints and ensure that a solution tour is uninterrupted and continuous. Finally, constraints (44) eliminate all subtours.

The following proposition is a straightforward result implied by construction of 
                           
                              G
                              ¯
                           
                        .

                           Proposition 2
                           
                              For any tour
                              
                                 
                                    T
                                    ∈
                                    T
                                 
                               
                              in G there exists an n-arc cycle
                              
                                 
                                    T
                                    ¯
                                 
                               
                              in
                              
                                 
                                    G
                                    ¯
                                 
                               
                              that goes through each cluster exactly once with
                              
                                 
                                    q
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    
                                       q
                                       ′
                                    
                                    
                                       (
                                       
                                          T
                                          ¯
                                       
                                       )
                                    
                                 
                               
                              and vice versa.
                           

Using Proposition 2, one can obtain an optimal solution for AQTSP by solving an AGTSP on 
                           
                              G
                              ¯
                           
                        . The following Theorem shows a possibility to reduce the size of the AGTSP formulation.

                           Theorem 3
                           
                              Constraints 
                              
                                 (41)
                               
                              in problem AGTSP are redundant and can be removed from the model.
                           

Suppose y
                              * is a feasible solution for problem AGTSP after removing constraint (41) and define, for each i ∈ V,

                                 
                                    
                                       
                                          
                                             ϵ
                                             i
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         j
                                                         ,
                                                         k
                                                         ∈
                                                         V
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         )
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                                k
                                             
                                             *
                                          
                                          .
                                       
                                    
                                 
                              We show that 
                                 
                                    
                                       ϵ
                                       i
                                    
                                    =
                                    1
                                 
                               for all i ∈ V. For that, we consider cluster 
                                 
                                    V
                                    s
                                 
                              . Since constraint (42) is satisfied for cluster 
                                 
                                    V
                                    s
                                 
                               by y
                              *, i.e.,

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ,
                                                         j
                                                         ∈
                                                         V
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         k
                                                         ,
                                                         s
                                                         ,
                                                         j
                                                         )
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                k
                                                s
                                                j
                                             
                                             *
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                 
                              there must exist a node 
                                 
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    ∈
                                    
                                       V
                                       s
                                    
                                 
                               with in-degree one in the tour, while the in-degree of all other nodes in cluster 
                                 
                                    V
                                    s
                                 
                               is zero. Hence by (43) the out-degree of node (s, t) must be equal to one while the out-degree of all the other nodes in the same cluster must be zero.□

As a consequence of Theorem 3, AGTSP simplifies as follows:

                           
                              
                                 
                                    AGTSP":
                                    
                                    min
                                    
                                    
                                       {
                                       
                                          ∑
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             )
                                             ∈
                                             A
                                          
                                       
                                       
                                          Q
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                          y
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                       :
                                       
                                       
                                          (
                                          42
                                          )
                                       
                                       --
                                       
                                          (
                                          45
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

Now let us consider the pricing problem of MP. Finding a negative reduced cost cycle for this problem is equivalent to solve a modified version of problem AGTSP’, w.r.t. the new cost 
                           
                              
                                 Q
                                 
                                    i
                                    j
                                    k
                                 
                              
                              +
                              
                                 π
                                 j
                              
                              ,
                           
                         in which each cluster is visited at most once. The formulation is as follows:

                           
                              (46)
                              
                                 
                                    
                                       
                                          
                                             PP:
                                             
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                (
                                                
                                                   Q
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   π
                                                   j
                                                
                                                )
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                (
                                                ρ
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      V
                                                   
                                                
                                                
                                                   π
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ,
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            k
                                                            ,
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             1
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            S
                                                            ,
                                                            j
                                                            ∉
                                                            S
                                                            ,
                                                            k
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≥
                                             ℓ
                                             
                                                (
                                                S
                                                )
                                             
                                             
                                             ∅
                                             ≠
                                             S
                                             ⊊
                                             V
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             43
                                             )
                                             ,
                                             (
                                             45
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where constraints (46) are the so-called resource constraint which enforce the solution to visit each cluster at most once. Constraints (47) are referred to as connectivity constraints. The right-hand side ℓ(S) is 1 if at least one of the clusters 
                           
                              
                                 V
                                 i
                              
                              ,
                           
                         
                        i ∈ S visited, otherwise 
                           
                              ℓ
                              (
                              S
                              )
                              =
                              0
                           
                        .

It should be observed that by forcing the solution of the pricing problem to be a cycle with negative cost we can easily remove constraints (47) from the pricing model. Therefore, finding a cycle with negative reduced cost is simply a matter of finding a path originating and ending at each node (i, j) of graph 
                           
                              G
                              ¯
                           
                         having a negative cost and satisfying the resource constraint (46). Since dual variables π are defined on each cluster 
                           
                              
                                 V
                                 i
                              
                              ,
                           
                         the problem of finding a negative reduced cost cycle can be formulated as resource-constrained elementary shortest path problem. Let 
                           
                              
                                 q
                                 ¯
                              
                              
                                 s
                                 t
                              
                           
                         denote the cost of the resource-constrained elementary shortest path from origin node (s, t) to itself in 
                           
                              G
                              ¯
                           
                        . The pricing problem can be written as:

                           
                              
                                 
                                    
                                       min
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                          ∈
                                          A
                                       
                                    
                                    
                                       {
                                       
                                          q
                                          
                                             s
                                             t
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

The solution of the subproblems provides either a certificate of optimality of the current solution (λ, π, ρ) or a new column Cp
                         that will be added to the master problem. It is worth pointing out that solving the pricing subproblem to optimality is only needed to prove optimality of the current primal and dual solutions; one can stop solving the subproblem whenever a negative reduced cost column is found (Barnhart, Johnson, Nemhauser, Savelsbergh, & Vance, 1998). This happens because adding this column to 
                           
                              C
                              ¯
                           
                         ensures that the new dual solution (π, ρ) will be different, and therefore the termination of the algorithm.

Column generation methods usually suffer from slow convergence to the optimal solution and tailing off effects. Primal degeneracy, dual degeneracy and instability in the behavior of dual variables are well known to be the main causes of this phenomenon (Gilmore & Gomory, 1961; Kallehauge, Larsen, & Madsen, 2006).

To control the dual variables during the solution process, we use the stabilized column generation approach proposed by Du Merle, Villeneuve, Desrosiers, and Hansen (1999). This approach combines the box step method (Marsten, Hogan, & Blankenship, 1975) with a kind of descent method proposed by Kim, Chang, and Lee (1995). The box step method introduces a box around the previous dual vector and modifies the master problem such that the feasible dual space is limited to the area defined by these boxes, while the latter tries to adapt the master problem so that the distance separating a dual solution from the previous optimal dual solution is linearly penalized.

In order to present the idea, let us rewrite the restricted version of the master problem MP, for 
                           
                              
                                 C
                                 ¯
                              
                              ⊆
                              C
                              ,
                           
                         as the following model:

                           
                              (48)
                              
                                 
                                    
                                       
                                          
                                             RMP:
                                             
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   C
                                                   ∈
                                                   
                                                      C
                                                      ¯
                                                   
                                                
                                             
                                             q
                                             
                                                (
                                                C
                                                )
                                             
                                             
                                                λ
                                                C
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   C
                                                   ∈
                                                   
                                                      C
                                                      ¯
                                                   
                                                   :
                                                   i
                                                   ∈
                                                   C
                                                
                                             
                                             
                                                λ
                                                C
                                             
                                             ≥
                                             1
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             39
                                             )
                                             ,
                                             (
                                             40
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where constraints (48) are obtained by subtracting each constraint (38) from (39) and state that each i ∈ V must be covered by at least one cycle. Note that since the set partitioning constraints admit negative dual values which can be problematic for the sub-problem, we used a relaxed version of the problem as the first step of the stabilization approach.

Consider the dual variables π associated with the constraints (48) and bound each πi
                         in the interval 
                           
                              [
                              
                                 δ
                                 i
                                 −
                              
                              ,
                              
                                 δ
                                 i
                                 +
                              
                              ]
                           
                        . These bounds are first given as parameters to the model and then automatically updated during the process. The dual variable πi
                         can take values outside the given bounds, but the dual objective is then penalized by 
                           
                              
                                 
                                    ɛ
                                 
                                 i
                                 −
                              
                              
                                 (
                                 
                                    δ
                                    i
                                    −
                                 
                                 −
                                 
                                    π
                                    i
                                 
                                 )
                              
                           
                         if 
                           
                              
                                 π
                                 i
                              
                              <
                              
                                 δ
                                 i
                                 −
                              
                           
                         and by 
                           
                              
                                 
                                    ɛ
                                 
                                 i
                                 +
                              
                              
                                 (
                                 
                                    δ
                                    i
                                    +
                                 
                                 −
                                 
                                    π
                                    i
                                 
                                 )
                              
                           
                         if 
                           
                              
                                 π
                                 i
                              
                              >
                              
                                 δ
                                 i
                                 +
                              
                           
                        . The dual of RMP then becomes:

                           
                              
                                 
                                    
                                       
                                          
                                             SRP:
                                             
                                             max
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                π
                                                i
                                             
                                             −
                                             
                                                
                                                   ɛ
                                                
                                                
                                                   i
                                                
                                                −
                                             
                                             
                                                ω
                                                i
                                                −
                                             
                                             −
                                             
                                                
                                                   ɛ
                                                
                                                
                                                   i
                                                
                                                +
                                             
                                             
                                                ω
                                                i
                                                +
                                             
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   C
                                                
                                             
                                             
                                                π
                                                i
                                             
                                             ≤
                                             q
                                             
                                                (
                                                C
                                                )
                                             
                                             
                                             C
                                             ∈
                                             
                                                C
                                                ¯
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                π
                                                i
                                             
                                             +
                                             
                                                ω
                                                i
                                                −
                                             
                                             ≥
                                             
                                                δ
                                                i
                                                −
                                             
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                π
                                                i
                                             
                                             −
                                             
                                                ω
                                                i
                                                +
                                             
                                             ≤
                                             
                                                δ
                                                i
                                                +
                                             
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             π
                                             ,
                                             
                                                ω
                                                −
                                             
                                             ,
                                             
                                                ω
                                                +
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ρ
                                             
                                             unrestricted
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The primal of the stabilized restricted master problem, and hence the dual of SRP, is:

                           
                              (49)
                              
                                 
                                    
                                       
                                          
                                             SRMP:
                                             
                                             min
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   C
                                                   ∈
                                                   
                                                      C
                                                      ¯
                                                   
                                                
                                             
                                             q
                                             
                                                (
                                                C
                                                )
                                             
                                             
                                                λ
                                                C
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   V
                                                
                                             
                                             −
                                             
                                                δ
                                                i
                                                −
                                             
                                             
                                                μ
                                                i
                                                −
                                             
                                             +
                                             
                                                δ
                                                i
                                                +
                                             
                                             
                                                μ
                                                i
                                                +
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   C
                                                   ∈
                                                   
                                                      C
                                                      ¯
                                                   
                                                   :
                                                   i
                                                   ∈
                                                   C
                                                
                                             
                                             
                                                λ
                                                C
                                             
                                             −
                                             
                                                μ
                                                i
                                                −
                                             
                                             +
                                             
                                                μ
                                                i
                                                +
                                             
                                             ≥
                                             1
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   C
                                                   ∈
                                                   
                                                      C
                                                      ¯
                                                   
                                                
                                             
                                             
                                                λ
                                                C
                                             
                                             =
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                μ
                                                i
                                                −
                                             
                                             ≤
                                             
                                                
                                                   ɛ
                                                
                                                
                                                   i
                                                
                                                −
                                             
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (51)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                μ
                                                i
                                                +
                                             
                                             ≤
                                             
                                                
                                                   ɛ
                                                
                                                
                                                   i
                                                
                                                +
                                             
                                             
                                             i
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                    
                                       
                                       
                                          
                                             λ
                                             ,
                                             
                                                μ
                                                −
                                             
                                             ,
                                             
                                                μ
                                                +
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This method is referred to as BoxPen stabilization since the bounds 
                           
                              (
                              
                                 δ
                                 −
                              
                              ,
                              
                                 δ
                                 +
                              
                              )
                           
                         on the original dual variables π can be represented by a bounding box containing the current dual solution.

In order to use the stabilized models efficiently, one must initialize and update the parameters correctly. In order to reduce the dual variables’ variations, select 
                           
                              [
                              
                                 δ
                                 −
                              
                              ,
                              
                                 δ
                                 +
                              
                              ]
                           
                         to form a small box containing the current dual solution, and solve the problem SRMP. At the first iteration, when no solution is available, the dual variables π can be simply estimated. If the new π lies in the box 
                           
                              [
                              
                                 δ
                                 −
                              
                              ,
                              
                                 δ
                                 +
                              
                              ]
                              ,
                           
                         reduce its width and augment the penalty given by 
                           
                              
                                 ɛ
                              
                              −
                           
                         and 
                           
                              
                                 ɛ
                              
                              +
                           
                        . Otherwise, enlarge the box and decrease the penalty. The update could be performed in each iteration, or alternatively, each time a dual solution of currently best value is obtained. In Section 6 we discuss more about the updating process.

From now on, we use CG and SCG to denote the basic version of the column generation and its stabilized version for solving problem MP.

In this section we present our computational experiments on the lower bound computations for the AQTSP. We used the AMPL modeling language (Fourer, Gay, & Kernighan, 1987) with Cplex 12.0.1 as linear solver for the RMP and as a mixed integer linear solver for the pricing problem on an Intel Core i5-2410M CPU with 2.30 GHz and 6 GB RAM in single processor mode. We implemented the algorithms for solving the PRLT and the LP models in the C++ language. In the following we present the test instances, the parameter setting of the stabilized column generation approach, and provide the comparison of the lower bounding approaches in details.

In order to evaluate the presented methods we considered three classes of instances from the literature (Fischer et al., 2014). The first and the second classes (Random and Reload) are randomly generated instances, while the third one, Real, arises in an application of computational biology (Fischer et al., 2014; Jäger & Molitor, 2008). The Random data set consists of a class of randomly generated instances with size ranging from 
                           
                              n
                              =
                              5
                           
                         to 
                           
                              n
                              =
                              25
                              ,
                           
                         where quadratic costs are defined as an integer number uniformly chosen within the set 
                           
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              10000
                              }
                           
                        . The Reload data set are instances on random graphs 
                           
                              G
                              =
                              (
                              V
                              ,
                              A
                              )
                           
                         with different number of nodes and arcs are generated as follows: For each V with n ∈ {15, 20} arc (i, j), i, j ∈ V, i ≠ j is present with probability 
                           
                              p
                              ∈
                              {
                              
                                 1
                                 2
                              
                              ,
                              1
                              }
                           
                        . If an arc (i, j) is present, then it is colored randomly with one of the colors 
                           
                              1
                              ,
                              …
                              
                              ,
                              d
                           
                         where d ∈ {5, 10, 20}. Based on the cost cts
                         of changing from color t to color s, two different data sets Reload1 and Reload2 are considered.

We implemented the stabilized column generation approach using different sets of initial values. In the following we present the results of some preliminary experiments whose purpose was to initialize and update the parameters.

We initialized 
                           
                              δ
                              −
                           
                         and 
                           
                              δ
                              +
                           
                         at 
                           
                              −
                              1000
                           
                         and 1000, respectively. The vector parameter 
                           
                              
                                 ɛ
                              
                              −
                           
                         and 
                           
                              
                                 ɛ
                              
                              +
                           
                         were selected as 
                           
                              −
                              5
                           
                         and 5, respectively and were kept fixed throughout the solution process. We updated the parameter 
                           
                              (
                              
                                 δ
                                 −
                              
                              ,
                              
                                 δ
                                 +
                              
                              )
                           
                         from 
                           
                              (
                              −
                              1000
                              ,
                              1000
                              )
                           
                         to 
                           
                              (
                              
                                 π
                                 ˜
                              
                              −
                              100
                              ,
                              
                                 π
                                 ˜
                              
                              +
                              100
                              )
                              ,
                           
                         where 
                           
                              π
                              ˜
                           
                         is the current dual solution, only if the column returned by the subproblem had a non-negative reduced cost and 
                           
                              
                                 (
                                 
                                    μ
                                    −
                                 
                                 ,
                                 
                                    μ
                                    +
                                 
                                 )
                              
                              ≠
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                        . The stopping criteria of the stabilized column generation algorithm is 
                           
                              
                                 
                                    q
                                    (
                                    C
                                    )
                                 
                                 ¯
                              
                              ≥
                              0
                           
                         and 
                           
                              
                                 (
                                 
                                    μ
                                    −
                                 
                                 ,
                                 
                                    μ
                                    +
                                 
                                 )
                              
                              =
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                        .

In order to show the effectiveness of stabilization, we compare the computational time of column generation to its stabilized version on instances with dimension 
                           
                              n
                              =
                              20
                           
                         for all data sets in Fig. 1
                        . For the Random and Reload data sets the results are the geometric averages over ten instances of size 
                           
                              n
                              =
                              20
                           
                        . The results show that the stabilization is very effective, especially for the Reload and the Real instances.

As we proved in Theorem 3, if the column entering the basis corresponds to a tour, then it is an optimal tour. Therefore, in our CG approach, a solution of the pricing problem is optimal for the master problem MP if it covers all the nodes i ∈ V. Since looking for a single cycle in the pricing problem requires some kind of subtour elimination constraint, we restrict the search to find a single cycle or a multiple one (a collection of cycles) with negative cost. Therefore, when no more new columns can be priced out, a solution of the master problem MP gives a lower bound for the original problem.

In Tables 1
                        
                        –3
                        , we present our computational results. We compare different lower bounding procedures proposed in the paper in terms of arithmetic average gap and geometric average computational time. The formula we used to compute the percent gaps is 
                           
                              100
                              ×
                              (
                              Opt
                              −
                              Lb
                              )
                              /
                              Opt
                              ,
                           
                         where Opt and Lb stand for the lower bound and the optimal solution values, respectively. All the optimal objective values obtained from Fischer (2014). Moreover, we compare our bounding procedures with bounds presented by Fischer (2014) in terms of average gap; the first one is the bound of the LPF formulation obtained by dynamically separating the subtour elimination constraints (3) by means of the LEMON Graph Library (Dezs, Jüttner, & Kovács, 2011), while the second one 
                           
                              LPF
                              +
                           
                         considers additional specific valid inequalities to LPF. Since the experiments have been done on different computers, it is difficult to establish a comparison in terms of computational times between our algorithms and those of Fischer (2014).


                        Table 1 reports the results for Random instances. Each row of the tables reports the average results over 10 instances of the same size. The problem size (n) is found in the first column of the table. The next three columns, from left to right, give the percent gaps obtained using the compact formulation LPFMTZ, the subgradient implementation of PRLT, and the SCG. The CPU execution times of each approach are given in the next two columns of the table. The execution time of solving the LP relaxation of LPFMTZ is less than 1 second for all instances and we did not report it in the table. The last two columns of the table report the percent gaps obtained using two lower bounds LPF and 
                           
                              LPF
                              +
                           
                         presented by Fischer (2014).

As we can observe from the results in Table 1, the SCG outperforms the best literature bounds LPF and 
                           
                              LPF
                              +
                           
                         when the size of the instances grows, and the difference becomes more evident for the largest instances. The bounds provided by PRLT are always better than those obtained by the compact linearized formulation LPFMTZ, and LPF formulation of Fischer (2014) when the size is over a certain threshold, but at the price of increased computational effort. Another interesting result observed from Table 1, is the quality of bounds obtained using the compact formulation LPFMTZ. The results indicate that the duality gaps implied by the LPF formulation of Fischer (2014) and the compact formulation LPFMTZ are competitive (especially when the dimension of the problem is increased). This shows that the main difficulty of the AQTSP for Random instances lies in the quadratic structure of the objective function rather than the TSP structure.


                        Table 2 presents the computational results for the Reload1 and Reload2 instances. Again, each row of the tables reports the average results over ten instances of the same size. The first two columns indicate the problem size (n) and the probability and number of colors (p, c). The next three columns, from left to right, give the percent average gaps obtained by LPFMTZ, PRLT, and SCG. The CPU execution times of each approach (except LPFMTZ) are given in the next two columns of the table. Again, the running time of solving the LP relaxation of LPFMTZ is less than 1 second for all instances and we did not report it in the table. The last two columns report the best known literature lower bounds LPF and 
                           
                              LPF
                              +
                           
                         for the Reload presented by Fischer (2014). The results in this table confirm the indications arising from the random instances, namely that the SCG, with the exception of a few classes of instances, is much better than all the other bounds. The bounds obtained by PRLT are better than those of LPFMTZ, are competitive to the bounds of LPF (Fischer, 2014), but worse than the bounds of 
                           
                              LPF
                              +
                           
                        .


                        Table 3 presents the computational results for Real instances. The structure of the table is the same as Table 1, but each row reports the results for a single instance. These data set seems to be much easier than the previous classes of instances. Fischer (2014) pointed out that all instances have been solved in the root-node of the branch-and-bound-tree using 
                           
                              LPF
                              +
                           
                        . As we can observe also from the table, the bounds obtained by LPF are tighter with respect to the previous classes of instances. Comparing the remaining, the SCG is comparable or even better than LPF (especially when the size of the instances grows), the PRLT bounds are better than LPFMTZ and competitive with those of LPF, but with the cost of increasing the running time.

@&#CONCLUSIONS@&#

In this paper we studied lower bounding schemes for the AQTSP. We proposed a cycle formulation for the problem and solved the resulting LP problem by a Column Generation approach. To solve the pricing problem of the Column Generation approach we used some modified version of the linearized formulations in the literature. To overcome the problems of instability in the behavior of dual variables of the presented master problem, we used a stabilized column generation approach. Moreover, we applied a specialized version of the reformulation-linearization technique on a compact formulation of the AQTSP, and developed an effective Lagrangian relaxation scheme to derive the associated lower bounds. Computational experiments show the value of our approach: first, the column generation approach is very promising as it outperforms the others on difficult test instances. Second, the linearized formulation of AQTSP combined with the compact formulation of Miller et al. (1960) for the ATSP provides bounds which (in contrast to ATSP) are competitive to those obtained by the linearized formulation combined with the Dantzig–Fulkerson–Johnson formulation (Dantzig et al., 1954). Finally, the bounds provided by the reformulation-linearization technique are always better than those of the compact linearized formulation, but with considerably increased running time.

@&#ACKNOWLEDGMENT@&#

The first author has been supported by the German Research Foundation (DFG) under grant BU 2313/2.

@&#REFERENCES@&#

