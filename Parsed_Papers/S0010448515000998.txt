@&#MAIN-TITLE@&#Enhanced medial-axis-based block-structured meshing in 2-D

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method is described for using the medial axis for block-structured meshing.


                        
                        
                           
                           The hitherto neglected angular information in the medial axis is shown to be useful.


                        
                        
                           
                           Geometry concavities are dealt with effectively.


                        
                        
                           
                           The surface is decomposed into m-sided and submappable subregions.


                        
                        
                           
                           The final meshes are of high quality for all types of 2-D geometry.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Medial axis

Quad mesh

Multiblock decomposition

Block-structured

Mesh singularities

Cross-field

@&#ABSTRACT@&#


               
               
                  New techniques are presented for using the medial axis to generate decompositions on which high quality block-structured meshes with well-placed mesh singularities can be generated. Established medial-axis-based meshing algorithms are effective for some geometries, but in general, they do not produce the most favourable decompositions, particularly when there are geometric concavities. This new approach uses both the topological and geometric information in the medial axis to establish a valid and effective arrangement of mesh singularities for any 2-D surface. It deals with concavities effectively and finds solutions that are most appropriate to the geometric shapes. Resulting meshes are shown for a number of example models.
               
            

@&#INTRODUCTION@&#

An assessment of the relative performances of multiblock structured meshes of turbomachinery that were generated by medial-axis-based methods, Cartesian grid methods and by manual interactive work was made in a recent paper  [1]. Adjoint error analyses in CFD simulations showed that the medial-axis-based methods generated higher quality meshes and this can be attributed to their boundary-sympathetic block configurations. But despite their relative effectivenesses, there are still some obvious improvements to be made, such as more natural treatment of concavities and responsiveness to geometric shapes. Addressing these limitations by employing the neglected geometric information in the medial axis is the objective of this work.

For a 2-D surface, the medial axis is defined as the set of points where each point, 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 ˆ
                              
                           
                        , has a centred inscribed circle, 
                           U
                        , that touches the boundary entities at more than a single point. Distinct parts of the medial axis are characterised by the number of touching points of 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                        .


                        Medial edges connect subsets of the points with two touching points and they usually make up the majority of the medial axis. The radius of 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         is called the medial radius, 
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                        , and the subtended angle between the radii of 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         to the touching points is called the medial angle, 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                        . A special type of medial edge feature that frequently occurs is termination at a convex corner where 
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                         shrinks to zero. The corresponding medial edge is called a flare or flange. These are all illustrated in Fig. 1
                        .


                        Medial vertices represent the meeting points of medial edges as 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         transitions from one boundary pair to another. In standard cases three touching points are involved. In special cases a medial vertex is equidistant to more than three touching points. There are two other special cases, the first being a medial vertex at the centre of a circular arc with 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         in finite contact. The other is a curvature contact scenario, such as near the end of the major principal axis of an ellipse. There, the curvature of 
                           U
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         equals that of the boundary at the touching point, which results in a single touching point belonging to a medial vertex with 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                         equal to zero (cf.  Fig. 10).

Quad meshing by medial axis decomposition was first conceived by Nackman and Srinivasan  [2]. They noticed that the medial axis presented a well-defined natural decomposition of the surface and used it without alterations to split the surface into blocks. Some additional rules for merging the produced blocks were devised to improve the suitability of the decomposition for meshing.

A better method was proposed by Tam and Armstrong  [3] that produces higher quality decompositions. They developed a strategy for using a Constrained Delaunay Triangulation (CDT) of a set of boundary points, whose circumcenters approximate the medial axis to an acceptable accuracy, to assemble ‘shape molecules’ characterising a mesh topology. By inserting cuts between the medial vertices the shape molecules are reduced to ‘shape atoms’ which are topological 4-, 5- and 6-sided polygons. Each of these are meshable by midpoint subdivision  [4] and an integer programming method can be used to find allowable division numbers on the subblock edges  [5,6]. An augmented algorithm with this approach has been implemented in the commercial software of Abaqus  [7], offering automatic high-quality meshing capability.

More recently, Rigby  [8] proposed an algorithm called ‘TopMaker’. It consists of a few simple rules for creating suitable cuts at medial vertices and along the medial axis and it is surprisingly effective in generating pleasing decompositions for a certain class of geometries.

Additional related methods include  [9] which is less general and has rules specifically tailored for managing circular holes. The ‘d-MAT’ method used by Xia and Tucker  [10,1] has similar rules to the TopMaker method and it produces comparable decompositions.

Mapped meshing  [11] is the most long-established method for generating quad meshes. The standard method involves solving for a boundary-fitted curvilinear coordinate system on the surface. The range of surfaces for which it is effective is limited to near rectangular simply connected surfaces and regular annuli. Mapped meshing with other simple mesh topologies has also been developed for triangular and polygon surfaces  [12]. Submapping  [13] extends the range of applicable surfaces to include those with ‘blocky’ profiles, not necessarily with convex corners but which allow logical mappings of the boundaries to a Cartesian coordinate system. The decomposition strategy for quad meshing, such as the aforementioned medial-axis based methods, is to subdivide complex domains into quadrilateral, polygon and ‘blocky’ subregions on which mapped meshing methods can be used.

The advancing front or paving method  [14] involves building layers of elements in stages, working inwards from the boundaries. When layers overlap the element connectivities are readjusted to produce a valid mesh. This often results in the creation of many irregular valence nodes, or singularities, along the collision zones of layers, which is typically around the medial axis. Unconstrained paving  [15] achieves more regular mesh patterns by identifying common configurations in the local geometry and topology before resolving the mesh connectivities in the collision zones, although there are some heuristic parameters that must be fine tuned for each geometry.

Traditional Cartesian grid methods  [16] comprise overlaying regular grids on the geometry. Elements that intersect with the boundary are removed and then the remaining outer elements are adapted and added to generate a boundary conformal mesh. While this approach generates meshes that are predominately structured, the mesh on the boundaries is inevitably irregular and of poor quality. Much better meshes can be produced by new methods which first seek a transformed representation of the surface where every edge follows a Cartesian coordinate system before applying a Cartesian grid  [17]. This is similar in principal to the submapping method. The grid transformed back to the original surface has regular connectivities and generally has good element qualities. However, the transformation may unavoidably have undesirable singularities on the boundary which cause poor mesh quality locally. A simple example of a geometry where the problem arises is a triangle. Ideally, the necessary singularities should occur in the interior to keep boundary element quality high and to minimise the overall mesh distortion.

The newest most advanced algorithms for quad mesh generation include Morse–Smale complex methods  [18] and cross-field methods  [19–22]. Both approaches solve scalar and or vector fields on the surface from which quadrangular charts are extracted and meshed by parametrisation methods. Impressive high-quality quad meshes with target size and direction sensitivity can be produced by these methods. Their downside is that they are complex, quite expensive and require a suitable triangulation of the surface.

A method with some similarities to the presented method is LayTracks  [23]. Its strategy for mesh generation is fundamentally different to decomposition based methods—it uses the medial axis to generate a mesh directly as opposed to using it to infer mesh properties and with that information create a decomposition. The algorithm creates regularly spaced thin strips between medial radii pairs from medial axis points to touching points. These strips are then divided up into quadrilateral elements. In common with the presented method, the mesh singularities are pushed to the interior and high quality elements are produced at the boundaries. In contrast to the presented method, at concavities the mesh rows curl around the sharp tips and elements tend to degenerate to triangles, similar to the TopMaker method.

In comparison to other widely used general quad meshing algorithms, such as paving or Cartesian grid methods, the TopMaker and T&A algorithms can usually generate superior block-structured meshes; they have fewer mesh singularities and simpler topologies than paved meshes and have higher quality elements on the boundaries than Cartesian meshes. However, they are in fact only effective for certain types of surfaces.

Neither handles concavities particularly well. The TopMaker algorithm makes the assumption that all corners are flat except those connected to flares which have one element. Using the definitions given in Section  3 (Fig. 6 (right)), these translate as 
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              =
                              2
                            and 
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              =
                              1
                            type corners respectively. Whilst this makes the decision making in the algorithm very straightforward, it doesn’t always lead to serviceable decompositions. Consider the decomposition shown in Fig. 2
                            (top right). The mesh is forced to wrap around the trailing edges which leads to highly distorted blocks. Therefore, in general, acceptable quality decompositions are only created for geometries with corner angles 
                              <
                              ∼
                              5
                              π
                              /
                              4
                           .

The T&A method performs slightly better with concavities as borne out in Fig. 2  (bottom right). In the first stage the surface is split by the best candidate CDT edges that fit most closely with the assigned mesh patterns at the corners, which are chosen based on corner angles. The splitting edges for concavity removal are shown in Fig. 2  (bottom left). This strategy can at least produce 
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              =
                              3
                            and 4 type corner patterns but it often does not lead to the best overall mesh topology. For example, the method always creates a split between concave vertices that share an inscribed circle and this results in the sub-optimal decomposition shown in Fig. 3
                            (centre) for the indents surface. But the most obvious and best quality decomposition is shown in Fig. 3  (right).

Another limitation is the almost exclusive use of topological information in the medial axis and the disregard of important embedded geometrical shape information. For example, each of the three surfaces shown in Fig. 4
                             (top row) are the same as far as the TopMaker and T&A algorithms are concerned because the medial axis topologies are identical. Thus, they are all treated as rectangular blocks for which a regular grid can be used in their interiors. This is appropriate for the first surface but a regular grid mapped to the second and third will be highly distorted. Preferably, they would be decomposed, or more specifically, the block topology solutions should contain some positive–negative singularity pairs, to give the block structures sketched in Fig. 4 (bottom row—middle and right).

Herein, a new approach is described which combines the medial-axis-based decomposition algorithms and the frame-field decomposition approaches  [24,19,25]. It makes use of the valuable and hitherto neglected geometric information in the medial axis, namely the medial angle, which leads to the development of a simple well-reasoned method for finding a suitable configuration of mesh singularities on the medial axis. This is essentially the critical step in a mesh generation problem, as explained briefly in the next section. It also gives a basic description of element orientation over the whole surface.

Based on this information, a new medial-axis-based decomposition method is presented. It provides a general way of handling concavities and is precisely responsive to important geometric shapes so that preferred solutions like those shown in Fig. 3  (right) and Fig. 4  (bottom row) are found automatically.

The method is applicable to all surfaces with computable medial axes, which are non-closed surfaces with boundaries. The more curved the surface is the less worthwhile the idea becomes that boundary alignment constraints should govern its mesh solution. For this reason the presented method, and indeed all medial-axis-based methods, are most suited to near-planar surfaces or small patches of curved ones.

@&#INTRODUCTION@&#

The new techniques are reasoned in terms of a rigorous theoretical description of unstructured quad meshes with infinitesimal properties that was described by Bunin  [26]. The theory gives insight into the fundamental properties of quad meshes and explains the crucial role played by mesh singularities, which are nodes where the regular grid connectivities are disrupted.

The key results of Bunin’s theory are: 
                           
                              •
                              The governing equation of an orthogonal mesh is 
                                    
                                       (1)
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                S
                                             
                                          
                                          ϕ
                                          =
                                          K
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          Z
                                          ≥
                                          −
                                          4
                                          .
                                       
                                    
                                  This is a Poisson equation and it describes stationary heat conduction amongst other physical phenomena. 
                                    
                                       
                                          Δ
                                       
                                       
                                          S
                                       
                                    
                                  is the Laplace–Beltrami operator where the subscript 
                                    S
                                  indicates that it is measured with respect to the parametric space of the surface and not the 3-D space that the surface is embedded in. 
                                    ϕ
                                  is a scalar field on the surface that controls the mesh, 
                                    K
                                  is the Gaussian curvature of the surface, 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                  is the type of a mesh singularity and 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                  is a Dirac delta function centred at the point on the surface where the singularity occurs, 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                 .

The type of a mesh singularity is given by an integer, 
                                    k
                                 , which essentially denotes the number of additional elements above four at a node.

The variable 
                                    ϕ
                                  corresponds to 
                                    −
                                    ln
                                    h
                                 , where 
                                    h
                                  is the edge length of an infinitesimal square element.

The curvatures of the mesh edges are related to the variation in the 
                                    ϕ
                                 -field by 
                                    
                                       (2)
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                g
                                             
                                          
                                          =
                                          
                                             
                                                ∂
                                                ϕ
                                             
                                             
                                                ∂
                                                e
                                             
                                          
                                          ≡
                                          
                                             〈
                                             
                                                
                                                   ∇
                                                
                                                
                                                   S
                                                
                                             
                                             ϕ
                                             ,
                                             
                                                e
                                             
                                             〉
                                          
                                          ,
                                       
                                    
                                  where 
                                    
                                       
                                          κ
                                       
                                       
                                          g
                                       
                                    
                                  denotes the geodesic curvature of the edge and its intrinsic normal, 
                                    
                                       e
                                    
                                 , is defined by 
                                    
                                       e
                                    
                                    =
                                    
                                       n
                                    
                                    ×
                                    
                                       t
                                    
                                  where 
                                    
                                       n
                                    
                                  and 
                                    
                                       t
                                    
                                  are the surface normal and the edge tangent vector respectively.

A cross-field describing the mesh directionality (see  [27–29,24,19]) is closely related to the 
                                    ϕ
                                 -field. The total change in angle of a cross along a curve, 
                                    α
                                 , (in a parallel-transport sense) is given by 
                                    
                                       (3)
                                       
                                          Δ
                                          θ
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                α
                                             
                                          
                                          
                                             
                                                ∂
                                                ϕ
                                             
                                             
                                                ∂
                                                e
                                             
                                          
                                          d
                                          s
                                          .
                                       
                                    
                                 
                              

The medial axis supplies a link between nearby boundaries and provides a means to assess the geometry locally. An intuitive idea is that the relative orientations of the boundaries indicate preferred patterns of the mesh in the intermediate areas. It is convenient to use a cross-field representation of the mesh to demonstrate this.

Given two points with assigned crosses, the total change in angle of any cross-field between them is unique up to a multiple of 
                           π
                           /
                           2
                        . The multiplying integer, call it 
                           n
                        , essentially specifies the number of 
                           π
                           /
                           2
                         turns made by a cross moving between the points. With reference to Bunin’s continuum theory, the total flux through a curve linking the points is given by 
                           
                              (4)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       α
                                    
                                 
                                 ≡
                                 
                                    
                                       ∫
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       e
                                    
                                 
                                 
                                 d
                                 s
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       κ
                                    
                                    
                                       g
                                    
                                 
                                 
                                 d
                                 s
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       b
                                    
                                 
                                 −
                                 
                                    
                                       θ
                                    
                                    
                                       a
                                    
                                 
                                 −
                                 n
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         with the symbol definitions as indicated in Fig. 5
                        
                         (left). A smooth regular cross-field is the most reasonable default target in the absence of supplementary information on the local target size and orientation of the mesh. This equates to looking for a mesh with minimal element distortion. With this target the total flux should be minimised and the optimum integer for 
                           n
                         can be computed by 
                           
                              (5)
                              
                                 
                                    
                                       
                                          n
                                          |
                                       
                                    
                                    
                                       
                                          optimum
                                       
                                    
                                 
                                 =
                                 
                                    round
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                α
                                             
                                          
                                          
                                             
                                                κ
                                             
                                             
                                                g
                                             
                                          
                                          
                                          d
                                          s
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                b
                                             
                                          
                                          −
                                          
                                             
                                                θ
                                             
                                             
                                                a
                                             
                                          
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For the particular case of a planar surface with the curve 
                           α
                         composed of the medial radii (traversed so that 
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                         is positive), then 
                           
                              
                                 ∫
                              
                              
                                 α
                              
                           
                           
                              
                                 κ
                              
                              
                                 g
                              
                           
                           
                           d
                           s
                           =
                           π
                           −
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                        . If the touching points are on boundary edges then 
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                         are zero, therefore 
                           
                              (6)
                              
                                 
                                    
                                       
                                          n
                                          |
                                       
                                    
                                    
                                       
                                          optimum
                                       
                                    
                                 
                                 =
                                 
                                    round
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          −
                                          
                                             
                                                θ
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The three basic mesh-flow types between boundary edges linked by the medial axis and their preferred medial angle ranges are summarised in the table in Fig. 5  (right). It may be helpful to think of the medial axis being aligned with the cross-field for 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                           =
                           0
                         and 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                           =
                           2
                         and running diagonally through the cross-field for 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                           =
                           1
                        .

If the touching points are on concave vertices 
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                         are not zero in general. To determine the optimum mesh-flow type in these cases the cross directions from which 
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                         are measured are chosen so that their values are minimised, and the non-zero entry 
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                           −
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                         is included in the calculation of 
                           
                              
                                 Φ
                              
                              
                                 α
                              
                           
                        . Alternatively, the medial radii directions can be adjusted by 
                           
                              
                                 θ
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 b
                              
                           
                         before 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                         is measured as shown in Fig. 6  (left).

The optimum mesh patterns at boundary corners can be decided by minimising the associated total flux radiating from the corner in the 
                           ϕ
                        -field. Bunin gives an analytic expression for the strength of a point source necessary at a corner which involves the corner angle, 
                           
                              
                                 θ
                              
                              
                                 c
                              
                           
                        , and an integer, 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                        , that specifies how many elements occur there. Choosing 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                         to minimise the strength gives the optimum ranges shown in Fig. 6  (right).

The cross-field degenerates at a corner vertex in the same way as it does at a mesh singularity. At a corner vertex the cross-field has a number of directions which are always evenly distributed angularly. Except for 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                           =
                           0
                         (which is especially degenerate), the cross-field has two directions pointing along the edges forming the corner and 
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              )
                           
                         directions pointing into the surface.

If the optimum mesh-flow behaviour is selected for every position of the medial axis the positions of mesh singularities are in effect decided. A general method for identifying these positions involves a flux balance calculation. Supposing the surface is sliced into a series of thin regions by medial radii as shown in Figs. 7–9
                        
                        
                        
                        . Treating each sliver as a control area, a flux balance analysis can be carried out using the medial angle-dependent values for the total fluxes across pairs of medial radii as described above. The total fluxes across the small boundary segments are given by the differences in angle of the adjacent boundary-aligned crosses (which should be small). The flux residual must equal 
                           k
                           π
                           /
                           2
                         where the integer 
                           k
                         denotes the type of singularity present. Most usually only simple singularities occur, i.e.   
                           k
                           =
                           ±
                           1
                         or ‘positive’ and ‘negative’ singularities. In some special cases higher-order singularities can occur, an example of which is at the central medial vertex of a regular hexagon, as shown in Fig. 9  (bottom right) where a 
                           k
                           =
                           2
                         type singularity occurs. This is identified in a general fashion.

At a medial vertex where the touching circle has a finite contact with a boundary there are a range of medial angle values associated with the medial vertex. These features can be equated to the limiting case where the boundary curve tends to a circular arc from an elliptical arc. Thus, the singularity type at the medial vertex is given by 
                           
                              (7)
                              
                                 k
                                 =
                                 −
                                 
                                    floor
                                 
                                 
                                    (
                                    
                                       
                                          
                                             max
                                          
                                          
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For example, a semi-circular end of a rectangular block has a corresponding medial vertex with 
                           
                              max
                           
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    m
                                 
                              
                              )
                           
                           =
                           π
                        . Therefore, a 
                           k
                           =
                           −
                           2
                         singularity is placed on the medial vertex. This is illustrated in Fig. 10.

A basic algorithm was developed to use the principles just described to find an effective arrangement of mesh singularities. Its general steps are outlined in Algorithm 1 below. It was implemented in a Python program using the CADfix API  [31].


                        
                           
                              
                           
                        
                     

The essential output of the algorithm is a layer of information on the medial axis detailing the mesh-flow type between associated boundaries and the positions where singularities occur. Line geometry is also created purely to illustrate the method which is shown in the next section.

Some illustrative results of the algorithm are shown Figs. 11 and 12
                        
                        . Two images are included for each example, one showing the medial axis and artefacts representing the solution process, and the other showing a crudely defined cross-field. When creating the crosses their overall turning behaviour over the medial radii is taken from the assigned mesh-flow type and a smooth and even rate of change of angle along the medial radii is assumed.

The geometries in Fig. 11 were seen previously in Figs. 2–4. The results match the ‘preferred decomposition’ topologies in each case. The additional positive and negative singularities appear in their natural positions in the ‘squeezed’ and ‘pinched’ rectangle surfaces. And, the concavities in the multi-element aerofoil and indents surfaces are managed nicely. The result in Fig. 12 for test surface 1 contains some collections of singularities in close proximity to each other. Depending on the target coarseness of the quad mesh these should be merged together to cancel each other out (for positive and negative singularity pairs) or to create higher-order singularities (for singularities of the same sign). The proposed decomposition method described in the next section achieves this.

One approach to generating a multiblock decomposition is to trace the separatrices of a cross-field. This has been explored in  [19,32,20] and robust and effective cross-field initialisation and streamline tracing on a triangulation of the surface have been developed. A decomposition of the multi-element aerofoil surface is shown in Fig. 13
                         that was created by the method of  [32] with a cross-field and singularities that correspond with those in  Fig. 11. In principle, these methods could be applied in the present method (with some modifications to clean up the cross-fields) but it would eliminate the niche that the medial axis decomposition methods fit into. Medial-axis-based methods should be ‘lightweight’, cheap, fast and robust, otherwise they offer no advantage over more sophisticated methods  [20–22] that can handle more general problems with target size and orientation fields. To fulfil these objectives undemanding techniques are called for to split the geometry using the medial axis in a similar manner to the T&A and TopMaker methods, but that can produce enhanced decompositions. The splits should follow the implicit mesh solution already achieved.

The algorithm as laid out in Algorithm 1 is simplistic and easy to understand. Moreover, it is easy to program. However, a more streamlined algorithm is possible which does not use a fixed set of analysis positions on the medial axis to define small control areas on which to compute flux balances. After assigning optimum mesh flow across the medial axis, flux imbalances, hence singularity occurrences, can only happen at three types of position on the medial axis: (1) points with critical 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                         values of 
                           π
                           /
                           4
                         and 
                           3
                           π
                           /
                           4
                         with touching points on smooth boundary edges, (2) medial vertices and (3) points along sections of the medial axis with a touching point on a concave corner where the cross-field direction for measuring the adjusted 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                         switches from one to another. This means that only these points really need to be assessed. So, a more efficient algorithm would concentrate on identifying these important analysis points on the medial axis and simply check them to find mesh singularities.

The primary objective of the decomposition process is to create logically convex polygon subregions around the mesh singularities and for the remaining subregions to be submappable. The adjective logical is used to indicate a property that is distinguished after the mesh is locally mapped to a Cartesian form with all edges along the coordinate directions. Logically convex 
                        m
                     -sided polygons can be meshed using the simple templates shown in Fig. 14
                     . The 
                        3
                        +
                     -sided polygon templates are the applications of mid-point subdivision. The 0-sided template is a widely used topology for meshing circles (see e.g.  [33]) and 1- and 2-sided templates are proposed simple candidates. Submappable regions can be meshed by a number of methods  [13,34,35]. Two examples of submapped meshes are shown in Fig. 15
                     .

By not fixing the singularity positions they are free to be repositioned inside their polygon subregions to suit the target element sizes and therefore allow better quality meshes to be produced. However, the proposed method cannot always succeed in creating a polygon subregion around a mesh singularity. Sometimes, its position is fixed instead and it appears as a corner vertex of adjacent subregions.

The medial axis links proximate boundaries and it makes available candidate splits between the boundaries. For two boundary edges coupled by the medial axis, the medial radii spanning between them can be used as decomposition splits. There are two standard types that are serviceable: 
                           n
                           =
                           0
                         and 
                           n
                           =
                           1
                         medial radii pairs as shown in Fig. 16
                        . The 
                           n
                           =
                           0
                         type split is preferable as it does not create a concave corner and medial angles closer to 
                           π
                         and 
                           π
                           /
                           2
                         are more favourable for each respectively.

For a logically concave vertex (i.e.   
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                           =
                           3
                         or 4) there are a discrete number of medial radii connected to the vertex that are allowed to be used as part of a split. These radii are either exactly aligned with the cross-field directions at the corner vertex, or are almost aligned and perpendicular to the edges forming the corner. This is illustrated in Fig. 17
                        .

The most complex scenario is when two concave vertices are on opposite sides of the medial axis. In these cases, there are no legitimate splits composed of pairs of medial radii generally. A simple work-around is to join a splitting edge of one orthogonally to the most suitable opposite splitting edge. This is illustrated in Fig. 18
                        . These splits can be determined as follows: 
                           
                              •
                              At a concave vertex, for one of its cross-field directions find the corresponding point on the medial axis.

If the opposite touching point is on an edge then simply use the medial radii as the second half of the split.

If the opposite touching point is also a concave vertex: 
                                    
                                       –
                                       If 
                                             n
                                             =
                                             0
                                           or 
                                             n
                                             =
                                             1
                                           find a projection to one of the opposite cross-field directions along the adjusted medial radius direction.

If 
                                             n
                                             =
                                             2
                                           find a projection to one of the opposite cross-field directions perpendicular to the adjusted medial radius direction.

A running example will be used to demonstrate the decomposition process steps on test surface surface 1 as they are described.


                        Step 1. Potential splits are determined for concave corners. The splits are named ‘CC
                           i
                        _
                           j
                        ’ where 
                           i
                         is a number identifier for the concave corner and 
                           j
                         is the split number connected to it. These can be seen in Fig. 19
                         as labelled dotted lines.


                        Step 2. A database is assembled for storing a list of neighbouring features for each singularity. All singularities are named (‘S
                           i
                        ’) and each is assessed in turn (in a non-specific order) as the centre singularity with its name as the key to the associative array or hash table. The medial axis is explored in all directions from the centre singularity position. Once another singularity, convex corner or concave corner split is encountered the exploration of that medial axis branch is stopped and a descriptive identifier is added to the neighbouring feature list: 
                           
                              •
                              For a neighbouring singularity its name is added.

For a convex corner an identifier–CX–followed by its 
                                    
                                       
                                          n
                                       
                                       
                                          c
                                       
                                    
                                  type is added.

For a concave corner split its name is added.

An additional Boolean attribute is added with these to mark whether the neighbouring feature is ‘unresolved’ (0) or ‘resolved’ (1), indicating whether or not a split needs to be created between it and the centre singularity in order to produce a convex polygon. The possibilities are as follows: 
                           
                              •
                              If a neighbouring concave corner split creates a logically straight edge or convex corner with respect to the centre singularity it is considered resolved.

If a neighbouring convex corner is of type 
                                    
                                       
                                          n
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    0
                                  (CX0) it is marked unresolved, otherwise it is marked resolved.

A neighbouring finite contact medial axis vertex without a singularity is marked as resolved.

A neighbouring singularity is marked as unresolved.


                        Step 3. Each singularity is dealt with in turn as the centre singularity of the evaluation, with the objective of creating decomposition splits around it to produce a logically convex polygon. If all the neighbouring features are resolved then this has already been achieved. For each unresolved neighbouring feature a split is searched for which would create a logically straight corner (
                           n
                           =
                           0
                        ) across the intermediate portion of the medial axis, between it and the centre singularity. If the unresolved neighbouring feature is not a singularity then splits that create logically convex corners (from the perspective of the centre singularity) are also permitted. The candidate splits that are found are ranked in order to choose the best one where 
                           n
                           =
                           0
                         types are preferred over 
                           n
                           =
                           1
                         and medial angles closer to 
                           π
                         and 
                           π
                           /
                           2
                         are more favourable for each. If no permitted split can be found between the centre singularity and a neighbouring feature then the centre singularity needs to be fixed, or if the neighbouring feature is a singularity then it may by fixed instead.

Fixing a singularity involves putting a split through it with the result that it appears as a corner vertex of subregion blocks in the decomposition, as shown in Fig. 20
                        . It is possible to create the complete decomposition by fixing every singularity, thus generating submappable subregions. However, this strategy would create a complex decomposition with a large number of subregions. Also, it is more desirable to allow singularities to float around inside 
                           m
                        -sided polygons to suit even distributions of element sizes. For these reasons singularities are only fixed when necessary.

If the central singularity has only unresolved neighbouring features which are singularities, it is checked to see if all the neighbouring singularities can be fixed to create a logically convex subregion around the centre singularities. If so, then this is carried out. Otherwise the centre singularity is fixed. In every case the database is updated to record whether the adjacent singularities can be considered resolved.

The route by which the decomposition process is performed for test surface 1 is illustrated in Fig. 21
                           . The order in which singularities are dealt with as the centre singularity follows the arbitrarily assigned numbering. There may be slight variation in the decomposition that is created depending on the arbitrary numbering. However, almost identical meshes should be able to be generated on the possible decompositions. The changes in the database at each point in the process are shown in Fig. 22
                           . The process is carried out as follows: 
                              
                                 1.
                                 With S1 as the centre singularity the two unresolved neighbouring features are S2 and S8. Decomposition splits of type 
                                       n
                                       =
                                       0
                                     are found that can resolve these. Since 
                                       n
                                       =
                                       0
                                     type decomposition splits create logically flat edges, S1 can be considered resolved as a neighbouring feature for S2 and S8.

With S2 as the centre singularity the only unresolved neighbouring feature is S3. However, there is no permitted split between S2 and S3. The first check is to see whether S3 can be fixed to create a logically flat or convex corner from the perspective of S2. It is found that S3 can be fixed to create a logically convex corner for S2. Since S3 is at a medial vertex it is prudent to see if additional decomposition edges can be created so that it can be made resolved for its other neighbouring features. Thus, the third edge is created to produce a logically convex corner from the perspective of S4. S3 has been fixed so nothing remains to be done for it.

With S4 as the centre singularity a logically flat 
                                       
                                          (
                                          n
                                          =
                                          0
                                          )
                                       
                                     split is found between it and S5.

With S5 as the centre singularity all neighbouring features are resolved after setting the concave corner splits CC2_1 and CC2_2.

With S6 as the centre singularity the only unresolved singularity is S7. S7 is fixed and is made resolved as a neighbouring feature of both S6 and S8. S8 now has only resolved neighbouring features so nothing remains to be done for it.

With S9 as the centre singularity all neighbouring features are resolved after setting the concave corner split CC1_2.

With S10 as the centre singularity a split cannot be found to resolve CC_1. Therefore S10 is fixed.

In the previous example the decomposition has been carried out with the intention that all singularities that are not exactly superimposed should be separated. However, it is usually preferable if they are merged together when they are below a minimum distance tolerance of each other. Ideally, the local target mesh size should dictate the tolerance. A geometry-based alternative is to use a fraction of the local medial radius to set the local tolerance value. A reasonable range for the tolerance is 
                           
                              [
                              
                                 
                                    r
                                 
                                 
                                    m
                                 
                              
                              /
                              4
                              ,
                              
                                 
                                    r
                                 
                                 
                                    m
                                 
                              
                              ]
                           
                        .

The singularities which are to be grouped together and merged for the tolerance setting of 
                           3
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                           /
                           4
                         are illustrated in Fig. 23
                        . The database is modified by treating the grouped singularities as a single combined singularity and updating the affected entries to register that, as shown in Table 2
                        .

Since S6 has a sign of 
                           +
                           1
                         and S7 has a sign of 
                           −
                           1
                        , the combined singularity, S6-7, has a net sign of 0. Therefore, it is a regular grid point and it doesn’t need to be treated as a singularity in the decomposition process. It is removed from the database and the entries for adjacent singularities are updated, as shown in Table 3
                        .

There are now fewer singularities to deal with and consequently the decomposition process requires fewer steps and the decomposition that is produced following the same procedure described previously is simpler. The final decomposition with an example mesh is shown in Fig. 24
                        .

Some examples showing the decomposition and example meshes thereon for a selection of surfaces are shown in Fig. 25
                        . The quality of the meshes could be boosted by applying smoothing methods, but this has not been done in order to preserve the decomposition edges in the mesh for clarity.

The ‘preferred decompositions’ which were introduced in Section  1.3.1 are achieved for the ‘squeezed’ rectangle and ‘pinched’ rectangle surfaces.

A decomposition is not shown for the indents surface (Fig. 3) because the solution given by the method does not contain any singularities (Fig. 11), which corresponds with its ‘preferred decomposition’. Therefore, submapping can be applied directly to generate a mesh.

A decomposition is created for the multi-element aerofoil which facilitates a more smoothly varying mesh than that created by the TopMaker and TA algorithms (seen previously in Fig. 2).

The test surface 2 case is a relatively simple geometry but it contains a number of holes and concavities which can cause issues in other decomposition methods. The proposed method produces a pleasing decomposition. The degenerate mesh at the lower right hand corner of the surface may draw disapproval but, theoretically speaking, it is the best way of meshing such an osculating corner.

Other decomposition examples for an ellipse and a circle surface are shown in Fig. 26
                        . Singularities are found at critical angles of 
                           π
                           /
                           4
                         and 
                           3
                           π
                           /
                           4
                         with a short distance between them on the ellipse. Using a low tolerance setting, a decomposition is generated with a topology according to the inferred medial axis solution (left). But with a higher tolerance the ellipse is divided into two 2-sided subregions (right).

The medial axis for a circle is a single point at its centre with a touching circle in complete finite contact. This means that there are four superimposed negative singularities in the solution. No decomposition is necessary and the circle is meshed using the 0-sided template.

In some cases where the surface contains holes additional splits may be required in order to produce submappable regions which are topological discs with a single closed loop of boundary edges. An example would be an annulus which the proposed method would leave as is since a ‘radial grid’ of concentric mesh rows is a good solution. However, if only mapping and submapping algorithms are available then it should be decomposed into a rectangle by creating a decomposition split between the inner and outer boundary loops. It is not difficult to add an extra step to the end of the procedure to check if such splits are required to convert multiply connected subregions to simply connected subregions and to find appropriate splits across the medial axis.

@&#CONCLUSION@&#

A novel approach has been described for using the medial axis to first identify an effective configuration of mesh singularities, and secondly, to decompose the surface for block-structured meshing. The weaknesses of existing medial axis based methods due to assumed mesh behaviour in relation to the medial axis which is inappropriate around concavities are avoided. The proposed methods offer more capable handling of 2-D surfaces of all types for generating high-quality decompositions. And yet, the increased generality does not entail a large increase in complexity.

Future work involves refining the implementation details of the singularity identification and decomposition algorithms. This is not trivial work and substantial effort will be required to develop a reliable and efficient method. However, because the presented methods are based on a solid theory and the rationale is clear for every step of the described algorithms, there should be no major problems lurking in the practical details of a general implementation.

@&#ACKNOWLEDGMENTS@&#

The authors acknowledge the support of ARA and the Technology Strategy Board (TSB) for funding within the Airbus Numerical Simulation and Design (ANSD) Project. The authors would also like to thank TranscenData for their support.

@&#REFERENCES@&#

